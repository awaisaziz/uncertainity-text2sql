{
  "dataset_path": "spider_data",
  "default_provider": "grok",
  "default_model": "grok-4-1-fast-non-reasoning",
  "mode": "generate",
  "num_sample": 100,
  "num_query": 35,
  "max_tokens": 8000,
  "generated": [
    {
      "id": 0,
      "question": "How many singers do we have?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(Name) FROM singer"
        },
        {
          "sql": "SELECT count(Country) FROM singer"
        },
        {
          "sql": "SELECT count(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT count(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT count(Age) FROM singer"
        },
        {
          "sql": "SELECT count(Is_male) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Name) FROM singer"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Country IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer_in_concert"
        },
        {
          "sql": "SELECT count(DISTINCT s.Singer_ID) FROM singer_in_concert s"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT Singer_ID FROM singer_in_concert) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT si.Singer_ID) FROM singer_in_concert si JOIN singer s ON si.Singer_ID = s.Singer_ID"
        },
        {
          "sql": "SELECT count(DISTINCT s.Singer_ID) FROM singer s JOIN singer_in_concert si ON s.Singer_ID = si.Singer_ID"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Singer_ID > 0"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Age > 0"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Age IS NOT NULL AND Age > 0"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID, Name, Country FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer GROUP BY 1 HAVING count(*) > 0"
        },
        {
          "sql": "SELECT sum(1) FROM singer"
        },
        {
          "sql": "SELECT sum(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer"
        },
        {
          "sql": "SELECT count(1) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer GROUP BY ()"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM singer)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM singer) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM singer CROSS JOIN (SELECT 1) AS dummy"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM (SELECT Singer_ID FROM singer UNION SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT cardinality(array_agg(Singer_ID)) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer ORDER BY Singer_ID LIMIT 999999"
        }
      ]
    },
    {
      "id": 1,
      "question": "What is the total number of singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM singer"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Name) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Country) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Age) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Is_male) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Name FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Country IS NOT NULL"
        },
        {
          "sql": "SELECT SUM(1) FROM singer"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer"
        },
        {
          "sql": "SELECT COUNT(1) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID, Name FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Age > 0"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Name) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer GROUP BY Singer_ID) AS T1"
        },
        {
          "sql": "SELECT COUNT(Singer_ID) FROM (SELECT Singer_ID FROM singer GROUP BY Singer_ID) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer GROUP BY 1"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Singer_ID IS NOT NULL AND Name IS NOT NULL THEN 1 ELSE 0 END) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID, ROW_NUMBER() OVER (ORDER BY Singer_ID) as rn FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Singer_ID) FROM (SELECT Singer_ID FROM singer WHERE Song_release_year IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer CROSS JOIN (SELECT 1 as dummy) AS T2"
        },
        {
          "sql": "SELECT COUNT(s.Singer_ID) FROM singer AS s"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Is_male IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(DISTINCT s.Singer_ID) FROM singer AS s"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT COUNT(*) as cnt FROM singer GROUP BY Singer_ID) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Singer_ID > 0 OR Singer_ID IS NULL"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CASE WHEN Age >= 0 THEN Singer_ID END) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer UNION ALL SELECT Singer_ID FROM singer WHERE 1=0) AS T1"
        }
      ]
    },
    {
      "id": 2,
      "question": "Show name, country, age for all singers ordered by age from the oldest to the youngest.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT singer.Name ,  singer.Country ,  singer.Age FROM singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Country ,  Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT s.Name ,  s.Country ,  s.Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM (SELECT * FROM singer) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC LIMIT 10000"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC FETCH FIRST 10000 ROWS ONLY"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC OFFSET 0"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer GROUP BY Name ,  Country ,  Age ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY MAX(Age) DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer t1 ORDER BY t1.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer CROSS JOIN (SELECT 1) t ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age=singer.Age) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Name != '' ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM (SELECT Name ,  Country ,  Age , ROW_NUMBER() OVER (ORDER BY Age DESC) rn FROM singer) WHERE rn <= 10000 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC, Singer_ID"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC, Name"
        },
        {
          "sql": "WITH all_singers AS (SELECT * FROM singer) SELECT Name ,  Country ,  Age FROM all_singers ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age > s1.Age) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC FOR BROWSE"
        },
        {
          "sql": "SELECT * FROM (SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer TABLESAMPLE SYSTEM (100) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESCING"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer s ORDER BY (Age * -1)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY GREATEST(Age) DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC NULLS FIRST"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age + 0 DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Age > -999 ORDER BY Age DESC"
        },
        {
          "sql": "WITH ranked_singers AS (SELECT Name ,  Country ,  Age , RANK() OVER (ORDER BY Age DESC) r FROM singer) SELECT Name ,  Country ,  Age FROM ranked_singers ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC, Singer_ID ASC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer s ORDER BY s.Age DESC, s.Singer_ID DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM (SELECT *, DENSE_RANK() OVER (ORDER BY Age DESC) rk FROM singer) ORDER BY rk"
        }
      ]
    },
    {
      "id": 3,
      "question": "What are the names, countries, and ages for every singer in descending order of age?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT singer.Name ,  singer.Country ,  singer.Age FROM singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT s.Name ,  s.Country ,  s.Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Country ,  Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Name IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT s.Name ,  s.Country ,  s.Age FROM singer s WHERE s.Singer_ID IS NOT NULL ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Age IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM (SELECT * FROM singer) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC FETCH FIRST ROWS ONLY"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESCENDING"
        },
        {
          "sql": "WITH singer_data AS (SELECT * FROM singer) SELECT Name ,  Country ,  Age FROM singer_data ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer GROUP BY Name ,  Country ,  Age ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY MAX(Age) DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age > s1.Age)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer EXCEPT SELECT NULL ,  NULL ,  NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT * FROM (SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC LIMIT 1000000"
        },
        {
          "sql": "SELECT s.Name ,  s.Country ,  s.Age FROM singer s LEFT JOIN singer s2 ON 1=0 ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer CROSS JOIN (SELECT 1) t ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer HAVING 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC OFFSET 0"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM (SELECT Singer_ID ,  Name ,  Country ,  Age FROM singer WHERE 1=1) ORDER BY Age DESC"
        },
        {
          "sql": "WITH RECURSIVE s AS (SELECT * FROM singer UNION ALL SELECT * FROM s) SELECT Name ,  Country ,  Age FROM s ORDER BY Age DESC LIMIT 10000"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC FOR UPDATE"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer s ORDER BY s.Age DESC NULLS LAST"
        },
        {
          "sql": "(SELECT Name ,  Country ,  Age FROM singer ORDER BY Age DESC)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY (Age * -1)"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer t ORDER BY t.Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer WHERE Singer_ID > 0 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name ,  Country ,  Age FROM singer ORDER BY Age + 0 DESC"
        }
      ]
    },
    {
      "id": 4,
      "question": "What is the average, minimum, and maximum age of all singers from France?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' GROUP BY Country"
        },
        {
          "sql": "SELECT avg(s.Age), min(s.Age), max(s.Age) FROM singer AS s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer AS s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE UPPER(Country)  =  'FRANCE'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT Age FROM singer WHERE Country  =  'France') AS t"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' AND Age IS NOT NULL"
        },
        {
          "sql": "SELECT t1.avg_age, t2.min_age, t3.max_age FROM (SELECT avg(Age) AS avg_age FROM singer WHERE Country  =  'France') AS t1, (SELECT min(Age) AS min_age FROM singer WHERE Country  =  'France') AS t2, (SELECT max(Age) AS max_age FROM singer WHERE Country  =  'France') AS t3"
        },
        {
          "sql": "SELECT avg_age, min_age, max_age FROM (SELECT avg(Age) AS avg_age, min(Age) AS min_age, max(Age) AS max_age FROM singer WHERE Country  =  'France') AS stats"
        },
        {
          "sql": "WITH french_stats AS (SELECT Age FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM french_stats"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Age) avg_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France') SELECT avg_age, min_age, max_age FROM stats"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age) AS average, min(Age) AS minimum, max(Age) AS maximum FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT (SELECT avg(Age) FROM singer WHERE Country  =  'France') AS avg_age, (SELECT min(Age) FROM singer WHERE Country  =  'France') AS min_age, (SELECT max(Age) FROM singer WHERE Country  =  'France') AS max_age"
        },
        {
          "sql": "SELECT DISTINCT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country IN ('France')"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT avg(Age), GREATEST(min(Age)), LEAST(max(Age)) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT sum(Age)/count(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT (SELECT avg(Age) FROM singer WHERE Country  =  'France'), (SELECT min(Age) FROM singer WHERE Country  =  'France'), (SELECT max(Age) FROM singer WHERE Country  =  'France')"
        },
        {
          "sql": "SELECT avg(Age), (SELECT min(Age) FROM singer WHERE Country  =  'France'), (SELECT max(Age) FROM singer WHERE Country  =  'France') FROM singer WHERE Country  =  'France' LIMIT 1"
        },
        {
          "sql": "SELECT a, b, c FROM (SELECT avg(Age) a, min(Age) b, max(Age) c FROM singer WHERE Country  =  'France') t"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Age) average_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France')"
        },
        {
          "sql": "SELECT min(Age), avg(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT max(Age), avg(Age), min(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT count(Age), sum(Age), avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age) average, min(Age) minimum, max(Age) maximum FROM singer WHERE Country  =  'France' GROUP BY Country HAVING Country  =  'France'"
        },
        {
          "sql": "SELECT t.avg_val, t.min_val, t.max_val FROM (SELECT avg(Age) avg_val, min(Age) min_val, max(Age) max_val FROM singer WHERE Country  =  'France') t"
        },
        {
          "sql": "WITH f AS (SELECT * FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM f"
        },
        {
          "sql": "WITH RECURSIVE temp(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM temp WHERE n < 1) SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer CROSS JOIN (SELECT 1) t WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT s1.avg_age, s2.min_age, s3.max_age FROM (SELECT avg(Age) avg_age FROM singer WHERE Country  =  'France') s1 CROSS JOIN (SELECT min(Age) min_age FROM singer WHERE Country  =  'France') s2 CROSS JOIN (SELECT max(Age) max_age FROM singer WHERE Country  =  'France') s3"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country || ''  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE length(Country)  =  6 AND Country  =  'France'"
        },
        {
          "sql": "SELECT coalesce(avg(Age), 0), coalesce(min(Age), 0), coalesce(max(Age), 0) FROM singer WHERE Country  =  'France'"
        }
      ]
    },
    {
      "id": 5,
      "question": "What is the average, minimum, and maximum age for all French singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' GROUP BY Country"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT Age FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' AND Is_male IS NOT NULL"
        },
        {
          "sql": "SELECT avg(singer.Age), min(singer.Age), max(singer.Age) FROM singer WHERE singer.Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age) AS average_age, min(Age) AS min_age, max(Age) AS max_age FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE UPPER(Country)  =  'FRANCE'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "WITH french_singers AS (SELECT * FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM french_singers"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' HAVING count(*) > 0"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT Singer_ID, Age FROM singer WHERE Country  =  'France') T1"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s JOIN (SELECT 'France' AS filter) f ON s.Country  =  f.filter"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country IN ('France')"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  ANY(ARRAY['France'])"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer CROSS JOIN (SELECT 1 AS dummy) d WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT t.avg_age, t.min_age, t.max_age FROM (SELECT avg(Age) avg_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France') t"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country  =  'France' AND s2.Singer_ID  =  singer.Singer_ID)"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer LEFT JOIN (SELECT Singer_ID FROM singer WHERE Country != 'France') non_french ON singer.Singer_ID  =  non_french.Singer_ID WHERE non_french.Singer_ID IS NULL"
        },
        {
          "sql": "SELECT p1, p2, p3 FROM (SELECT avg(Age) p1, min(Age) p2, max(Age) p3 FROM singer WHERE Country  =  'France') AS stats"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Age) avg_val, min(Age) min_val, max(Age) max_val FROM singer WHERE Country  =  'France') SELECT avg_val, min_val, max_val FROM stats"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' AND Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT AVG(CAST(Age AS FLOAT)), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT corr(Age, Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT regr_avgx(Age, Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT mode() WITHIN GROUP (ORDER BY Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT stddev(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT variance(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT sum(Age)/count(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT (SELECT avg(Age) FROM singer WHERE Country  =  'France'), (SELECT min(Age) FROM singer WHERE Country  =  'France'), (SELECT max(Age) FROM singer WHERE Country  =  'France')"
        },
        {
          "sql": "SELECT a,b,c FROM (VALUES ((SELECT avg(Age) FROM singer WHERE Country  =  'France'), (SELECT min(Age) FROM singer WHERE Country  =  'France'), (SELECT max(Age) FROM singer WHERE Country  =  'France'))) AS t(a,b,c)"
        },
        {
          "sql": "WITH RECURSIVE french AS (SELECT * FROM singer WHERE Country  =  'France' UNION ALL SELECT * FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM french"
        },
        {
          "sql": "SELECT avg(Age OVER()), min(Age) OVER(), max(Age) OVER() FROM singer WHERE Country  =  'France' LIMIT 1"
        },
        {
          "sql": "SELECT first_value(avg(Age)) OVER(), first_value(min(Age)) OVER(), first_value(max(Age)) OVER() FROM (SELECT Age FROM singer WHERE Country  =  'France') GROUP BY ()"
        }
      ]
    },
    {
      "id": 6,
      "question": "Show the name and the release year of the song by the youngest singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name,Song_release_year FROM singer ORDER BY Age ASC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s WHERE s.Age=(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age= (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Name,s1.Song_release_year FROM singer s1 WHERE s1.Age=(SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age <= ALL(SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s1 WHERE NOT EXISTS(SELECT 1 FROM singer s2 WHERE s2.Age<s1.Age)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s JOIN (SELECT MIN(Age) min_age FROM singer) t ON s.Age=t.min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,Age,RANK() OVER(ORDER BY Age) rnk FROM singer) t WHERE rnk=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,Age,ROW_NUMBER() OVER(ORDER BY Age) rn FROM singer) t WHERE rn=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT *,DENSE_RANK() OVER(ORDER BY Age) rnk FROM singer) t WHERE rnk=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age=(SELECT Age FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s,(SELECT MIN(Age) min_age FROM singer) t WHERE s.Age=t.min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer GROUP BY Name,Song_release_year,Age HAVING Age=MIN(Age) ORDER BY Age LIMIT 1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,MIN(Age) OVER() min_age,Age FROM singer) t WHERE Age=min_age"
        },
        {
          "sql": "SELECT DISTINCT Name,Song_release_year FROM singer s1,singer s2 WHERE s1.Age<=s2.Age AND NOT EXISTS(SELECT 1 FROM singer s3 WHERE s3.Age<s1.Age)"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(Age) min_age FROM singer) SELECT Name,Song_release_year FROM singer,youngest WHERE Age=min_age"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(Age) AS min_age FROM singer) SELECT Name,Song_release_year FROM singer s,min_age_cte c WHERE s.Age=c.min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s1 WHERE s1.Age=(SELECT s2.Age FROM singer s2 ORDER BY s2.Age LIMIT 1)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Singer_ID=(SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s INNER JOIN (SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1) y ON s.Singer_ID=y.Singer_ID"
        },
        {
          "sql": "SELECT FIRST_VALUE(Name) OVER(ORDER BY Age),FIRST_VALUE(Song_release_year) OVER(ORDER BY Age) FROM singer LIMIT 1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age=(SELECT Age FROM (SELECT DISTINCT Age FROM singer ORDER BY Age LIMIT 1) t)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,Age FROM singer ORDER BY Age) t LIMIT 1"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s WHERE s.Age=ANY(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s WHERE Age=(SELECT TOP 1 Age FROM singer ORDER BY Age)"
        },
        {
          "sql": "WITH ranked_singers AS (SELECT Name,Song_release_year,Age,ROW_NUMBER() OVER(PARTITION BY 1 ORDER BY Age) as rn FROM singer) SELECT Name,Song_release_year FROM ranked_singers WHERE rn=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE (Age, Singer_ID) IN (SELECT Age,Singer_ID FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,PERCENT_RANK() OVER(ORDER BY Age) pr FROM singer) WHERE pr=0"
        },
        {
          "sql": "SELECT s1.Name,s1.Song_release_year FROM singer s1 LEFT JOIN singer s2 ON s2.Age<s1.Age WHERE s2.Singer_ID IS NULL"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer MINUS SELECT Name,Song_release_year FROM singer s1 WHERE EXISTS(SELECT 1 FROM singer s2 WHERE s2.Age<s1.Age)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer HAVING MIN(Age)=Age LIMIT 1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,LAG(Age) OVER(ORDER BY Age) prev_age,Age FROM singer) WHERE prev_age IS NULL OR Age=prev_age"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s CROSS JOIN (SELECT MIN(Age) m FROM singer) m WHERE s.Age=m.m"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer QUALIFY ROW_NUMBER() OVER(ORDER BY Age)=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer MATCH_RECOGNIZE(ORDER BY Age MEASURES MATCH_NUMBER() AS mn PATTERN(A) DEFINE A AS TRUE) WHERE mn=1"
        }
      ]
    },
    {
      "id": 7,
      "question": "What are the names and release years for all the songs of the youngest singer?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Name, s1.Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s WHERE s.Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s WHERE s.Age = (SELECT MIN(Age) FROM singer t)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "WITH youngest_age AS (SELECT MIN(Age) AS min_age FROM singer) SELECT Song_Name, Song_release_year FROM singer, youngest_age WHERE Age = min_age"
        },
        {
          "sql": "WITH min_age AS (SELECT MIN(Age) min_age FROM singer) SELECT s.Song_Name, s.Song_release_year FROM singer s, min_age m WHERE s.Age = m.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 WHERE s1.Age = (SELECT s2.Age FROM singer s2 ORDER BY s2.Age LIMIT 1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY Age) rn FROM singer) ranked WHERE rn = 1"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)) y ON s.Singer_ID = y.Singer_ID"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age = (SELECT MIN(Age) FROM singer))"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 JOIN (SELECT MIN(Age) min_age FROM singer) m ON s1.Age = m.min_age"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s1 WHERE Age = (SELECT Age FROM singer ORDER BY Age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT Age FROM (SELECT DISTINCT Age FROM singer ORDER BY Age LIMIT 1) t)"
        },
        {
          "sql": "WITH youngest AS (SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1) SELECT s.Song_Name, s.Song_release_year FROM singer s, youngest y WHERE s.Singer_ID = y.Singer_ID"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 WHERE Age = ALL (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Name, s.Song_release_year FROM singer s INNER JOIN (SELECT Singer_ID, Age FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)) y ON s.Singer_ID = y.Singer_ID"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT Song_Name, Song_release_year, Age FROM singer ORDER BY Age LIMIT 1) LIMIT 1000"
        },
        {
          "sql": "WITH age_stats AS (SELECT MIN(Age) min_age FROM singer) SELECT Song_Name, Song_release_year FROM singer s CROSS JOIN age_stats a WHERE s.Age = a.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age BETWEEN (SELECT MIN(Age) FROM singer) AND (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 WHERE s1.Age <= (SELECT MAX(Age) FROM (SELECT Age FROM singer ORDER BY Age LIMIT 1) t)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age = s.Age AND s2.Age = (SELECT MIN(Age) FROM singer))"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM (SELECT Singer_ID, Name, Song_release_year, RANK() OVER (ORDER BY Age ASC) rnk FROM singer) ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Singer_ID = (SELECT Singer_ID FROM singer ORDER BY Age ASC LIMIT 1)"
        },
        {
          "sql": "WITH singer_ages AS (SELECT Singer_ID, Age FROM singer), min_age_val AS (SELECT MIN(Age) min_age FROM singer_ages) SELECT s.Name, s.Song_release_year FROM singer s JOIN singer_ages sa ON s.Singer_ID = sa.Singer_ID JOIN min_age_val m ON sa.Age = m.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer LEFT JOIN (SELECT Singer_ID FROM singer WHERE Age > (SELECT MIN(Age) FROM singer)) older ON singer.Singer_ID = older.Singer_ID WHERE older.Singer_ID IS NULL"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT *, DENSE_RANK() OVER (ORDER BY Age) AS rnk FROM singer) WHERE rnk = 1"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s WHERE Age = (SELECT Age FROM singer s2 GROUP BY Age ORDER BY MIN(Age) LIMIT 1)"
        },
        {
          "sql": "WITH recursive min_finder AS (SELECT MIN(Age) AS age_val FROM singer) SELECT Song_Name, Song_release_year FROM singer, min_finder WHERE Age = age_val"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer GROUP BY Song_Name, Song_release_year, Age HAVING Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age AND s2.Age IS NOT NULL)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT Song_Name, Song_release_year, FIRST_VALUE(Age) OVER (ORDER BY Age ROWS UNBOUNDED PRECEDING) as min_age FROM singer) t WHERE Age = min_age"
        }
      ]
    },
    {
      "id": 8,
      "question": "What are all distinct countries where singers above age 20 are from?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Age > 20 GROUP BY s.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Country IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country FROM singer WHERE Age > 20) t GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 21 - 1"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age >= 21 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age >= 21"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age NOT BETWEEN 0 AND 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE NOT (Age <= 20)"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE NOT (s.Age <= 20) GROUP BY s.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 GROUP BY Country HAVING COUNT(*) > 0"
        },
        {
          "sql": "WITH young AS (SELECT Country FROM singer WHERE Age <= 20) SELECT DISTINCT Country FROM singer WHERE Country NOT IN (SELECT Country FROM young WHERE Country IS NOT NULL)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer EXCEPT SELECT Country FROM singer WHERE Age <= 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 INTERSECT SELECT Country FROM singer"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = singer.Country AND s2.Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT t1.Country FROM singer t1 WHERE EXISTS (SELECT 1 FROM singer t2 WHERE t2.Country = t1.Country AND t2.Age > 20)"
        },
        {
          "sql": "SELECT Country FROM singer s1 WHERE Age > 20 AND Country IN (SELECT Country FROM singer s2 WHERE s2.Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT Country, Age FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MIN(Age) > 20"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MAX(Age) > 20 AND MIN(Age) > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer GROUP BY Country, Age HAVING Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING COUNT(CASE WHEN Age > 20 THEN 1 END) > 0"
        },
        {
          "sql": "SELECT DISTINCT t.Country FROM singer t JOIN (SELECT Country FROM singer WHERE Age > 20 GROUP BY Country) t2 ON t.Country = t2.Country"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 JOIN singer s2 ON s1.Country = s2.Country WHERE s2.Age > 20 GROUP BY s1.Country"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 UNION SELECT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "WITH older_singers AS (SELECT DISTINCT Country FROM singer WHERE Age > 20) SELECT Country FROM older_singers"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Singer_ID, Country FROM singer WHERE Age > 20) t GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Name FROM (SELECT Country AS Name FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > (SELECT AVG(Age) - 10 FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s WHERE 20 < (SELECT Age FROM singer s2 WHERE s2.Singer_ID = s.Singer_ID)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE rowid IN (SELECT rowid FROM singer WHERE Age > 20) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 ORDER BY Country LIMIT 10000"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country ORDER BY COUNT(*) DESC"
        }
      ]
    },
    {
      "id": 9,
      "question": "What are  the different countries with singers above age 20?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Age > 20 GROUP BY s.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Country IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, Age FROM singer) t WHERE t.Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age >= 21"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 AND Country <> '' GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer AS s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer t WHERE t.Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MIN(Age) > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 UNION SELECT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM (SELECT DISTINCT Country, Age FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Age > 20) t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT c.Country FROM (SELECT Singer_ID FROM singer WHERE Age > 20) a JOIN singer c ON a.Singer_ID = c.Singer_ID GROUP BY c.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 INTERSECT SELECT Country FROM singer"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 WHERE s1.Age > 20 AND NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age <= 20)"
        },
        {
          "sql": "WITH older_singers AS (SELECT Country FROM singer WHERE Age > 20) SELECT DISTINCT Country FROM older_singers"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING COUNT(*) > 0 AND MIN(Age) > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT Country, MAX(Age) as max_age FROM singer GROUP BY Country) t WHERE max_age > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID > 0 AND Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer s WHERE Age > 20 LIMIT 10000 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age BETWEEN 21 AND 150"
        },
        {
          "sql": "SELECT c FROM (SELECT Country as c, Age FROM singer WHERE Age > 20 GROUP BY Country, Age) t GROUP BY c"
        },
        {
          "sql": "SELECT DISTINCT substring(Country,1,100) FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 QUALIFY ROW_NUMBER() OVER (PARTITION BY Country ORDER BY Name) = 1"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 ORDER BY Country"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age - 20 > 0 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer FETCH FIRST 10000 ROWS ONLY WHERE Age > 20"
        },
        {
          "sql": "WITH RECURSIVE t AS (SELECT Country FROM singer WHERE Age > 20 UNION SELECT Country FROM t WHERE 1=0) SELECT DISTINCT Country FROM t"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country FROM singer WHERE Age > 20 UNION ALL SELECT Country FROM singer WHERE Age > 20) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT trim(Country) FROM singer WHERE Age > 20"
        }
      ]
    },
    {
      "id": 10,
      "question": "Show all countries and the number of singers in each country.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country,COUNT(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY singer.Country"
        },
        {
          "sql": "SELECT s.Country,COUNT(*) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country,COUNT(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,SUM(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Name AS Country,COUNT(*) FROM (SELECT DISTINCT Country FROM singer) Name GROUP BY Name"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(*) FROM singer s2 WHERE s2.Country=s1.Country) FROM singer s1 GROUP BY Country"
        },
        {
          "sql": "SELECT c.Country,COUNT(*) FROM (SELECT DISTINCT Country FROM singer) c JOIN singer s ON c.Country=s.Country GROUP BY c.Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer WHERE Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer WHERE Name IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(Singer_ID) FROM singer s2 WHERE s2.Country=s1.Country) FROM (SELECT DISTINCT Country FROM singer) s1"
        },
        {
          "sql": "WITH country_count AS (SELECT Country FROM singer) SELECT Country,COUNT(*) FROM country_count GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY Country HAVING COUNT(*)>0"
        },
        {
          "sql": "SELECT Country,GREATEST(COUNT(*),0) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY Country ORDER BY COUNT(*) DESC"
        },
        {
          "sql": "SELECT Country,COUNT(Singer_ID) FROM singer GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "WITH singer_stats AS (SELECT Country,1 as cnt FROM singer) SELECT Country,SUM(cnt) FROM singer_stats GROUP BY Country"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(*) FROM singer WHERE Country=singer.Country) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country,COUNT(s2.Singer_ID) FROM singer s JOIN singer s2 ON s.Country=s2.Country GROUP BY s.Country"
        },
        {
          "sql": "SELECT DISTINCT s1.Country,(SELECT COUNT(*) FROM singer s2 WHERE s2.Country=s1.Country) cnt FROM singer s1"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM (SELECT Singer_ID,Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(DISTINCT Singer_ID) FROM singer s2 WHERE s2.Country=s1.Country) FROM singer s1 GROUP BY Country"
        },
        {
          "sql": "WITH countries AS (SELECT DISTINCT Country FROM singer), singers AS (SELECT Country FROM singer) SELECT c.Country,COUNT(s.Country) FROM countries c LEFT JOIN singers s ON c.Country=s.Country GROUP BY c.Country"
        },
        {
          "sql": "SELECT Country,SUM(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(CASE WHEN Age>0 THEN Singer_ID END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(Singer_ID) FROM singer s2 WHERE s2.Country=s1.Country GROUP BY s2.Country) FROM (SELECT DISTINCT Country FROM singer) s1"
        },
        {
          "sql": "SELECT s.Country,COUNT(*) OVER (PARTITION BY s.Country) FROM singer s GROUP BY s.Country,s.Singer_ID"
        },
        {
          "sql": "WITH RECURSIVE cnt(singer_count,Country) AS (SELECT COUNT(*),Country FROM singer GROUP BY Country) SELECT Country,singer_count FROM cnt"
        },
        {
          "sql": "SELECT Country,COUNT(*) FROM singer GROUP BY Country UNION SELECT Country,COUNT(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country,COUNT(DISTINCT Singer_ID) FROM (SELECT Singer_ID,Country FROM singer UNION SELECT Singer_ID,Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country,(SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer WHERE Country=t.Country) u) FROM (SELECT DISTINCT Country FROM singer) t GROUP BY Country"
        }
      ]
    },
    {
      "id": 11,
      "question": "How many singers are from each country?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Age) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Is_male) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country, count(*) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT s.Country, count(s.Singer_ID) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT singer.Country, count(*) FROM singer GROUP BY singer.Country"
        },
        {
          "sql": "SELECT DISTINCT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY singer.Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY singer.Country"
        },
        {
          "sql": "SELECT s.Country, count(s.Name) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM (SELECT Singer_ID, Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM (SELECT * FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Name IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Country IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "WITH c AS (SELECT Country FROM singer) SELECT Country, count(*) FROM c GROUP BY Country"
        },
        {
          "sql": "WITH singer_data AS (SELECT * FROM singer) SELECT Country, count(*) FROM singer_data GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country HAVING count(*) > 0"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country ORDER BY Country ASC"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country ORDER BY count(*) DESC"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY 1"
        },
        {
          "sql": "SELECT 1 AS Country_col, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country AS c, count(Singer_ID) FROM singer GROUP BY c"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING count(*) > 0"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, count(*) as cnt FROM singer GROUP BY Country) t"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, count(Singer_ID) FROM singer GROUP BY Country) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT Country, count(*) FROM singer GROUP BY Country) t"
        },
        {
          "sql": "SELECT Country, sum(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, sum(1) OVER (PARTITION BY Country) FROM (SELECT DISTINCT Singer_ID, Country FROM singer) t GROUP BY Country"
        }
      ]
    },
    {
      "id": 12,
      "question": "List all song names by singers above the average age.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) AS avg_val FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age > avg_val"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) avg_val FROM singer) SELECT s.Song_Name FROM singer s, avg_age a WHERE s.Age > a.avg_val"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age GROUP BY s2.Age HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ALL (SELECT Age FROM singer WHERE Age < (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > SOME (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age, AVG(Age) OVER() AS avg_age FROM singer) t WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY Age DESC) rn FROM singer) t WHERE rn <= (SELECT COUNT(*) * 0.5 FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer GROUP BY Song_Name HAVING MIN(Age) > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE (SELECT COUNT(*) FROM singer s2 WHERE s2.Age >= s1.Age) < (SELECT COUNT(*) * 0.5 FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT s1.Song_Name FROM singer s1 JOIN singer s2 ON s1.Age > s2.Age GROUP BY s1.Song_Name HAVING COUNT(s2.Singer_ID) > (SELECT COUNT(*) * 0.5 FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age >= (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer CROSS JOIN (SELECT AVG(Age) avg_age FROM singer) avg WHERE Age > avg.avg_age"
        },
        {
          "sql": "SELECT s.Song_Name FROM singer s INNER JOIN (SELECT AVG(Age) avg_age FROM singer) a ON 1=1 WHERE s.Age > a.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer GROUP BY Country)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age FROM singer) t WHERE Age > (SELECT AVG(Age) FROM t)"
        },
        {
          "sql": "SELECT Song_Name FROM singer EXCEPT SELECT Song_Name FROM singer WHERE Age <= (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer INTERSECT SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age BETWEEN (SELECT AVG(Age) FROM singer) AND 999"
        },
        {
          "sql": "SELECT Song_Name FROM singer HAVING Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE NOT (Age <= (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "WITH RECURSIVE avg_calc AS (SELECT AVG(Age) avg_age FROM singer) SELECT Song_Name FROM singer, avg_calc WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID > 0 AND Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM (SELECT Song_Name, Age FROM singer WHERE Age IS NOT NULL) WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s WHERE s.Age > (SELECT AVG(Age) FROM singer WHERE Singer_ID != s.Singer_ID)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE (Age - (SELECT AVG(Age) FROM singer)) > 0"
        },
        {
          "sql": "SELECT Song_Name FROM singer, (SELECT AVG(Age) AS avg_a FROM singer) AS a WHERE Age > a.avg_a"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT * FROM singer ORDER BY Age DESC LIMIT (SELECT CEIL(COUNT(*)/2) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT MEDIAN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > AVG(Age) OVER()"
        }
      ]
    },
    {
      "id": 13,
      "question": "What are all the song names by singers who are older than average?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT s1.Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT s.Song_Name FROM singer s WHERE s.Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) AS avg_val FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age > avg_val"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) FROM singer) SELECT Song_Name FROM singer WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ALL (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 JOIN (SELECT AVG(Age) AS avg_age FROM singer) s2 ON s1.Age > s2.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer CROSS JOIN (SELECT AVG(Age) AS avg_age FROM singer) t WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer GROUP BY 1)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT * FROM singer) s WHERE s.Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > AVG(Age) GROUP BY Singer_ID, Name, Country, Song_Name, Song_release_year, Age, Is_male HAVING COUNT(*) = 1"
        },
        {
          "sql": "SELECT Song_Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s.Age > AVG(s2.Age))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer GROUP BY Singer_ID HAVING AVG(Age) > (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Singer_ID IN (SELECT s1.Singer_ID FROM singer s1 WHERE s1.Age > (SELECT AVG(s2.Age) FROM singer s2))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE (SELECT AVG(Age) FROM singer) < Age"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(Age) FROM singer s2 WHERE s2.Singer_ID != s1.Singer_ID)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Age, Song_Name, ROW_NUMBER() OVER (ORDER BY Age DESC) rn FROM singer) s WHERE rn <= (SELECT COUNT(*) FROM singer WHERE Age > AVG(Age))"
        },
        {
          "sql": "SELECT Song_Name FROM singer EXCEPT SELECT Song_Name FROM singer WHERE Age <= (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer INTERSECT SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(Age) FROM singer s2 CROSS JOIN (SELECT 1) t)"
        },
        {
          "sql": "WITH singer_avg AS (SELECT Singer_ID, AVG(Age) OVER () AS avg_age FROM singer) SELECT Song_Name FROM singer s JOIN singer_avg sa ON s.Singer_ID = sa.Singer_ID WHERE s.Age > sa.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM (SELECT Age FROM singer) t)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s OUTER APPLY (SELECT AVG(Age) AS avg_age FROM singer) t WHERE s.Age > t.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age BETWEEN (SELECT AVG(Age) FROM singer)+0.0001 AND 999"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age - (SELECT AVG(Age) FROM singer) AS age_diff FROM singer) t WHERE age_diff > 0"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer WHERE Age > (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > SOME (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age >= s1.Age AND s2.Age >= (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer GROUP BY Song_Name HAVING MIN(Age) > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1, (SELECT AVG(Age) avg_age FROM singer) t WHERE s1.Age > t.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer UNION SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "WITH RECURSIVE avg_calc AS (SELECT AVG(Age) AS avg_age FROM singer UNION ALL SELECT avg_age FROM avg_calc) SELECT Song_Name FROM singer, avg_calc WHERE Age > avg_age LIMIT (SELECT COUNT(*) FROM singer WHERE Age > AVG(Age))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE (Age * 1.0) > (SELECT AVG(Age * 1.0) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM (SELECT Song_Name, Age FROM singer) s WHERE Age > (SELECT AVG(Age) FROM singer) ORDER BY Song_Name LIMIT 99999"
        }
      ]
    },
    {
      "id": 14,
      "question": "Show location and name for all stadiums with a capacity between 5000 and 10000.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity > 4999 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity >= 5000 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity > 4999 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE 5000 <= Capacity AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity IN (SELECT Capacity FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000)"
        },
        {
          "sql": "SELECT s1.Location,s1.Name FROM stadium s1 WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity >= 5000 AND s2.Capacity <= 10000 AND s1.Stadium_ID = s2.Stadium_ID)"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity NOT BETWEEN 0 AND 4999 AND Capacity NOT BETWEEN 10001 AND 999999"
        },
        {
          "sql": "SELECT Location,Name FROM (SELECT * FROM stadium) AS s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT DISTINCT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT s.Location,s.Name FROM stadium s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium t WHERE t.Capacity >= 5000 AND t.Capacity <= 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Stadium_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Capacity IS NOT NULL"
        },
        {
          "sql": "WITH valid_stadiums AS (SELECT * FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000) SELECT Location,Name FROM valid_stadiums"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity > 5000 - 1 AND Capacity < 10000 + 1"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE NOT (Capacity < 5000 OR Capacity > 10000)"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity - 5000 >= 0 AND 10000 - Capacity >= 0"
        },
        {
          "sql": "SELECT s.Location,s.Name FROM stadium s INNER JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000) AS t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Location"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Name"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 LIMIT 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Stadium_ID > 0 AND Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Location IS NOT NULL AND Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Name <> '' AND Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM (SELECT Location,Name,Capacity FROM stadium WHERE Capacity >= 0) AS sub WHERE sub.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium s1 WHERE s1.Capacity IN (SELECT s2.Capacity FROM stadium s2 WHERE s2.Capacity >= 5000 AND s2.Capacity <= 10000)"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN GREATEST(5000,0) AND LEAST(10000,999999)"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE ABS(Capacity - 7500) <= 2500"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE MOD(Capacity,1) = 0 AND Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity = ANY(VALUES (5000),(5001),(5002)) UNION SELECT Location,Name FROM stadium WHERE Capacity = ANY(VALUES (9998),(9999),(10000))"
        },
        {
          "sql": "SELECT Location,Name FROM stadium CROSS JOIN (SELECT 1 AS x WHERE 1=1) AS dummy WHERE stadium.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location,Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND 1=1"
        },
        {
          "sql": "SELECT Location,Name FROM stadium LEFT JOIN (SELECT 1 AS dummy) ON 1=1 WHERE stadium.Capacity BETWEEN 5000 AND 10000"
        }
      ]
    },
    {
      "id": 15,
      "question": "What are the locations and names of all stations with capacity between 5000 and 10000?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity > 4999 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT stadium.Location, stadium.Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity > 4999 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE 5000 <= Capacity AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity IN (SELECT Capacity FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT s1.Location, s1.Name FROM stadium s1 WHERE s1.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 INTERSECT SELECT Location, Name FROM stadium WHERE Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM (SELECT * FROM stadium) WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 LIMIT 10000"
        },
        {
          "sql": "SELECT DISTINCT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Location"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Name"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Capacity"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Stadium_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Location IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Name IS NOT NULL"
        },
        {
          "sql": "SELECT s.Location, s.Name FROM stadium s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium t WHERE t.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE NOT (Capacity < 5000 OR Capacity > 10000)"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity - 5000 >= 0 AND 10000 - Capacity >= 0"
        },
        {
          "sql": "SELECT Name AS Location, Location AS Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity > 4999.9 AND Capacity < 10000.1"
        },
        {
          "sql": "SELECT Location, Name FROM stadium s1 JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000) s2 ON s1.Stadium_ID = s2.Stadium_ID"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Stadium_ID = stadium.Stadium_ID AND s2.Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "WITH valid_stadiums AS (SELECT * FROM stadium WHERE Capacity BETWEEN 5000 AND 10000) SELECT Location, Name FROM valid_stadiums"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Highest IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Lowest IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Average IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Capacity IS NOT NULL"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity * 1.0 BETWEEN 5000 AND 10000"
        }
      ]
    },
    {
      "id": 16,
      "question": "What is the maximum capacity and the average of all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(stadium.Capacity), avg(stadium.Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(s.Capacity), avg(s.Capacity) FROM stadium AS s"
        },
        {
          "sql": "SELECT max(s.Capacity), avg(s.Capacity) FROM stadium s"
        },
        {
          "sql": "SELECT Capacity, Capacity FROM stadium LIMIT 1 OFFSET (SELECT count(*) FROM stadium)-1"
        },
        {
          "sql": "SELECT max_capacity, avg_capacity FROM (SELECT Capacity AS max_capacity, avg(Capacity) AS avg_capacity FROM stadium) AS s"
        },
        {
          "sql": "SELECT max(Capacity), (SELECT avg(Capacity) FROM stadium) FROM stadium WHERE Stadium_ID = (SELECT min(Stadium_ID) FROM stadium)"
        },
        {
          "sql": "SELECT max_capacity, avg_capacity FROM (SELECT max(Capacity) AS max_capacity, Capacity AS avg_capacity FROM stadium) AS t1 CROSS JOIN (SELECT avg(Capacity) AS avg_capacity FROM stadium) AS t2"
        },
        {
          "sql": "WITH stats AS (SELECT max(Capacity) AS m, avg(Capacity) AS a FROM stadium) SELECT m, a FROM stats"
        },
        {
          "sql": "WITH s AS (stadium) SELECT max(s.Capacity), avg(s.Capacity) FROM s"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium GROUP BY ()"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium GROUP BY 1"
        },
        {
          "sql": "SELECT greatest(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT (SELECT max(Capacity) FROM stadium), (SELECT avg(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT (SELECT Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT first_value(Capacity) OVER (ORDER BY Capacity DESC), avg(Capacity) OVER() FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT max(Capacity) OVER(), avg(Capacity) OVER() FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT percentile_cont(1) WITHIN GROUP (ORDER BY Capacity) , avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT (SELECT Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1) AS max_cap, (SELECT avg(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT * FROM (SELECT max(Capacity) AS a, avg(Capacity) AS b FROM stadium) t"
        },
        {
          "sql": "SELECT max(Capacity) FROM stadium UNION ALL SELECT avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT column1, column2 FROM (VALUES ((SELECT max(Capacity) FROM stadium), (SELECT avg(Capacity) FROM stadium))) AS t(column1, column2)"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium HAVING 1=1"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium WHERE 1=1"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium WHERE Stadium_ID > 0 - 1"
        },
        {
          "sql": "WITH RECURSIVE t(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM t WHERE n < 1) SELECT max(Capacity), avg(Capacity) FROM stadium, t"
        },
        {
          "sql": "SELECT json_value(json_arrayagg(Capacity ORDER BY Capacity DESC),'$[0]'), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT (SELECT Capacity FROM stadium ORDER BY Capacity DESC FETCH FIRST 1 ROW ONLY), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(Capacity) FILTER (WHERE Capacity IS NOT NULL), avg(Capacity) FILTER (WHERE Capacity IS NOT NULL) FROM stadium"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium TABLESAMPLE SYSTEM (100)"
        },
        {
          "sql": "EXPLAIN (ANALYZE true, COSTS false) SELECT max(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT * FROM crosstab('SELECT ''max''::text, Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1 UNION ALL SELECT ''avg'', Capacity * 0 + avg(Capacity) FROM stadium')"
        },
        {
          "sql": "SELECT unnest(ARRAY[(SELECT max(Capacity) FROM stadium), (SELECT avg(Capacity) FROM stadium)])"
        },
        {
          "sql": "SELECT * FROM LATERAL (VALUES (max(Capacity), avg(Capacity)) FROM stadium) AS t(max_c, avg_c)"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium WINDOW w AS ()"
        }
      ]
    },
    {
      "id": 17,
      "question": "What is the average and maximum capacities for all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT AVG(Capacity), MAX(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT avg(Capacity), greatest(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT (SELECT avg(Capacity) FROM stadium), (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT avg(s.Ccapacity), max(s.Capacity) FROM stadium s"
        },
        {
          "sql": "SELECT AVG(s.Capacity), MAX(s.Capacity) FROM stadium AS s"
        },
        {
          "sql": "WITH stats AS (SELECT Capacity FROM stadium) SELECT avg(Capacity), max(Capacity) FROM stats"
        },
        {
          "sql": "WITH s AS (SELECT * FROM stadium) SELECT avg(Capacity), max(Capacity) FROM s"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium GROUP BY ()"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium GROUP BY 1"
        },
        {
          "sql": "SELECT Capacity FROM stadium GROUP BY Capacity HAVING avg(Capacity) = (SELECT avg(Capacity) FROM stadium) LIMIT 1 UNION SELECT Capacity FROM stadium GROUP BY Capacity HAVING max(Capacity) = (SELECT max(Capacity) FROM stadium) LIMIT 1"
        },
        {
          "sql": "SELECT t1.avg_cap, t2.max_cap FROM (SELECT avg(Capacity) AS avg_cap FROM stadium) t1 CROSS JOIN (SELECT max(Capacity) AS max_cap FROM stadium) t2"
        },
        {
          "sql": "SELECT a.avg_cap, b.max_cap FROM (SELECT avg(Capacity) avg_cap FROM stadium) a, (SELECT max(Capacity) max_cap FROM stadium) b"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Capacity) AS avg_cap FROM stadium) t1 CROSS JOIN (SELECT max(Capacity) AS max_cap FROM stadium) t2"
        },
        {
          "sql": "SELECT (SELECT avg(Capacity) FROM stadium) AS a, (SELECT max(Capacity) FROM stadium) AS b"
        },
        {
          "sql": "SELECT * FROM crosstab('SELECT ''avg'' as k, avg(capacity) FROM stadium UNION ALL SELECT ''max'', max(capacity) FROM stadium')"
        },
        {
          "sql": "SELECT avg(c1.Capacity), max(c2.Capacity) FROM stadium c1 CROSS JOIN stadium c2"
        },
        {
          "sql": "SELECT avg(s1.Capacity), max(s2.Capacity) FROM stadium s1, stadium s2"
        },
        {
          "sql": "SELECT Capacity FROM (SELECT Capacity, avg(Capacity) OVER() as avg_c, max(Capacity) OVER() as max_c FROM stadium) WHERE 1=0 UNION SELECT avg_c, max_c FROM (SELECT Capacity, avg(Capacity) OVER() as avg_c, max(Capacity) OVER() as max_c FROM stadium) LIMIT 1"
        },
        {
          "sql": "SELECT avg(Capacity) FILTER (WHERE 1=1), max(Capacity) FILTER (WHERE 1=1) FROM stadium"
        },
        {
          "sql": "SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Capacity) OVER(), max(Capacity) OVER() FROM stadium WHERE Stadium_ID IS NOT NULL LIMIT 1"
        },
        {
          "sql": "SELECT first_value(avg(Capacity)) OVER(), last_value(max(Capacity)) OVER() FROM stadium LIMIT 1"
        },
        {
          "sql": "(SELECT avg(Capacity) FROM stadium) UNION ALL (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT array_agg(Capacity)[1]::numeric, max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT (stadium_agg).count FILTER (WHERE true), max(Capacity) FROM (SELECT string_agg(Capacity::text, ',') stadium_agg FROM stadium) LIMIT 1"
        },
        {
          "sql": "SELECT extract(epoch from avg(Capacity::interval)), max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT width_bucket(avg(Capacity), array[0,1000000]), max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT lag(avg(Capacity)) OVER(), lead(max(Capacity)) OVER() FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT cume_dist() * sum(Capacity) OVER(), max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT ntile(1) OVER(ORDER BY Capacity), max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT regr_avgx(Capacity, Capacity), regr_sxx(Capacity, Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT corr(Capacity, Capacity), max(Capacity) FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT unnest(array[avg(Capacity), max(Capacity)]) FROM stadium"
        }
      ]
    },
    {
      "id": 18,
      "question": "What is the name and capacity for the stadium with highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE s1.Average = (SELECT MAX(s2.Average) FROM stadium s2)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE s.Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT stadium.Name, stadium.Capacity FROM stadium WHERE Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM stadium t WHERE t.Average > s.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 JOIN (SELECT MAX(Average) max_avg FROM stadium) t ON s1.Average = t.max_avg"
        },
        {
          "sql": "WITH max_avg AS (SELECT MAX(Average) AS m FROM stadium) SELECT Name, Capacity FROM stadium, max_avg WHERE Average = m"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average IN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average = (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s, (SELECT MAX(Average) AS max_a FROM stadium) m WHERE s.Average = m.max_a"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium GROUP BY Name, Capacity, Average HAVING Average = MAX(Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, Average, RANK() OVER (ORDER BY Average DESC) rnk FROM stadium) WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, ROW_NUMBER() OVER (ORDER BY Average DESC) rn FROM stadium) WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, DENSE_RANK() OVER (ORDER BY Average DESC) drnk FROM stadium) WHERE drnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average > ALL (SELECT Average FROM stadium WHERE Average < (SELECT MAX(Average) FROM stadium))"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, ROW_NUMBER() OVER (ORDER BY Average DESC) as rn FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE Average NOT IN (SELECT Average FROM stadium s2 WHERE s2.Average < s1.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = ANY (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE Average >= (SELECT AVG(Average) FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium))"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT *, COUNT(*) OVER (PARTITION BY Average) cnt FROM stadium) WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium FETCH FIRST 1 ROWS ONLY ORDER BY Average DESC"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s CROSS JOIN (SELECT MAX(Average) ma FROM stadium) m WHERE s.Average = m.ma"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average >= (SELECT MAX(Average) FROM stadium WHERE Stadium_ID <> (SELECT Stadium_ID FROM stadium WHERE Average = MAX(Average)))"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1) SELECT Name, Capacity FROM stadium, max_stadium WHERE stadium.Stadium_ID = max_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 INNER JOIN (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1) s2 ON s1.Stadium_ID = s2.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium MINUS SELECT Name, Capacity FROM stadium WHERE Average < (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (VALUES (Average)) AS t(max_avg) JOIN stadium ON stadium.Average = t.max_avg CROSS JOIN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average BETWEEN (SELECT MAX(Average) FROM stadium) AND (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "WITH RECURSIVE max_avg AS (SELECT MAX(Average) FROM stadium UNION ALL SELECT MAX(Average) FROM stadium LIMIT 1) SELECT Name, Capacity FROM stadium, max_avg WHERE Average = max_avg.column1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium HAVING MAX(Average) = Average GROUP BY Stadium_ID, Name, Capacity, Average"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, FIRST_VALUE(Average) OVER (ORDER BY Average DESC) as top_avg FROM stadium) WHERE Average = top_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE 1 = (SELECT COUNT(DISTINCT s2.Average) FROM stadium s2 WHERE s2.Average >= s1.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = GREATEST((SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1))"
        }
      ]
    },
    {
      "id": 19,
      "question": "What is the name and capacity for the stadium with the highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average = (SELECT MAX(s2.Average) FROM stadium s2)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average IN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "WITH max_avg AS (SELECT MAX(Average) AS max_val FROM stadium) SELECT Name, Capacity FROM stadium, max_avg WHERE stadium.Average = max_avg.max_val"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT MAX(Average) AS max_avg FROM stadium) m ON s.Average = m.max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = ALL (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium s WHERE s.Average = (SELECT MAX(Average) FROM stadium s2)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, ROW_NUMBER() OVER (ORDER BY Average DESC) as rn FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average > ALL (SELECT Average FROM stadium WHERE Average < (SELECT MAX(Average) FROM stadium))"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE s1.Average = (SELECT MAX(s2.Average) FROM stadium s2 WHERE s2.Average > 0)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, MAX(Average) OVER () as max_att FROM stadium) t WHERE Average = max_att"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Average = (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "WITH top_stadium AS (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1) SELECT s.Name, s.Capacity FROM stadium s JOIN top_stadium t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average NOT IN (SELECT Average FROM stadium WHERE Average < (SELECT MAX(Average) FROM stadium))"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average >= (SELECT MAX(Average) FROM stadium WHERE Stadium_ID != s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium GROUP BY Stadium_ID, Name, Capacity, Average HAVING Average = MAX(Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT *, DENSE_RANK() OVER (ORDER BY Average DESC) rnk FROM stadium) WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE 1 = (SELECT COUNT(DISTINCT s2.Average) FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "WITH stats AS (SELECT MAX(Average) max_a FROM stadium) SELECT Name, Capacity FROM stadium CROSS JOIN stats WHERE Average = max_a"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium HAVING Average = MAX(Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)) SELECT Name, Capacity FROM stadium s JOIN max_stadium m ON s.Stadium_ID = m.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, Average, COUNT(*) OVER (PARTITION BY Average) as cnt FROM stadium) t WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average = (SELECT TOP 1 Average FROM stadium ORDER BY Average DESC)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average IN (SELECT DISTINCT TOP 1 Average FROM stadium ORDER BY Average DESC)"
        },
        {
          "sql": "WITH RECURSIVE max_finder AS (SELECT MAX(Average) m FROM stadium UNION ALL SELECT m FROM max_finder LIMIT 1) SELECT Name, Capacity FROM stadium, max_finder WHERE Average = m"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium MINUS SELECT Name, Capacity FROM stadium s1 WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average BETWEEN (SELECT MAX(Average) FROM stadium) AND (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "WITH avgs AS (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1) SELECT s.Name, s.Capacity FROM stadium s, avgs a WHERE s.Average = a.Average"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s CROSS JOIN (SELECT MAX(Average) ma FROM stadium) x WHERE s.Average = x.ma"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity FROM stadium WHERE Average > (SELECT AVG(Average) FROM stadium)) WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Location = (SELECT Location FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)) AND Average = (SELECT MAX(Average) FROM stadium)"
        }
      ]
    },
    {
      "id": 20,
      "question": "How many concerts are there in year 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year  =  2014 OR Year  =  2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Year = 2014 OR Year = 2015 THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT * FROM concert WHERE Year IN (2014,2015)) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year >= 2014 AND Year <= 2015"
        },
        {
          "sql": "SELECT COUNT(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year = 2014 UNION ALL SELECT COUNT(*) FROM concert WHERE Year = 2015"
        },
        {
          "sql": "SELECT SUM(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year = 2014 UNION ALL SELECT COUNT(*) FROM concert WHERE Year = 2015) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "WITH c2014 AS (SELECT COUNT(*) AS cnt FROM concert WHERE Year = 2014), c2015 AS (SELECT COUNT(*) FROM concert WHERE Year = 2015) SELECT SUM(cnt) FROM c2014, c2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE (Year = 2014 OR Year = 2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Year IN (2014,2015)) AS subq"
        },
        {
          "sql": "SELECT COUNT(c1.concert_ID) FROM concert c1 WHERE c1.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year = ANY(ARRAY[2014,2015])"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert t WHERE t.Year = 2014 OR t.Year = 2015"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Year) FROM concert WHERE Year IN (2014,2015) GROUP BY Year HAVING Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT 1 FROM concert WHERE Year IN (2014,2015)) t"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM (SELECT * FROM concert WHERE Year >=2014 AND Year <=2015) AS temp"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert CROSS JOIN (SELECT 1 AS dummy) d WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c INNER JOIN (SELECT 2014 AS y UNION SELECT 2015) y ON c.Year = y.y"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS (SELECT 1 FROM (VALUES (2014),(2015)) AS years(y) WHERE years.y = concert.Year)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID, Year FROM concert WHERE Year IN (2014,2015) GROUP BY concert_ID, Year) AS t"
        },
        {
          "sql": "SELECT SUM(CASE Year WHEN 2014 THEN 1 WHEN 2015 THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year != ALL (SELECT year FROM (SELECT 2013 AS year UNION SELECT 2016) AS other_years)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c WHERE c.Year > 2013 AND c.Year < 2016"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE NOT (Year < 2014 OR Year > 2015)"
        },
        {
          "sql": "WITH years2014_15 AS (SELECT 2014 AS y UNION ALL SELECT 2015) SELECT COUNT(*) FROM concert c INNER JOIN years2014_15 y ON c.Year = y.y"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert GROUP BY Year HAVING Year IN (2014,2015)"
        }
      ]
    },
    {
      "id": 21,
      "question": "How many concerts occurred in 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM concert WHERE Year  =  2014 OR Year  =  2015"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(DISTINCT concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year >= 2014 AND Year <= 2015"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM concert WHERE Year = 2014 UNION SELECT * FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM concert WHERE Year IN (2014,2015)) AS T1"
        },
        {
          "sql": "SELECT count(concert.concert_ID) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year = 2014 UNION ALL SELECT count(*) FROM concert WHERE Year = 2015"
        },
        {
          "sql": "SELECT sum(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT count(DISTINCT concert.concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 WHERE T1.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(c.concert_ID) FROM concert AS c WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert c WHERE c.Year >= 2014 AND c.Year <= 2015"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT concert_ID FROM concert WHERE Year = 2014 UNION ALL SELECT concert_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year > 2013 AND Year < 2016"
        },
        {
          "sql": "SELECT sum(CASE Year WHEN 2014 THEN 1 WHEN 2015 THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE NOT (Year < 2014 OR Year > 2015)"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Year != 2014 AND Year != 2015 AND 1=0 UNION ALL SELECT count(concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Year FROM concert GROUP BY Year HAVING Year IN (2014,2015)) AS T1 CROSS JOIN (SELECT 1 AS x) AS T2"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE (Year - 2014) * (Year - 2015) <= 0"
        },
        {
          "sql": "SELECT count(*) FROM concert LEFT JOIN stadium ON concert.Stadium_ID = stadium.Stadium_ID WHERE concert.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert c INNER JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(DISTINCT c.concert_ID) FROM concert c JOIN stadium s USING(Stadium_ID) WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE EXISTS (SELECT 1 FROM (VALUES (2014),(2015)) AS y(year) WHERE concert.Year = y.year)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year IN (SELECT 2014 UNION SELECT 2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert CROSS JOIN (SELECT 2014 AS y UNION SELECT 2015) AS years WHERE concert.Year = years.y"
        },
        {
          "sql": "SELECT count(c.concert_ID) FROM concert c WHERE c.Year |& 2014 > 0 OR c.Year = 2015"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT 1 FROM concert WHERE Year IN (2014,2015) GROUP BY concert_ID)"
        },
        {
          "sql": "WITH years2014 AS (SELECT * FROM concert WHERE Year = 2014), years2015 AS (SELECT * FROM concert WHERE Year = 2015) SELECT count(*) FROM years2014 UNION ALL SELECT count(*) FROM years2015"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE MOD(Year,100) IN (14,15) AND Year >= 2000 AND Year < 2100"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Year = ANY(ARRAY[2014,2015])"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year = ALL(2014,2015) OR Year IS NULL AND 1=0"
        },
        {
          "sql": "SELECT count(DISTINCT CASE WHEN Year IN (2014,2015) THEN concert_ID END) FROM concert"
        }
      ]
    },
    {
      "id": 22,
      "question": "Show the stadium name and the number of concerts in each stadium.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(*) FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(DISTINCT concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID  =  s.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID  =  s.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(c.concert_ID) FROM stadium, concert c WHERE stadium.Stadium_ID  =  c.Stadium_ID  GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(*) FROM stadium s, concert c WHERE s.Stadium_ID  =  c.Stadium_ID  GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM concert WHERE Stadium_ID  =  stadium.Stadium_ID ) as cnt FROM stadium"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(c.concert_ID) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ) FROM stadium s"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT stadium.Name, count(concert.concert_ID) FROM stadium INNER JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , stadium.Name"
        },
        {
          "sql": "SELECT Name FROM stadium t1 WHERE 1=(SELECT 1 FROM concert t2 WHERE t2.Stadium_ID  =  t1.Stadium_ID  GROUP BY t2.Stadium_ID  HAVING count(*)>0)"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s JOIN concert c USING(Stadium_ID) GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(1) FROM stadium JOIN concert ON Stadium_ID  =  Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT Name, sum(CASE WHEN concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(*) FROM (SELECT concert_ID FROM concert WHERE Stadium_ID  =  s.Stadium_ID ) t) FROM stadium s"
        },
        {
          "sql": "WITH cnt AS (SELECT Stadium_ID , count(*) as num FROM concert GROUP BY Stadium_ID ) SELECT s.Name, cnt.num FROM stadium s JOIN cnt ON s.Stadium_ID  =  cnt.Stadium_ID"
        },
        {
          "sql": "WITH cte_concerts AS (SELECT Stadium_ID FROM concert) SELECT s.Name, count(cte_concerts.Stadium_ID) FROM stadium s JOIN cte_concerts ON s.Stadium_ID  =  cte_concerts.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT s.Name, count(DISTINCT c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium st JOIN (SELECT * FROM concert) c ON st.Stadium_ID  =  c.Stadium_ID GROUP BY st.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID ) GROUP BY Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, cnt FROM stadium s JOIN (SELECT Stadium_ID , count(concert_ID) as cnt FROM concert GROUP BY Stadium_ID ) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(1) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ) FROM stadium s WHERE EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID )"
        },
        {
          "sql": "SELECT Name FROM stadium GROUP BY Name HAVING count(concert.Stadium_ID)>0 FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name, count(c.concert_ID) OVER (PARTITION BY s.Stadium_ID ) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.concert_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Name, GREATEST(count(concert_ID), 0) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s1.Name, (SELECT count(c1.concert_ID) FROM concert c1 WHERE c1.Stadium_ID  =  s1.Stadium_ID ) FROM stadium s1"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ) > 0"
        },
        {
          "sql": "SELECT s.Name, COALESCE((SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ), 0) FROM stadium s"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY Name, s.Stadium_ID ORDER BY Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM (SELECT s.Stadium_ID , s.Name, c.concert_ID FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID) t GROUP BY Stadium_ID , Name"
        }
      ]
    },
    {
      "id": 23,
      "question": "For each stadium, how many concerts play there?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT stadium.Stadium_ID , count(*) FROM stadium INNER JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID"
        },
        {
          "sql": "SELECT Location FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location HAVING count(concert_ID) > 0"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Location, count(DISTINCT concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Capacity, count(*) FROM stadium JOIN concert USING(Stadium_ID) GROUP BY Stadium_ID , Capacity"
        },
        {
          "sql": "SELECT s.Location, count(*) FROM stadium s JOIN concert c USING(Stadium_ID) GROUP BY s.Stadium_ID , s.Location"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium, concert WHERE stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT Location FROM (SELECT DISTINCT Stadium_ID , Location FROM stadium) s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , Location"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Location, count(1) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert) ORDER BY Name"
        },
        {
          "sql": "SELECT s.Capacity, (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) FROM stadium s"
        },
        {
          "sql": "SELECT Location, (SELECT count(concert_ID) FROM concert WHERE Stadium_ID  =  stadium.Stadium_ID) FROM stadium"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID , count(*) AS cnt FROM concert GROUP BY Stadium_ID) SELECT s.Name, cc.cnt FROM stadium s LEFT JOIN concert_counts cc ON s.Stadium_ID  =  cc.Stadium_ID"
        },
        {
          "sql": "SELECT Name, cnt FROM stadium s LEFT JOIN (SELECT Stadium_ID , count(*) cnt FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Location FROM stadium GROUP BY Stadium_ID , Location HAVING sum(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM concert) THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID)"
        },
        {
          "sql": "SELECT Location, count(concert.Stadium_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Capacity FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Capacity"
        },
        {
          "sql": "SELECT Location FROM stadium FULL OUTER JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name FROM stadium CROSS JOIN (SELECT Stadium_ID FROM concert) c WHERE stadium.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Highest, count(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Highest"
        },
        {
          "sql": "SELECT Location FROM stadium s WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Stadium_ID , count(concert_ID) FROM stadium NATURAL JOIN concert GROUP BY Stadium_ID"
        },
        {
          "sql": "WITH RECURSIVE stadium_concerts AS (SELECT Stadium_ID , 0 as level FROM stadium UNION ALL SELECT c.Stadium_ID , sc.level + 1 FROM stadium_concerts sc JOIN concert c ON sc.Stadium_ID  =  c.Stadium_ID) SELECT Location, count(*) - 1 FROM stadium s JOIN stadium_concerts sc ON s.Stadium_ID  =  sc.Stadium_ID GROUP BY s.Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name FROM stadium s JOIN LATERAL (SELECT count(*) cnt FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) lc ON true"
        },
        {
          "sql": "SELECT Location, cardinality(array_agg(concert_ID)) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Location"
        },
        {
          "sql": "SELECT s.Name, GREATEST(0, (SELECT count(*) FROM concert WHERE Stadium_ID  =  s.Stadium_ID)) FROM stadium s"
        },
        {
          "sql": "SELECT Location FROM stadium MATCH (concert) AGAINST (Stadium_ID) GROUP BY Stadium_ID , Location"
        },
        {
          "sql": "SELECT Name FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY Stadium_ID ORDER BY Name) rn FROM stadium) s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE rn = 1"
        },
        {
          "sql": "SELECT Capacity FROM stadium PIVOT (count(concert_ID) FOR Stadium_ID IN (SELECT Stadium_ID FROM concert))"
        }
      ]
    },
    {
      "id": 24,
      "question": "Show the stadium name and capacity with most number of concerts in year 2014 or after.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) = (SELECT MAX(c2) FROM (SELECT COUNT(*) c2 FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t))"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014 GROUP BY s.Stadium_ID HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014 GROUP BY c.Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) as cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID WHERE cc.cnt = (SELECT MAX(cnt) FROM concert_counts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT c.Stadium_ID FROM concert c WHERE c.Year >= 2014 GROUP BY c.Stadium_ID ORDER BY COUNT(c.concert_ID) DESC FETCH FIRST 1 ROW ONLY)"
        },
        {
          "sql": "SELECT DISTINCT FIRST_VALUE(s.Name) OVER (ORDER BY COUNT(*) DESC), FIRST_VALUE(s.Capacity) OVER (ORDER BY COUNT(*) DESC) FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) rn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ranked ON s.Stadium_ID = ranked.Stadium_ID WHERE ranked.rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t1 WHERE cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t2))"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) = (SELECT MAX(c2) FROM (SELECT COUNT(*) c2 FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID) x)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) as concert_cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014) WHERE concert_cnt = (SELECT MAX(concert_cnt) FROM (SELECT COUNT(*) concert_cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID))"
        },
        {
          "sql": "WITH max_concerts AS (SELECT MAX(cnt) max_cnt FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t) SELECT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) = (SELECT max_cnt FROM max_concerts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID = SOME (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE (SELECT COUNT(*) FROM concert c1 WHERE c1.Stadium_ID = s1.Stadium_ID AND c1.Year >= 2014) >= ALL (SELECT COUNT(*) FROM concert c2 JOIN stadium s2 ON c2.Stadium_ID = s2.Stadium_ID WHERE c2.Year >= 2014 GROUP BY s2.Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium INTERSECT SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) top ON stadium.Stadium_ID = top.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year >= 2014 ORDER BY Stadium_ID LIMIT (SELECT 1 FROM (SELECT COUNT(DISTINCT Stadium_ID) FROM concert WHERE Year >= 2014 ORDER BY COUNT(*) DESC LIMIT 1) t)) AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.*, DENSE_RANK() OVER (ORDER BY COUNT(c.concert_ID) DESC) rnk FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity) WHERE rnk = 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s CROSS JOIN (SELECT MAX(cnt) max_cnt FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x) m JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity, m.max_cnt HAVING COUNT(*) = m.max_cnt"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) as concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ORDER BY concerts DESC LIMIT 1)"
        },
        {
          "sql": "WITH RECURSIVE stadium_ranking AS (SELECT Stadium_ID, COUNT(*) cnt, 1 rn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID HAVING rn = 1) SELECT s.Name, s.Capacity FROM stadium s JOIN stadium_ranking sr ON s.Stadium_ID = sr.Stadium_ID WHERE sr.cnt = (SELECT MAX(cnt) FROM stadium_ranking)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN LATERAL (SELECT COUNT(*) cnt FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) cnt ON true WHERE cnt.cnt = (SELECT MAX(cnt2) FROM (SELECT COUNT(*) cnt2 FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x)"
        },
        {
          "sql": "SELECT * FROM (SELECT Name, Capacity, COUNT(*) as concert_count FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Year >= 2014 GROUP BY Stadium_ID, Name, Capacity ORDER BY concert_count DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, COUNT(*) cnt, RANK() OVER (ORDER BY COUNT(*) DESC) r FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_stadiums r ON s.Stadium_ID = r.Stadium_ID WHERE r.r = 1"
        },
        {
          "sql": "SELECT DISTINCT ON (s.Name, s.Capacity) s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 ORDER BY COUNT(*) OVER (PARTITION BY s.Stadium_ID) DESC, s.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c1 WHERE c1.Year >= 2014 GROUP BY c1.Stadium_ID HAVING COUNT(*) > (SELECT COUNT(*) FROM concert c2 WHERE c2.Stadium_ID = s.Stadium_ID AND c2.Year >= 2014)) AND EXISTS (SELECT 1 FROM concert c3 WHERE c3.Stadium_ID = s.Stadium_ID AND c3.Year >= 2014)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(DISTINCT c.concert_ID) OVER (PARTITION BY s.Stadium_ID) as concerts FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014) t WHERE concerts = (SELECT MAX(concerts) FROM (SELECT COUNT(DISTINCT concert_ID) concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE Stadium_ID = (SELECT arg_max(Stadium_ID, COUNT(*)) FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium NATURAL JOIN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "WITH concert_stats AS (SELECT Stadium_ID, COUNT(*) as num_concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID), max_stats AS (SELECT MAX(num_concerts) as max_concerts FROM concert_stats) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_stats cs ON s.Stadium_ID = cs.Stadium_ID JOIN max_stats ms ON cs.num_concerts = ms.max_concerts"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (VALUES (SELECT COUNT(*) FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)) AS t(max_count) JOIN concert c ON c.Stadium_ID = Stadium_ID WHERE c.Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) = t.max_count)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s, (SELECT Stadium_ID, COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID)) top_stadium WHERE s.Stadium_ID = top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium MATCH_RECOGNIZE (PARTITION BY Stadium_ID MEASURE COUNT(concert.concert_ID) AS cnt AFTER MATCH ORDER BY cnt DESC PATTERN (s c*) FIRST(s.Name) FIRST(s.Capacity)) WHERE Year >= 2014 GROUP BY Stadium_ID LIMIT 1 ORDER BY cnt DESC"
        }
      ]
    },
    {
      "id": 25,
      "question": "What is the name and capacity of the stadium with the most concerts after 2013 ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY cnt DESC LIMIT 1) c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(c.concert_ID) DESC FETCH FIRST 1 ROW ONLY"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) AS num_concerts FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID ORDER BY cc.num_concerts DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t)"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 AND s.Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT c.Stadium_ID FROM concert c WHERE c.Year > 2013 GROUP BY c.Stadium_ID HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year > 2013 GROUP BY c2.Stadium_ID))"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, COUNT(*) AS concert_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_stadiums rs ON s.Stadium_ID = rs.Stadium_ID WHERE rs.rn = 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013 GROUP BY c.Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) AS concert_count FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY concert_count DESC LIMIT 1) t"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(concert_ID) DESC LIMIT 1) top_stadium ON s.Stadium_ID = top_stadium.Stadium_ID"
        },
        {
          "sql": "WITH max_concerts AS (SELECT MAX(concert_count) AS max_count FROM (SELECT COUNT(*) AS concert_count FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t) SELECT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) = (SELECT max_count FROM max_concerts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY cnt DESC LIMIT 1) t)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s CROSS JOIN (SELECT Stadium_ID, COUNT(*) AS max_concerts FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) top ON s.Stadium_ID = top.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND Year > 2013) = (SELECT MAX(COUNT(*)) FROM concert WHERE Year > 2013 GROUP BY Stadium_ID)"
        },
        {
          "sql": "WITH concerts_after_2013 AS (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID), top_stadium AS (SELECT Stadium_ID FROM concerts_after_2013 ORDER BY cnt DESC LIMIT 1) SELECT s.Name, s.Capacity FROM stadium s JOIN top_stadium ts ON s.Stadium_ID = ts.Stadium_ID"
        },
        {
          "sql": "SELECT FIRST_VALUE(Name) OVER (ORDER BY cnt DESC), FIRST_VALUE(Capacity) OVER (ORDER BY cnt DESC) FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) c ON s.Stadium_ID = c.Stadium_ID LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) rnk FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) ranked ON s.Stadium_ID = ranked.Stadium_ID AND ranked.rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.*, COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) AS concert_cnt FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013) ranked WHERE concert_cnt = (SELECT MAX(concert_cnt) FROM (SELECT COUNT(*) AS concert_cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t)"
        },
        {
          "sql": "WITH RECURSIVE top_concerts AS (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID), stadium_max AS (SELECT MAX(cnt) max_cnt FROM top_concerts) SELECT s.Name, s.Capacity FROM stadium s JOIN top_concerts tc ON s.Stadium_ID = tc.Stadium_ID JOIN stadium_max sm ON tc.cnt = sm.max_cnt"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT DISTINCT Stadium_ID FROM concert c1 WHERE Year > 2013 AND (SELECT COUNT(*) FROM concert c2 WHERE c2.Stadium_ID = c1.Stadium_ID AND c2.Year > 2013) >= ALL (SELECT COUNT(*) FROM concert c3 WHERE c3.Year > 2013 GROUP BY c3.Stadium_ID))"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c1, concert c2 WHERE c1.Stadium_ID != s.Stadium_ID AND c2.Stadium_ID = s.Stadium_ID AND c1.Year > 2013 AND c2.Year > 2013 GROUP BY c1.Stadium_ID HAVING COUNT(c1.concert_ID) < COUNT(c2.concert_ID)) AND EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = s.Stadium_ID AND Year > 2013)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN LATERAL (SELECT COUNT(*) AS cnt FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013) c ON true WHERE c.cnt = (SELECT MAX(COUNT(*)) FROM concert WHERE Year > 2013 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, DENSE_RANK() OVER (ORDER BY COUNT(c.concert_ID) DESC) rnk FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity) ranked WHERE rnk = 1"
        },
        {
          "sql": "WITH stadium_concerts AS (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID), counts AS (SELECT sc.Stadium_ID, COUNT(*) cnt FROM stadium_concerts sc JOIN concert c ON sc.Stadium_ID = c.Stadium_ID AND c.Year > 2013 GROUP BY sc.Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN counts ct ON s.Stadium_ID = ct.Stadium_ID WHERE ct.cnt = (SELECT MAX(cnt) FROM counts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert c WHERE Year > 2013 GROUP BY Stadium_ID HAVING COUNT(*) >= (SELECT COUNT(*) FROM concert c2 WHERE c2.Year > 2013 GROUP BY c2.Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1 / 1))"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID AND c.Year > 2013) > ALL (SELECT COUNT(*) - 1 FROM concert c2 WHERE c2.Year > 2013 AND c2.Stadium_ID != s1.Stadium_ID GROUP BY c2.Stadium_ID)"
        },
        {
          "sql": "WITH cte AS (SELECT Stadium_ID, COUNT(*) cnt, COUNT(*) OVER () total FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN cte c ON s.Stadium_ID = c.Stadium_ID WHERE c.cnt = (SELECT MAX(cnt) FROM cte)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID = SOME (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT ON (s.Stadium_ID) s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 ORDER BY s.Stadium_ID, COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s, (SELECT Stadium_ID, COUNT(concert_ID) OVER (ORDER BY COUNT(concert_ID) DESC) rn FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t WHERE s.Stadium_ID = t.Stadium_ID AND rn = 1"
        },
        {
          "sql": "WITH unpacked AS (SELECT Stadium_ID FROM concert WHERE Year > 2013), grouped AS (SELECT Stadium_ID, COUNT(*) OVER (PARTITION BY Stadium_ID) cnt FROM unpacked) SELECT DISTINCT s.Name, s.Capacity FROM stadium s JOIN grouped g ON s.Stadium_ID = g.Stadium_ID WHERE g.cnt = (SELECT MAX(cnt) FROM grouped)"
        }
      ]
    },
    {
      "id": 26,
      "question": "Which year has most number of concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_Name) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC FETCH FIRST 1 ROW ONLY"
        },
        {
          "sql": "SELECT t.Year FROM (SELECT Year, count(*) as cnt FROM concert GROUP BY Year) t ORDER BY t.cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(concert_ID) FROM concert GROUP BY Year) ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert c1 GROUP BY Year HAVING count(*) >= ALL (SELECT count(*) FROM concert c2 GROUP BY Year)"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT count(*) FROM concert c2 WHERE c2.Year=c1.Year)= (SELECT max(cnt) FROM (SELECT count(*) cnt FROM concert GROUP BY Year)) GROUP BY Year"
        },
        {
          "sql": "WITH c AS (SELECT Year, count(*) cnt FROM concert GROUP BY Year) SELECT Year FROM c WHERE cnt = (SELECT max(cnt) FROM c)"
        },
        {
          "sql": "WITH ranked AS (SELECT Year, count(*) cnt, ROW_NUMBER() OVER (ORDER BY count(*) DESC) rn FROM concert GROUP BY Year) SELECT Year FROM ranked WHERE rn=1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) = (SELECT max(c) FROM (SELECT count(*) c FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT min(Year) FROM (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(concert_ID) OVER (PARTITION BY Year) cnt FROM concert) GROUP BY Year ORDER BY max(cnt) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1) GROUP BY Year"
        },
        {
          "sql": "SELECT DISTINCT Year FROM concert ORDER BY (SELECT count(*) FROM concert c2 WHERE c2.Year=concert.Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID) >= (SELECT count(concert_ID) FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT t1.Year FROM concert t1 JOIN (SELECT Year, ROW_NUMBER() OVER (ORDER BY count(*) DESC) rnk FROM concert GROUP BY Year) t2 ON t1.Year=t2.Year WHERE t2.rnk=1 GROUP BY t1.Year"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) > ALL (SELECT count(*) FROM concert WHERE Year != (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1) GROUP BY Year)"
        },
        {
          "sql": "WITH yearly_cnt AS (SELECT Year, count(*) as total FROM concert GROUP BY Year), max_cnt AS (SELECT max(total) mx FROM yearly_cnt) SELECT Year FROM yearly_cnt, max_cnt WHERE total=mx"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, DENSE_RANK() OVER (ORDER BY count(*) DESC) r FROM concert GROUP BY Year) WHERE r=1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(distinct concert_ID) = (SELECT max(cnt) FROM (SELECT count(distinct concert_ID) cnt FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year FROM concert GROUP BY Year HAVING count(*) >= (SELECT avg(count(*)) * 3 FROM concert GROUP BY Year)) ORDER BY (SELECT count(*) FROM concert c2 WHERE c2.Year=concert.Year) DESC LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE cnts(Year, total, max_total) AS (SELECT Year, count(*), (SELECT max(count(*)) FROM concert GROUP BY Year) FROM concert GROUP BY Year) SELECT Year FROM cnts WHERE total=max_total"
        },
        {
          "sql": "SELECT Year FROM concert c GROUP BY Year HAVING count(*) = (SELECT count(*) FROM concert WHERE Stadium_ID IS NOT NULL GROUP BY Year ORDER BY count(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, LAG(count(*)) OVER (ORDER BY count(*) DESC) FROM concert GROUP BY Year) WHERE LAG(count(*)) OVER (ORDER BY count(*) DESC) IS NULL"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY sum(1) OVER (PARTITION BY Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (VALUES (SELECT Year FROM concert ORDER BY count(*) DESC LIMIT 1))"
        },
        {
          "sql": "SELECT Year FROM concert EXCEPT SELECT Year FROM concert WHERE Year NOT IN (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1) GROUP BY Year"
        },
        {
          "sql": "SELECT * FROM (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC) LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) IN (SELECT max(count(*)) FROM concert GROUP BY Year)"
        },
        {
          "sql": "WITH max_concerts AS (SELECT max(count(*)) m FROM concert GROUP BY Year) SELECT Year FROM concert c1 GROUP BY Year HAVING count(*)=(SELECT m FROM max_concerts)"
        },
        {
          "sql": "SELECT Year FROM (SELECT *, count(*) OVER (PARTITION BY Year) c FROM concert) GROUP BY Year ORDER BY max(c) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID)>(SELECT avg(count(concert_ID)) FROM concert GROUP BY Year)*1.5 ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, NTILE(1) OVER (ORDER BY count(*) DESC) n FROM concert GROUP BY Year) WHERE n=1"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE NOT EXISTS (SELECT 1 FROM concert c2 WHERE c2.Year != c1.Year GROUP BY c2.Year HAVING count(*)> (SELECT count(*) FROM concert c3 WHERE c3.Year=c1.Year)) GROUP BY c1.Year"
        }
      ]
    },
    {
      "id": 27,
      "question": "What is the year that had the most concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c GROUP BY c.Year ORDER BY count(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert AS c GROUP BY c.Year ORDER BY count(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(*) as cnt FROM concert GROUP BY Year) t ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT c.Year,count(c.concert_ID) FROM concert c GROUP BY c.Year) t ORDER BY count DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c INNER JOIN (SELECT Year,count(*) as mx FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1) m ON c.Year=m.Year GROUP BY c.Year"
        },
        {
          "sql": "SELECT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT min(Year) FROM (SELECT Year,count(*) as cnt FROM concert GROUP BY Year ORDER BY cnt DESC) ranked"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*)=(SELECT max(cnt) FROM (SELECT count(*) cnt FROM concert GROUP BY Year) t)"
        },
        {
          "sql": "WITH yearly_counts AS (SELECT Year,count(*) cnt FROM concert GROUP BY Year) SELECT Year FROM yearly_counts WHERE cnt=(SELECT max(cnt) FROM yearly_counts)"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID)=(SELECT max(t.cnt) FROM (SELECT count(concert_ID) cnt FROM concert GROUP BY Year) t)"
        },
        {
          "sql": "SELECT DISTINCT c1.Year FROM concert c1 JOIN concert c2 ON c1.Year=c2.Year GROUP BY c1.Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT count(*) FROM concert c2 WHERE c2.Year=c1.Year)=(SELECT max(cnt) FROM (SELECT count(*) cnt FROM concert GROUP BY Year) t)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,row_number() OVER (ORDER BY count(*) DESC) rn FROM concert GROUP BY Year) WHERE rn=1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,dense_rank() OVER (ORDER BY count(*) DESC) rn FROM concert GROUP BY Year) WHERE rn=1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(*) cnt, rank() OVER (ORDER BY count(*) DESC) rnk FROM concert GROUP BY Year) WHERE rnk=1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY sum(1) OVER (PARTITION BY Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM (SELECT * FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1) c"
        },
        {
          "sql": "SELECT Year FROM (SELECT DISTINCT Year FROM concert ORDER BY (SELECT count(*) FROM concert c2 WHERE c2.Year=concert.Year) DESC LIMIT 1) t"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*)=ALL(SELECT count(*) FROM concert GROUP BY Year)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(1) c FROM concert GROUP BY Year) t1 WHERE c=(SELECT max(c) FROM (SELECT count(1) c FROM concert GROUP BY Year) t2)"
        },
        {
          "sql": "SELECT Year FROM concert t1 WHERE NOT EXISTS(SELECT 1 FROM concert t2 WHERE t2.Year<>t1.Year GROUP BY t2.Year HAVING count(*)> (SELECT count(*) FROM concert t3 WHERE t3.Year=t1.Year)) GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(concert_ID) OVER (PARTITION BY Year) cnt FROM concert WHERE concert_ID IS NOT NULL) GROUP BY Year ORDER BY max(cnt) DESC LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE cnts AS (SELECT Year,1 cnt FROM concert UNION ALL SELECT Year,cnt+1 FROM cnts JOIN concert c ON cnts.Year=c.Year WHERE cnt<100) SELECT Year FROM cnts GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY (SELECT count(*) FROM concert c2 WHERE c2.Year=concert.Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c WHERE (SELECT count(*) FROM concert WHERE Year=c.Year)=(SELECT max(count(*)) FROM (SELECT 1 FROM concert GROUP BY Year) t GROUP BY Year)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(distinct concert_ID) as concerts FROM concert GROUP BY Year) ORDER BY concerts DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert MATCH (Year) GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT *, (ROW_NUMBER() OVER (ORDER BY Year)-1) % (SELECT count(DISTINCT Year) FROM concert)+1 as grp FROM (SELECT DISTINCT Year FROM concert ORDER BY count(*) DESC) t) WHERE grp=1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*)>ALL(SELECT count(*) FROM concert GROUP BY Year WHERE Year<>concert.Year)"
        },
        {
          "sql": "SELECT DISTINCT Year FROM concert ORDER BY count(concert_ID) OVER (PARTITION BY Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(*) as total FROM concert GROUP BY Year HAVING total >= ALL(SELECT count(*) FROM concert GROUP BY Year)) t"
        },
        {
          "sql": "WITH ranked_years AS (SELECT Year,count(*) as concerts,row_number() OVER(ORDER BY count(*) DESC) as rn FROM concert GROUP BY Year) SELECT Year FROM ranked_years WHERE rn=1"
        },
        {
          "sql": "SELECT Year FROM concert c GROUP BY c.Year ORDER BY COALESCE((SELECT count(*) FROM concert WHERE Year=c.Year),0) DESC LIMIT 1"
        }
      ]
    },
    {
      "id": 28,
      "question": "Show the stadium names without any concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium LEFT JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT COALESCE(c.Stadium_ID, 0) FROM concert c WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert UNION SELECT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, s.Name HAVING COUNT(c.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert c JOIN stadium s2 ON c.Stadium_ID = s2.Stadium_ID WHERE s2.Stadium_ID = stadium.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium FULL OUTER JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID = s1.Stadium_ID)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s CROSS JOIN (SELECT 1) t LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT COALESCE(Stadium_ID, -1) FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT COUNT(*) FROM concert WHERE Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON stadium.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > 0 AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) x ON s.Stadium_ID = x.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT (Stadium_ID IN (SELECT Stadium_ID FROM concert))"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c WHERE c.Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium s LEFT OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.concert_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Stadium_ID = s.Stadium_ID AND NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Stadium_ID > 0)"
        },
        {
          "sql": "SELECT Name FROM (SELECT * FROM stadium) s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE s1.Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c JOIN stadium s2 ON c.Stadium_ID = s2.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium HAVING COUNT(concert.Stadium_ID) = 0 FROM stadium LEFT JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID GROUP BY Stadium_ID, Name"
        },
        {
          "sql": "WITH used_stadiums AS (SELECT DISTINCT Stadium_ID FROM concert) SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM used_stadiums)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT DISTINCT s.Stadium_ID FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = s.Stadium_ID))"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium s WHERE (SELECT COUNT(DISTINCT c.Stadium_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        }
      ]
    },
    {
      "id": 29,
      "question": "What are the names of the stadiums without any concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c)"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.concert_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.concert_Name IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT * FROM concert WHERE Stadium_ID = stadium.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID > ALL (SELECT COALESCE(c.Stadium_ID,0) FROM concert c)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c1 ON s.Stadium_ID = c1.Stadium_ID LEFT JOIN singer_in_concert sic ON c1.concert_ID = sic.concert_ID WHERE c1.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT (s.Stadium_ID IN (SELECT Stadium_ID FROM concert))"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE (SELECT COUNT(c.Stadium_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 i UNION SELECT 2) t LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c JOIN singer_in_concert sic ON c.concert_ID = sic.concert_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) t WHERE t.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM (SELECT s.*, COUNT(c.concert_ID) as cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, s.Name, s.Location, s.Capacity, s.Highest, s.Lowest, s.Average) t WHERE cnt = 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert))"
        },
        {
          "sql": "WITH no_concerts AS (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) SELECT s.Name FROM stadium s JOIN no_concerts nc ON s.Stadium_ID = nc.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (Location, Stadium_ID) NOT IN (SELECT (SELECT Location FROM stadium ss WHERE ss.Stadium_ID = c.Stadium_ID), c.Stadium_ID FROM concert c WHERE c.Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium INTERSECT SELECT Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE Stadium_ID IN (SELECT ns.Stadium_ID FROM (SELECT DISTINCT Stadium_ID FROM stadium) ns LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON ns.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium GROUP BY Stadium_ID, Name, Location, Capacity, Highest, Lowest, Average HAVING COUNT(concert.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT COALESCE(c.Stadium_ID, -1) FROM concert c)"
        },
        {
          "sql": "SELECT Name FROM stadium s RIGHT JOIN (SELECT DISTINCT Stadium_ID FROM stadium EXCEPT SELECT DISTINCT Stadium_ID FROM concert) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE LENGTH(COALESCE((SELECT concert_Name FROM concert c WHERE c.Stadium_ID = s.Stadium_ID LIMIT 1), '')) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID BETWEEN (SELECT MIN(Stadium_ID)-1 FROM concert)+1 AND (SELECT MAX(Stadium_ID)+1 FROM stadium) AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT BOOL_OR(c.Stadium_ID IS NULL) FROM (SELECT Stadium_ID FROM concert WHERE Stadium_ID = s.Stadium_ID LIMIT 1) c) OR (SELECT COUNT(*) FROM concert c2 WHERE c2.Stadium_ID = s.Stadium_ID) = 0"
        }
      ]
    },
    {
      "id": 30,
      "question": "Show countries where a singer above age 40 and a singer below 30 are from.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 40 INTERSECT SELECT DISTINCT s.Country FROM singer s WHERE s.Age < 30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 40 INTERSECT SELECT DISTINCT Country FROM singer WHERE Age < 30"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 WHERE s1.Age > 40 AND s1.Country IN (SELECT DISTINCT s2.Country FROM singer s2 WHERE s2.Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 40 AND EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s.Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 AND Country IN (SELECT Country FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT t1.Country FROM (SELECT Country FROM singer WHERE Age > 40) t1 INNER JOIN (SELECT Country FROM singer WHERE Age < 30) t2 ON t1.Country = t2.Country"
        },
        {
          "sql": "SELECT s.Country FROM singer s INNER JOIN singer s2 ON s.Country = s2.Country WHERE s.Age > 40 AND s2.Age < 30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 JOIN singer s2 ON s1.Country = s2.Country WHERE s1.Age > 40 AND s2.Age < 30"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, Age FROM singer) t1 WHERE t1.Age > 40 AND t1.Country IN (SELECT t2.Country FROM (SELECT Country, Age FROM singer) t2 WHERE t2.Age < 30)"
        },
        {
          "sql": "WITH old_singers AS (SELECT DISTINCT Country FROM singer WHERE Age > 40), young_singers AS (SELECT DISTINCT Country FROM singer WHERE Age < 30) SELECT Country FROM old_singers INTERSECT SELECT Country FROM young_singers"
        },
        {
          "sql": "WITH countries_old AS (SELECT Country FROM singer WHERE Age > 40), countries_young AS (SELECT Country FROM singer WHERE Age < 30) SELECT DISTINCT co.Country FROM countries_old co JOIN countries_young cy ON co.Country = cy.Country"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1, singer s2 WHERE s1.Country = s2.Country AND s1.Age > 40 AND s2.Age < 30"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MIN(Age) < 30 AND MAX(Age) > 40"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Country IN (SELECT Country FROM singer WHERE Age < 30 GROUP BY Country HAVING MAX(Age) > 40)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer GROUP BY Country HAVING SUM(CASE WHEN Age > 40 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN Age < 30 THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT c.Country FROM (SELECT Country, MAX(CASE WHEN Age > 40 THEN 1 ELSE 0 END) has_old, MAX(CASE WHEN Age < 30 THEN 1 ELSE 0 END) has_young FROM singer GROUP BY Country) c WHERE c.has_old = 1 AND c.has_young = 1"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT Country, COUNT(CASE WHEN Age > 40 THEN 1 END) cnt_old, COUNT(CASE WHEN Age < 30 THEN 1 END) cnt_young FROM singer GROUP BY Country) t WHERE cnt_old > 0 AND cnt_young > 0"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 WHERE s1.Age > 40 AND (SELECT COUNT(*) FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30) > 0"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE Age > 40 AND (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30 LIMIT 1) IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 QUALIFY COUNT(*) OVER (PARTITION BY Country WHERE Age < 30) > 0"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 40 AND 30 > (SELECT MIN(s2.Age) FROM singer s2 WHERE s2.Country = s.Country)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 40 AND 40 < (SELECT MAX(s2.Age) FROM singer s2 WHERE s2.Country = Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT c.Country FROM (SELECT Country FROM singer WHERE Age > 40) c WHERE EXISTS (SELECT 1 FROM singer WHERE Country = c.Country AND Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT t.Country FROM (SELECT Country FROM singer WHERE Age > 40) t WHERE t.Country = ANY (SELECT Country FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 EXCEPT SELECT Country FROM singer WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = singer.Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Age > 40 AND s.Country IN (SELECT DISTINCT Country FROM singer EXCEPT SELECT Country FROM singer WHERE Age >= 30)"
        },
        {
          "sql": "SELECT * FROM (SELECT DISTINCT Country FROM singer WHERE Age > 40) t1 WHERE t1.Country IN (SELECT DISTINCT Country FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country FROM singer WHERE Age > 40 INTERSECT SELECT Country FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM ((SELECT Country FROM singer WHERE Age > 40) UNION (SELECT Country FROM singer WHERE Age < 30)) t WHERE t.Country IN (SELECT Country FROM singer WHERE Age > 40) AND t.Country IN (SELECT Country FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 WHERE s1.Age > 40 UNION SELECT s2.Country FROM singer s2 WHERE s2.Age < 30 AND s2.Country IN (SELECT Country FROM singer WHERE Age > 40)"
        },
        {
          "sql": "WITH RECURSIVE countries AS (SELECT DISTINCT Country FROM singer WHERE Age > 40 UNION SELECT DISTINCT Country FROM countries, singer WHERE singer.Country = countries.Country AND singer.Age < 30) SELECT Country FROM countries"
        },
        {
          "sql": "SELECT Country FROM singer s1 WHERE s1.Age > 40 AND ROW_NUMBER() OVER (PARTITION BY s1.Country ORDER BY s1.Age DESC) = 1 AND EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT FIRST_VALUE(Country) OVER (PARTITION BY CASE WHEN Age > 40 OR Age < 30 THEN 1 END ORDER BY Country) FROM singer WHERE (Age > 40 OR Age < 30) GROUP BY Country HAVING COUNT(CASE WHEN Age > 40 THEN 1 END) > 0 AND COUNT(CASE WHEN Age < 30 THEN 1 END) > 0"
        },
        {
          "sql": "SELECT Country FROM singer MATCH_RECOGNIZE (PARTITION BY Country ORDER BY Age MEASURES X.Age AS min_age, LAST(Age) AS max_age PATTERN (X* Y*) DEFINE X AS Age < 30, Y AS Age > 40) WHERE max_age > 40 AND min_age < 30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 40 AND Country OVERLAPS (SELECT Country FROM singer WHERE Age < 30)"
        }
      ]
    },
    {
      "id": 31,
      "question": "Show names for all stadiums except for stadiums having a concert in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT EXISTS (SELECT 1 FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT Stadium_ID FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT (s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014))"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE (c.Year = 2014 OR c.Year IS NULL) AND c.Year IS NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014) c WHERE s.Stadium_ID <> c.Stadium_ID AND NOT EXISTS (SELECT 1 FROM concert c2 WHERE c2.Stadium_ID = s.Stadium_ID AND c2.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (SELECT COUNT(*) FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year = 2014) = 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT (EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year = 2014))"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year <> 2014 OR c.Stadium_ID IS NULL AND c.Year IS NULL"
        },
        {
          "sql": "SELECT Name FROM (SELECT * FROM stadium) s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "WITH no2014 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year <> 2014) SELECT s.Name FROM stadium s LEFT JOIN no2014 n ON s.Stadium_ID = n.Stadium_ID WHERE n.Stadium_ID IS NOT NULL OR s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT SUM(CASE WHEN Year = 2014 THEN 1 ELSE 0 END) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS (SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID IN (SELECT t.Stadium_ID FROM stadium t WHERE t.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014))"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 GROUP BY Stadium_ID HAVING COUNT(*) > 0)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium LEFT JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014) c ON stadium.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) t WHERE t.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (Stadium_ID, 0) NOT IN (SELECT Stadium_ID, 1 FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s, concert c WHERE s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 OR s.Stadium_ID <> c.Stadium_ID AND c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT CASE WHEN Year = 2014 THEN Stadium_ID END FROM concert)"
        },
        {
          "sql": "WITH excluded AS (SELECT Stadium_ID FROM concert WHERE Year = 2014) SELECT s.Name FROM stadium s LEFT JOIN excluded e ON s.Stadium_ID = e.Stadium_ID WHERE e.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE LENGTH((SELECT GROUP_CONCAT(c.concert_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)) = 0"
        }
      ]
    },
    {
      "id": 32,
      "question": "What are the names of all stadiums that did not have a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID=stadium.Stadium_ID AND Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID=c.Stadium_ID AND c.Year=2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID=c.Stadium_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID <> ALL (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year=2014 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT NULL FROM concert c WHERE c.Stadium_ID=stadium.Stadium_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT Stadium_ID FROM concert WHERE Year=2014) c ON s.Stadium_ID=c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE 0=(SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID=s.Stadium_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT Stadium_ID FROM concert WHERE Year=2014 UNION SELECT NULL) AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT (s.Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year=2014 UNION SELECT 0)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 i WHERE NOT EXISTS(SELECT 1 FROM concert WHERE Year=2014)) x WHERE NOT EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID=s.Stadium_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (SELECT COUNT(*) FROM concert WHERE Stadium_ID=stadium.Stadium_ID AND Year=2014)=0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year=2014)) t ON s.Stadium_ID=t.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s, concert c WHERE s.Stadium_ID=c.Stadium_ID AND c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Year=2014 AND Stadium_ID=s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT COALESCE(Stadium_ID,0) FROM concert WHERE Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID=c.Stadium_ID AND c.Year <> 2014 WHERE c.concert_ID IS NULL OR NOT EXISTS(SELECT 1 FROM concert c2 WHERE c2.Stadium_ID=s.Stadium_ID AND c2.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM (SELECT Stadium_ID FROM concert WHERE Year=2014) c)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c CROSS JOIN (SELECT 1) WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM (SELECT s.*, (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID=s.Stadium_ID AND c.Year=2014) as cnt FROM stadium s) t WHERE cnt=0"
        },
        {
          "sql": "WITH no2014 AS (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert WHERE Year=2014) SELECT Name FROM stadium s JOIN no2014 n ON s.Stadium_ID=n.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert WHERE Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT MATCH (SELECT 1 FROM concert c WHERE c.Year=2014 AND c.Stadium_ID=s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID=c.Stadium_ID AND c.Year=2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM stadium WHERE Stadium_ID=s.Stadium_ID AND NOT EXISTS(SELECT 1 FROM concert WHERE Stadium_ID=s.Stadium_ID AND Year=2014))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (Stadium_ID, 2014) NOT IN (SELECT Stadium_ID, Year FROM concert)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2014) c ON stadium.Stadium_ID=c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 JOIN concert c ON s2.Stadium_ID=c.Stadium_ID WHERE s1.Stadium_ID=s2.Stadium_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM stadium GROUP BY Stadium_ID, Name HAVING SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year=2014) THEN 1 ELSE 0 END)=0"
        },
        {
          "sql": "WITH c2014 AS (SELECT Stadium_ID FROM concert WHERE Year=2014) SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM c2014)"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year=2014 GROUP BY Stadium_ID HAVING COUNT(*)>0)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT BOOL_OR(Year=2014) FROM concert WHERE Stadium_ID=s.Stadium_ID) IS NULL OR (SELECT BOOL_OR(Year=2014) FROM concert WHERE Stadium_ID=s.Stadium_ID)=false"
        }
      ]
    },
    {
      "id": 33,
      "question": "Show the name and theme for all concerts and the number of singers in each concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme FROM concert"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert NATURAL JOIN singer_in_concert"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c NATURAL JOIN singer_in_concert sic"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert c CROSS JOIN singer_in_concert sic"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c CROSS JOIN singer_in_concert sic"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE c.concert_ID IN (SELECT sic.concert_ID FROM singer_in_concert sic)"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.concert_ID = concert.concert_ID)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.concert_ID = c.concert_ID)"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM (SELECT * FROM concert) c"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM (SELECT * FROM concert) c"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT DISTINCT concert_Name, Theme FROM concert, singer_in_concert"
        },
        {
          "sql": "SELECT DISTINCT c.concert_Name, c.Theme FROM concert c, singer_in_concert sic"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert JOIN (SELECT DISTINCT concert_ID FROM singer_in_concert) sic"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c JOIN (SELECT DISTINCT concert_ID FROM singer_in_concert) sic ON c.concert_ID = sic.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert GROUP BY concert_ID)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE c.concert_ID IN (SELECT sic.concert_ID FROM singer_in_concert sic GROUP BY sic.concert_ID)"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert t1 WHERE EXISTS (SELECT concert_ID FROM singer_in_concert t2 WHERE t2.concert_ID = t1.concert_ID)"
        },
        {
          "sql": "SELECT t1.concert_Name, t1.Theme FROM concert t1 WHERE EXISTS (SELECT concert_ID FROM singer_in_concert t2 WHERE t2.concert_ID = t1.concert_ID)"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert LEFT JOIN (SELECT concert_ID, COUNT(*) as cnt FROM singer_in_concert GROUP BY concert_ID) sic ON concert.concert_ID = sic.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c LEFT JOIN (SELECT concert_ID, COUNT(*) as cnt FROM singer_in_concert GROUP BY concert_ID) sic ON c.concert_ID = sic.concert_ID"
        },
        {
          "sql": "WITH sic_cnt AS (SELECT concert_ID, COUNT(*) as cnt FROM singer_in_concert GROUP BY concert_ID) SELECT concert_Name, Theme FROM concert c JOIN sic_cnt s ON c.concert_ID = s.concert_ID"
        },
        {
          "sql": "WITH sic_cnt AS (SELECT concert_ID, COUNT(*) as cnt FROM singer_in_concert GROUP BY concert_ID) SELECT c.concert_Name, c.Theme FROM concert c JOIN sic_cnt s ON c.concert_ID = s.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert INTERSECT SELECT concert_Name, Theme FROM concert c JOIN singer_in_concert sic ON c.concert_ID = sic.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c INTERSECT SELECT concert_Name, Theme FROM concert JOIN singer_in_concert"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert c1 WHERE c1.concert_ID = ANY (SELECT concert_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE c.concert_ID = ANY (SELECT sic.concert_ID FROM singer_in_concert sic)"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert EXCEPT SELECT concert_Name, Theme FROM concert WHERE concert_ID NOT IN (SELECT concert_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c EXCEPT SELECT concert_Name, Theme FROM concert WHERE concert_ID NOT IN (SELECT sic.concert_ID FROM singer_in_concert sic)"
        },
        {
          "sql": "SELECT * FROM (SELECT concert_Name, Theme FROM concert) AS subq"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM (SELECT * FROM concert) AS c"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert HAVING COUNT(*) > 0 FROM singer_in_concert GROUP BY concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c HAVING COUNT(sic.concert_ID) > 0 FROM singer_in_concert sic GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert MATCH (singer_in_concert)"
        }
      ]
    },
    {
      "id": 34,
      "question": "What are the names , themes , and number of singers for every concert ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(DISTINCT Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(DISTINCT sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(*) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(*) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(*) FROM singer_in_concert sic WHERE sic.concert_ID  =  concert.concert_ID) AS singer_count FROM concert"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(DISTINCT Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  concert.concert_ID) FROM concert"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(DISTINCT sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) FROM concert LEFT JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) FROM concert LEFT JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, COUNT(sic.Singer_ID) FROM concert c1 LEFT JOIN singer_in_concert sic ON c1.concert_ID  =  sic.concert_ID GROUP BY c1.concert_ID, c1.concert_Name, c1.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COALESCE(singer_count, 0) FROM concert c1 LEFT JOIN (SELECT concert_ID, COUNT(Singer_ID) singer_count FROM singer_in_concert GROUP BY concert_ID) c2 ON c1.concert_ID  =  c2.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COALESCE(t.singer_count, 0) FROM concert c LEFT JOIN (SELECT concert_ID, COUNT(Singer_ID) singer_count FROM singer_in_concert GROUP BY concert_ID) t ON c.concert_ID  =  t.concert_ID"
        },
        {
          "sql": "WITH singer_counts AS (SELECT concert_ID, COUNT(Singer_ID) AS cnt FROM singer_in_concert GROUP BY concert_ID) SELECT c.concert_Name, c.Theme, sc.cnt FROM concert c JOIN singer_counts sc ON c.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "WITH cnt AS (SELECT concert_ID, COUNT(*) cnt FROM singer_in_concert GROUP BY concert_ID) SELECT concert_Name, Theme, cnt FROM concert JOIN cnt ON concert.concert_ID  =  cnt.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers.num_singers FROM concert, (SELECT concert_ID, COUNT(Singer_ID) num_singers FROM singer_in_concert GROUP BY concert_ID) singers WHERE concert.concert_ID  =  singers.concert_ID"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, c2.num_singers FROM concert c1, (SELECT concert_ID, COUNT(Singer_ID) num_singers FROM singer_in_concert GROUP BY concert_ID) c2 WHERE c1.concert_ID  =  c2.concert_ID"
        },
        {
          "sql": "SELECT DISTINCT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) OVER (PARTITION BY concert.concert_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID"
        },
        {
          "sql": "SELECT DISTINCT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) OVER (PARTITION BY c.concert_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert) GROUP BY concert_ID, concert_Name, Theme ORDER BY concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(1) FROM singer_in_concert WHERE concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, (SELECT COUNT(sic1.Singer_ID) FROM singer_in_concert sic1 WHERE sic1.concert_ID  =  c1.concert_ID) FROM concert c1"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM (SELECT concert.*, COUNT(singer_in_concert.Singer_ID) singer_cnt FROM concert LEFT JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme) t"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM (SELECT c.*, COUNT(sic.Singer_ID) singer_cnt FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme) sub"
        },
        {
          "sql": "SELECT concert_Name, Theme, SUM(CASE WHEN singer_in_concert.concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM concert LEFT JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, SUM(CASE WHEN sic.concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(s.Singer_ID) FROM concert c JOIN singer_in_concert sic JOIN singer s ON sic.Singer_ID  =  s.Singer_ID AND sic.concert_ID  =  c.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, cardinality(array_agg(singer_in_concert.Singer_ID)) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE 0 < (SELECT COUNT(*) FROM singer_in_concert sic WHERE sic.concert_ID  =  concert.concert_ID)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE 0 < (SELECT COUNT(sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID)"
        },
        {
          "sql": "SELECT concert_Name, Theme, GROUP_CONCAT(singer_in_concert.Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, GROUP_CONCAT(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        }
      ]
    },
    {
      "id": 35,
      "question": "List singer names and number of concerts for each singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer JOIN singer_in_concert ON singer.Singer_ID  =  singer_in_concert.Singer_ID GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(sic.concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM singer JOIN singer_in_concert USING(Singer_ID) GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(sic.concert_ID) FROM singer_in_concert sic JOIN singer s ON sic.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(DISTINCT concert_ID) FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, count(sic.concert_ID) FROM singer_in_concert sic JOIN singer s USING(Singer_ID) GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert GROUP BY Singer_ID) ORDER BY Name"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(*) FROM singer_in_concert sic2 WHERE sic2.Singer_ID  =  s.Singer_ID) FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT Name, (SELECT count(concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) FROM singer s WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.Singer_ID  =  s.Singer_ID)"
        },
        {
          "sql": "WITH singer_concerts AS (SELECT Singer_ID, count(concert_ID) as concert_count FROM singer_in_concert GROUP BY Singer_ID) SELECT s.Name, sc.concert_count FROM singer s JOIN singer_concerts sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(sic.concert_ID) FROM singer LEFT JOIN singer_in_concert sic ON Singer_ID  =  sic.Singer_ID GROUP BY Singer_ID, Name HAVING count(sic.concert_ID) > 0"
        },
        {
          "sql": "SELECT s1.Name, count(s2.concert_ID) FROM singer s1 JOIN (SELECT * FROM singer_in_concert) s2 ON s1.Singer_ID  =  s2.Singer_ID GROUP BY s1.Singer_ID, s1.Name"
        },
        {
          "sql": "SELECT DISTINCT s.Name, cnt FROM singer s JOIN (SELECT Singer_ID, count(*) as cnt FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name, sum(CASE WHEN concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer LEFT JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Singer_ID, Name HAVING sum(CASE WHEN concert_ID IS NOT NULL THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT Name FROM (SELECT s.Name, count(sic.concert_ID) as c FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name) t"
        },
        {
          "sql": "SELECT s.Name, GROUP_CONCAT(concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, cardinality(collect(concert_ID)) FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Name"
        },
        {
          "sql": "WITH RECURSIVE cnt AS (SELECT Singer_ID, 1 as concerts FROM singer_in_concert UNION ALL SELECT c.Singer_ID, cnt.concerts + 1 FROM cnt JOIN singer_in_concert c ON cnt.Singer_ID  =  c.Singer_ID) SELECT DISTINCT s.Name, cnt.concerts FROM singer s JOIN cnt ON s.Singer_ID  =  cnt.Singer_ID"
        },
        {
          "sql": "SELECT Name, count(concert_ID) OVER (PARTITION BY Singer_ID) FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Name, concert_ID"
        },
        {
          "sql": "SELECT * FROM (SELECT Name, count(concert_ID) as num_concerts FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Singer_ID, Name) LIMIT 1000"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM singer_in_concert sic WHERE sic.Singer_ID  =  singer.Singer_ID GROUP BY sic.Singer_ID) FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT s.Name, coalesce(sc.concert_count, 0) FROM singer s LEFT JOIN (SELECT Singer_ID, count(concert_ID) as concert_count FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID WHERE sc.concert_count IS NOT NULL"
        },
        {
          "sql": "SELECT Name FROM singer CROSS JOIN (SELECT Singer_ID, count(*) as cnt FROM singer_in_concert GROUP BY Singer_ID) t WHERE singer.Singer_ID  =  t.Singer_ID"
        },
        {
          "sql": "SELECT s.Name, count(*) FROM (SELECT DISTINCT Singer_ID, concert_ID FROM singer_in_concert) sic JOIN singer s ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(1) FROM singer JOIN singer_in_concert sic ON singer.Singer_ID  =  sic.Singer_ID GROUP BY singer.Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(sic.concert_ID) FROM singer_in_concert sic RIGHT JOIN singer s ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, s.Name HAVING count(sic.concert_ID) > 0"
        },
        {
          "sql": "SELECT Name, regr_count(concert_ID) FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Name"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer_in_concert GROUP BY Singer_ID)"
        },
        {
          "sql": "SELECT s.Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer_in_concert sic GROUP BY sic.Singer_ID HAVING count(sic.concert_ID) > 0 AND sic.Singer_ID  =  s.Singer_ID)"
        },
        {
          "sql": "WITH singer_stats AS (SELECT Singer_ID, count(concert_ID) FROM singer_in_concert GROUP BY Singer_ID) SELECT Name, singer_stats.count FROM singer JOIN singer_stats ON singer.Singer_ID  =  singer_stats.Singer_ID"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer NATURAL JOIN singer_in_concert GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT DISTINCT Name, sub.cnt FROM singer, LATERAL (SELECT count(*) as cnt FROM singer_in_concert WHERE Singer_ID  =  singer.Singer_ID) sub WHERE sub.cnt > 0"
        },
        {
          "sql": "SELECT Name FROM singer s MATCH (SELECT * FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) GROUP BY s.Name HAVING count(*) > 0"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer JOIN LATERAL (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  singer.Singer_ID) t ON true GROUP BY Name"
        }
      ]
    },
    {
      "id": 36,
      "question": "What are the names of the singers and number of concerts for each person?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT s.Name ,  count(sc.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(DISTINCT sc.concert_ID) FROM singer AS s JOIN singer_in_concert AS sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(*) FROM singer JOIN singer_in_concert USING(Singer_ID) GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM concert c JOIN singer_in_concert sc ON c.concert_ID  =  sc.concert_ID JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  cnt FROM singer s JOIN (SELECT Singer_ID ,  count(concert_ID) cnt FROM singer_in_concert GROUP BY Singer_ID) t ON s.Singer_ID  =  t.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  cnt FROM singer s JOIN (SELECT Singer_ID ,  count(*) cnt FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(*) FROM singer_in_concert sc2 WHERE sc2.Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT Name ,  (SELECT count(concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT s.Name ,  count(sc.concert_ID) FROM singer_in_concert sc JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "WITH singer_concerts AS (SELECT Singer_ID ,  count(concert_ID) AS concert_count FROM singer_in_concert GROUP BY Singer_ID) SELECT s.Name ,  sc.concert_count FROM singer s JOIN singer_concerts sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  concert_count FROM singer s JOIN (SELECT Singer_ID ,  count(concert_ID) AS concert_count FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer s INNER JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID INNER JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert GROUP BY Singer_ID HAVING count(concert_ID) > 0) ORDER BY Name"
        },
        {
          "sql": "SELECT s1.Name ,  count(s2.concert_ID) FROM singer s1 LEFT JOIN singer_in_concert s2 ON s1.Singer_ID  =  s2.Singer_ID GROUP BY s1.Singer_ID ,  s1.Name HAVING count(s2.concert_ID) > 0"
        },
        {
          "sql": "SELECT Name ,  sum(CASE WHEN Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IS NOT NULL) THEN 1 ELSE 0 END) FROM singer GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(DISTINCT concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID GROUP BY Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT DISTINCT Name ,  GREATEST(count(concert_ID), 0) FROM singer LEFT JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT Name ,  cardinality(array_agg(concert_ID)) FROM singer JOIN singer_in_concert USING(Singer_ID) GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(sc.concert_ID) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM (SELECT DISTINCT Singer_ID ,  Name ,  concert_ID FROM singer JOIN singer_in_concert USING(Singer_ID)) GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT Name ,  cnt.concert_count FROM singer ,  (SELECT Singer_ID ,  count(*) concert_count FROM singer_in_concert GROUP BY Singer_ID) cnt WHERE singer.Singer_ID  =  cnt.Singer_ID"
        },
        {
          "sql": "SELECT * FROM (SELECT s.Name ,  count(sc.concert_ID) n_concerts FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name) t"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM singer CROSS JOIN singer_in_concert WHERE singer.Singer_ID  =  singer_in_concert.Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  COALESCE(cnt, 0) FROM singer s LEFT JOIN (SELECT Singer_ID ,  count(concert_ID) cnt FROM singer_in_concert GROUP BY Singer_ID) t ON s.Singer_ID  =  t.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM singer NATURAL JOIN singer_in_concert GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  sum(1) FROM singer_in_concert sic JOIN singer s ON sic.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  extract(epoch from count(concert_ID)) FROM singer JOIN singer_in_concert ON Singer_ID  =  Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(*) FROM singer s WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.Singer_ID  =  s.Singer_ID) GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  (SELECT count(*) FROM (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  outer_singer.Singer_ID) t) FROM singer outer_singer"
        },
        {
          "sql": "WITH RECURSIVE cnt AS (SELECT Singer_ID ,  1 as concerts FROM singer_in_concert UNION ALL SELECT Singer_ID ,  concerts + 1 FROM cnt JOIN singer_in_concert ON Singer_ID  =  Singer_ID) SELECT DISTINCT s.Name ,  MAX(c.concerts) FROM singer s JOIN cnt c ON s.Singer_ID  =  c.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM (SELECT s.Name ,  c.concert_ID FROM singer s FULL JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID FULL JOIN concert c ON sic.concert_ID  =  c.concert_ID) t GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name ,  ROW_NUMBER() OVER (PARTITION BY s.Singer_ID ORDER BY sc.concert_ID) - ROW_NUMBER() OVER (ORDER BY s.Singer_ID ,  sc.concert_ID) + count(*) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM singer s MATCH_RECOGNIZE (PARTITION BY Singer_ID MEASURES COUNT(concert_ID) AS concert_cnt ALL ROWS PER MATCH PATTERN (A*) DEFINE A AS true) GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer AS s NATURAL JOIN singer_in_concert AS sic JOIN concert AS c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        }
      ]
    },
    {
      "id": 37,
      "question": "List all singer names in concerts in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID JOIN concert ON singer_in_concert.concert_ID=concert.concert_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=singer.Singer_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer s, singer_in_concert sic, concert c WHERE s.Singer_ID=sic.Singer_ID AND sic.concert_ID=c.concert_ID AND c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID = sic.Singer_ID JOIN concert AS c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) t JOIN singer s ON t.Singer_ID=s.Singer_ID"
        },
        {
          "sql": "WITH c2014 AS (SELECT concert_ID FROM concert WHERE Year=2014) SELECT Name FROM singer JOIN singer_in_concert sic ON singer.Singer_ID=sic.Singer_ID WHERE sic.concert_ID IN (SELECT concert_ID FROM c2014)"
        },
        {
          "sql": "SELECT s.Name FROM concert c JOIN singer_in_concert sic ON c.concert_ID=sic.concert_ID JOIN singer s ON sic.Singer_ID=s.Singer_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM ((singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID) JOIN concert ON singer_in_concert.concert_ID=concert.concert_ID) WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT s1.Name FROM singer s1 WHERE s1.Singer_ID IN (SELECT sic1.Singer_ID FROM singer_in_concert sic1, concert c1 WHERE sic1.concert_ID=c1.concert_ID AND c1.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM singer s JOIN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) sub ON s.Singer_ID=sub.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM singer,concert,singer_in_concert WHERE singer.Singer_ID=singer_in_concert.Singer_ID AND singer_in_concert.concert_ID=concert.concert_ID AND concert.Year=2014"
        },
        {
          "sql": "WITH concerts_2014 AS (SELECT * FROM concert WHERE Year=2014) SELECT Name FROM singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID JOIN concerts_2014 ON singer_in_concert.concert_ID=concerts_2014.concert_ID"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE EXISTS (SELECT NULL FROM concert c JOIN singer_in_concert sic ON c.concert_ID=sic.concert_ID WHERE c.Year=2014 AND sic.Singer_ID=s.Singer_ID)"
        },
        {
          "sql": "SELECT s.Name FROM (SELECT concert_ID FROM concert WHERE Year=2014) c2014 JOIN singer_in_concert sic ON c2014.concert_ID=sic.concert_ID JOIN singer s ON sic.Singer_ID=s.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer INNER JOIN singer_in_concert USING(Singer_ID) INNER JOIN concert USING(concert_ID) WHERE Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer s1 JOIN singer_in_concert s2 ON s1.Singer_ID=s2.Singer_ID JOIN concert c2 ON s2.concert_ID=c2.concert_ID AND c2.Year=2014"
        },
        {
          "sql": "SELECT singer.Name FROM concert INNER JOIN singer_in_concert ON concert.concert_ID=singer_in_concert.concert_ID INNER JOIN singer ON singer_in_concert.Singer_ID=singer.Singer_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT Name FROM (SELECT Singer_ID,concert_ID FROM singer_in_concert) sic JOIN concert ON sic.concert_ID=concert.concert_ID JOIN singer ON sic.Singer_ID=singer.Singer_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer s JOIN LATERAL (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=s.Singer_ID AND c.Year=2014 LIMIT 1) t ON true"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID=ANY(SELECT Singer_ID FROM singer_in_concert WHERE concert_ID=ANY(SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID IN (SELECT unnest(ARRAY_AGG(DISTINCT Singer_ID)) FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s LEFT JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID LEFT JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014 AND c.concert_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Name FROM (SELECT Singer_ID FROM singer_in_concert GROUP BY Singer_ID HAVING STRING_AGG(concert_ID::text,'|')::text ~* '(^|\\|)('|| (SELECT STRING_AGG(concert_ID::text,'|') FROM concert WHERE Year=2014) || '(\\|$)') singers JOIN singer USING(Singer_ID)"
        },
        {
          "sql": "SELECT Name FROM singer CROSS JOIN (SELECT 1 WHERE EXISTS(SELECT 1 FROM concert WHERE Year=2014 JOIN singer_in_concert USING(concert_ID) AND singer_in_concert.Singer_ID=singer.Singer_ID)) t"
        },
        {
          "sql": "SELECT DISTINCT (SELECT Name FROM singer s WHERE s.Singer_ID=sic.Singer_ID) FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE (SELECT COUNT(*) FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=s.Singer_ID AND c.Year=2014)>0"
        },
        {
          "sql": "SELECT Name FROM singer UNION SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert JOIN concert USING(concert_ID) WHERE Year=2014 AND Singer_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM singer s JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert INTERSECT SELECT Singer_ID FROM singer_in_concert JOIN concert ON concert.concert_ID=singer_in_concert.concert_ID WHERE Year=2014) t ON s.Singer_ID=t.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM (SELECT * FROM singer EXCEPT SELECT Name FROM singer WHERE Singer_ID NOT IN (SELECT Singer_ID FROM singer_in_concert JOIN concert ON concert.concert_ID=singer_in_concert.concert_ID WHERE Year=2014))"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert EXCEPT SELECT Singer_ID FROM singer_in_concert WHERE concert_ID NOT IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "WITH RECURSIVE singers2014(Singer_ID) AS (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID=(SELECT concert_ID FROM concert WHERE Year=2014 LIMIT 1) UNION SELECT sic.Singer_ID FROM singer_in_concert sic JOIN singers2014 s ON sic.concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) SELECT Name FROM singer JOIN singers2014 USING(Singer_ID)"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM (SELECT Singer_ID, MAX(Year) over (PARTITION BY Singer_ID) max_year FROM singer_in_concert JOIN concert USING(concert_ID)) t WHERE max_year>=2014 AND Year=2014)"
        }
      ]
    },
    {
      "id": 38,
      "question": "What are the names of the singers who performed in a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=singer.Singer_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID WHERE sic.concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT sic.Singer_ID FROM singer_in_concert sic INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer s, singer_in_concert sic, concert c WHERE s.Singer_ID=sic.Singer_ID AND sic.concert_ID=c.concert_ID AND c.Year=2014"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) t ON s.Singer_ID=t.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID=ANY (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM ((singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID) INNER JOIN concert c ON sic.concert_ID=c.concert_ID) WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic CROSS JOIN concert c WHERE sic.concert_ID=c.concert_ID AND c.Year=2014)"
        },
        {
          "sql": "WITH c2014 AS (SELECT concert_ID FROM concert WHERE Year=2014) SELECT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID WHERE sic.concert_ID IN (SELECT concert_ID FROM c2014)"
        },
        {
          "sql": "SELECT s1.Name FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer_in_concert sic1, concert c1 WHERE sic1.Singer_ID=s1.Singer_ID AND sic1.concert_ID=c1.concert_ID AND c1.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM singer, (SELECT sic.Singer_ID FROM singer_in_concert sic JOIN concert ON sic.concert_ID=concert.concert_ID WHERE concert.Year=2014) AS t WHERE singer.Singer_ID=t.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID=(SELECT concert_ID FROM concert WHERE Year=2014 LIMIT 900000000))"
        },
        {
          "sql": "SELECT s.Name FROM singer AS s INNER JOIN singer_in_concert AS sic ON s.Singer_ID = sic.Singer_ID INNER JOIN concert AS c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM (SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014) t"
        },
        {
          "sql": "SELECT singer.Name FROM concert INNER JOIN singer_in_concert ON concert.concert_ID=singer_in_concert.concert_ID INNER JOIN singer ON singer_in_concert.Singer_ID=singer.Singer_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID, concert WHERE singer_in_concert.concert_ID=concert.concert_ID AND concert.Year=2014"
        },
        {
          "sql": "WITH singers2014 AS (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singers2014)"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM (concert c JOIN singer_in_concert sic ON c.concert_ID=sic.concert_ID) JOIN singer s ON sic.Singer_ID=s.Singer_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM (singer JOIN singer_in_concert) JOIN concert ON singer_in_concert.concert_ID=concert.concert_ID WHERE singer.Singer_ID=singer_in_concert.Singer_ID AND concert.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer s1 JOIN (SELECT sic.Singer_ID FROM singer_in_concert sic INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014) t ON s1.Singer_ID=t.Singer_ID"
        },
        {
          "sql": "SELECT singer.Name FROM singer_in_concert INNER JOIN singer ON singer_in_concert.Singer_ID=singer.Singer_ID INNER JOIN concert ON singer_in_concert.concert_ID=concert.concert_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM (singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID), concert c WHERE sic.concert_ID=c.concert_ID AND c.Year=2014"
        },
        {
          "sql": "SELECT s.Name FROM singer s WHERE s.Singer_ID IN (SELECT sic.Singer_ID FROM singer_in_concert sic WHERE sic.concert_ID IN (SELECT c.concert_ID FROM concert c WHERE c.Year=2014))"
        },
        {
          "sql": "WITH concerts14 AS (SELECT * FROM concert WHERE Year=2014) SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concerts14 c ON sic.concert_ID=c.concert_ID"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT NULL FROM (singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID) WHERE sic.Singer_ID=singer.Singer_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer AS s, singer_in_concert AS sic, concert AS c WHERE s.Singer_ID=sic.Singer_ID AND sic.concert_ID=c.concert_ID AND c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM (SELECT s.Singer_ID, s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID WHERE sic.concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT singer.Name FROM ((concert INNER JOIN singer_in_concert ON concert.concert_ID = singer_in_concert.concert_ID) INNER JOIN singer ON singer_in_concert.Singer_ID = singer.Singer_ID) WHERE concert.Year = 2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic CROSS JOIN (SELECT concert_ID FROM concert WHERE Year=2014) c WHERE sic.concert_ID=c.concert_ID)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN (SELECT DISTINCT Singer_ID, concert_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) AS sub ON s.Singer_ID = sub.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT sic.Singer_ID FROM (singer_in_concert sic INNER JOIN concert c ON sic.concert_ID = c.concert_ID) WHERE c.Year = 2014)"
        }
      ]
    },
    {
      "id": 39,
      "question": "what is the name and nation of the singer who have a song having 'Hey' in its name?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT singer.Name, singer.Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE 'Hey%' OR Song_Name LIKE '% Hey%' OR Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LENGTH(Song_Name) > 0 AND Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT s1.Name, s1.Country FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = s1.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT * FROM singer) t WHERE t.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer s WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "WITH hey_singers AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM hey_singers)"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE POSITION('Hey' IN Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name ~* 'hey'"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Country FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE CONCAT('%', 'Hey', '%')"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s INNER JOIN (SELECT DISTINCT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') hs ON s.Singer_ID = hs.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE INSTR(UPPER(Song_Name), 'HEY') > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "SELECT Name, Country FROM singer t1 WHERE EXISTS (SELECT 1 FROM singer t2 WHERE t2.Singer_ID = t1.Singer_ID AND t2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "WITH singers_with_hey AS (SELECT DISTINCT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM singer s JOIN singers_with_hey sh ON s.Singer_ID = sh.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name MATCH 'Hey'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM (SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%') t"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name ILIKE '%Hey%'"
        },
        {
          "sql": "SELECT s.Name, Country FROM singer s WHERE s.Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOCATE('Hey', Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT Singer_ID, Name, Country FROM singer) t WHERE t.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "WITH target_singers AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT DISTINCT Name, Country FROM singer s WHERE s.Singer_ID IN (SELECT Singer_ID FROM target_singers)"
        },
        {
          "sql": "SELECT Name, Country FROM singer s1 INNER JOIN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') s2 ON s1.Singer_ID = s2.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' AND Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT t1.Name, t1.Country FROM singer t1, singer t2 WHERE t1.Singer_ID = t2.Singer_ID AND t2.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name SIMILAR TO '%Hey%'"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name LIKE '%Hey%' GROUP BY s.Singer_ID, s.Name, s.Country"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 1000"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name COLLATE UTF8_GENERAL_CI LIKE '%Hey%'"
        }
      ]
    },
    {
      "id": 40,
      "question": "What is the name and country of origin of every singer who has a song with the word 'Hey' in its title?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE 'Hey%' OR Song_Name LIKE '% Hey%' OR Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOCATE('Hey', Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE POSITION('Hey' IN Song_Name) > 0"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOWER(Song_Name) LIKE '%hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT * FROM singer) t WHERE t.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT DISTINCT s1.Name, s1.Country FROM singer s1 INNER JOIN singer s2 ON s1.Singer_ID = s2.Singer_ID WHERE s2.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer s WHERE Song_Name LIKE '%Hey%' AND s.Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "WITH hey_singers AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM hey_singers)"
        },
        {
          "sql": "SELECT Name, Country FROM singer CROSS JOIN (SELECT 1) t WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name MATCH 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = s1.Singer_ID AND s2.Song_Name NOT LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT Singer_ID, Name, Country, Song_Name FROM singer) AS sub WHERE sub.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE INSTR(Song_Name, 'Hey') > 0"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = s.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name ILIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name ~* 'hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer GROUP BY Singer_ID, Name, Country HAVING MAX(CASE WHEN Song_Name LIKE '%Hey%' THEN 1 ELSE 0 END) = 1"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer, (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') hey WHERE singer.Singer_ID = hey.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer UNION SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' ORDER BY Name"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 10000"
        },
        {
          "sql": "WITH RECURSIVE hey_finder AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%' UNION ALL SELECT hf.Singer_ID FROM hey_finder hf) SELECT DISTINCT Name, Country FROM singer s JOIN hey_finder hf ON s.Singer_ID = hf.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer LEFT JOIN (SELECT Singer_ID FROM singer WHERE Song_Name NOT LIKE '%Hey%') nohey ON singer.Singer_ID = nohey.Singer_ID WHERE nohey.Singer_ID IS NULL"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE (SELECT COUNT(*) FROM (SELECT 1) t WHERE Song_Name LIKE '%Hey%') > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer MATCH (Song_Name) AGAINST ('Hey')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE BINARY Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer s WHERE Song_Name LIKE CONCAT('%', 'Hey', '%')"
        }
      ]
    },
    {
      "id": 41,
      "question": "Find the name and location of the stadiums which some concerts happened in the years of both 2014 and 2015.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year IN (2014,2015) GROUP BY s.Stadium_ID ,  s.Name ,  s.Location HAVING SUM(CASE WHEN c.Year=2014 THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN c.Year=2015 THEN 1 ELSE 0 END)>0"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2014 INTERSECT SELECT c.Stadium_ID FROM concert c WHERE c.Year=2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s JOIN concert c1 ON s.Stadium_ID  =  c1.Stadium_ID JOIN concert c2 ON s.Stadium_ID  =  c2.Stadium_ID WHERE c1.Year=2014 AND c2.Year=2015"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2014) AND EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year=2014 AND s.Stadium_ID IN (SELECT c2.Stadium_ID FROM concert c2 WHERE c2.Year=2015)"
        },
        {
          "sql": "WITH years14 AS (SELECT Stadium_ID FROM concert WHERE Year=2014), years15 AS (SELECT Stadium_ID FROM concert WHERE Year=2015) SELECT s.Name ,  s.Location FROM stadium s JOIN years14 y14 ON s.Stadium_ID  =  y14.Stadium_ID JOIN years15 y15 ON s.Stadium_ID  =  y15.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year=2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year=2015) y ON s.Stadium_ID  =  y.Stadium_ID"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT c1.Stadium_ID FROM concert c1 WHERE c1.Year=2014 AND EXISTS(SELECT 1 FROM concert c2 WHERE c2.Stadium_ID  =  c1.Stadium_ID AND c2.Year=2015))"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID ,  s.Name ,  s.Location HAVING MIN(c.Year)=2014 AND MAX(c.Year)=2015 AND COUNT(DISTINCT c.Year)=2"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE (SELECT COUNT(DISTINCT c.Year) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year IN (2014,2015))=2"
        },
        {
          "sql": "SELECT DISTINCT s1.Name ,  s1.Location FROM stadium s1 JOIN concert c1 ON s1.Stadium_ID  =  c1.Stadium_ID JOIN stadium s2 ON s1.Stadium_ID  =  s2.Stadium_ID JOIN concert c2 ON s2.Stadium_ID  =  c2.Stadium_ID WHERE c1.Year=2014 AND c2.Year=2015"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium s JOIN (SELECT Stadium_ID ,  COUNT(DISTINCT Year) as yr_cnt FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING yr_cnt=2) t ON s.Stadium_ID  =  t.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING SUM(Year=2014)>0 AND SUM(Year=2015)>0)"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2014) INTERSECT SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2015)"
        },
        {
          "sql": "WITH c14 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2014), c15 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2015) SELECT Name ,  Location FROM stadium s JOIN c14 ON s.Stadium_ID  =  c14.Stadium_ID JOIN c15 ON s.Stadium_ID  =  c15.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s JOIN concert c14 ON s.Stadium_ID  =  c14.Stadium_ID JOIN concert c15 ON s.Stadium_ID  =  c15.Stadium_ID WHERE c14.Year=2014 AND c15.Year=2015 AND c14.concert_ID  <>  c15.concert_ID"
        },
        {
          "sql": "SELECT Name ,  Location FROM (SELECT s.Name ,  s.Location ,  c.Year FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID) t GROUP BY Name ,  Location HAVING SUM(Year=2014)>0 AND SUM(Year=2015)>0"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2014)>0 AND (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2015)>0"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID AND c.Year IN (2014,2015) GROUP BY s.Stadium_ID ,  s.Name ,  s.Location HAVING COUNT(DISTINCT c.Year)=2"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID ,  Year FROM concert WHERE Year IN (2014,2015)) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2)"
        },
        {
          "sql": "SELECT s1.Name ,  s1.Location FROM stadium s1 ,  stadium s2 ,  concert c1 ,  concert c2 WHERE s1.Stadium_ID  =  c1.Stadium_ID AND s1.Stadium_ID  =  s2.Stadium_ID AND s2.Stadium_ID  =  c2.Stadium_ID AND c1.Year=2014 AND c2.Year=2015"
        },
        {
          "sql": "WITH both_years AS (SELECT Stadium_ID FROM concert WHERE Year=2014 UNION SELECT Stadium_ID FROM concert WHERE Year=2015 GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2) SELECT Name ,  Location FROM stadium s JOIN both_years b ON s.Stadium_ID  =  b.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert c1 JOIN concert c2 ON c1.Stadium_ID  =  c2.Stadium_ID WHERE c1.Year=2014 AND c2.Year=2015) t ON s.Stadium_ID  =  t.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s JOIN LATERAL (SELECT Year FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) t1 ON t1.Year=2014 JOIN LATERAL (SELECT Year FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) t2 ON t2.Year=2015"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2014 INTERSECT SELECT DISTINCT Stadium_ID FROM concert WHERE Year=2015)"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE NOT EXISTS(SELECT 1 FROM (SELECT DISTINCT Year FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) y WHERE y.Year NOT IN (2014,2015)) AND EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2014) AND EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year=2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s ,  concert c WHERE s.Stadium_ID  =  c.Stadium_ID AND c.Year IN (2014,2015) GROUP BY s.Stadium_ID ,  s.Name ,  s.Location HAVING COUNT(DISTINCT c.Year)=2"
        },
        {
          "sql": "WITH RECURSIVE tmp AS (SELECT Stadium_ID FROM concert WHERE Year=2014 UNION SELECT Stadium_ID FROM concert WHERE Year=2015 AND Stadium_ID IN (SELECT Stadium_ID FROM tmp)) SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM tmp WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2)"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium s MATCH (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2014) AND MATCH (SELECT c.Stadium_ID FROM concert c WHERE c.Year=2015)"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert PIVOT (COUNT(*) FOR Year IN (2014 AS y14, 2015 AS y15)) WHERE y14>0 AND y15>0) p ON s.Stadium_ID  =  p.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Location FROM (SELECT s.*, STRING_AGG(CAST(c.Year AS VARCHAR),'') as years FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID) t WHERE years LIKE '%2014%' AND years LIKE '%2015%'"
        },
        {
          "sql": "SELECT s.Name ,  s.Location FROM stadium s WHERE Stadium_ID  &>  (SELECT Stadium_ID FROM concert WHERE Year=2014 LIMIT 1) AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year=2015)"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium GROUP BY Stadium_ID HAVING BOOL_OR((SELECT Year=2014 FROM concert c WHERE c.Stadium_ID  =  stadium.Stadium_ID LIMIT 1)) AND BOOL_OR((SELECT Year=2015 FROM concert c WHERE c.Stadium_ID  =  stadium.Stadium_ID LIMIT 1))"
        },
        {
          "sql": "SELECT s1.Name ,  s1.Location FROM stadium s1 CROSS JOIN stadium s2 WHERE s1.Stadium_ID  =  s2.Stadium_ID AND EXISTS(SELECT 1 FROM concert c1 WHERE c1.Stadium_ID  =  s1.Stadium_ID AND c1.Year=2014) AND EXISTS(SELECT 1 FROM concert c2 WHERE c2.Stadium_ID  =  s2.Stadium_ID AND c2.Year=2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s RIGHT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year IN (2014,2015) AND (SELECT COUNT(DISTINCT cc.Year) FROM concert cc WHERE cc.Stadium_ID  =  s.Stadium_ID)=2"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium s WHERE JSON_ARRAYAGG((SELECT JSON_OBJECT('year',c.Year) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID)) LIKE '%2014%' AND JSON_ARRAYAGG((SELECT JSON_OBJECT('year',c.Year) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID)) LIKE '%2015%'"
        }
      ]
    },
    {
      "id": 42,
      "question": "What are the names and locations of the stadiums that had concerts that occurred in both 2014 and 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year IN (2014,2015) GROUP BY s.Stadium_ID, s.Name, s.Location HAVING COUNT(DISTINCT c.Year) = 2"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014) AND s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c1 ON s.Stadium_ID = c1.Stadium_ID JOIN concert c2 ON s.Stadium_ID = c2.Stadium_ID WHERE c1.Year = 2014 AND c2.Year = 2015"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014) AND EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2015)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year = 2015) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014 AND s.Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE (SELECT COUNT(DISTINCT c.Year) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year IN (2014,2015)) = 2"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, Name, Location HAVING SUM(CASE WHEN c.Year = 2014 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN c.Year = 2015 THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT DISTINCT s1.Name, s1.Location FROM stadium s1 JOIN concert c1 ON s1.Stadium_ID = c1.Stadium_ID WHERE c1.Year = 2014 AND EXISTS (SELECT 1 FROM concert c2 JOIN stadium s2 ON c2.Stadium_ID = s2.Stadium_ID WHERE c2.Year = 2015 AND s2.Stadium_ID = s1.Stadium_ID)"
        },
        {
          "sql": "WITH years2014 AS (SELECT Stadium_ID FROM concert WHERE Year = 2014), years2015 AS (SELECT Stadium_ID FROM concert WHERE Year = 2015) SELECT s.Name, s.Location FROM stadium s JOIN years2014 y1 ON s.Stadium_ID = y1.Stadium_ID JOIN years2015 y2 ON s.Stadium_ID = y2.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s INNER JOIN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING ARRAY_AGG(DISTINCT Year) @> ARRAY[2014,2015]) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert c1 WHERE Year = 2014 AND EXISTS (SELECT 1 FROM concert c2 WHERE c2.Stadium_ID = c1.Stadium_ID AND c2.Year = 2015))"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID CROSS JOIN (SELECT 1 i WHERE 2014 IN (SELECT Year FROM concert WHERE Stadium_ID = s.Stadium_ID) AND 2015 IN (SELECT Year FROM concert WHERE Stadium_ID = s.Stadium_ID)) t"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM (SELECT Year FROM concert WHERE Stadium_ID = s.Stadium_ID) y WHERE y.Year NOT IN (2014,2015)) AND EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = s.Stadium_ID AND Year IN (2014,2015))"
        },
        {
          "sql": "SELECT Name, Location FROM (SELECT s.*, COUNT(DISTINCT c.Year) as year_count FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year IN (2014,2015) GROUP BY s.Stadium_ID, s.Name, s.Location) t WHERE year_count = 2"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN LATERAL (SELECT Year FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year IN (2014,2015) GROUP BY Year HAVING COUNT(*) > 0) years ON true GROUP BY s.Stadium_ID, s.Name, s.Location HAVING COUNT(*) = 2"
        },
        {
          "sql": "SELECT DISTINCT Name, Location FROM stadium s WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year = 2014) AND Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT s1.Name, s1.Location FROM stadium s1, stadium s2 WHERE s1.Stadium_ID = s2.Stadium_ID AND EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID = s1.Stadium_ID AND c1.Year = 2014) AND EXISTS (SELECT 1 FROM concert c2 WHERE c2.Stadium_ID = s2.Stadium_ID AND c2.Year = 2015)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium NATURAL JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year) = 2) t"
        },
        {
          "sql": "WITH RECURSIVE years_check(Stadium_ID, years_found) AS (SELECT Stadium_ID, 0 FROM concert WHERE Year = 2014 UNION ALL SELECT c.Stadium_ID, y.years_found + 1 FROM concert c JOIN years_check y ON c.Stadium_ID = y.Stadium_ID WHERE c.Year = 2015 AND y.years_found = 1) SELECT s.Name, s.Location FROM stadium s JOIN years_check yc ON s.Stadium_ID = yc.Stadium_ID WHERE years_found = 2"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s JOIN (SELECT Stadium_ID, STRING_AGG(CAST(Year AS VARCHAR), ',') as years FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING years = '2014,2015') t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c1 ON s.Stadium_ID = c1.Stadium_ID LEFT JOIN concert c2 ON s.Stadium_ID = c2.Stadium_ID AND c2.Year = 2015 WHERE c1.Year = 2014 AND c2.concert_ID IS NOT NULL"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE (SELECT BIT_OR(1 << (Year - 2014)) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year IN (2014,2015)) = 3"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT unnest(ARRAY_AGG(DISTINCT Stadium_ID)) FROM (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT Stadium_ID FROM concert WHERE Year = 2015) t GROUP BY Stadium_ID HAVING COUNT(*) = 2)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s MATCH (SELECT Stadium_ID FROM concert WHERE Year = 2014) AND MATCH (SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s, (VALUES (2014),(2015)) v(year) WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = v.year) GROUP BY s.Stadium_ID, Name, Location HAVING COUNT(DISTINCT v.year) = 2"
        },
        {
          "sql": "SELECT DISTINCT Name, Location FROM stadium JOIN (SELECT Stadium_ID FROM concert PIVOT (COUNT(*) FOR Year IN (2014,2015)) GROUP BY Stadium_ID HAVING \"2014\" > 0 AND \"2015\" > 0) t USING (Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN jsonb_each_text(to_jsonb((SELECT jsonb_agg(Year) FROM concert WHERE Stadium_ID = s.Stadium_ID AND Year IN (2014,2015)))) j WHERE j.value::int IN (2014,2015) GROUP BY s.Stadium_ID, s.Name, s.Location HAVING COUNT(DISTINCT j.value::int) = 2"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID OVERLAPS (SELECT Stadium_ID FROM concert WHERE Year = 2014) AND Stadium_ID OVERLAPS (SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "WITH stadium_years AS (SELECT Stadium_ID, COLLECT_SET(Year) as years FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID) SELECT s.Name, s.Location FROM stadium s JOIN stadium_years sy ON s.Stadium_ID = sy.Stadium_ID WHERE size(sy.years) = 2"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE json_extract( (SELECT json_group_array(Year) FROM concert WHERE Stadium_ID = s.Stadium_ID), '$[*]' ) GLOB '*2014*' AND json_extract( (SELECT json_group_array(Year) FROM concert WHERE Stadium_ID = s.Stadium_ID), '$[*]' ) GLOB '*2015*'"
        },
        {
          "sql": "SELECT DISTINCT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year BETWEEN 2014 AND 2015 GROUP BY Stadium_ID HAVING MIN(Year) = 2014 AND MAX(Year) = 2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year % 100 IN (14,15) AND Year / 100 = 20 GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year) = 2) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Location FROM (SELECT s.*, bool_and(Year IN (2014,2015)) as has_both FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, Name, Location) t WHERE has_both AND (SELECT COUNT(DISTINCT Year) FROM concert WHERE Stadium_ID = t.Stadium_ID AND Year IN (2014,2015)) = 2"
        }
      ]
    },
    {
      "id": 43,
      "question": "Find the number of concerts happened in the stadium with the highest capacity .",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C1 JOIN stadium S ON C1.Stadium_ID = S.Stadium_ID WHERE S.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C JOIN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) MAX_S ON C.Stadium_ID = MAX_S.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT MAX_S.Stadium_ID FROM (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) MAX_S)"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM max_stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C WHERE EXISTS (SELECT 1 FROM stadium S WHERE S.Stadium_ID = C.Stadium_ID AND S.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert JOIN stadium ON concert.Stadium_ID = stadium.Stadium_ID AND stadium.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT C.concert_ID) FROM concert C INNER JOIN stadium S ON C.Stadium_ID = S.Stadium_ID WHERE S.Capacity = (SELECT MAX(S2.Capacity) FROM stadium S2)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)))"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM stadium WHERE Capacity >= ALL (SELECT Capacity FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(*) FROM stadium S1 JOIN concert C ON S1.Stadium_ID = C.Stadium_ID WHERE S1.Capacity = (SELECT MAX(S2.Capacity) FROM stadium S2)"
        },
        {
          "sql": "SELECT COUNT(C.concert_ID) FROM concert C, stadium S WHERE C.Stadium_ID = S.Stadium_ID AND S.Capacity >= ALL (SELECT Capacity FROM stadium)"
        },
        {
          "sql": "WITH highest_capacity AS (SELECT MAX(Capacity) max_cap FROM stadium) SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID JOIN highest_capacity H ON S.Capacity = H.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium S WHERE NOT EXISTS (SELECT 1 FROM stadium S2 WHERE S2.Capacity > S.Capacity))"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM concert CROSS JOIN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) top_stadium WHERE concert.Stadium_ID = top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) top JOIN concert ON top.Stadium_ID = concert.Stadium_ID"
        },
        {
          "sql": "SELECT SUM(CASE WHEN C.Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) THEN 1 ELSE 0 END) FROM concert C"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID LEFT JOIN stadium S2 ON S2.Capacity > S.Capacity WHERE S2.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT S.Stadium_ID FROM stadium S WHERE S.Capacity = (SELECT MAX(stadium.Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM (SELECT concert_ID, stadium.Capacity FROM concert JOIN stadium ON concert.Stadium_ID = stadium.Stadium_ID) WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, Capacity, ROW_NUMBER() OVER (ORDER BY Capacity DESC) as rn FROM stadium) SELECT COUNT(*) FROM concert C JOIN ranked_stadiums R ON C.Stadium_ID = R.Stadium_ID WHERE R.rn = 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C INNER JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity IN (SELECT MAX(Capacity) FROM stadium)) MS ON C.Stadium_ID = MS.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(1) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert FULL OUTER JOIN stadium S ON concert.Stadium_ID = S.Stadium_ID WHERE S.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(C.concert_ID) FROM concert C WHERE C.Stadium_ID = (SELECT TOP 1 Stadium_ID FROM stadium ORDER BY Capacity DESC)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT C.* FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID WHERE S.Capacity >= (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "WITH top_stadium AS (SELECT Stadium_ID FROM stadium WHERE Capacity IN (SELECT DISTINCT MAX(Capacity) FROM stadium)) SELECT COUNT(*) FROM concert, top_stadium WHERE concert.Stadium_ID = top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C1 WHERE Stadium_ID IN (SELECT C2.Stadium_ID FROM stadium C2 WHERE C2.Capacity = (SELECT MAX(C3.Capacity) FROM stadium C3))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT C.concert_ID) FROM stadium S CROSS JOIN concert C WHERE S.Stadium_ID = C.Stadium_ID AND S.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID > 0 AND Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT 1 FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) GROUP BY Stadium_ID)"
        },
        {
          "sql": "WITH max_cap AS (SELECT MAX(Capacity) mc FROM stadium), max_stad AS (SELECT Stadium_ID FROM stadium, max_cap WHERE Capacity = mc) SELECT COUNT(*) FROM concert, max_stad WHERE concert.Stadium_ID = max_stad.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C JOIN LATERAL (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) ms ON C.Stadium_ID = ms.Stadium_ID"
        }
      ]
    },
    {
      "id": 44,
      "question": "What are the number of concerts that occurred in the stadium with the largest capacity ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c, stadium s WHERE c.Stadium_ID = s.Stadium_ID AND s.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT s1.Stadium_ID FROM stadium s1 WHERE s1.Capacity = (SELECT MAX(s2.Capacity) FROM stadium s2))"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM max_stadium)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE s.Capacity >= ALL (SELECT Capacity FROM stadium)"
        },
        {
          "sql": "SELECT SUM(CASE WHEN c.Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert c"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) s ON c.Stadium_ID = s.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c INNER JOIN stadium s ON c.Stadium_ID = s.Stadium_ID INNER JOIN (SELECT MAX(Capacity) max_cap FROM stadium) m ON s.Capacity = m.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS (SELECT 1 FROM stadium s WHERE s.Stadium_ID = concert.Stadium_ID AND s.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(c1.concert_ID) FROM concert c1 WHERE c1.Stadium_ID = ANY (SELECT s.Stadium_ID FROM stadium s WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium)) t"
        },
        {
          "sql": "WITH largest_capacity AS (SELECT MAX(Capacity) max_cap FROM stadium) SELECT COUNT(*) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID, largest_capacity l WHERE s.Capacity = l.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert NATURAL JOIN stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c CROSS JOIN (SELECT MAX(Capacity) max_cap FROM stadium) m JOIN stadium s ON c.Stadium_ID = s.Stadium_ID AND s.Capacity = m.max_cap"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c LEFT JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert c, (SELECT Stadium_ID FROM stadium WHERE Capacity >= ALL(SELECT Capacity FROM stadium)) s WHERE c.Stadium_ID = s.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT c.concert_ID FROM concert c INNER JOIN stadium s ON c.Stadium_ID = s.Stadium_ID ORDER BY s.Capacity DESC LIMIT (SELECT COUNT(*) FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) * 1000000) t"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, Capacity, ROW_NUMBER() OVER (ORDER BY Capacity DESC) rn FROM stadium) SELECT COUNT(*) FROM concert c JOIN ranked_stadiums r ON c.Stadium_ID = r.Stadium_ID WHERE r.rn = 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity > s1.Capacity))"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity > s.Capacity)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM stadium WHERE Capacity IN (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert EXCEPT SELECT COUNT(concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity < (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE s.Capacity = (SELECT FIRST_VALUE(Capacity) OVER (ORDER BY Capacity DESC) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = ALL (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "WITH max_cap AS (SELECT Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1) SELECT COUNT(*) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID JOIN max_cap m ON s.Capacity = m.Capacity"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT c.* FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity > ALL (SELECT Capacity-1 FROM stadium)) t"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert GROUP BY Stadium_ID HAVING Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert UNION ALL SELECT 0 WHERE NOT EXISTS (SELECT 1 FROM stadium WHERE Capacity > (SELECT Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID LIMIT 1))"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY Capacity DESC) rn FROM stadium) s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE s.rn = 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c RIGHT JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CASE WHEN s.Capacity = (SELECT MAX(Capacity) FROM stadium) THEN c.concert_ID END) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s WHERE s.Capacity >= (SELECT AVG(Capacity) FROM stadium) * 2 AND s.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        }
      ]
    },
    {
      "id": 45,
      "question": "Find the number of pets whose weight is heavier than 10.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(DISTINCT PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10.0"
        },
        {
          "sql": "SELECT count(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(pet_age) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE NOT (weight <= 10)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT count(PetID) FROM (SELECT * FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight BETWEEN 10.0001 AND 999999"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > CAST(10 AS DECIMAL)"
        },
        {
          "sql": "WITH heavy_pets AS (SELECT * FROM Pets WHERE weight > 10) SELECT count(*) FROM heavy_pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight - 10 > 0"
        },
        {
          "sql": "SELECT count(*) FROM Pets CROSS JOIN (SELECT 10 AS threshold) AS T1 WHERE Pets.weight > T1.threshold"
        },
        {
          "sql": "SELECT count(Pets.PetID) FROM Pets WHERE Pets.weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE EXISTS (SELECT 1 WHERE weight > 10)"
        },
        {
          "sql": "SELECT sum(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT cardinality(ARRAY_AGG(PetID)) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID, PetType FROM Pets WHERE weight > 10) AS subq"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > ALL (SELECT 10)"
        },
        {
          "sql": "SELECT (SELECT count(PetID) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE weight > 10 AND PetType IS NOT NULL"
        },
        {
          "sql": "SELECT count(pet_age) FROM Pets WHERE pet_age IS NOT NULL AND weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 AND PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "WITH T1 AS (SELECT weight FROM Pets WHERE weight > 10) SELECT count(*) FROM T1"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > (SELECT AVG(weight) FROM Pets WHERE weight <= 10) + 0.0001"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets LEFT JOIN (SELECT 10 AS lim) AS dummy ON 1=1 WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID FROM Pets WHERE weight > 10 GROUP BY PetID) AS T2"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 GROUP BY () HAVING count(*) > 0"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1.0 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT count(DISTINCT CASE WHEN weight > 10 THEN PetID END) FROM Pets"
        }
      ]
    },
    {
      "id": 46,
      "question": "How many pets have a greater weight than 10?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(DISTINCT PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE NOT (weight <= 10)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT count(T1.PetID) FROM Pets AS T1 WHERE T1.weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10.0"
        },
        {
          "sql": "SELECT sum(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10 GROUP BY PetType HAVING count(PetID) > 0"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "WITH HeavyPets AS (SELECT * FROM Pets WHERE weight > 10) SELECT count(*) FROM HeavyPets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight BETWEEN 10.0001 AND 999999"
        },
        {
          "sql": "SELECT sum(CASE WHEN Pets.weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > (SELECT 10)"
        },
        {
          "sql": "SELECT (SELECT count(PetID) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(Pets.PetID) FROM Pets WHERE Pets.weight > 10"
        },
        {
          "sql": "WITH T1 AS (SELECT PetID FROM Pets WHERE weight > 10) SELECT count(*) FROM T1"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT sum(CAST(weight > 10 AS INTEGER)) FROM Pets"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(pet_age) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(weight) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 GROUP BY ()"
        },
        {
          "sql": "WITH PetCount AS (SELECT count(*) AS cnt FROM Pets WHERE weight > 10) SELECT cnt FROM PetCount"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE weight > 10 AND PetType IS NOT NULL GROUP BY () HAVING count(DISTINCT PetType) > 0"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets WHERE weight > 10 UNION ALL SELECT 0) WHERE 1=1 GROUP BY ()"
        },
        {
          "sql": "SELECT count(*) FROM Pets CROSS JOIN (SELECT 1 AS dummy) WHERE Pets.weight > 10"
        },
        {
          "sql": "SELECT sum(IIF(weight > 10, 1, 0)) FROM Pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > ALL (SELECT 10)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID, weight FROM Pets) WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE EXISTS (SELECT 1 FROM (SELECT 10 AS threshold) WHERE weight > threshold)"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1 END) FROM Pets WHERE weight IS NOT NULL"
        }
      ]
    },
    {
      "id": 47,
      "question": "Find the weight of the youngest dog.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog') AND PetType='dog'"
        },
        {
          "sql": "SELECT MIN(weight) FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age,weight FROM Pets WHERE PetType='dog') AS T1 WHERE pet_age=MIN(pet_age)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 WHERE P1.PetType='dog' AND P1.pet_age=(SELECT MIN(P2.pet_age) FROM Pets P2 WHERE P2.PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT P.weight FROM Pets P INNER JOIN (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType='dog') T ON P.pet_age=T.min_age WHERE P.PetType='dog'"
        },
        {
          "sql": "SELECT weight FROM Pets P1 WHERE PetType='dog' AND NOT EXISTS (SELECT 1 FROM Pets P2 WHERE P2.PetType='dog' AND P2.pet_age<P1.pet_age)"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age,weight,PetType FROM Pets) T WHERE T.PetType='dog' AND T.pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT T1.weight FROM Pets T1 WHERE T1.PetType='dog' AND T1.pet_age=(SELECT MIN(T2.pet_age) FROM Pets T2 WHERE T2.PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID=(SELECT PetID FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT P.weight FROM Pets P, (SELECT MIN(pet_age) AS min_age FROM Pets WHERE PetType='dog') T WHERE P.PetType='dog' AND P.pet_age=T.min_age"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC ROWS UNBOUNDED PRECEDING) FROM Pets WHERE PetType='dog' LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' GROUP BY pet_age,weight HAVING pet_age=MIN(pet_age)"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age,MIN(weight) weight FROM Pets WHERE PetType='dog' GROUP BY pet_age) T1 WHERE pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "WITH min_dog_age AS (SELECT MIN(pet_age) age FROM Pets WHERE PetType='dog') SELECT weight FROM Pets,P1 CROSS JOIN min_dog_age WHERE PetType='dog' AND pet_age=P1.age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age <= ALL (SELECT pet_age FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 WHERE P1.PetType='dog' AND pet_age=(SELECT pet_age FROM Pets P2 WHERE P2.PetType='dog' GROUP BY pet_age ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType ILIKE 'dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType ILIKE 'dog')"
        },
        {
          "sql": "SELECT * FROM (SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age,PetID ASC LIMIT 1) T"
        },
        {
          "sql": "SELECT weight FROM Pets P WHERE EXISTS (SELECT 1 FROM Pets P2 WHERE P2.PetType='dog' AND P.pet_age=P2.pet_age AND P2.pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')) AND P.PetType='dog'"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=ANY (ARRAY(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog'))"
        },
        {
          "sql": "SELECT (SELECT weight FROM Pets P1 WHERE P1.PetType='dog' ORDER BY P1.pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM (SELECT DISTINCT pet_age,weight FROM Pets WHERE PetType='dog') WHERE pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT P.weight FROM Pets P WHERE P.PetType='dog' FETCH FIRST ROW ONLY ORDER BY P.pet_age ASC"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND ROW_NUMBER() OVER (ORDER BY pet_age ASC)=1"
        },
        {
          "sql": "SELECT weight FROM (SELECT *,RANK() OVER (ORDER BY pet_age ASC) rnk FROM Pets WHERE PetType='dog') WHERE rnk=1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets WHERE PetType='dog' AND pet_age>0 ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "WITH ranked_dogs AS (SELECT weight,pet_age,DENSE_RANK() OVER (ORDER BY pet_age ASC) r FROM Pets WHERE PetType='dog') SELECT weight FROM ranked_dogs WHERE r=1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' INTERSECT SELECT weight FROM Pets WHERE pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 JOIN (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType='dog') AS T1 ON P1.pet_age = T1.min_age WHERE P1.PetType='dog'"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE LOWER(PetType)='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE LOWER(PetType)='dog')"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age,weight,PetType,row_number() OVER (PARTITION BY PetType ORDER BY pet_age ASC) rn FROM Pets) WHERE PetType='dog' AND rn=1"
        }
      ]
    },
    {
      "id": 48,
      "question": "How much does the youngest dog weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT MIN(weight) FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT p1.weight FROM Pets p1 WHERE p1.PetType='dog' AND p1.pet_age=(SELECT MIN(p2.pet_age) FROM Pets p2 WHERE p2.PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC ROWS UNBOUNDED PRECEDING) FROM Pets WHERE PetType='dog' LIMIT 1"
        },
        {
          "sql": "WITH youngest_dog_age AS (SELECT MIN(pet_age) AS min_age FROM Pets WHERE PetType='dog') SELECT weight FROM Pets, youngest_dog_age WHERE PetType='dog' AND pet_age=min_age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=MIN(pet_age) OVER (PARTITION BY PetType) AND PetType='dog' LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age ASC) as rn FROM Pets WHERE PetType='dog') WHERE rn=1"
        },
        {
          "sql": "SELECT p.weight FROM Pets p INNER JOIN (SELECT MIN(pet_age) AS min_age FROM Pets WHERE PetType='dog') y ON p.pet_age=y.min_age AND p.PetType='dog'"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age <= ALL (SELECT pet_age FROM Pets WHERE PetType='dog') LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND (pet_age,PetID)=(SELECT pet_age,MIN(PetID) FROM Pets WHERE PetType='dog' GROUP BY pet_age ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "WITH ranked_dogs AS (SELECT weight, pet_age, DENSE_RANK() OVER (ORDER BY pet_age ASC) as rnk FROM Pets WHERE PetType='dog') SELECT weight FROM ranked_dogs WHERE rnk=1"
        },
        {
          "sql": "SELECT weight FROM Pets p1 WHERE PetType='dog' AND NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType='dog' AND p2.pet_age<p1.pet_age)"
        },
        {
          "sql": "SELECT MAX(weight) FROM (SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1) t"
        },
        {
          "sql": "SELECT weight FROM (SELECT * FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "WITH min_age AS (SELECT pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1) SELECT weight FROM Pets, min_age WHERE PetType='dog' AND pet_age=min_age.pet_age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID=(SELECT PetID FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets CROSS JOIN (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType='dog') sub WHERE PetType='dog' AND pet_age=min_age"
        },
        {
          "sql": "SELECT p.weight FROM Pets p WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets WHERE PetType='dog' LIMIT 1)"
        },
        {
          "sql": "WITH dog_ages AS (SELECT pet_age FROM Pets WHERE PetType='dog'), min_dog_age AS (SELECT MIN(pet_age) age FROM dog_ages) SELECT weight FROM Pets, min_dog_age WHERE PetType='dog' AND pet_age=age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' FETCH FIRST 1 ROW ONLY ORDER BY pet_age ASC"
        },
        {
          "sql": "SELECT DISTINCT weight FROM Pets WHERE PetType='dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM (SELECT PetID, pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1) earliest JOIN Pets ON PetID"
        },
        {
          "sql": "WITH dogs AS (SELECT * FROM Pets WHERE PetType='dog'), min_age_dog AS (SELECT MIN(pet_age) age FROM dogs) SELECT weight FROM dogs, min_age_dog WHERE pet_age=age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE CONCAT(PetType, pet_age) = (SELECT CONCAT(PetType, pet_age) FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets p WHERE p.PetType='dog' AND p.pet_age NOT IN (SELECT pet_age-1 FROM Pets WHERE PetType='dog' UNION SELECT pet_age FROM Pets WHERE PetType='dog' AND pet_age>0)"
        },
        {
          "sql": "WITH ordered_dogs AS (SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age ASC) SELECT weight FROM ordered_dogs LIMIT 1"
        },
        {
          "sql": "SELECT (SELECT weight FROM Pets p2 WHERE p2.PetType='dog' ORDER BY p2.pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' GROUP BY PetID HAVING pet_age=MIN(pet_age) ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE youngest AS (SELECT MIN(pet_age) age FROM Pets WHERE PetType='dog' UNION ALL SELECT age FROM youngest LIMIT 1) SELECT weight FROM Pets, youngest WHERE PetType='dog' AND pet_age=age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType||pet_age=(SELECT PetType||pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT p.weight FROM Pets p, (SELECT pet_age FROM Pets WHERE PetType='dog' HAVING MIN(pet_age)=pet_age) m WHERE p.PetType='dog' AND p.pet_age=m.pet_age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets WHERE PetType='dog' GROUP BY pet_age ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "WITH dog_min AS (SELECT weight, pet_age FROM Pets WHERE PetType='dog' QUALIFY pet_age=MIN(pet_age) OVER ()) SELECT weight FROM dog_min LIMIT 1"
        }
      ]
    },
    {
      "id": 49,
      "question": "Find the maximum weight for each type of pet. List the maximum weight and pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT max(weight) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1 GROUP BY PetType"
        },
        {
          "sql": "WITH pet_max AS (SELECT PetType, max(weight) AS mw FROM Pets GROUP BY PetType) SELECT PetType, mw FROM pet_max"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets AS p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT p.PetType, max(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType HAVING count(*) > 0"
        },
        {
          "sql": "SELECT PetType, GREATEST(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT max(p2.weight) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, weight, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY weight DESC) AS rn FROM Pets) SELECT PetType, weight FROM ranked_pets WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "WITH max_weights AS (SELECT DISTINCT PetType, FIRST_VALUE(weight) OVER (PARTITION BY PetType ORDER BY weight DESC) AS max_wt FROM Pets) SELECT PetType, max_wt FROM max_weights"
        },
        {
          "sql": "SELECT PetType, CORR(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, max(p2.weight) FROM Pets p JOIN Pets p2 ON p.PetType = p2.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE weight IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, weight FROM Pets) SELECT PetType, max(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM (SELECT * FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) FROM (SELECT PetType, weight FROM Pets) t GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ALL"
        },
        {
          "sql": "WITH RECURSIVE pet_max AS (SELECT PetType, max(weight) FROM Pets GROUP BY PetType) SELECT * FROM pet_max"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType UNION SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, max(weight) AS max_weight FROM Pets GROUP BY PetType) ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FOR UPDATE"
        },
        {
          "sql": "EXISTS (SELECT 1 FROM Pets) AND (SELECT PetType, max(weight) FROM Pets GROUP BY PetType)"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType INTO temp_table"
        },
        {
          "sql": "DECLARE @result TABLE (PetType varchar(50), max_weight float); INSERT INTO @result SELECT PetType, max(weight) FROM Pets GROUP BY PetType; SELECT * FROM @result"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType WINDOW w AS ()"
        },
        {
          "sql": "WITH pet_data AS (SELECT PetType, weight FROM Pets WHERE pet_age > 0) SELECT PetType, max(weight) FROM pet_data GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, (SELECT max(p2.weight) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM (SELECT DISTINCT PetType FROM Pets) p1"
        },
        {
          "sql": "SELECT PetType, max(weight) KEEP (DENSE_RANK FIRST ORDER BY weight DESC) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, LAST_VALUE(weight) OVER (PARTITION BY PetType ORDER BY weight ROWS UNBOUNDED PRECEDING) AS max_weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets)"
        },
        {
          "sql": "SELECT PetType, PERCENTILE_CONT(1) WITHIN GROUP (ORDER BY weight DESC) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType MATCHES (SELECT PetType FROM Pets)"
        }
      ]
    },
    {
      "id": 50,
      "question": "List the maximum weight and type for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT max(weight) FROM Pets T2 WHERE T2.PetType  =  T1.PetType) FROM Pets T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT p.PetType, max(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType HAVING count(*) > 0"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, weight FROM Pets) SELECT PetType, max(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, GREATEST(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) max_weight FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT max(T2.weight) FROM Pets T2 WHERE T2.PetType  =  T1.PetType) FROM Pets T1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType LIMIT 10000"
        },
        {
          "sql": "WITH RECURSIVE pet_max AS (SELECT PetType, weight, 1 as lvl FROM Pets UNION ALL SELECT PetType, weight, lvl+1 FROM pet_max WHERE lvl < 1) SELECT PetType, max(weight) FROM pet_max GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FOR UPDATE"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets t GROUP BY t.PetType"
        },
        {
          "sql": "SELECT p.PetType, max(p.weight) FROM Pets p, Pets p2 WHERE p.PetType  =  p2.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType UNION SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH cte AS (SELECT PetType, max(weight) as mw FROM Pets GROUP BY PetType) SELECT * FROM cte"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType EXCEPT SELECT PetType, 0 FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ALL"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType WITH ROLLUP"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType, PetID HAVING PetID IS NULL"
        },
        {
          "sql": "SELECT PetType, FIRST_VALUE(weight) OVER (ORDER BY weight DESC ROWS UNBOUNDED PRECEDING) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FETCH FIRST 10000 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ROLLUP(PetType)"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType, PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, max(p1.weight) FROM Pets p1 WHERE p1.weight  =  (SELECT max(p2.weight) FROM Pets p2 WHERE p2.PetType  =  p1.PetType) GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType HAVING min(PetType) IS NOT NULL"
        },
        {
          "sql": "WITH pet_weights AS (SELECT DISTINCT PetType, weight FROM Pets) SELECT PetType, max(weight) FROM pet_weights GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, LAST_VALUE(weight) OVER (PARTITION BY PetType ORDER BY weight ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType INTERSECT SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY max(weight) DESC"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, max(weight) FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType WHERE TRUE"
        }
      ]
    },
    {
      "id": 51,
      "question": "Find number of pets owned by students who are older than 20.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE P.PetID IN (SELECT PetID FROM Has_Pet H WHERE H.StuID IN (SELECT StuID FROM Student S WHERE S.Age > 20))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT SUM(CASE WHEN P.PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Pets P FULL OUTER JOIN Has_Pet H ON P.PetID = H.PetID FULL OUTER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS temp"
        },
        {
          "sql": "WITH OlderStudents AS (SELECT StuID FROM Student WHERE Age > 20) SELECT COUNT(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM OlderStudents)"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.weight) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON S.StuID = H.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.pet_age) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetType) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age > 20)"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age > 20)"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS PetOwners ON P.PetID = PetOwners.PetID"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON S.StuID = H.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(1) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H.StuID AND S.Age > 20)"
        },
        {
          "sql": "WITH PetCount AS (SELECT COUNT(P.PetID) as cnt FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 GROUP BY 1) SELECT cnt FROM PetCount"
        },
        {
          "sql": "SELECT COUNT_BIG(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) t"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20 AND P.PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE P.PetID = ANY (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT REPLICATE('X', (SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20))"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM ((Pets P JOIN Has_Pet H) ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(P.*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(H.*) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID) AND S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S WHERE S.Age > 20 AND EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "WITH RECURSIVE temp(n) AS (SELECT 0 UNION ALL SELECT n+1 FROM temp WHERE n < (SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) - 1) SELECT COUNT(*) FROM temp"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20) t ON true"
        },
        {
          "sql": "SELECT (SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE P.PetID IN (SELECT DISTINCT PetID FROM Has_Pet H WHERE H.StuID IN (SELECT DISTINCT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT COALESCE(P.PetID, H.PetID)) FROM Pets P FULL JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID = ANY (SELECT StuID FROM Student WHERE Age > 20)"
        }
      ]
    },
    {
      "id": 52,
      "question": "How many pets are owned by students that have an age greater than 20?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT SUM(CASE WHEN H.StuID IN (SELECT StuID FROM Student WHERE Age > 20) THEN 1 ELSE 0 END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS sub"
        },
        {
          "sql": "SELECT COUNT(P.PetType) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.weight) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS temp"
        },
        {
          "sql": "SELECT SUM(CASE WHEN S.Age > 20 THEN 1 ELSE 0 END) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID"
        },
        {
          "sql": "SELECT COUNT(P.pet_age) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS owners ON P.PetID = owners.PetID"
        },
        {
          "sql": "WITH older_students AS (SELECT StuID FROM Student WHERE Age > 20) SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN older_students OS ON H.StuID = OS.StuID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM (SELECT StuID FROM Student WHERE Age > 20) AS old_students JOIN Has_Pet H ON old_students.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20)"
        },
        {
          "sql": "SELECT COUNT(P.*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age > 20)"
        },
        {
          "sql": "SELECT COUNT(1) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetType) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 AND COUNT(DISTINCT P.PetType) > 0"
        },
        {
          "sql": "SELECT COUNT(H.*) FROM Has_Pet H INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT (SELECT COUNT(*) FROM Pets WHERE PetID = H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 GROUP BY H.PetID HAVING COUNT(*) = 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetID IN (SELECT DISTINCT PetID FROM Has_Pet WHERE StuID IN (SELECT DISTINCT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Pets P1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Student S1 ON H1.StuID = S1.StuID WHERE H1.PetID = P1.PetID AND S1.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID, COUNT(*) as cnt FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 GROUP BY PetID) AS grouped_pets"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P LEFT JOIN Has_Pet H ON P.PetID = H.PetID LEFT JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 AND H.StuID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets CROSS JOIN (SELECT StuID FROM Student WHERE Age > 20) AS old_s JOIN Has_Pet H ON old_s.StuID = H.StuID AND Pets.PetID = H.PetID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT COALESCE(P.PetID, H.PetID)) FROM Pets P FULL OUTER JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON COALESCE(H.StuID, P.PetID) = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.Age > 20) AS cartesian"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20 LIMIT 1) AS t ON true"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetID = ANY (SELECT PetID FROM Has_Pet WHERE StuID = ANY (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID CROSS JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID FROM Has_Pet EXCEPT SELECT PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age <= 20) AS only_old"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20) > 0"
        }
      ]
    },
    {
      "id": 53,
      "question": "Find the number of dog pets that are raised by female students (with sex F).",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(DISTINCT P1.PetID) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT HP1.StuID FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog') AS T1"
        },
        {
          "sql": "SELECT count(HP1.StuID) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(P1.weight) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(P1.pet_age) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(S1.StuID) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 WHERE PetType = 'dog' AND PetID IN (SELECT PetID FROM Has_Pet HP1 WHERE StuID IN (SELECT StuID FROM Student WHERE Sex = 'F'))"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 JOIN Has_Pet HP1 ON P1.PetID = HP1.PetID WHERE P1.PetType = 'dog' AND HP1.StuID IN (SELECT StuID FROM Student WHERE Sex = 'F')"
        },
        {
          "sql": "SELECT count(*) FROM Has_Pet HP1 WHERE HP1.StuID IN (SELECT StuID FROM Student WHERE Sex = 'F') AND HP1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT count(*) FROM Student S1 WHERE S1.Sex = 'F' AND EXISTS (SELECT 1 FROM Has_Pet HP1 JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE HP1.StuID = S1.StuID AND P1.PetType = 'dog')"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 WHERE P1.PetType = 'dog' AND EXISTS (SELECT 1 FROM Has_Pet HP1 JOIN Student S1 ON HP1.StuID = S1.StuID WHERE HP1.PetID = P1.PetID AND S1.Sex = 'F')"
        },
        {
          "sql": "SELECT count(*) FROM Has_Pet HP1 WHERE EXISTS (SELECT 1 FROM Student S1 WHERE S1.StuID = HP1.StuID AND S1.Sex = 'F') AND EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID = HP1.PetID AND P1.PetType = 'dog')"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 WHERE P1.PetType = 'dog' AND EXISTS (SELECT 1 FROM Has_Pet HP1 JOIN Student S1 ON HP1.StuID = S1.StuID WHERE HP1.PetID = P1.PetID AND S1.Sex = 'F')"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT P1.PetID FROM Pets P1 JOIN Has_Pet HP1 ON P1.PetID = HP1.PetID JOIN Student S1 ON HP1.StuID = S1.StuID WHERE P1.PetType = 'dog' AND S1.Sex = 'F') AS T1"
        },
        {
          "sql": "SELECT count(HP1.PetID) FROM Has_Pet HP1 JOIN Student S1 ON HP1.StuID = S1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(DISTINCT HP1.PetID) FROM Has_Pet HP1 JOIN Student S1 ON HP1.StuID = S1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT sum(CASE WHEN P1.PetType = 'dog' THEN 1 ELSE 0 END) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE S1.Sex = 'F'"
        },
        {
          "sql": "SELECT sum(CASE WHEN S1.Sex = 'F' AND P1.PetType = 'dog' THEN 1 ELSE 0 END) FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID"
        },
        {
          "sql": "SELECT count(*) FROM Student, Has_Pet, Pets WHERE Student.StuID = Has_Pet.StuID AND Has_Pet.PetID = Pets.PetID AND Student.Sex = 'F' AND Pets.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(Pets.PetID) FROM Student, Has_Pet, Pets WHERE Student.StuID = Has_Pet.StuID AND Has_Pet.PetID = Pets.PetID AND Student.Sex = 'F' AND Pets.PetType = 'dog'"
        },
        {
          "sql": "WITH female_dog_owners AS (SELECT StuID FROM Student WHERE Sex = 'F') SELECT count(*) FROM female_dog_owners FDO JOIN Has_Pet HP ON FDO.StuID = HP.StuID JOIN Pets P ON HP.PetID = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "WITH dogs AS (SELECT PetID FROM Pets WHERE PetType = 'dog') SELECT count(*) FROM dogs D JOIN Has_Pet HP ON D.PetID = HP.PetID JOIN Student S ON HP.StuID = S.StuID WHERE S.Sex = 'F'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT 1 FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT count(1) FROM Student S1 INNER JOIN Has_Pet H1 ON S1.StuID = H1.StuID INNER JOIN Pets P1 ON H1.PetID = P1.PetID WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(P1.PetType) FROM ((Student S1 JOIN Has_Pet H1 ON S1.StuID = H1.StuID) JOIN Pets P1 ON H1.PetID = P1.PetID) WHERE S1.Sex = 'F' AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog' AND H2.StuID = S1.StuID) FROM Student S1 WHERE S1.Sex = 'F' GROUP BY S1.StuID HAVING count(*) > 0"
        },
        {
          "sql": "SELECT sum(q1.dog_count) FROM (SELECT count(P.PetID) AS dog_count FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog' GROUP BY S.StuID) q1"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE PetType = 'dog' AND PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Sex = 'F'))"
        },
        {
          "sql": "SELECT count(DISTINCT P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT count(H.PetID) FROM Has_Pet H INNER JOIN Student S ON H.StuID = S.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT count(*) FROM Student S WHERE Sex = 'F' AND StuID IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog')"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P, Has_Pet H, Student S WHERE P.PetType = 'dog' AND P.PetID = H.PetID AND H.StuID = S.StuID AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT H.StuID, P.PetID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F' AND P.PetType = 'dog') AS subq"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets P WHERE P.PetType = 'dog' AND EXISTS (SELECT 1 FROM Has_Pet H WHERE H.PetID = P.PetID AND H.StuID IN (SELECT StuID FROM Student WHERE Sex = 'F'))"
        }
      ]
    },
    {
      "id": 54,
      "question": "How many dog pets are raised by female students?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P1.PetID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(H1.StuID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(H1.PetID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT S1.StuID FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog') AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1 INNER JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID INNER JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE P1.PetType  =  'dog' AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Pets P1 INNER JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID INNER JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE P1.PetType  =  'dog' AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID WHERE H1.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID  =  P2.PetID WHERE P2.PetType  =  'dog') AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P1.PetID FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID WHERE P1.PetType  =  'dog' AND H1.StuID IN (SELECT S1.StuID FROM Student S1 WHERE S1.Sex  =  'F')) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE P1.PetType  =  'dog') AND Sex  =  'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P1 WHERE PetType  =  'dog' AND PetID IN (SELECT H1.PetID FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE S1.Sex  =  'F')"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H1 WHERE H1.StuID IN (SELECT S1.StuID FROM Student S1 WHERE S1.Sex  =  'F') AND H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType  =  'dog')"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H1.PetID) FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType  =  'dog') AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT SUM(CASE WHEN P1.PetType  =  'dog' THEN 1 ELSE 0 END) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT SUM(CASE WHEN S1.Sex  =  'F' AND P1.PetType  =  'dog' THEN 1 ELSE 0 END) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1, Has_Pet H1, Pets P1 WHERE S1.StuID  =  H1.StuID AND H1.PetID  =  P1.PetID AND S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Student S1, Has_Pet H1, Pets P1 WHERE S1.StuID  =  H1.StuID AND H1.PetID  =  P1.PetID AND S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM ((Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID) JOIN Pets P1 ON H1.PetID  =  P1.PetID) WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1 JOIN (Has_Pet H1 JOIN Pets P1 ON H1.PetID  =  P1.PetID) ON S1.StuID  =  H1.StuID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID) JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H1.PetID) FROM (Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID) JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Student S1 WHERE S1.StuID  =  H1.StuID AND S1.Sex  =  'F') AND EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID  =  H1.PetID AND P1.PetType  =  'dog')"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P1 WHERE P1.PetType  =  'dog' AND EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE H1.PetID  =  P1.PetID AND S1.Sex  =  'F')"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1 WHERE S1.Sex  =  'F' AND EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE H1.StuID  =  S1.StuID AND P1.PetType  =  'dog')"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID WHERE P1.PetType  =  'dog' AND EXISTS (SELECT 1 FROM Student S1 WHERE S1.StuID  =  H1.StuID AND S1.Sex  =  'F')"
        },
        {
          "sql": "SELECT COUNT(H1.PetID) FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE P1.PetType  =  'dog' AND EXISTS (SELECT 1 FROM Student S1 WHERE S1.StuID  =  H1.StuID AND S1.Sex  =  'F')"
        },
        {
          "sql": "WITH FemaleDogOwners AS (SELECT H1.PetID FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog') SELECT COUNT(*) FROM FemaleDogOwners"
        },
        {
          "sql": "WITH DogsByFemales AS (SELECT DISTINCT P1.PetID FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE P1.PetType  =  'dog' AND S1.Sex  =  'F') SELECT COUNT(PetID) FROM DogsByFemales"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID LEFT JOIN Pets P1 ON H1.PetID  =  P1.PetID AND P1.PetType  =  'dog' WHERE S1.Sex  =  'F' AND P1.PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(P1.weight) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(P1.pet_age) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT COUNT(S1.StuID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog' AND S1.Age > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT 1 FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog') AS TempTable"
        }
      ]
    },
    {
      "id": 55,
      "question": "Find the number of distinct type of pets.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT count(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets GROUP BY PetType)"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets ORDER BY PetType ASC LIMIT 18446744073709551615) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE EXISTS (SELECT 1 FROM Pets P2 WHERE P2.PetType = Pets.PetType)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets UNION SELECT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE pet_age > 0"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT PetType, PetID FROM Pets) AS T1 GROUP BY PetType"
        },
        {
          "sql": "WITH pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT count(*) FROM pet_types"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets)"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM (SELECT * FROM Pets) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets EXCEPT SELECT NULL) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets JOIN Has_Pet ON 1=1"
        },
        {
          "sql": "SELECT count(PetType) FROM (SELECT PetType, ROW_NUMBER() OVER (PARTITION BY PetType) AS rn FROM Pets) AS T1 WHERE rn = 1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets GROUP BY PetType HAVING count(*) > 0) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE PetID IN (SELECT PetID FROM Pets)"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 WHERE EXISTS (SELECT 1 FROM Pets P2 GROUP BY P2.PetType HAVING P2.PetType = P1.PetType)"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM (SELECT PetType FROM Pets WHERE weight IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets INTERSECT SELECT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets P1 WHERE PetType NOT IN (SELECT PetType FROM Pets P2 WHERE P2.PetID < P1.PetID)"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, ROW_NUMBER() OVER (ORDER BY PetType) AS rn FROM Pets GROUP BY PetType) SELECT count(*) FROM ranked_pets"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets LEFT JOIN Student ON 1=0"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets WHERE PetType <> '' GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM Pets WHERE PetType LIKE '_%'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets GROUP BY PetType ORDER BY PetType) AS T1"
        },
        {
          "sql": "SELECT count(PetType) FROM (SELECT DISTINCT PetType FROM Pets WHERE pet_age IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 JOIN (SELECT DISTINCT PetType FROM Pets) AS T2 ON P1.PetType = T2.PetType GROUP BY T2.PetType"
        },
        {
          "sql": "SELECT count(DISTINCT PetType) FROM (SELECT PetType FROM Pets UNION ALL SELECT PetType FROM Pets WHERE 1=0) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetType FROM Pets GROUP BY PetType, pet_age HAVING pet_age IS NOT NULL) AS T1 GROUP BY PetType"
        }
      ]
    },
    {
      "id": 56,
      "question": "How many different types of pet are there?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType, PetID FROM Pets) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT pet_age) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE pet_age > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE weight > 0 GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT T1.PetType) FROM Pets AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets AS T1 GROUP BY T1.PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "WITH PetTypes AS (SELECT DISTINCT PetType FROM Pets) SELECT COUNT(*) FROM PetTypes"
        },
        {
          "sql": "WITH UniquePets AS (SELECT PetType FROM Pets GROUP BY PetType) SELECT COUNT(*) FROM UniquePets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType, COUNT(*) FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM (SELECT * FROM Pets WHERE PetType != '') AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT UPPER(PetType) FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets UNION SELECT 0 WHERE 1=0"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets p1 WHERE PetType IN (SELECT PetType FROM Pets p2 WHERE p1.PetID = p2.PetID)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets EXCEPT SELECT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets INTERSECT SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets FETCH FIRST 100000 ROWS ONLY"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IN ('Dog', 'Cat', 'Fish', 'Bird', 'Other') GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets p WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType = p.PetType)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets ORDER BY PetType) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets SAMPLE 100 PERCENT"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets AS T1 LEFT JOIN Pets AS T2 ON T1.PetType = T2.PetType GROUP BY T1.PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IN (SELECT PetID FROM Pets)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType, ROW_NUMBER() OVER (PARTITION BY PetType) AS rn FROM Pets) AS T1 GROUP BY PetType"
        }
      ]
    },
    {
      "id": 57,
      "question": "Find the first name of students who have cat or dog pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND (P.PetType = 'cat' OR P.PetType = 'dog'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND H.StuID = S.StuID AND P.PetType = 'cat' UNION SELECT 1 FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND H2.StuID = S.StuID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog'"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID > 0 AND PetID IN (SELECT PetID FROM Pets WHERE PetType <> '' AND (PetType = 'cat' OR PetType = 'dog')))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, H.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) T1 JOIN Pets P ON T1.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM ((Student S JOIN Has_Pet H ON S.StuID = H.StuID) JOIN Pets P ON H.PetID = P.PetID) WHERE P.PetType = 'cat' OR P.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog')) > 0"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Pets.PetType LIKE '%cat%' OR Pets.PetType LIKE '%dog%'"
        },
        {
          "sql": "WITH CatDogOwners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN CatDogOwners CDO ON S.StuID = CDO.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING MAX(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 ELSE 0 END) = 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog') LIMIT 1) T ON true"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID, Fname FROM Student) S WHERE EXISTS (SELECT 1 FROM (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) X WHERE X.StuID = S.StuID)"
        },
        {
          "sql": "SELECT S1.Fname FROM Student S1 WHERE S1.StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID = H1.PetID AND (P1.PetType = 'cat' OR P1.PetType = 'dog')))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (((Student CROSS JOIN Has_Pet) T1 JOIN Has_Pet T2 ON T1.StuID = T2.StuID) JOIN Pets ON T2.PetID = Pets.PetID) WHERE T1.StuID = Student.StuID AND Pets.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S CROSS JOIN (SELECT DISTINCT StuID FROM Has_Pet H WHERE H.PetID IN (SELECT P.PetID FROM Pets P WHERE P.PetType = 'cat' OR P.PetType = 'dog')) T WHERE S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (StuID, 0) IN (SELECT H.StuID, CASE WHEN P.PetType IN ('cat','dog') THEN 1 ELSE 0 END FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID)"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet EXCEPT SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType NOT IN ('cat','dog'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT * FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)) S JOIN Pets P ON S.StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID = P.PetID) WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S WHERE StuID IN (SELECT TOP 100 PERCENT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog') ORDER BY StuID)"
        },
        {
          "sql": "SELECT Fname FROM Student MATCH (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) ON StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT Fname FROM Student INTERSECT SELECT Fname FROM Student S2 WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S2.StuID AND P.PetType IN ('cat','dog')))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student, (SELECT StuID FROM Has_Pet H JOIN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')) PD ON H.PetID = PD.PetID) T WHERE Student.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE 1 = (SELECT CASE WHEN COUNT(P.PetType) > 0 THEN 1 ELSE 0 END FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog') GROUP BY H.StuID)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S LEFT JOIN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType NOT IN ('cat','dog')) N ON S.StuID = N.StuID WHERE N.StuID IS NULL AND EXISTS (SELECT 1 FROM Has_Pet H2 WHERE H2.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID FROM Has_Pet INTERSECT SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) T JOIN Student S ON T.StuID = S.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student WHERE LENGTH(Fname) > 0 AND StuID IN (SELECT StuID FROM Has_Pet H, (SELECT PetID FROM Pets WHERE LOWER(PetType) IN ('cat','dog')) P WHERE H.PetID = P.PetID)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING STRING_AGG((SELECT PetType FROM Pets P WHERE P.PetID = Has_Pet.PetID), ',') LIKE '%cat%' OR STRING_AGG((SELECT PetType FROM Pets P WHERE P.PetID = Has_Pet.PetID), ',') LIKE '%dog%') G ON S.StuID = G.StuID"
        }
      ]
    },
    {
      "id": 58,
      "question": "What are the first names of every student who has a cat or dog as a pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' OR PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType IN ('cat','dog')) T1 JOIN Student S ON T1.StuID = S.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog')) T1 ON S.StuID = T1.StuID"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND (P.PetType = 'cat' OR P.PetType = 'dog')))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM ((SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') UNION (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')) T JOIN Student ON T.StuID = Student.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')))"
        },
        {
          "sql": "WITH pet_owners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN pet_owners PO ON S.StuID = PO.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType = 'cat' OR PetType = 'dog')"
        },
        {
          "sql": "SELECT S.Fname FROM Student S WHERE S.StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID = H1.PetID AND (P1.PetType = 'cat' OR P1.PetType = 'dog')))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, H.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) T1 WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S INNER JOIN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog') T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT * FROM Has_Pet H, Pets P WHERE H.StuID = Student.StuID AND H.PetID = P.PetID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) T1 WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "WITH cat_dog_pets AS (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog') SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN cat_dog_pets C ON H.PetID = C.PetID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')) P ON H.PetID = P.PetID)"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID CROSS JOIN Pets P WHERE H.PetID = P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT S.Fname FROM (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog')) T JOIN Student S ON T.StuID = S.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID > 0 AND StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) T"
        },
        {
          "sql": "SELECT Fname FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID FROM Has_Pet H WHERE H.PetID IN (SELECT P.PetID FROM Pets P WHERE P.PetType IN ('cat','dog'))) T1 JOIN Student S ON T1.StuID = S.StuID"
        },
        {
          "sql": "WITH qualified_students AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) SELECT S.Fname FROM Student S, qualified_students QS WHERE S.StuID = QS.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S WHERE S.StuID = (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog') LIMIT 1) OR EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student INTERSECT SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.*, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname FROM Student S1 JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) T ON S1.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog')) > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING MAX((SELECT PetType FROM Pets P WHERE P.PetID = Has_Pet.PetID) IN ('cat','dog')) = 1)"
        }
      ]
    },
    {
      "id": 59,
      "question": "Find the first name of students who have both cat and dog pets .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' INTERSECT SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND H1.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND H1.StuID = S.StuID) AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog' AND H2.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND S.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) t WHERE (SELECT COUNT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = t.StuID AND P.PetType IN ('cat','dog')) = 2"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') > 0 AND (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID HAVING SUM(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) t ON S.StuID = t.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) t GROUP BY StuID HAVING GROUP_CONCAT(DISTINCT PetType) LIKE '%cat,dog%' OR GROUP_CONCAT(DISTINCT PetType) LIKE '%dog,cat%')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S1 JOIN Has_Pet HP1 ON S1.StuID = HP1.StuID JOIN Pets PT1 ON HP1.PetID = PT1.PetID, Student S2 JOIN Has_Pet HP2 ON S2.StuID = HP2.StuID JOIN Pets PT2 ON HP2.PetID = PT2.PetID WHERE S1.StuID = S2.StuID AND PT1.PetType = 'cat' AND PT2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID = ANY (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat') AND StuID = ANY (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, COUNT(DISTINCT P.PetType) as pet_count FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog') GROUP BY S.StuID, S.Fname HAVING SUM(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) > 0) t"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat'), dog_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') SELECT Fname FROM Student WHERE StuID IN (SELECT * FROM cat_owners INTERSECT SELECT * FROM dog_owners)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE NOT EXISTS (SELECT 1 FROM (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') c WHERE c.StuID = S.StuID EXCEPT SELECT 1 WHERE 1=0) AND NOT EXISTS (SELECT 1 FROM (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') d WHERE d.StuID = S.StuID EXCEPT SELECT 1 WHERE 1=0)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING MIN(PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))) IS NOT NULL AND COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN PetID END) > 0 AND COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN PetID END) > 0)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat' LIMIT 1) c1 ON 1=1 JOIN LATERAL (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog' LIMIT 1) d1 ON 1=1"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname FROM Student S WHERE StuID IN (SELECT COUNT(DISTINCT PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID HAVING FIND_IN_SET('cat', GROUP_CONCAT(DISTINCT P.PetType)) AND FIND_IN_SET('dog', GROUP_CONCAT(DISTINCT P.PetType)))) t"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' INTERSECT SELECT DISTINCT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND (P.PetType = 'cat' OR P.PetType = 'dog') GROUP BY H.StuID HAVING BIT_OR(CASE P.PetType WHEN 'cat' THEN 1 ELSE 0 END) = 1 AND BIT_OR(CASE P.PetType WHEN 'dog' THEN 2 ELSE 0 END) = 2)"
        },
        {
          "sql": "WITH pet_types AS (SELECT StuID, GROUP_CONCAT(DISTINCT PetType ORDER BY PetType) as types FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID GROUP BY StuID) SELECT Fname FROM Student S JOIN pet_types pt ON S.StuID = pt.StuID WHERE pt.types = 'cat,dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog') GROUP BY StuID HAVING COUNT(*) >= 2 AND SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 ELSE 0 END) = 1)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.StuID, S.Fname, COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) as cat_count, COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) as dog_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname) t WHERE cat_count > 0 AND dog_count > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (StuID, 'cat') IN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) AND (StuID, 'dog') IN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT H.StuID, 'cat' FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND H.StuID = S.StuID INTERSECT SELECT H.StuID, 'dog' FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet HP1 WHERE EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID = HP1.PetID AND P1.PetType = 'cat') AND EXISTS (SELECT 1 FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE HP2.StuID = HP1.StuID AND P2.PetType = 'dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S, (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') c, (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') d WHERE S.StuID = c.StuID AND S.StuID = d.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT t1.StuID FROM (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') t1, (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') t2 WHERE t1.StuID = t2.StuID)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) t GROUP BY StuID, Fname HAVING SUM(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetType = 'dog' THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "WITH both_pets AS (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType IN ('cat','dog') GROUP BY StuID HAVING COUNT(DISTINCT PetType) = 2) SELECT Fname FROM Student WHERE StuID IN (SELECT * FROM both_pets)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) LIKE '%cat%' AND (SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) LIKE '%dog%'"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM ((Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat') JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT HP.StuID FROM Has_Pet HP WHERE HP.PetID IN (SELECT P.PetID FROM Pets P WHERE P.PetType = 'cat' UNION ALL SELECT P.PetID FROM Pets P WHERE P.PetType = 'dog') GROUP BY HP.StuID HAVING COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 END) > 0 AND COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 END) > 0)"
        },
        {
          "sql": "SELECT Fname FROM Student S MATCH (SELECT 1 FROM Has_Pet H1, Pets P1 WHERE H1.StuID = S.StuID AND H1.PetID = P1.PetID AND P1.PetType = 'cat') AND MATCH (SELECT 1 FROM Has_Pet H2, Pets P2 WHERE H2.StuID = S.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname, bool_and(P.PetType = 'cat' OR 1=0) OVER (PARTITION BY S.StuID) as has_cat, bool_and(P.PetType = 'dog' OR 1=0) OVER (PARTITION BY S.StuID) as has_dog FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) t WHERE has_cat AND has_dog"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet H1 JOIN (SELECT PetID FROM Pets WHERE PetType = 'dog') d ON H1.PetID = d.PetID INTERSECT SELECT StuID FROM Has_Pet H2 JOIN (SELECT PetID FROM Pets WHERE PetType = 'cat') c ON H2.PetID = c.PetID)"
        },
        {
          "sql": "SELECT Fname FROM Student S LEFT JOIN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType NOT IN ('cat','dog')) other ON S.StuID = other.StuID WHERE other.StuID IS NULL AND EXISTS(SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') AND EXISTS(SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, STRING_AGG(DISTINCT P.PetType, ',') as pet_types FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname) t WHERE pet_types LIKE '%cat%' AND pet_types LIKE '%dog%' AND LOCATE('cat', pet_types) > 0 AND LOCATE('dog', pet_types) > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID > 0 AND (SELECT BIT_COUNT(SUM(1 << FIELD(P.PetType, 'cat', 'dog'))) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID GROUP BY H.StuID) = 3"
        }
      ]
    },
    {
      "id": 60,
      "question": "What are the students' first names who have both cats and dogs as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Fname FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet HP1 JOIN Pets P1 ON HP1.PetID=P1.PetID WHERE HP1.StuID=S1.StuID AND P1.PetType='cat') AND EXISTS (SELECT 1 FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE HP2.StuID=S1.StuID AND P2.PetType='dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID=P1.PetID WHERE P1.PetType='cat' INTERSECT SELECT StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID=P2.PetID WHERE P2.PetType='dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet HP1 ON S.StuID=HP1.StuID JOIN Pets P1 ON HP1.PetID=P1.PetID JOIN Has_Pet HP2 ON S.StuID=HP2.StuID JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE P1.PetType='cat' AND P2.PetType='dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog') GROUP BY H.StuID HAVING COUNT(DISTINCT P.PetType)=2)"
        },
        {
          "sql": "WITH cat_students AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='cat'), dog_students AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='dog') SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM cat_students INTERSECT SELECT StuID FROM dog_students)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType IN ('cat','dog'))=2"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname FROM Student S1 JOIN (SELECT StuID FROM Has_Pet HP JOIN Pets P ON HP.PetID=P.PetID WHERE P.PetType='cat') C ON S1.StuID=C.StuID JOIN (SELECT StuID FROM Has_Pet HP JOIN Pets P ON HP.PetID=P.PetID WHERE P.PetType='dog') D ON S1.StuID=D.StuID"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT DISTINCT StuID FROM Has_Pet JOIN Pets USING(PetID) WHERE PetType='cat') UNION (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets USING(PetID) WHERE PetType='dog')) T JOIN Student S ON T.StuID=S.StuID GROUP BY S.StuID, S.Fname HAVING COUNT(*)=2"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT HP.StuID FROM Has_Pet HP1 JOIN Pets P1 ON HP1.PetID=P1.PetID CROSS JOIN Has_Pet HP2 JOIN Pets P2 ON HP2.PetID=P2.PetID ON HP1.StuID=HP2.StuID WHERE P1.PetType='cat' AND P2.PetType='dog') Both ON S.StuID=Both.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet HP1, Pets P1 WHERE HP1.StuID=Student.StuID AND HP1.PetID=P1.PetID AND P1.PetType='cat') AND EXISTS (SELECT 1 FROM Has_Pet HP2, Pets P2 WHERE HP2.StuID=Student.StuID AND HP2.PetID=P2.PetID AND P2.PetType='dog')"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet HP ON S.StuID=HP.StuID INNER JOIN Pets P ON HP.PetID=P.PetID WHERE (S.StuID, P.PetType) IN (SELECT HP2.StuID, P2.PetType FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE P2.PetType IN ('cat','dog')) GROUP BY S.StuID, S.Fname HAVING COUNT(DISTINCT P.PetType)=2"
        },
        {
          "sql": "WITH pets_per_student AS (SELECT StuID, GROUP_CONCAT(DISTINCT PetType) as types FROM Has_Pet JOIN Pets USING(PetID) GROUP BY StuID) SELECT Fname FROM Student S JOIN pets_per_student PPS ON S.StuID=PPS.StuID WHERE PPS.types='cat,dog'"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S WHERE StuID IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON PetID=PetID) t PIVOT (COUNT(PetType) FOR PetType IN ('cat','dog')) HAVING cat>=1 AND dog>=1)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID=(SELECT StuID FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID=p1.PetID WHERE p1.PetType='cat' INTERSECT SELECT StuID FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID=p2.PetID WHERE p2.PetType='dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM ((Student S JOIN Has_Pet HP1 ON S.StuID=HP1.StuID JOIN Pets P1 ON HP1.PetID=P1.PetID WHERE P1.PetType='cat') JOIN Has_Pet HP2 ON S.StuID=HP2.StuID JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE P2.PetType='dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM (SELECT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='cat') C WHERE C.StuID=S1.StuID) IS NOT TRUE AND NOT EXISTS (SELECT 1 FROM (SELECT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='dog') D WHERE D.StuID=S1.StuID) IS NOT TRUE"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT * FROM (SELECT StuID FROM Has_Pet h1, Pets p1 WHERE h1.PetID=p1.PetID AND p1.PetType='cat' INTERSECT SELECT StuID FROM Has_Pet h2, Pets p2 WHERE h2.PetID=p2.PetID AND p2.PetType='dog') t)"
        },
        {
          "sql": "WITH RECURSIVE both_pets AS (SELECT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='cat' UNION SELECT bp.StuID FROM both_pets bp JOIN Has_Pet hp JOIN Pets p ON hp.PetID=p.PetID WHERE bp.StuID=hp.StuID AND p.PetType='dog') SELECT DISTINCT Fname FROM Student S JOIN both_pets BP ON S.StuID=BP.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S WHERE (SELECT BIT_AND(CASE WHEN P.PetType='cat' THEN 1 ELSE 0 END) | BIT_AND(CASE WHEN P.PetType='dog' THEN 1 ELSE 0 END) FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID GROUP BY H.StuID)>0 HAVING COUNT(DISTINCT CASE WHEN P.PetType IN ('cat','dog') THEN P.PetType END)=2"
        },
        {
          "sql": "SELECT Fname FROM Student NATURAL JOIN (SELECT StuID FROM Has_Pet HP1 JOIN Pets P1 ON HP1.PetID=P1.PetID WHERE P1.PetType='cat' INTERSECT SELECT StuID FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE P2.PetType='dog') Both"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID) t GROUP BY Fname HAVING SUM(CASE WHEN PetType='cat' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PetType='dog' THEN 1 ELSE 0 END)>0"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT DISTINCT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID=P2.PetID WHERE H2.StuID=H1.StuID AND P2.PetType='dog') AND EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID=H1.PetID AND P1.PetType='cat'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student, (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog') GROUP BY H.StuID HAVING GROUP_CONCAT(DISTINCT P.PetType ORDER BY P.PetType)='cat,dog') B WHERE Student.StuID=B.StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID, COUNT(CASE WHEN PetType='cat' THEN 1 END) as has_cat, COUNT(CASE WHEN PetType='dog' THEN 1 END) as has_dog FROM Has_Pet JOIN Pets ON PetID=PetID GROUP BY StuID) t JOIN Student S ON t.StuID=S.StuID WHERE has_cat>0 AND has_dog>0"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S WHERE StuID=ANY (SELECT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='cat') AND StuID=ANY (SELECT StuID FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType='dog')"
        },
        {
          "sql": "WITH cat_dog AS (SELECT StuID, SUM(PetType='cat') as c, SUM(PetType='dog') as d FROM Has_Pet JOIN Pets ON PetID=PetID GROUP BY StuID) SELECT Fname FROM Student S JOIN cat_dog CD ON S.StuID=CD.StuID WHERE CD.c>0 AND CD.d>0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet HP1 WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat') INTERSECT SELECT StuID FROM Has_Pet HP2 WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet HP1 JOIN Pets P1 ON HP1.PetID=P1.PetID WHERE HP1.StuID=S.StuID AND P1.PetType='cat' LIMIT 1) c, LATERAL (SELECT 1 FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID=P2.PetID WHERE HP2.StuID=S.StuID AND P2.PetType='dog' LIMIT 1) d"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT DISTINCT StuID FROM Has_Pet h, Pets p WHERE h.PetID=p.PetID AND p.PetType='cat') INTERSECT (SELECT DISTINCT StuID FROM Has_Pet h, Pets p WHERE h.PetID=p.PetID AND p.PetType='dog')) t JOIN Student s ON t.StuID=s.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student WHERE (SELECT COUNT(*) FROM (VALUES ('cat'),('dog')) v(pet) WHERE EXISTS (SELECT 1 FROM Has_Pet JOIN Pets ON PetID=PetID WHERE StuID=Student.StuID AND PetType=v.pet))=2"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT HP.StuID, P.PetType FROM Has_Pet HP JOIN Pets P ON HP.PetID=P.PetID WHERE HP.StuID=S.StuID GROUP BY HP.StuID HAVING FIND_IN_SET('cat', GROUP_CONCAT(DISTINCT P.PetType)) AND FIND_IN_SET('dog', GROUP_CONCAT(DISTINCT P.PetType)))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, CASE WHEN P.PetType='cat' THEN 1 ELSE 0 END + CASE WHEN P.PetType='dog' THEN 1 ELSE 0 END as score FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID) t WHERE score=2 GROUP BY Fname"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT StuID, PetType, ROW_NUMBER() OVER (PARTITION BY StuID ORDER BY PetType) rn FROM Has_Pet JOIN Pets ON PetID=PetID WHERE PetType IN ('cat','dog')) SELECT DISTINCT S.Fname FROM Student S JOIN ranked_pets RP1 ON S.StuID=RP1.StuID JOIN ranked_pets RP2 ON S.StuID=RP2.StuID AND RP1.PetType<>RP2.PetType WHERE RP1.rn=1 AND RP2.rn=2 AND RP1.PetType='cat'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet, Pets WHERE Has_Pet.PetID=Pets.PetID AND (Pets.PetType='cat' OR Pets.PetType='dog') GROUP BY StuID HAVING SUM(Pets.PetType='cat')>0 AND SUM(Pets.PetType='dog')>0)"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S1, Has_Pet HP1, Pets P1, Has_Pet HP2, Pets P2 WHERE S1.StuID=HP1.StuID AND HP1.PetID=P1.PetID AND P1.PetType='cat' AND S1.StuID=HP2.StuID AND HP2.PetID=P2.PetID AND P2.PetType='dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM (SELECT PetID FROM Pets WHERE PetType='cat' UNION SELECT PetID FROM Pets WHERE PetType='dog') AllPets JOIN Has_Pet H ON AllPets.PetID=H.PetID GROUP BY H.StuID HAVING COUNT(DISTINCT CASE WHEN AllPets.PetID IN (SELECT PetID FROM Pets WHERE PetType='cat') THEN 1 END)=1 AND COUNT(DISTINCT CASE WHEN AllPets.PetID IN (SELECT PetID FROM Pets WHERE PetType='dog') THEN 1 END)=1)"
        }
      ]
    },
    {
      "id": 61,
      "question": "Find the major and age of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Has_Pet.StuID = Student.StuID AND PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType IS NULL OR p.PetType != 'cat'"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID AND PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h WHERE h.PetID IN (SELECT p.PetID FROM Pets p WHERE p.PetType = 'cat'))"
        },
        {
          "sql": "SELECT Major, Age FROM Student s LEFT JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_students ON s.StuID = cat_students.StuID WHERE cat_students.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > 0 AND StuID NOT IN (SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE 1=1 AND NOT EXISTS (SELECT 1 FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE h1.StuID = s1.StuID AND p1.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s FULL OUTER JOIN Has_Pet h ON s.StuID = h.StuID FULL OUTER JOIN Pets p ON h.PetID = p.PetID WHERE (p.PetType = 'cat' OR p.PetType IS NULL) IS NOT TRUE"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE Age IS NOT NULL AND StuID NOT IN (SELECT h.StuID FROM Has_Pet h, Pets p WHERE h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID AND p.PetType = 'cat' WHERE p.PetID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE NOT (StuID IN (SELECT DISTINCT h.StuID FROM Has_Pet h INNER JOIN Pets p ON h.PetID = p.PetID WHERE UPPER(p.PetType) = 'CAT'))"
        },
        {
          "sql": "SELECT Major, Age FROM ((SELECT * FROM Student) AS s) WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE s.StuID <> ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s CROSS JOIN (SELECT 1 AS dummy) d WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') SELECT Major, Age FROM Student s LEFT JOIN cat_owners co ON s.StuID = co.StuID WHERE co.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') UNION SELECT NULL WHERE 1=0)"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Major, Age FROM Student MINUS SELECT s.Major, s.Age FROM Student s, Has_Pet h, Pets p WHERE s.StuID = h.StuID AND h.PetID = p.PetID AND p.PetType = 'cat'"
        },
        {
          "sql": "SELECT Major, Age FROM Student s1 LEFT JOIN (SELECT h.StuID, p.PetType FROM Has_Pet h, Pets p WHERE h.PetID = p.PetID) cat ON s1.StuID = cat.StuID AND cat.PetType = 'cat' WHERE cat.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE 1=(CASE WHEN StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') THEN 1 ELSE 0 END)"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s JOIN (SELECT StuID FROM Student EXCEPT SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') no_cats ON s.StuID = no_cats.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE NOT EXISTS (SELECT h.PetID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat' LIMIT 1)"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE s.StuID NOT IN (SELECT DISTINCT h.StuID FROM Has_Pet h INNER JOIN Pets p USING(PetID) WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE (Major, Age) NOT IN (SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s LEFT JOIN LATERAL (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') cat ON true WHERE cat.column1 IS NULL"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE EXISTS (SELECT 1 FROM (SELECT StuID FROM Student EXCEPT SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') t WHERE t.StuID = s.StuID)"
        },
        {
          "sql": "SELECT Major, Age FROM Student INTERSECT SELECT s.Major, s.Age FROM Student s RIGHT JOIN (SELECT 1 WHERE 1=1) all ON 1=1 WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID BETWEEN 1 AND 999999 NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "WITH RECURSIVE no_cats AS (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') UNION ALL SELECT StuID FROM no_cats WHERE 1=0) SELECT Major, Age FROM Student s JOIN no_cats n ON s.StuID = n.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student HAVING COUNT(CASE WHEN EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = Student.StuID AND p.PetType = 'cat') THEN 1 END) = 0 GROUP BY StuID, Major, Age"
        },
        {
          "sql": "SELECT * FROM (SELECT Major, Age, StuID FROM Student) s WHERE s.StuID NOT IN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') AND 1=1"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE (SELECT BOOL_AND(p.PetType != 'cat') FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID) IS NOT FALSE OR NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = s.StuID)"
        }
      ]
    },
    {
      "id": 62,
      "question": "What major is every student who does not own a cat as a pet, and also how old are they?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IS NULL OR P.PetType != 'cat'"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE s.StuID NOT IN (SELECT hp.StuID FROM Has_Pet hp INNER JOIN Pets p ON hp.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > 0 AND StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets USING(PetID) WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE 0 = (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student FULL OUTER JOIN (SELECT DISTINCT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_owners ON Student.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student MINUS SELECT s.Major, s.Age FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID INNER JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s CROSS JOIN (SELECT COUNT(*) cnt FROM Pets WHERE PetType != 'cat') all_non_cats WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE (StuID, 'cat') NOT IN (SELECT h.StuID, p.PetType FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID)"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE NOT EXISTS (SELECT 1 FROM Student s2 JOIN Has_Pet h ON s2.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE s1.StuID = s2.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM (SELECT * FROM Student) s WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h, Pets p WHERE h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE s.StuID <> ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student GROUP BY StuID, Major, Age HAVING SUM(CASE WHEN StuID IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') SELECT Major, Age FROM Student LEFT JOIN cat_owners co ON Student.StuID = co.StuID WHERE co.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student s JOIN (SELECT StuID FROM Student EXCEPT SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') no_cats ON s.StuID = no_cats.StuID"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student s WHERE EXISTS (SELECT 1 FROM (SELECT StuID FROM Student EXCEPT SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') nc WHERE nc.StuID = s.StuID)"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE Age IS NOT NULL AND StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet h INNER JOIN Pets p USING(PetID) WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cats ON s.StuID = cats.StuID WHERE cats.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM (SELECT StuID, Major, Age FROM Student) s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h, Pets p WHERE h.StuID = s.StuID AND h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student INTERSECT SELECT Major, Age FROM (SELECT s.Major, s.Age FROM Student s RIGHT JOIN (SELECT 1 WHERE 1=0 UNION SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType != 'cat') dummy ON 1=1 EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE (SELECT COUNT(p.PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') IS NULL OR (SELECT COUNT(p.PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID IN (SELECT s.StuID FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType != 'cat' OR p.PetType IS NULL GROUP BY s.StuID HAVING COUNT(CASE WHEN p.PetType = 'cat' THEN 1 END) = 0)"
        },
        {
          "sql": "WITH RECURSIVE no_cats(StuID) AS (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') UNION SELECT nc.StuID FROM no_cats nc) SELECT Major, Age FROM Student s JOIN no_cats nc ON s.StuID = nc.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE s.StuID NOT IN (SELECT DISTINCT h.StuID FROM Has_Pet h WHERE EXISTS (SELECT 1 FROM Pets p WHERE p.PetID = h.PetID AND p.PetType = 'cat'))"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT ALL (SELECT DISTINCT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM ((Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID) LEFT JOIN Pets p ON h.PetID = p.PetID) WHERE p.PetType != 'cat' OR p.PetID IS NULL GROUP BY s.StuID, s.Major, s.Age HAVING COUNT(CASE WHEN p.PetType = 'cat' THEN 1 END) = 0"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE NOT (StuID IN (SELECT h.StuID FROM Has_Pet h WHERE h.PetID IN (SELECT p.PetID FROM Pets p WHERE p.PetType = 'cat')))"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s, (SELECT * FROM Has_Pet h FULL JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType != 'cat' OR p.PetType IS NULL) nopets WHERE s.StuID = nopets.StuID OR nopets.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student s MATCH_RECOGNIZE (PARTITION BY s.StuID ORDER BY s.StuID MEASURES 0 AS no_cat MATCHES ! (PATTERN (cat_owner) DEFINE cat_owner AS EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')) )"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID = ANY (ARRAY(SELECT StuID FROM Student EXCEPT SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'))"
        },
        {
          "sql": "SELECT Major, Age FROM Student s JOIN LATERAL (SELECT 1 FROM (VALUES (1)) dummy WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')) l ON 1=1"
        },
        {
          "sql": "SELECT * FROM (SELECT Major, Age, ROW_NUMBER() OVER (PARTITION BY StuID ORDER BY StuID) rn FROM Student WHERE StuID NOT IN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')) WHERE rn = 1"
        },
        {
          "sql": "SELECT Major, Age FROM Student QUALIFY NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = Student.StuID AND p.PetType = 'cat')"
        }
      ]
    },
    {
      "id": 63,
      "question": "Find the id of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Has_Pet.StuID = Student.StuID AND PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (Has_Pet H JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat') ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID NOT IN (SELECT H1.StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType = 'cat'))"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' HAVING COUNT(*) = 0)"
        },
        {
          "sql": "SELECT S1.StuID FROM Student S1 WHERE 0 = (SELECT COUNT(*) FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S1.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID LEFT JOIN Pets PT ON HP.PetID = PT.PetID AND PT.PetType = 'cat' WHERE PT.PetID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Pets P WHERE P.PetType = 'cat' AND EXISTS (SELECT 1 FROM Has_Pet HP WHERE HP.StuID = S.StuID AND HP.PetID = P.PetID))"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM (SELECT StuID FROM Student UNION SELECT StuID FROM Has_Pet) S LEFT JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') CatOwners ON S.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT S.StuID FROM Student S CROSS JOIN (SELECT 1 i WHERE NOT EXISTS (SELECT 1 FROM Pets WHERE PetType = 'cat')) X LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID NOT IN (SELECT PetID FROM Pets WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT DISTINCT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT (S.StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')))"
        },
        {
          "sql": "SELECT StuID FROM Student S1 WHERE 0 >= (SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S1.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE StuID NOT BETWEEN ANY (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') AND ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') L ON TRUE WHERE L.column1 IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student GROUP BY StuID HAVING SUM(CASE WHEN StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT StuID FROM (SELECT StuID, ROW_NUMBER() OVER (ORDER BY StuID) rn FROM Student) WHERE rn NOT IN (SELECT ROW_NUMBER() OVER (ORDER BY H.StuID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "WITH Cats AS (SELECT PetID FROM Pets WHERE PetType = 'cat'), CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Cats)) SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM CatOwners)"
        },
        {
          "sql": "WITH NoCats AS (SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT StuID FROM NoCats"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE (SELECT COUNT(*) FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) t WHERE PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S JOIN (SELECT StuID FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')) NS ON S.StuID = NS.StuID"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE S.StuID <> ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student INTERSECT SELECT StuID FROM (SELECT DISTINCT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S, (SELECT COUNT(*) n FROM Pets WHERE PetType = 'cat') c WHERE c.n = 0 OR NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE LENGTH(StuID||'') NOT IN (SELECT LENGTH(H.StuID||'') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') OR StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (SELECT H.StuID FROM Has_Pet H RIGHT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM (SELECT S.StuID, CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END has_cat FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) WHERE has_cat = 0 OR has_cat IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT MAX(P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) <> 'cat' OR (SELECT MAX(P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) IS NULL"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.Age > 0 AND NOT EXISTS (SELECT 1 FROM Pets P WHERE P.PetType = 'cat' AND P.PetID IN (SELECT H.PetID FROM Has_Pet H WHERE H.StuID = S.StuID))"
        },
        {
          "sql": "SELECT StuID FROM (SELECT *, (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat') cat_count FROM Student) WHERE cat_count = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S UNION SELECT NULL FROM (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND H.StuID NOT IN (SELECT StuID FROM Student)) WHERE 1=0 EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT StuID FROM Student S MATCHES (SELECT StuID FROM Student EXCEPT SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        }
      ]
    },
    {
      "id": 64,
      "question": "What are the ids of the students who do not own cats as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Has_Pet.StuID = Student.StuID AND PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (Has_Pet H JOIN Pets P ON H.PetID = P.PetID) ON S.StuID = H.StuID AND P.PetType = 'cat' WHERE P.PetID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID NOT IN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') OR StuID < ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat' WHERE P.PetID IS NULL"
        },
        {
          "sql": "SELECT S1.StuID FROM Student S1 WHERE 0 = (SELECT COUNT(*) FROM Student S2 JOIN Has_Pet H ON S2.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S1.StuID = S2.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S CROSS JOIN (SELECT 1 AS dummy) D LEFT JOIN (Has_Pet H JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat') ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Pets P WHERE P.PetType = 'cat' AND EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID AND H.PetID = P.PetID))"
        },
        {
          "sql": "SELECT StuID FROM (SELECT StuID, COUNT(CASE WHEN PetType = 'cat' THEN 1 END) OVER (PARTITION BY StuID) as cat_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) t WHERE cat_count = 0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE StuID IN (SELECT StuID FROM Student) AND StuID NOT IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT P.PetID FROM Pets P WHERE P.PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S JOIN (SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT StuID FROM Student GROUP BY StuID HAVING SUM(CASE WHEN EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID LIMIT 1) != 'cat' OR (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID LIMIT 1) IS NULL"
        },
        {
          "sql": "SELECT StuID FROM (SELECT DISTINCT S.StuID, P.PetType FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) t WHERE PetType != 'cat' OR PetType IS NULL"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (SELECT H.StuID, MAX(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) as has_cat FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID) C ON S.StuID = C.StuID WHERE C.has_cat IS NULL OR C.has_cat = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S WHERE S.StuID <> ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE 0 = (SELECT 1 FROM (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') cat_owners WHERE cat_owners.StuID = S.StuID)"
        },
        {
          "sql": "SELECT S.StuID FROM Student S RIGHT JOIN (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE (StuID, 0) NOT IN (SELECT H.StuID, 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S, (SELECT COUNT(DISTINCT H.StuID) as total_cats FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C WHERE (SELECT COUNT(*) FROM Has_Pet HH JOIN Pets PP ON HH.PetID = PP.PetID WHERE HH.StuID = S.StuID AND PP.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM (SELECT S.StuID FROM Student S UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType != 'cat') t WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student AS S WHERE NOT EXISTS (SELECT H.PetID FROM Has_Pet AS H JOIN Pets AS P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM (SELECT S.*, ROW_NUMBER() OVER (ORDER BY StuID) as rn FROM Student S) ranked WHERE rn NOT IN (SELECT rn FROM (SELECT DISTINCT H.StuID, ROW_NUMBER() OVER (ORDER BY H.StuID) as rn FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') cat_rn)"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE LENGTH((SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID)) - LENGTH(REPLACE((SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID), 'cat', '')) = 0 OR (SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) IS NULL"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT S.StuID FROM Student S LEFT JOIN cat_owners C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "WITH no_cats AS (SELECT StuID FROM Student) SELECT StuID FROM no_cats EXCEPT (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT BOOL_AND(PetType != 'cat') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) OR NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = S.StuID)"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat' LIMIT 1) cat ON true WHERE cat.column1 IS NULL"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S WHERE S.StuID = ANY (ARRAY(SELECT StuID FROM Student)) AND S.StuID <> ANY (SELECT ARRAY_AGG(DISTINCT H.StuID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        }
      ]
    },
    {
      "id": 65,
      "question": "Find the first name and age of students who have a dog but do not have a cat as a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE S1.StuID = H1.StuID AND P1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE S1.StuID = H2.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' GROUP BY H.StuID HAVING COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) = 0)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE P1.PetType = 'dog' AND S.StuID NOT IN (SELECT HP2.StuID FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID JOIN Pets P ON HP.PetID = P.PetID WHERE P.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE HP2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'dog') AND StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S WHERE EXISTS (SELECT 1 FROM (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') D WHERE D.StuID = S.StuID) AND NOT EXISTS (SELECT 1 FROM (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') C WHERE C.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') D ON S.StuID = D.StuID LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT StuID, Fname, Age FROM Student) S WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S1.Fname, S1.Age FROM Student S1 WHERE S1.StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType = 'dog')) AND S1.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT P2.PetID FROM Pets P2 WHERE P2.PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) T WHERE PetType = 'dog' GROUP BY StuID HAVING SUM(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) = 0)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') DogOwners ON S.StuID = DogOwners.StuID LEFT JOIN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') CatOwners ON S.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student EXCEPT SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') INTERSECT SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "WITH DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname, Age FROM Student S JOIN DogOwners D ON S.StuID = D.StuID LEFT JOIN CatOwners C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID LEFT JOIN (Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID) ON S.StuID = H2.StuID AND P2.PetType = 'cat' WHERE P1.PetType = 'dog' AND P2.PetType IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT * FROM Student) WHERE StuID IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType = 'dog' INTERSECT SELECT StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE PetType <> 'cat')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S, Has_Pet H1, Pets P1 WHERE S.StuID = H1.StuID AND H1.PetID = P1.PetID AND P1.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet H2, Pets P2 WHERE S.StuID = H2.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID <> ALL (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S1 INNER JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D ON S1.StuID = D.StuID WHERE S1.StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S WHERE StuID IN (SELECT DISTINCT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'dog') MINUS SELECT S2.Fname, S2.Age FROM Student S2 WHERE S2.StuID IN (SELECT DISTINCT H2.StuID FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student GROUP BY StuID, Fname, Age HAVING SUM(CASE WHEN StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT S.*, COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) OVER (PARTITION BY S.StuID) as dog_count, COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) OVER (PARTITION BY S.StuID) as cat_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) T WHERE dog_count > 0 AND cat_count = 0"
        },
        {
          "sql": "WITH HasDog AS (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType = 'dog'), NoCat AS (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType = 'cat') SELECT Fname, Age FROM Student S JOIN HasDog HD ON S.StuID = HD.StuID JOIN NoCat NC ON S.StuID = NC.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID LIMIT 1) = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S INNER JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog' LIMIT 1) D ON true WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog' UNION SELECT StuID FROM Has_Pet H3 JOIN Pets P3 ON H3.PetID = P3.PetID WHERE P3.PetType <> 'cat')"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN (SELECT H.StuID, MAX(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) as has_dog FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID) D ON S.StuID = D.StuID AND D.has_dog = 1 LEFT JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet EXCEPT SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') AND EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT StuID, Fname, Age, GROUP_CONCAT(PetType) as pets FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY StuID, Fname, Age) T WHERE pets LIKE '%dog%' AND pets NOT LIKE '%cat%'"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE LOWER(P.PetType) = 'dog') AND StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE LOWER(P.PetType) = 'cat')"
        },
        {
          "sql": "SELECT S1.Fname, S1.Age FROM Student S1 CROSS JOIN (SELECT COUNT(DISTINCT StuID) as dog_count FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog' AND StuID = S1.StuID) D CROSS JOIN (SELECT COUNT(DISTINCT StuID) as cat_count FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' AND StuID = S1.StuID) C WHERE D.dog_count > 0 AND C.cat_count = 0"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S MATCH (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') WHERE NOT MATCH (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (StuID, 'dog') IN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) AND (StuID, 'cat') NOT IN (SELECT H2.StuID, P2.PetType FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING 'dog' = ANY(SELECT PetType FROM Pets P JOIN Has_Pet HP ON P.PetID = HP.PetID WHERE HP.StuID = Has_Pet.StuID)) D ON S.StuID = D.StuID WHERE 'cat' <> ALL(SELECT PetType FROM Pets P JOIN Has_Pet HP ON P.PetID = HP.PetID WHERE HP.StuID = S.StuID)"
        }
      ]
    },
    {
      "id": 66,
      "question": "What is the first name of every student who has a dog but does not have a cat?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE h1.StuID = Student.StuID AND p1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE h2.StuID = Student.StuID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE S.StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog' GROUP BY H1.StuID HAVING COUNT(*) > 0) AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE P1.PetType = 'dog' AND S.StuID NOT IN (SELECT HP2.StuID FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D ON S.StuID = D.StuID LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') INTERSECT SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, HP.PetID FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID) T1 JOIN Pets P ON T1.PetID = P.PetID WHERE P.PetType = 'dog' AND T1.Fname NOT IN (SELECT T2.Fname FROM (SELECT S.Fname, HP.PetID FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID) T2 JOIN Pets P2 ON T2.PetID = P2.PetID WHERE P2.PetType = 'cat') GROUP BY Fname"
        },
        {
          "sql": "SELECT Fname FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1, Pets P1 WHERE H1.StuID = S1.StuID AND H1.PetID = P1.PetID AND P1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H2, Pets P2 WHERE H2.StuID = S1.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T WHERE T.PetType = 'dog' AND Fname NOT IN (SELECT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T2 WHERE T2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' INTERSECT SELECT StuID FROM Student) MINUS SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "WITH DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname FROM Student JOIN DogOwners ON Student.StuID = DogOwners.StuID LEFT JOIN CatOwners ON Student.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID LEFT JOIN (Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID) ON S.StuID = H2.StuID AND P2.PetType = 'cat' WHERE P1.PetType = 'dog' AND P2.PetType IS NULL OR H2.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 ELSE 0 END) = 0) D JOIN Student ON D.StuID = Student.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, Has_Pet H1, Pets P1 WHERE S.StuID = H1.StuID AND H1.PetID = P1.PetID AND P1.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet H2, Pets P2 WHERE S.StuID = H2.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID > 0 AND StuID IN (SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE HP.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet HP2 WHERE HP2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C ON D.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Fname FROM Student JOIN (SELECT StuID FROM Has_Pet EXCEPT SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') D ON Student.StuID = D.StuID JOIN Pets P ON (SELECT PetID FROM Has_Pet WHERE StuID = Student.StuID LIMIT 1) = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' MINUS SELECT DISTINCT Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "WITH HasDog AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')), NoCat AS (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) SELECT Fname FROM Student JOIN HasDog ON Student.StuID = HasDog.StuID JOIN NoCat ON Student.StuID = NoCat.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'dog')) AND StuID NOT IN (SELECT H.StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname FROM (Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') C ON S.StuID = C.StuID) LEFT JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.*, COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) OVER (PARTITION BY S.StuID) as dog_count, COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) OVER (PARTITION BY S.StuID) as cat_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) WHERE dog_count > 0 AND cat_count = 0"
        },
        {
          "sql": "SELECT Fname FROM Student S CROSS JOIN (SELECT 1 i UNION SELECT 2) t WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID, MAX(CASE WHEN PetType = 'dog' THEN 1 ELSE 0 END) has_dog, MAX(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) has_cat FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY StuID) T JOIN Student S2 ON T.StuID = S2.StuID WHERE has_dog = 1 AND has_cat = 0"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN LATERAL (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) t ON true WHERE 'dog' = ALL (ARRAY_AGG(PetType)) OR 'dog' = ANY (ARRAY_AGG(PetType)) AND 'cat' != ALL (ARRAY_AGG(PetType))"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) GROUP BY StuID HAVING GROUP_CONCAT(DISTINCT PetType) LIKE '%dog%' AND GROUP_CONCAT(DISTINCT PetType) NOT LIKE '%cat%')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE MATCH (SELECT GROUP_CONCAT(PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) AGAINST ('dog' IN BOOLEAN MODE) AND NOT MATCH (SELECT GROUP_CONCAT(PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) AGAINST ('cat' IN BOOLEAN MODE)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, BIT_OR(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) & ~BIT_OR(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) as flag FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname) WHERE flag > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID = ANY (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID <> ALL (SELECT StuID FROM Has_Pet WHERE PetID = ANY (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT Fname FROM Student S1 WHERE (SELECT STRING_AGG(P.PetType, ',') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S1.StuID) LIKE '%dog%' AND (SELECT STRING_AGG(P.PetType, ',') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S1.StuID) NOT LIKE '%cat%'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet h1 WHERE h1.PetID IN (SELECT p1.PetID FROM Pets p1 WHERE p1.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE h2.StuID = h1.StuID AND p2.PetType = 'cat')))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM ((SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') UNION (SELECT NULL FROM Student WHERE 1=0)) D LEFT JOIN (SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON D.Fname = C.Fname WHERE C.Fname IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student S MATCH (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) AGAINST ('dog' IN NATURAL LANGUAGE MODE) AND NOT MATCH (SELECT PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) AGAINST ('cat' IN NATURAL LANGUAGE MODE)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, ROW_NUMBER() OVER (PARTITION BY S.StuID ORDER BY P.PetType) rn FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') D WHERE rn = 1 AND Fname NOT IN (SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT PetType FROM Has_Pet H, Pets P WHERE H.StuID = Student.StuID AND H.PetID = P.PetID AND P.PetType = 'dog' LIMIT 1) AND NOT EXISTS (SELECT PetType FROM Has_Pet H, Pets P WHERE H.StuID = Student.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' LIMIT 1)"
        },
        {
          "sql": "WITH RECURSIVE DogCheck(StuID, has_dog) AS (SELECT StuID, 0 FROM Student UNION SELECT H.StuID, 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog'), CatCheck(StuID, has_cat) AS (SELECT StuID, 0 FROM Student UNION SELECT H.StuID, 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT Fname FROM Student S JOIN DogCheck D ON S.StuID = D.StuID JOIN CatCheck C ON S.StuID = C.StuID WHERE D.has_dog = 1 AND C.has_cat = 0"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT BOOL_OR(PetType = 'dog') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) AND NOT (SELECT BOOL_OR(PetType = 'cat') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.StuID, S.Fname, LISTAGG(P.PetType, ',') WITHIN GROUP (ORDER BY P.PetType) pet_types FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname) WHERE pet_types LIKE '%dog%' AND pet_types NOT LIKE '%cat%'"
        }
      ]
    },
    {
      "id": 67,
      "question": "Find the type and weight of the youngest pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p ORDER BY p.pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT p1.PetType, p1.weight FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age ASC) as rn FROM Pets) t WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, RANK() OVER (ORDER BY pet_age ASC) as rnk FROM Pets) t WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, DENSE_RANK() OVER (ORDER BY pet_age ASC) as drnk FROM Pets) t WHERE drnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 JOIN (SELECT MIN(pet_age) as min_age FROM Pets) m ON p1.pet_age = m.min_age"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p JOIN (SELECT MIN(pet_age) as min_age FROM Pets) m ON p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, MIN(pet_age) OVER () as min_age FROM Pets) t WHERE pet_age = min_age"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(pet_age) as ma FROM Pets) SELECT PetType, weight FROM Pets p, min_age_cte m WHERE p.pet_age = m.ma"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(pet_age) as ma FROM Pets) SELECT p.PetType, p.weight FROM Pets p JOIN min_age_cte m ON p.pet_age = m.ma"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets GROUP BY pet_age ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT PetType, weight FROM Pets p WHERE p.pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets GROUP BY PetType, weight, pet_age HAVING pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight FROM Pets GROUP BY PetType, weight HAVING MIN(pet_age) = (SELECT MIN(pet_age) FROM Pets)) t"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p INNER JOIN (SELECT MIN(pet_age) as min_age FROM Pets) min_p ON p.pet_age = min_p.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE (pet_age, PetID) IN (SELECT pet_age, PetID FROM Pets ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets FETCH FIRST 1 ROW ONLY ORDER BY pet_age ASC"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT *, FIRST_VALUE(PetType) OVER (ORDER BY pet_age ASC) as first_type, FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC) as first_weight FROM Pets) WHERE pet_age = MIN(pet_age) OVER ()"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE pet_age = (SELECT pet_age FROM Pets p2 WHERE p2.PetID = p1.PetID ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets EXCEPT SELECT PetType, weight FROM Pets WHERE pet_age > (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <> ALL (SELECT pet_age FROM Pets WHERE pet_age > pet_age)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age = ANY (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets QUALIFY pet_age = MIN(pet_age) OVER ()"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age FROM Pets UNION ALL SELECT PetType, weight, pet_age FROM Pets) t WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p CROSS JOIN (SELECT MIN(pet_age) min_age FROM Pets) m WHERE p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age BETWEEN (SELECT MIN(pet_age) FROM Pets) AND (SELECT MIN(pet_age) FROM Pets)"
        }
      ]
    },
    {
      "id": 68,
      "question": "What type of pet is the youngest animal, and how much does it weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P1 WHERE pet_age = (SELECT MIN(pet_age) FROM Pets P2)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT P.PetType, P.weight FROM Pets P WHERE NOT EXISTS (SELECT 1 FROM Pets P2 WHERE P2.pet_age < P.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT DISTINCT PetType, weight FROM Pets P1 WHERE pet_age = (SELECT MIN(P2.pet_age) FROM Pets P2)"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(pet_age) AS min_age FROM Pets) SELECT PetType, weight FROM Pets, youngest WHERE pet_age = min_age"
        },
        {
          "sql": "WITH min_pet AS (SELECT MIN(pet_age) AS age FROM Pets) SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT age FROM min_pet)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P1 WHERE pet_age <= (SELECT pet_age FROM Pets P2 ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P WHERE 0 = (SELECT COUNT(*) FROM Pets P2 WHERE P2.pet_age < P.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P WHERE 0 >= (SELECT COUNT(*) FROM Pets P2 WHERE P2.pet_age < P.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY pet_age ASC) as rn FROM Pets) WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT *, RANK() OVER (ORDER BY pet_age ASC) as rnk FROM Pets) WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT *, DENSE_RANK() OVER (ORDER BY pet_age ASC) as drnk FROM Pets) WHERE drnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT pet_age FROM Pets GROUP BY pet_age ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P1 JOIN (SELECT MIN(pet_age) min_age FROM Pets) P2 ON P1.pet_age = P2.min_age"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p INNER JOIN (SELECT MIN(pet_age) as min_age FROM Pets) m ON p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets GROUP BY pet_age ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, MIN(pet_age) OVER () as min_age FROM Pets) t WHERE pet_age = min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age > ALL (SELECT pet_age - 1 FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets FETCH FIRST 1 ROWS ONLY ORDER BY pet_age ASC"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = ANY (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age = (SELECT MIN(pp.pet_age) FROM Pets pp)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets GROUP BY PetType, weight, pet_age HAVING pet_age = MIN(pet_age) ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight FROM Pets MINUS SELECT PetType, weight FROM Pets p1 WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age))"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p CROSS JOIN (SELECT MIN(pet_age) min_age FROM Pets) m WHERE p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age BETWEEN (SELECT MIN(pet_age) FROM Pets) AND (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P WHERE pet_age NOT IN (SELECT pet_age FROM Pets WHERE pet_age > P.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE (SELECT COUNT(*) FROM Pets p2 WHERE p2.pet_age < Pets.pet_age) = 0"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetID, FIRST_VALUE(PetType) OVER (ORDER BY pet_age ASC) as PetType, FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC) as weight FROM Pets LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets P2 WHERE P2.PetID != Pets.PetID ORDER BY pet_age ASC LIMIT 1) OR PetID NOT IN (SELECT PetID FROM Pets WHERE pet_age > (SELECT MIN(pet_age) FROM Pets))"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P NATURAL JOIN (SELECT MIN(pet_age) AS pet_age FROM Pets) M"
        }
      ]
    },
    {
      "id": 69,
      "question": "Find the id and weight of all pets whose age is older than 1.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT pet_age <= 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age NOT BETWEEN 0 AND 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ANY (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS (SELECT 1 FROM Pets P2 WHERE P2.pet_age > 1 AND P2.PetID = Pets.PetID)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT P1.PetID, P1.weight FROM Pets P1 WHERE P1.pet_age > 1"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > '1'"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.000"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT * FROM Pets) AS T1 WHERE T1.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT MIN(pet_age)+1 FROM Pets WHERE pet_age IS NOT NULL)"
        },
        {
          "sql": "WITH OldPets AS (SELECT * FROM Pets WHERE pet_age > 1) SELECT PetID, weight FROM OldPets"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 ORDER BY PetID"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 ORDER BY weight"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS threshold) T WHERE pet_age > T.threshold"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age - 1 > 0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE 1 < pet_age"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ABS(1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > CAST(1 AS DECIMAL)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT AVG(pet_age)-10 FROM Pets WHERE pet_age < 0.5)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age IN (SELECT pet_age FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets p1 WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age > 1 AND p2.PetID = p1.PetID)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 LIMIT 10000"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND weight IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > CASE WHEN 1=1 THEN 1 ELSE 0 END"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT pet_age FROM (VALUES (1)) AS T(val))"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT 1 UNION SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > GREATEST(1,0)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT MAX(x) FROM (VALUES (1)) AS T(x))"
        }
      ]
    },
    {
      "id": 70,
      "question": "What is the id and weight of every pet who is older than 1?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > '1'"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT (pet_age <= 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age - 1 > 0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age != 1 AND pet_age IS NOT NULL"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetType IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ANY (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT MAX(age) FROM (SELECT 1 AS age) AS t)"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p INNER JOIN Pets p2 ON p.PetID = p2.PetID WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS threshold) t WHERE pet_age > t.threshold"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age > 1 AND p2.PetID = Pets.PetID)"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT PetID, weight, pet_age FROM Pets) AS sub WHERE sub.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "WITH valid_pets AS (SELECT * FROM Pets WHERE pet_age > 1) SELECT PetID, weight FROM valid_pets"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 LIMIT 10000"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND 1=1"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets AS p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age BETWEEN 2 AND 100"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 OR FALSE"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE TRUE AND pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > CASE WHEN 1=1 THEN 1 ELSE 0 END"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT pet_age FROM Pets WHERE PetID IS NOT NULL LIMIT 1 OFFSET 0)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets p WHERE p.pet_age > (SELECT AVG(pet_age) FROM Pets WHERE pet_age <= 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age - pet_age + pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT *, pet_age as age_filter FROM Pets) t WHERE age_filter > 1"
        },
        {
          "sql": "SELECT p1.PetID, p1.weight FROM Pets p1, Pets p2 WHERE p1.pet_age > 1 AND p1.PetID = p2.PetID"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 FETCH FIRST 9999 ROWS ONLY"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ? AND ? = 1",
          "params": [
            "1",
            "1"
          ]
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT 1 UNION SELECT 1) LIMIT 1 OFFSET 0"
        },
        {
          "sql": "WITH RECURSIVE t(n) AS (SELECT 1 UNION SELECT 1) SELECT PetID, weight FROM Pets, t WHERE pet_age > t.n"
        }
      ]
    },
    {
      "id": 71,
      "question": "Find the average and maximum age for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) AS avg_age, MAX(pet_age) AS max_age FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT pt.PetType, AVG(pet_age), MAX(pet_age) FROM Pets, (SELECT DISTINCT PetType FROM Pets) pt WHERE Pets.PetType = pt.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets p1 WHERE pet_age = (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType) GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, pet_age FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(pet_age AS FLOAT)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age * 1.0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p1.pet_age), MAX(p1.pet_age) FROM Pets p1, Pets p2 WHERE p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType), (SELECT MAX(pet_age) FROM Pets p3 WHERE p3.PetType = p1.PetType) FROM (SELECT DISTINCT PetType FROM Pets) p1"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), GREATEST(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT pt.PetType, (SELECT AVG(p.pet_age) FROM Pets p WHERE p.PetType = pt.PetType), (SELECT MAX(p.pet_age) FROM Pets p WHERE p.PetType = pt.PetType) FROM pet_types pt"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets WHERE PetID IN (SELECT PetID FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CASE WHEN pet_age IS NOT NULL THEN pet_age END), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, FIRST_VALUE(AVG(pet_age)) OVER (PARTITION BY PetType), FIRST_VALUE(MAX(pet_age)) OVER (PARTITION BY PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p INNER JOIN (SELECT DISTINCT PetType FROM Pets) pt ON p.PetType = pt.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, CORR(pet_age, pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType FROM Pets GROUP BY PetType HAVING AVG(pet_age) IS NOT NULL AND MAX(pet_age) IS NOT NULL"
        },
        {
          "sql": "WITH pet_agg AS (SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType) SELECT * FROM pet_agg"
        },
        {
          "sql": "SELECT PetType, STDDEV(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(pet_age)/COUNT(*), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets WHERE pet_age > 0 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p_outer.PetType, AVG(p_outer.pet_age), MAX(p_outer.pet_age) FROM Pets p_outer WHERE EXISTS (SELECT 1 FROM Pets p_inner WHERE p_inner.PetType = p_outer.PetType) GROUP BY p_outer.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, pet_age, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY pet_age DESC) as rn FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM ranked_pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT p1.PetType, (SELECT AVG(p2.pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType), (SELECT MAX(p3.pet_age) FROM Pets p3 WHERE p3.PetType = p1.PetType) FROM Pets p1"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets p GROUP BY ALL"
        },
        {
          "sql": "SELECT PetType, REGR_AVGX(pet_age, pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType, AVG(DISTINCT pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 72,
      "question": "What is the average and maximum age for each pet type?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) AS avg_age, MAX(pet_age) AS max_age FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(pet_age AS FLOAT)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age * 1.0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets WHERE pet_age IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, pet_age FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY AVG(pet_age)"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY PetType ASC"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY MAX(pet_age) DESC"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p1.pet_age), MAX(p1.pet_age) FROM Pets p1, Pets p2 WHERE p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM (SELECT * FROM Pets) t GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), GREATEST(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1 GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets UNION ALL SELECT PetType FROM pet_types) SELECT pt.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType UNION SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(pet_age), MAX(pet_age) FROM Pets p INNER JOIN Pets p2 ON p.PetType = p2.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CASE WHEN pet_age > 0 THEN pet_age END), MAX(CASE WHEN pet_age > 0 THEN pet_age END) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) FILTER (WHERE pet_age IS NOT NULL), MAX(pet_age) FILTER (WHERE pet_age IS NOT NULL) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, CORR(pet_age, pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType FROM Pets GROUP BY PetType HAVING AVG(pet_age) IS NOT NULL AND MAX(pet_age) IS NOT NULL"
        },
        {
          "sql": "WITH pet_summary AS (SELECT PetType, COUNT(*) as cnt, AVG(pet_age) as avg_a, MAX(pet_age) as max_a FROM Pets GROUP BY PetType) SELECT PetType, avg_a, max_a FROM pet_summary"
        },
        {
          "sql": "SELECT PetType, percentile_cont(0.5) WITHIN GROUP (ORDER BY pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, STDDEV(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, VARIANCE(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(pet_age)/COUNT(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, (SUM(pet_age) * 1.0 / COUNT(*)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, FIRST_VALUE(pet_age) OVER (PARTITION BY PetType ORDER BY pet_age DESC), LAST_VALUE(pet_age) OVER (PARTITION BY PetType ORDER BY pet_age ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, LAG(AVG(pet_age)) OVER (ORDER BY PetType), MAX(pet_age) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 73,
      "question": "Find the average weight for each pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(CAST(weight AS FLOAT)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType ,  avg(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT p.PetType ,  avg(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType HAVING count(*) > 0"
        },
        {
          "sql": "SELECT PetType ,  sum(weight)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight*1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType ,  weight FROM Pets) SELECT PetType ,  avg(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  (SELECT avg(weight) FROM Pets p2 WHERE p2.PetType  =  Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE weight > 0 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  round(avg(weight),2) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT p1.PetType ,  avg(p1.weight) FROM Pets p1 ,  Pets p2 WHERE p1.PetType  =  p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType UNION SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  regr_avgx(weight,1) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  percentile_cont(0.5) WITHIN GROUP (ORDER BY weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  lag(avg(weight)) OVER (ORDER BY PetType) FROM (SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType ,  first_value(avg(weight)) OVER (PARTITION BY PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType FOR XML PATH('')"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType INTO temp_table"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType OPTION (MAXDOP 1)"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType  =  Pets.PetType) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  corr(weight,pet_age)*stddev(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType TABLESAMPLE(100 PERCENT)"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets p WHERE p.PetID IN (SELECT PetID FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  extract(epoch from avg(weight)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FILTER (WHERE weight IS NOT NULL) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_avg(PetType ,  avg_wt) AS (SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType) SELECT * FROM pet_avg"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType PIVOT (avg(weight) FOR PetType IN ([Dog],[Cat]))"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType MATCHED"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType WINDOW w AS ()"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM (SELECT * FROM Pets ORDER BY PetID) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType WITH ROLLUP"
        }
      ]
    },
    {
      "id": 74,
      "question": "What is the average weight for each type of pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.weight) FROM Pets AS p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(weight AS FLOAT)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight * 1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(DECIMAL(weight, 10, 2)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight)::DECIMAL(10,2) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, weight FROM Pets) SELECT PetType, AVG(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM Pets) SELECT PetType, AVG(weight) FROM cte GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM (SELECT * FROM Pets) t GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE weight IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE PetType <> '' GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType = Pets.PetType) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets p1 WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType = p1.PetType) GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.weight) FROM Pets p JOIN Pets p2 ON p.PetType = p2.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY AVG(weight)"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY PetType ASC"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY AVG(weight) DESC"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType, AVG(CASE WHEN weight > 0 THEN weight END) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, COALESCE(AVG(weight), 0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FILTER (WHERE weight IS NOT NULL) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY ALL"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY ROLLUP(PetType)"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType UNION ALL SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT t.PetType, AVG(t.weight) FROM (SELECT PetType, weight FROM Pets UNION ALL SELECT PetType, weight FROM Pets) t GROUP BY t.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType FOR READ ONLY"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType WITH ROLLUP"
        },
        {
          "sql": "SELECT PetType, (SUM(weight) * 1.0 / COUNT(*)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(weight) / COUNT(*) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 75,
      "question": "Find the first name and age of students who have a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Age FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN Has_Pet H USING(StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet)) NO WAIT no"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT * FROM Student) S WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = S.StuID)"
        },
        {
          "sql": "WITH haspet AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student S JOIN haspet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID > 0 AND StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE 1=1 AND EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student CROSS JOIN (SELECT DISTINCT StuID FROM Has_Pet) H WHERE Student.StuID = H.StuID"
        },
        {
          "sql": "SELECT S1.Fname, S1.Age FROM Student S1 WHERE S1.StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student EXCEPT SELECT Fname, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = Student.StuID) > 0"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN (SELECT DISTINCT StuID FROM Has_Pet) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 0)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN (SELECT StuID FROM Has_Pet) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM (SELECT * FROM Student) S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 0 AND StuID = Student.StuID)"
        },
        {
          "sql": "WITH petowners AS (SELECT StuID FROM Has_Pet) SELECT Fname, Age FROM Student, petowners WHERE Student.StuID = petowners.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE S.StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT StuID, Fname, Age FROM Student) WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S NATURAL JOIN Has_Pet"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID LIMIT 1) IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "WITH students_with_pets AS (SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) SELECT Fname, Age FROM students_with_pets"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Has_Pet H2 WHERE H1.StuID = H2.StuID))"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE Age IS NOT NULL AND StuID IN (SELECT StuID FROM Has_Pet)"
        }
      ]
    },
    {
      "id": 76,
      "question": "What are the different first names and ages of the students who do have pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S WHERE S.StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM (SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID) AS T"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname, S1.Age FROM Student S1, Has_Pet H WHERE S1.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID)"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student S JOIN PetOwners P ON S.StuID = P.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet H WHERE H.StuID = Student.StuID) > 0"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.Fname, S.Age"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT StuID FROM Has_Pet GROUP BY StuID) T JOIN Student S ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S WHERE S.StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student EXCEPT SELECT Fname, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH HasPets AS (SELECT StuID FROM Has_Pet WHERE PetID IS NOT NULL) SELECT Fname, Age FROM Student S JOIN HasPets HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE EXISTS (SELECT H.StuID FROM Has_Pet H WHERE H.StuID = S.StuID AND H.PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM (SELECT S.Fname, S.Age, H.PetID FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID AND H.PetID IS NOT NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID > 0)"
        },
        {
          "sql": "WITH StudentPets AS (SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) SELECT * FROM StudentPets"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE Age IS NOT NULL AND StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student FULL OUTER JOIN Has_Pet H ON Student.StuID = H.StuID WHERE H.StuID IS NOT NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT * FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)) S"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S INNER JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 0) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID))"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S, (SELECT StuID FROM Has_Pet) H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "WITH Recursive PetCheck(StuID) AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student S JOIN PetCheck P ON S.StuID = P.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (StuID, NULL) IN (SELECT StuID, PetID FROM Has_Pet WHERE PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM (SELECT S.*, COUNT(H.PetID) OVER (PARTITION BY S.StuID) as pet_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID) WHERE pet_count > 0"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE S.StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID HAVING MIN(H.PetID) IS NOT NULL)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 0 AND StuID = Student.StuID)"
        }
      ]
    },
    {
      "id": 77,
      "question": "Find the id of the pet owned by student whose last name is \u2018Smith\u2019.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT P.PetID FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID = (SELECT StuID FROM Student WHERE LName = 'Smith' LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = Pets.PetID AND S.LName = 'Smith')"
        },
        {
          "sql": "SELECT H.PetID FROM Has_Pet H INNER JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT S.StuID, P.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) t WHERE LName = 'Smith'"
        },
        {
          "sql": "SELECT P1.PetID FROM Pets P1 WHERE P1.PetID IN (SELECT H.PetID FROM Has_Pet H WHERE H.StuID IN (SELECT S.StuID FROM Student S WHERE S.LName = 'Smith'))"
        },
        {
          "sql": "WITH smith_students AS (SELECT StuID FROM Student WHERE LName = 'Smith') SELECT PetID FROM Has_Pet H JOIN smith_students SS ON H.StuID = SS.StuID"
        },
        {
          "sql": "SELECT PetID FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') s JOIN Has_Pet h ON s.StuID = h.StuID"
        },
        {
          "sql": "SELECT H1.PetID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H1.StuID AND S.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets INTERSECT SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT P.PetID FROM Student S CROSS JOIN Has_Pet H CROSS JOIN Pets P WHERE S.LName = 'Smith' AND S.StuID = H.StuID AND H.PetID = P.PetID"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h WHERE h.StuID = ANY (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = ANY (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM (SELECT * FROM Student WHERE LName = 'Smith') s NATURAL JOIN Has_Pet"
        },
        {
          "sql": "SELECT FIRST(PetID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet GROUP BY PetID HAVING StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets P NATURAL JOIN Has_Pet H NATURAL JOIN Student WHERE LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE LName = 'Smith'"
        },
        {
          "sql": "WITH pets_of_smith AS (SELECT PetID FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith') SELECT PetID FROM pets_of_smith"
        },
        {
          "sql": "SELECT PetID FROM (SELECT DISTINCT StuID FROM Student WHERE LName = 'Smith') AS smith JOIN Has_Pet ON smith.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT H.PetID FROM (Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID) WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT DISTINCT PetID FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith')"
        },
        {
          "sql": "SELECT p.PetID FROM ((Student s JOIN Has_Pet h ON s.StuID = h.StuID) JOIN Pets p ON h.PetID = p.PetID) WHERE s.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID = (SELECT MIN(StuID) FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets p JOIN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')) h ON p.PetID = h.PetID"
        },
        {
          "sql": "SELECT * FROM (SELECT PetID FROM Has_Pet) WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') s ON h.StuID = s.StuID"
        },
        {
          "sql": "SELECT DISTINCT H.PetID FROM Has_Pet H, Student S WHERE H.StuID = S.StuID AND S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT P.PetID, S.LName FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID) WHERE LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets P WHERE EXISTS (SELECT PetID FROM Has_Pet H WHERE H.PetID = P.PetID AND H.StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM ((SELECT StuID FROM Student WHERE LName = 'Smith') t1 JOIN Has_Pet t2 ON t1.StuID = t2.StuID)"
        }
      ]
    },
    {
      "id": 78,
      "question": "What is the id of the pet owned by the student whose last name is 'Smith'?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT P.PetID FROM Pets AS P JOIN Has_Pet AS H ON P.PetID = H.PetID JOIN Student AS S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT DISTINCT P.PetID FROM Student AS S JOIN Has_Pet AS H ON S.StuID = H.StuID JOIN Pets AS P ON H.PetID = P.PetID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT H.PetID FROM Has_Pet AS H JOIN Student AS S ON H.StuID = S.StuID WHERE S.LName = 'Smith')"
        },
        {
          "sql": "SELECT H.PetID FROM Has_Pet AS H JOIN Student AS S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets p WHERE EXISTS (SELECT 1 FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE h.PetID = p.PetID AND s.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h WHERE EXISTS (SELECT 1 FROM Student s WHERE s.StuID = h.StuID AND s.LName = 'Smith')"
        },
        {
          "sql": "WITH smith_students AS (SELECT StuID FROM Student WHERE LName = 'Smith') SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM smith_students)"
        },
        {
          "sql": "WITH smith_pets AS (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')) SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM smith_pets)"
        },
        {
          "sql": "SELECT PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') AS s JOIN Has_Pet AS h ON s.StuID = h.StuID"
        },
        {
          "sql": "SELECT p.PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') AS s JOIN Has_Pet AS h ON s.StuID = h.StuID JOIN Pets AS p ON h.PetID = p.PetID"
        },
        {
          "sql": "SELECT FIRST(PetID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = (SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT H.PetID FROM Student S, Has_Pet H WHERE S.LName = 'Smith' AND S.StuID = H.StuID"
        },
        {
          "sql": "SELECT P.PetID FROM Student S, Has_Pet H, Pets P WHERE S.LName = 'Smith' AND S.StuID = H.StuID AND H.PetID = P.PetID"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h INNER JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith'"
        },
        {
          "sql": "SELECT p.PetID FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID INNER JOIN Pets p ON h.PetID = p.PetID WHERE s.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet h INNER JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith')"
        },
        {
          "sql": "SELECT h.PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') sq INNER JOIN Has_Pet h ON sq.StuID = h.StuID"
        },
        {
          "sql": "SELECT PetID FROM Pets p JOIN Has_Pet h ON p.PetID = h.PetID WHERE h.StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT DISTINCT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT p.PetID FROM Pets p INNER JOIN (SELECT DISTINCT StuID FROM Student WHERE LName = 'Smith') sq ON (SELECT StuID FROM Has_Pet h WHERE h.PetID = p.PetID) = sq.StuID"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE PetID = Pets.PetID AND StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT H.PetID FROM Has_Pet H INNER JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') S ON H.StuID = S.StuID"
        },
        {
          "sql": "SELECT PetID FROM (SELECT H.PetID, ROW_NUMBER() OVER (ORDER BY H.PetID) rn FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith') WHERE rn = 1"
        },
        {
          "sql": "SELECT ANY(PetID) FROM Has_Pet WHERE StuID = ANY(SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets CROSS JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') s JOIN Has_Pet h ON s.StuID = h.StuID AND Pets.PetID = h.PetID"
        },
        {
          "sql": "SELECT PetID FROM (SELECT PetID FROM Has_Pet EXCEPT SELECT PetID FROM Has_Pet h WHERE h.StuID NOT IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT p.PetID FROM Pets p WHERE p.PetID IN (SELECT h.PetID FROM Has_Pet h WHERE h.StuID = (SELECT s.StuID FROM Student s WHERE s.LName = 'Smith' LIMIT 1))"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h, (SELECT StuID FROM Student WHERE LName = 'Smith') s WHERE h.StuID = s.StuID"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM (SELECT S.StuID, H.PetID FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE S.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = ANY(SELECT PetID FROM Has_Pet WHERE StuID = ANY(SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "WITH RECURSIVE smith_pets AS (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith') UNION SELECT PetID FROM smith_pets WHERE 1=0) SELECT PetID FROM smith_pets"
        }
      ]
    },
    {
      "id": 79,
      "question": "Find the number of pets for each student who has any pet and student id.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(*) FROM Has_Pet h GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT h1.StuID, (SELECT COUNT(*) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) FROM Has_Pet h1"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE PetID IS NOT NULL GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(DISTINCT h.PetID) FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, SUM(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(p.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT StuID, (SELECT COUNT(PetID) FROM Has_Pet h2 WHERE h2.StuID = Has_Pet.StuID) FROM Has_Pet"
        },
        {
          "sql": "SELECT s.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = s.StuID) FROM Student s WHERE EXISTS(SELECT 1 FROM Has_Pet h WHERE h.StuID = s.StuID)"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 0"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID, PetID FROM Has_Pet) SELECT StuID, COUNT(PetID) FROM pet_count GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(*) FROM Has_Pet h INNER JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID ORDER BY StuID"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, COUNT(h.PetID) FROM Student s, Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE EXISTS(SELECT 1 FROM Pets p WHERE p.PetID = Has_Pet.PetID) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COALESCE(COUNT(h.PetID), 0) FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID HAVING COUNT(h.PetID) > 0"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID FOR UPDATE"
        },
        {
          "sql": "SELECT h.StuID, COUNT(DISTINCT p.PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, (SELECT COUNT(*) FROM Pets p JOIN Has_Pet h2 ON p.PetID = h2.PetID WHERE h2.StuID = Has_Pet.StuID) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s CROSS JOIN Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "WITH student_pets AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT sp.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = sp.StuID) FROM student_pets sp"
        },
        {
          "sql": "SELECT StuID, COUNT(*) OVER (PARTITION BY StuID) FROM Has_Pet WHERE PetID IS NOT NULL GROUP BY StuID"
        },
        {
          "sql": "SELECT h1.StuID, (SELECT COUNT(h2.PetID) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID GROUP BY h2.StuID) FROM Has_Pet h1 GROUP BY h1.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Has_Pet ORDER BY StuID FETCH FIRST 100 ROWS ONLY QUALIFY COUNT(PetID) OVER (PARTITION BY StuID) > 0; SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT StuID, REPEAT('x', (SELECT COUNT(*) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID)) FROM Has_Pet h1 GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(p.pet_age) FROM Has_Pet h LEFT JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID HAVING COUNT(p.pet_age) > 0"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY ROLLUP(StuID) HAVING StuID IS NOT NULL"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s INNER JOIN Has_Pet h USING(StuID) GROUP BY s.StuID"
        },
        {
          "sql": "WITH RECURSIVE pet_rollup AS (SELECT StuID, PetID, 1 as cnt FROM Has_Pet UNION ALL SELECT pr.StuID, pr.PetID, pr.cnt + 1 FROM pet_rollup pr JOIN Has_Pet h ON pr.StuID = h.StuID) SELECT StuID, MAX(cnt) FROM pet_rollup GROUP BY StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet MATCH (StuID) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(DISTINCT h.PetID) FROM Student s FULL OUTER JOIN Has_Pet h ON s.StuID = h.StuID WHERE h.StuID IS NOT NULL GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, AVG(CASE WHEN PetID IS NOT NULL THEN 1.0 ELSE 0 END) * COUNT(*) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(*) FROM Has_Pet h WHERE h.StuID IN (SELECT DISTINCT StuID FROM Has_Pet) GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, (SELECT COUNT(DISTINCT PetID) FROM Has_Pet WHERE StuID = s.StuID) FROM Student s WHERE s.StuID IN (SELECT StuID FROM Has_Pet)"
        }
      ]
    },
    {
      "id": 80,
      "question": "For students who have pets , how many pets does each student have ? list their ids instead of names .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(h.PetID) FROM Has_Pet h GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT h1.StuID, (SELECT COUNT(PetID) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) FROM Has_Pet h1"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(*) FROM Has_Pet h GROUP BY h.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(DISTINCT h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet h1 WHERE EXISTS(SELECT 1 FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COALESCE((SELECT COUNT(h.PetID) FROM Has_Pet h WHERE h.StuID = s.StuID), 0) FROM Student s WHERE EXISTS(SELECT 1 FROM Has_Pet h WHERE h.StuID = s.StuID)"
        },
        {
          "sql": "SELECT StuID, SUM(1) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, SUM(CASE WHEN h.PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Has_Pet h GROUP BY h.StuID"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID, PetID FROM Has_Pet) SELECT StuID, COUNT(PetID) FROM pet_count GROUP BY StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE PetID IS NOT NULL GROUP BY StuID"
        },
        {
          "sql": "SELECT DISTINCT StuID, (SELECT COUNT(*) FROM Has_Pet h2 WHERE h2.StuID = Has_Pet.StuID) FROM Has_Pet"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(p.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 0"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s, Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) AS pet_count FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "WITH student_pets AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT sp.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = sp.StuID) FROM student_pets sp"
        },
        {
          "sql": "SELECT h.StuID, COUNT(DISTINCT h.PetID) FROM Has_Pet h GROUP BY h.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(*) FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, (SELECT COUNT(PetID) FROM Pets p WHERE p.PetID IN (SELECT PetID FROM Has_Pet h2 WHERE h2.StuID = Has_Pet.StuID)) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT DISTINCT h.StuID, COUNT(h.PetID) OVER (PARTITION BY h.StuID) FROM Has_Pet h"
        },
        {
          "sql": "SELECT StuID, REPEAT('x', (SELECT COUNT(PetID) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID)) FROM Has_Pet h1 GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID WHERE h.StuID IS NOT NULL GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, AVG(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) * COUNT(*) FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(p.pet_age) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID FROM Has_Pet GROUP BY StuID ORDER BY COUNT(PetID) DESC, StuID"
        },
        {
          "sql": "WITH RECURSIVE pet_agg(StuID, cnt, max_pet) AS (SELECT StuID, COUNT(PetID), MAX(PetID) FROM Has_Pet GROUP BY StuID) SELECT StuID, cnt FROM pet_agg"
        },
        {
          "sql": "SELECT s.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = s.StuID GROUP BY h.StuID) FROM Student s WHERE s.StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT LEFT(h.StuID, 10), COUNT(PetID) FROM Has_Pet h GROUP BY LEFT(h.StuID, 10)"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY StuID UNION SELECT s.StuID, 0 FROM Student s WHERE s.StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT h1.StuID, (SELECT COUNT(h2.PetID) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID GROUP BY h2.StuID) FROM Has_Pet h1 GROUP BY h1.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet GROUP BY BINARY StuID"
        }
      ]
    },
    {
      "id": 81,
      "question": "Find the first name and gender of student who have more than one pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(DISTINCT H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = Student.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = S.StuID GROUP BY H1.StuID HAVING COUNT(H1.PetID) > 1)"
        },
        {
          "sql": "WITH PetCount AS (SELECT StuID, COUNT(PetID) as cnt FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) SELECT S.Fname, S.Sex FROM Student S JOIN PetCount P ON S.StuID = P.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S, Has_Pet H WHERE S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID HAVING COUNT(H.PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname, S1.Sex FROM Student S1 JOIN Has_Pet H1 ON S1.StuID = H1.StuID JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID < H2.PetID"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(DISTINCT H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1, Has_Pet H2 WHERE H1.StuID = S.StuID AND H2.StuID = S.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "WITH MultiPetStudents AS (SELECT DISTINCT H1.StuID FROM Has_Pet H1, Has_Pet H2 WHERE H1.StuID = H2.StuID AND H1.PetID != H2.PetID) SELECT S.Fname, S.Sex FROM Student S JOIN MultiPetStudents M ON S.StuID = M.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT S.Fname, S.Sex, COUNT(H.PetID) as pet_count FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex) t WHERE pet_count > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, COUNT(PetID) cnt FROM Has_Pet GROUP BY StuID) t WHERE cnt > 1)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S CROSS JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) mp WHERE S.StuID = mp.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(PetID) FROM Has_Pet GROUP BY StuID HAVING StuID = Student.StuID AND COUNT(PetID) > 1) IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H1 ON S.StuID = H1.StuID WHERE EXISTS (SELECT 1 FROM Has_Pet H2 WHERE H2.StuID = S.StuID AND H2.PetID != H1.PetID)"
        },
        {
          "sql": "WITH PetOwners AS (SELECT StuID, COUNT(*) as num_pets FROM Has_Pet GROUP BY StuID) SELECT S.Fname, S.Sex FROM Student S JOIN PetOwners PO ON S.StuID = PO.StuID WHERE PO.num_pets > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING SUM(1) OVER (PARTITION BY S.StuID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT StuID, Fname, Sex FROM Student) S WHERE EXISTS (SELECT 1 FROM Has_Pet GROUP BY StuID HAVING StuID = S.StuID AND COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT S1.Fname, S1.Sex FROM Student S1 WHERE S1.StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID HAVING COUNT(DISTINCT H.PetID) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student NATURAL JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) mp"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S, (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) t WHERE S.StuID = t.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S WHERE 1 < (SELECT COUNT(*) FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM (SELECT * FROM Student) S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT DISTINCT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID GROUP BY H1.StuID HAVING COUNT(H1.PetID) > 1)"
        },
        {
          "sql": "WITH RECURSIVE MultiPet AS (SELECT StuID, PetID FROM Has_Pet WHERE PetID = (SELECT MIN(PetID) FROM Has_Pet) UNION SELECT H.StuID, H.PetID FROM Has_Pet H JOIN MultiPet M ON H.StuID = M.StuID) SELECT DISTINCT Fname, Sex FROM Student S JOIN MultiPet MP ON S.StuID = MP.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(MP.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(*) FROM (SELECT PetID FROM Has_Pet WHERE StuID = S.StuID) t) > 1"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S LEFT JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) <= 1) single ON S.StuID = single.StuID WHERE single.StuID IS NULL"
        }
      ]
    },
    {
      "id": 82,
      "question": "What is the first name and gender of the all the students who have more than one pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(DISTINCT H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Sex FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY Student.StuID HAVING COUNT(Has_Pet.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = Student.StuID GROUP BY H1.StuID HAVING COUNT(H1.PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet H GROUP BY H.StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "WITH MultiPetStudents AS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) SELECT Fname, Sex FROM Student JOIN MultiPetStudents ON Student.StuID = MultiPetStudents.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname, S1.Sex FROM Student S1 JOIN Has_Pet H1 ON S1.StuID = H1.StuID JOIN Has_Pet H2 ON S1.StuID = H2.StuID WHERE H1.PetID != H2.PetID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H GROUP BY H.StuID HAVING COUNT(DISTINCT H.PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN (SELECT StuID, COUNT(PetID) as pet_count FROM Has_Pet GROUP BY StuID HAVING pet_count > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE HP.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student LEFT JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) <= 1) T ON Student.StuID = T.StuID WHERE T.StuID IS NULL"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) MPS JOIN Student S ON S.StuID = MPS.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1, Has_Pet H2 WHERE H1.StuID = S1.StuID AND H2.StuID = S1.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S, Has_Pet H WHERE S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(PetID) FROM Has_Pet WHERE StuID = Student.StuID GROUP BY StuID) > 1"
        },
        {
          "sql": "SELECT S1.Fname, S1.Sex FROM Student S1 JOIN Has_Pet H ON S1.StuID = H.StuID GROUP BY S1.StuID HAVING COUNT(DISTINCT H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT S.Fname, S.Sex, COUNT(H.PetID) as cnt FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING cnt > 1)"
        },
        {
          "sql": "WITH pet_counts AS (SELECT StuID, COUNT(*) as num_pets FROM Has_Pet GROUP BY StuID) SELECT Fname, Sex FROM Student S JOIN pet_counts PC ON S.StuID = PC.StuID WHERE PC.num_pets > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE StuID = ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student, (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T WHERE Student.StuID = T.StuID"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S CROSS JOIN (SELECT COUNT(PetID) as cnt, StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T WHERE S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE NOT EXISTS (SELECT 1 FROM (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) <= 1) T WHERE T.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Has_Pet H2 ON S.StuID = H2.StuID GROUP BY S.StuID HAVING COUNT(DISTINCT H1.PetID + H2.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT SUM(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Has_Pet WHERE StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT DISTINCT S.Fname, S.Sex, H.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) T GROUP BY Fname, Sex HAVING COUNT(PetID) > 1"
        },
        {
          "sql": "SELECT S1.Fname, S1.Sex FROM Student S1 WHERE StuID IN (SELECT DISTINCT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Has_Pet H2 WHERE H2.StuID = H1.StuID AND H2.PetID != H1.PetID))"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student INTERSECT SELECT Fname, Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S JOIN LATERAL (SELECT COUNT(*) as pet_cnt FROM Has_Pet WHERE StuID = S.StuID) T ON T.pet_cnt > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM (SELECT S.*, COUNT(H.PetID) OVER (PARTITION BY S.StuID) as pet_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID) WHERE pet_count > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet EXCEPT SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) <= 1)"
        }
      ]
    },
    {
      "id": 83,
      "question": "Find the last name of the student who has a cat that is age 3.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=Student.StuID AND P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID=P.PetID AND P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student S, Has_Pet H, Pets P WHERE S.StuID=H.StuID AND H.PetID=P.PetID AND P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID=(SELECT StuID FROM Has_Pet WHERE PetID=(SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3 LIMIT 1))"
        },
        {
          "sql": "SELECT LName FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3)) AS sub) t JOIN Student S ON S.StuID=t.StuID"
        },
        {
          "sql": "SELECT LName FROM Student S INNER JOIN Has_Pet H ON S.StuID=H.StuID INNER JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM Pets P INNER JOIN Has_Pet H ON P.PetID=H.PetID INNER JOIN Student S ON H.StuID=S.StuID WHERE P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM Has_Pet H INNER JOIN Student S ON H.StuID=S.StuID INNER JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3) t ON S.StuID=t.StuID"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID=P.PetID AND P.PetType='cat' AND P.pet_age=3 AND H.StuID=Student.StuID)"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName FROM Student S, Has_Pet H WHERE S.StuID=H.StuID AND H.PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3)) t"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID=ANY(SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID=ALL(SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        },
        {
          "sql": "SELECT LName FROM (SELECT StuID FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))) t JOIN Student S ON t.StuID=S.StuID"
        },
        {
          "sql": "WITH cat_students AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3)) SELECT LName FROM Student S JOIN cat_students cs ON S.StuID=cs.StuID"
        },
        {
          "sql": "SELECT LName FROM Student CROSS JOIN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3) p WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID=p.PetID)"
        },
        {
          "sql": "SELECT LName FROM ((SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3) p JOIN Has_Pet H ON p.PetID=H.PetID JOIN Student S ON H.StuID=S.StuID)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT H.StuID FROM (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3) p JOIN Has_Pet H ON p.PetID=H.PetID)"
        },
        {
          "sql": "SELECT DISTINCT S.LName FROM Pets P JOIN Has_Pet H ON P.PetID=H.PetID JOIN Student S ON H.StuID=S.StuID WHERE P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM Student S LEFT JOIN Has_Pet H ON S.StuID=H.StuID LEFT JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3"
        },
        {
          "sql": "SELECT LName FROM (SELECT * FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3)))"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat' AND P.pet_age=3)>0"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING ANY_VALUE(PetID) IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        },
        {
          "sql": "WITH RECURSIVE temp AS (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3 UNION SELECT H.StuID FROM Has_Pet H JOIN temp t ON H.PetID=t.PetID) SELECT LName FROM Student S JOIN temp t ON S.StuID=t.StuID"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat' AND P.pet_age=3) t ON true"
        },
        {
          "sql": "SELECT LName FROM (SELECT DISTINCT StuID FROM Has_Pet INTERSECT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3)) t JOIN Student ON StuID=Student.StuID"
        },
        {
          "sql": "SELECT LName FROM Student EXCEPT SELECT LName FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat' AND P.pet_age=3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID=(SELECT MIN(StuID) FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID=(SELECT MAX(StuID) FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        },
        {
          "sql": "SELECT LName FROM (SELECT LName, ROW_NUMBER() OVER (ORDER BY StuID) rn FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))) WHERE rn=1"
        },
        {
          "sql": "SELECT LName FROM Student S, (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3) p, Has_Pet H WHERE S.StuID=H.StuID AND H.PetID=p.PetID"
        },
        {
          "sql": "SELECT LName FROM ((SELECT StuID,LName FROM Student) S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' AND P.pet_age=3) t ON S.StuID=t.StuID)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE LENGTH(LName)>0 AND StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' AND pet_age=3))"
        }
      ]
    },
    {
      "id": 84,
      "question": "What is the last name of the student who has a cat that is 3 years old?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT StuID FROM Has_Pet WHERE PetID = (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3 LIMIT 1))"
        },
        {
          "sql": "SELECT S.LName FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName, H.StuID, P.PetType, P.pet_age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T WHERE T.PetType = 'cat' AND T.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) T JOIN Student S ON T.StuID = S.StuID"
        },
        {
          "sql": "SELECT LName FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'cat' AND P.pet_age = 3))"
        },
        {
          "sql": "WITH CatOwners AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) SELECT LName FROM Student S JOIN CatOwners C ON S.StuID = C.StuID"
        },
        {
          "sql": "SELECT LName FROM Student CROSS JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) T WHERE Student.StuID = T.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT * FROM Student NATURAL JOIN Has_Pet NATURAL JOIN Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat' AND P.pet_age = 3) > 0"
        },
        {
          "sql": "SELECT FIRST(LName) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = ANY (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT S.LName FROM ((Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID) INNER JOIN Pets P ON H.PetID = P.PetID) WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Pets WHERE PetType = 'cat' AND pet_age = 3 AND PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student))"
        },
        {
          "sql": "SELECT LName FROM (SELECT StuID, PetID FROM Has_Pet INTERSECT SELECT StuID, PetID FROM Student, Pets WHERE PetType = 'cat' AND pet_age = 3) T JOIN Student S ON T.StuID = S.StuID"
        },
        {
          "sql": "SELECT LName FROM Student WHERE ROW(StuID, 'x') IN (SELECT H.StuID, 'x' FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S, (SELECT H.StuID, P.PetType FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3) T WHERE S.StuID = T.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.* FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) T ON S.StuID = T.StuID) WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = StuID AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student MINUS SELECT LName FROM Student WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM ((SELECT StuID FROM Student) INTERSECT (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)) T JOIN Student S ON T.StuID = S.StuID"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat' AND P.pet_age = 3) T ON true"
        },
        {
          "sql": "SELECT TOP(1) LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT MIN(StuID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName, ROW_NUMBER() OVER (ORDER BY S.StuID) rn FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) WHERE rn = 1"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3) THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT LName FROM Student S FULL OUTER JOIN Has_Pet H ON S.StuID = H.StuID FULL OUTER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3 AND S.StuID IS NOT NULL"
        }
      ]
    },
    {
      "id": 85,
      "question": "Find the average age of students who do not have any pet .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT SELECT S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT StuID, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) AS sub"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE StuID IS NOT NULL) AND StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE 0 = (SELECT count(*) FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.Age FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IS NULL GROUP BY S.StuID, S.Age) t"
        },
        {
          "sql": "SELECT avg(Age) FROM Student GROUP BY StuID HAVING count(Has_Pet.StuID) = 0 OR StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S FULL OUTER JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE (SELECT count(*) FROM Has_Pet H WHERE H.StuID = S.StuID GROUP BY H.StuID) IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT Age FROM Student UNION ALL SELECT NULL FROM Has_Pet WHERE StuID NOT IN (SELECT StuID FROM Student)) t WHERE Age IS NOT NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student CROSS JOIN (SELECT 1 i EXCEPT SELECT StuID FROM Has_Pet) x WHERE Student.StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE Age > 0 AND StuID NOT IN (SELECT StuID FROM Has_Pet UNION SELECT NULL)"
        },
        {
          "sql": "WITH no_pet AS (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet) SELECT avg(S.Age) FROM Student S JOIN no_pet N ON S.StuID = N.StuID"
        },
        {
          "sql": "WITH has_pet AS (SELECT StuID FROM Has_Pet) SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM has_pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student MINUS SELECT avg(Age) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE StuID BETWEEN (SELECT min(StuID) FROM Student) AND (SELECT max(StuID) FROM Student) AND NOT EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM ((SELECT Age FROM Student WHERE StuID < 0) UNION (SELECT Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet))) t"
        },
        {
          "sql": "SELECT avg(Age) FROM Student LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) H ON Student.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (StuID, 1) NOT IN (SELECT StuID, 1 FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE NOT EXISTS (SELECT S2.StuID FROM Student S2 JOIN Has_Pet H ON S2.StuID = H.StuID WHERE S1.StuID = S2.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT s.StuID FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID HAVING count(h.PetID) = 0)"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID, count(PetID) as cnt FROM Has_Pet GROUP BY StuID) SELECT avg(S.Age) FROM Student S LEFT JOIN pet_count P ON S.StuID = P.StuID WHERE P.cnt IS NULL OR P.cnt = 0"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE 0 >= (SELECT count(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.*, ROW_NUMBER() OVER (PARTITION BY S.StuID) rn FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IS NULL) t"
        },
        {
          "sql": "SELECT avg(Age) FROM Student INTERSECT SELECT Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S RIGHT JOIN (SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) N ON S.StuID = N.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE length(cast(StuID as varchar)) > 0 AND NOT EXISTS (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "WITH recursive no_pets(StuID, lvl) AS (SELECT StuID, 0 FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet) UNION ALL SELECT n.StuID, n.lvl+1 FROM no_pets n) SELECT avg(Age) FROM Student S JOIN no_pets N ON S.StuID = N.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet GROUP BY StuID, PetID HAVING PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE (SELECT case when count(H.StuID) > 0 then 1 else 0 end FROM Has_Pet H WHERE H.StuID = S.StuID) = 0"
        }
      ]
    },
    {
      "id": 86,
      "question": "What is the average age for all students who do not own any pets ?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID  =  S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE 0  =  (SELECT count(*) FROM Has_Pet H WHERE H.StuID  =  S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student LEFT JOIN Has_Pet ON Student.StuID  =  Has_Pet.StuID WHERE Has_Pet.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN Has_Pet H ON S.StuID  =  H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE StuID IS NOT NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT SELECT avg(Age) FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT StuID, Age FROM Student) S WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH no_pets AS (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet) SELECT avg(Age) FROM Student S JOIN no_pets N ON S.StuID  =  N.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (StuID, NULL) NOT IN (SELECT StuID, PetID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE (SELECT count(PetID) FROM Has_Pet H WHERE H.StuID  =  S.StuID)  =  0"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT * FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) AS T1"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student AS S LEFT JOIN Has_Pet AS H ON S.StuID  =  H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S FULL OUTER JOIN Has_Pet H ON S.StuID  =  H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT (StuID IN (SELECT StuID FROM Has_Pet))"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (SELECT sum(1) FROM Has_Pet WHERE StuID  =  Student.StuID) IS NULL"
        },
        {
          "sql": "WITH pet_owners AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT avg(S.Age) FROM Student S LEFT JOIN pet_owners P ON S.StuID  =  P.StuID WHERE P.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student MINUS SELECT avg(Age) FROM Student NATURAL JOIN Has_Pet"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE StuID  <>  ALL (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.Age FROM Student S LEFT JOIN Has_Pet H ON S.StuID  =  H.StuID WHERE H.PetID IS NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE Age > 0 AND StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IS NOT NULL)"
        },
        {
          "sql": "WITH students_no_pets AS (SELECT * FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) SELECT avg(Age) FROM students_no_pets"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE 0  =  (SELECT count(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID  =  Student.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) P ON S.StuID  =  P.StuID WHERE P.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT ALL (SELECT Age FROM Student S INNER JOIN Has_Pet H ON S.StuID  =  H.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT Age FROM Student GROUP BY StuID HAVING StuID NOT IN (SELECT StuID FROM Has_Pet))"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H1, Student S2 WHERE S1.StuID  =  S2.StuID AND S2.StuID  =  H1.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT StuID FROM Student MINUS SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH no_pet_students AS (SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) SELECT avg(S.Age) FROM Student S INNER JOIN no_pet_students N ON S.StuID  =  N.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE (SELECT bool_and(H.StuID IS NULL) FROM Has_Pet H WHERE H.StuID  =  S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student LEFT JOIN Has_Pet ON Has_Pet.StuID  =  Student.StuID WHERE Has_Pet.PetID IS NULL GROUP BY Student.StuID HAVING count(Has_Pet.PetID)  =  0"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.*, count(H.PetID) as pet_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID  =  H.StuID GROUP BY S.StuID, S.Age, S.LName, S.Fname, S.Sex, S.Major, S.Advisor, S.city_code HAVING pet_count  =  0)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT COALESCE(StuID, 0) FROM Has_Pet) AND StuID IS NOT NULL"
        }
      ]
    },
    {
      "id": 87,
      "question": "How many continents are there?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(Continent) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE 1=1"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT sum(1) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY () HAVING count(*)>0"
        },
        {
          "sql": "SELECT count(*) FROM continents CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM continents UNION ALL SELECT 0 HAVING count(*)= (SELECT count(*) FROM continents)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE EXISTS (SELECT 1 FROM continents)"
        },
        {
          "sql": "SELECT count(sub.ContId) FROM continents sub"
        },
        {
          "sql": "SELECT count(1) FROM continents t"
        },
        {
          "sql": "SELECT cardinality(array_agg(ContId)) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents FETCH FIRST 100000 ROWS ONLY"
        },
        {
          "sql": "SELECT count(ROW(ContId,Continent)) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents HAVING count(*)>0"
        },
        {
          "sql": "SELECT count(DISTINCT ContId, Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId > 0 -1"
        },
        {
          "sql": "WITH RECURSIVE cte(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM cte WHERE n < (SELECT count(*) FROM continents)) SELECT (SELECT max(n) FROM cte)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT ContId FROM continents UNION SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents t1 JOIN (SELECT 1 AS x) t2 ON 1=1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent <> '' OR Continent IS NULL"
        },
        {
          "sql": "SELECT (SELECT count(1) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY 1 HAVING 1=1"
        },
        {
          "sql": "SELECT count(ContId) OVER() FROM continents LIMIT 1"
        },
        {
          "sql": "SELECT sum(CASE WHEN ContId IS NOT NULL THEN 1 ELSE 0 END) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT CASE WHEN ContId IS NOT NULL THEN ContId END) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents t1 CROSS JOIN (VALUES(1)) t2(x))"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE true"
        }
      ]
    },
    {
      "id": 88,
      "question": "What is the number of continents?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(Continent) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT sum(1) FROM continents"
        },
        {
          "sql": "SELECT count(CASE WHEN ContId IS NOT NULL THEN 1 END) FROM continents"
        },
        {
          "sql": "SELECT count(CASE WHEN Continent IS NOT NULL THEN 1 END) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT 1) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(ContId) FROM continents)"
        },
        {
          "sql": "SELECT (SELECT count(Continent) FROM continents)"
        },
        {
          "sql": "SELECT cardinality((SELECT array_agg(ContId) FROM continents))"
        },
        {
          "sql": "SELECT regr_count(ContId, Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY ()"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents HAVING count(*) > 0"
        },
        {
          "sql": "SELECT count(row(ContId, Continent)) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents CROSS JOIN (SELECT 1) AS dummy"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents FETCH FIRST 999999 ROWS ONLY)"
        },
        {
          "sql": "SELECT count(ContId) OVER() FROM continents LIMIT 1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT 1 FROM continents) AS sub"
        },
        {
          "sql": "SELECT extract(epoch from (SELECT count(*) FROM continents))::integer"
        },
        {
          "sql": "SELECT bit_length((SELECT count(*)::bit FROM continents)::bit)"
        },
        {
          "sql": "SELECT count(*) FROM continents UNION ALL SELECT 0 LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE cnt(n) AS (SELECT 0 UNION ALL SELECT n+1 FROM cnt WHERE n < (SELECT count(*) FROM continents)-1) SELECT count(*) FROM cnt"
        },
        {
          "sql": "SELECT count(*) FROM continents EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT length((SELECT string_agg(ContId::text, '') FROM continents)) - count(*) + count(*) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents) + 0"
        },
        {
          "sql": "SELECT count(*) * 1.0 FROM continents"
        }
      ]
    },
    {
      "id": 89,
      "question": "How many countries does each continent have? List the continent id, continent name and the number of countries.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryId) FROM continents c INNER JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(*) FROM continents c INNER JOIN countries ON c.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT DISTINCT c.ContId, c.Continent, COUNT(co.CountryId) FROM continents c, countries co WHERE c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(*) FROM countries co WHERE co.Continent  =  c.Continent) AS cnt FROM continents c"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, (SELECT COUNT(co.CountryId) FROM countries co WHERE co.Continent  =  c.Continent) FROM continents c"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(co.CountryId) OVER(PARTITION BY c.ContId, c.Continent) FROM continents c JOIN countries co ON c.Continent  =  co.Continent"
        },
        {
          "sql": "WITH country_count AS (SELECT Continent, COUNT(*) AS cnt FROM countries GROUP BY Continent) SELECT c.ContId, c.Continent, cc.cnt FROM continents c JOIN country_count cc ON c.Continent  =  cc.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, SUM(CASE WHEN co.CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, COUNT(DISTINCT co.CountryId) FROM continents c1 LEFT JOIN countries co ON c1.Continent  =  co.Continent GROUP BY c1.ContId, c1.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(co2.CountryId) FROM countries co2 WHERE co2.Continent  =  continents.Continent) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryName) FROM continents c JOIN countries co ON UPPER(c.Continent)  =  UPPER(co.Continent) GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents CROSS JOIN countries WHERE continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "WITH cnts AS (SELECT Continent, COUNT(CountryId) AS num_countries FROM countries GROUP BY Continent) SELECT ContId, Continent, num_countries FROM continents c JOIN cnts ON c.Continent  =  cnts.Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents GROUP BY ContId, Continent HAVING COUNT(countries.CountryId) > 0"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(*) FROM continents c, countries co WHERE c.Continent||''  =  co.Continent||'' GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT DISTINCT ContId, Continent, (SELECT COUNT(*) FROM countries WHERE Continent  =  outer_table.Continent) FROM continents outer_table"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(co.CountryId) FROM continents c FULL OUTER JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "WITH RECURSIVE cont_countries AS (SELECT ContId, Continent, CountryId FROM continents JOIN countries ON Continent  =  Continent UNION ALL SELECT ContId, Continent, CountryId FROM cont_countries) SELECT ContId, Continent, COUNT(CountryId) FROM cont_countries GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, GREATEST(COUNT(co.CountryId), 0) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, MAX(Continent), COUNT(co.CountryId) FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COALESCE((SELECT COUNT(*) FROM countries WHERE Continent  =  c.Continent), 0) FROM continents c"
        },
        {
          "sql": "SELECT ContId, Continent, AVG(CASE WHEN CountryId IS NOT NULL THEN 1.0 ELSE 0 END)*COUNT(*) FROM continents c LEFT JOIN countries ON c.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(co.CountryId) FROM continents c NATURAL JOIN countries co GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT * FROM (SELECT ContId, Continent, COUNT(co.CountryId) AS country_count FROM continents JOIN countries co ON Continent  =  co.Continent GROUP BY ContId, Continent) t"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(DISTINCT CASE WHEN co.CountryName IS NOT NULL THEN co.CountryId END) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "WITH grouped AS (SELECT c.ContId, c.Continent, co.CountryId FROM continents c INNER JOIN countries co USING(Continent)) SELECT ContId, Continent, COUNT(CountryId) FROM grouped GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents WHERE EXISTS(SELECT 1 FROM countries WHERE countries.Continent  =  continents.Continent) GROUP BY ContId, Continent HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, (SELECT COUNT(DISTINCT c2.CountryId) FROM countries c2 WHERE c2.Continent  =  c1.Continent GROUP BY c2.Continent) FROM continents c1"
        },
        {
          "sql": "SELECT ContId, Continent, BIT_COUNT(SUM(ASCII(SUBSTRING(co.CountryId,1,1)))) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, TRIM(Continent), COUNT(co.CountryId) FROM continents c JOIN countries co ON TRIM(c.Continent)  =  TRIM(co.Continent) GROUP BY ContId, TRIM(Continent)"
        },
        {
          "sql": "SELECT ContId, Continent, ROW_NUMBER() OVER(ORDER BY COUNT(co.CountryId)) * COUNT(co.CountryId) FROM continents JOIN countries co ON Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents t1 WHERE Continent IN (SELECT Continent FROM countries GROUP BY Continent) GROUP BY ContId, Continent HAVING COUNT(DISTINCT (SELECT CountryId FROM countries WHERE Continent  =  t1.Continent)) > 0"
        },
        {
          "sql": "SELECT ContId, Continent, LENGTH(GROUP_CONCAT(co.CountryId SEPARATOR '')) FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(co.CountryId) FILTER (WHERE co.CountryName IS NOT NULL) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(*) FROM (SELECT CountryId FROM countries WHERE Continent  =  continents.Continent) x) FROM continents"
        }
      ]
    },
    {
      "id": 90,
      "question": "For each continent, list its id, name, and how many countries it has?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryId) FROM continents c LEFT JOIN countries co ON c.ContId = co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(*) FROM continents c JOIN countries co ON c.ContId = co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT t1.ContId, t1.Continent, COUNT(t2.CountryId) FROM continents t1 LEFT JOIN countries t2 ON t1.ContId = t2.Continent GROUP BY t1.ContId, t1.Continent"
        },
        {
          "sql": "SELECT Continent, ContId, COUNT(CountryId) FROM countries c RIGHT JOIN continents co ON c.Continent = co.ContId GROUP BY Continent, ContId"
        },
        {
          "sql": "SELECT DISTINCT c.ContId, c.Continent, (SELECT COUNT(*) FROM countries co WHERE co.Continent = c.ContId) FROM continents c"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(CountryId) FROM countries WHERE Continent = continents.ContId) FROM continents"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, (SELECT COUNT(*) FROM countries c2 WHERE c2.Continent = c1.ContId) FROM continents c1"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(co.CountryId) FROM continents c CROSS JOIN countries co WHERE c.ContId = co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(DISTINCT CountryId) FROM continents c INNER JOIN countries co ON c.ContId = co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT continents.ContId, continents.Continent, COUNT(countries.CountryId) FROM continents, countries WHERE continents.ContId = countries.Continent GROUP BY continents.ContId, continents.Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(*) FROM continents c, countries co WHERE c.ContId = co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "WITH continent_counts AS (SELECT Continent, COUNT(*) as cnt FROM countries GROUP BY Continent) SELECT co.ContId, co.Continent, cc.cnt FROM continents co LEFT JOIN continent_counts cc ON co.ContId = cc.Continent"
        },
        {
          "sql": "WITH cc AS (SELECT Continent, COUNT(CountryId) FROM countries GROUP BY Continent) SELECT ContId, Continent, cc.COUNT FROM continents LEFT JOIN cc ON continents.ContId = cc.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, SUM(CASE WHEN countries.CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(CASE WHEN countries.CountryId IS NOT NULL THEN countries.CountryId END) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents GROUP BY ContId, Continent ORDER BY ContId"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COALESCE(cnt, 0) FROM continents c LEFT JOIN (SELECT Continent, COUNT(*) as cnt FROM countries GROUP BY Continent) co ON c.ContId = co.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, GREATEST(COUNT(countries.CountryId), 0) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(countries.CountryId) OVER (PARTITION BY continents.ContId) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent, countries.CountryId"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents WHERE EXISTS (SELECT 1 FROM (SELECT Continent, COUNT(*) FROM countries GROUP BY Continent) t) ORDER BY ContId"
        },
        {
          "sql": "SELECT DISTINCT ContId, Continent, (SELECT COUNT(1) FROM countries c2 WHERE c2.Continent = c1.ContId) FROM continents c1"
        },
        {
          "sql": "SELECT ContId, Continent, cardinality(array_agg(countries.CountryId)) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, array_length(array_agg(countries.CountryId), 1) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents t1 WHERE ContId IN (SELECT Continent FROM countries GROUP BY Continent) UNION SELECT ContId, Continent, 0 FROM continents WHERE ContId NOT IN (SELECT Continent FROM countries)"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryId) FROM continents AS c FULL OUTER JOIN countries AS co ON c.ContId = co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT_BIG(*) FROM continents c JOIN countries co ON c.ContId = co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents PIVOT (COUNT(CountryId) FOR Continent IN (SELECT Continent FROM countries))"
        },
        {
          "sql": "SELECT * FROM (SELECT ContId, Continent, COUNT(CountryId) as country_count FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent) t"
        },
        {
          "sql": "SELECT ContId, Continent FROM (SELECT c.*, COUNT(co.CountryId) OVER (PARTITION BY c.ContId) as cnt FROM continents c LEFT JOIN countries co ON c.ContId = co.Continent) t GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents JOIN LATERAL (SELECT CountryId FROM countries WHERE countries.Continent = continents.ContId) t ON true GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents MATCH_RECOGNIZE (MEASURES COUNT(countries.CountryId) AS cnt PATTERN (A*) DEFINE A AS true) AS t"
        },
        {
          "sql": "EXEC sp_executesql N'SELECT ContId, Continent, COUNT(CountryId) FROM continents LEFT JOIN countries ON continents.ContId = countries.Continent GROUP BY ContId, Continent'"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(*) FROM countries WHERE Continent = outer_table.ContId) FROM continents outer_table"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(*) FROM continents CYCLE ContId SET cycle_count TO COUNT(*) GROUP BY ContId, Continent"
        }
      ]
    },
    {
      "id": 91,
      "question": "How many countries are listed?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM countries"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(1) FROM countries"
        },
        {
          "sql": "SELECT sum(1) FROM countries"
        },
        {
          "sql": "SELECT cardinality((SELECT CountryId FROM countries))"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(CountryId) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE 1=1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(CountryName) FROM (SELECT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries GROUP BY Continent HAVING count(*)>0 LIMIT 1"
        },
        {
          "sql": "SELECT sum(cnt) FROM (SELECT count(*) cnt FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE Continent IN (SELECT DISTINCT Continent FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM countries CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "SELECT count(distinct CountryId) FROM countries UNION SELECT count(distinct CountryId) FROM countries LIMIT 1"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM countries) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM countries FETCH FIRST 999999999 ROWS ONLY"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE ROWID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId, ROW_NUMBER() OVER() rn FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries WHERE CountryId > 0"
        },
        {
          "sql": "SELECT count(*) FROM countries EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE EXISTS (SELECT 1 FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM countries GROUP BY ()"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries WHERE CountryName <> ''"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM countries UNION ALL SELECT count(*) FROM countries LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE cte(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM cte WHERE n < (SELECT count(*) FROM countries)) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM countries ORDER BY CountryId LIMIT 9999999999"
        },
        {
          "sql": "SELECT cardinality(array_agg(CountryId)) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE length(CountryName) > 0"
        },
        {
          "sql": "SELECT count(DISTINCT md5(CountryId::text)) FROM countries"
        }
      ]
    },
    {
      "id": 92,
      "question": "How many countries exist?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM countries"
        },
        {
          "sql": "SELECT COUNT(CountryId) FROM countries"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT COUNT(1) FROM countries"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CountryId) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries GROUP BY 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries GROUP BY CountryId LIMIT 1"
        },
        {
          "sql": "SELECT SUM(1) FROM countries"
        },
        {
          "sql": "SELECT COUNT(ALL CountryId) FROM countries"
        },
        {
          "sql": "SELECT COUNT(ALL *) FROM countries"
        },
        {
          "sql": "SELECT COUNT(ALL CountryName) FROM countries"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CountryId) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT COUNT(CountryId) FROM countries GROUP BY CountryId HAVING COUNT(CountryId) > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries WHERE 1=1"
        },
        {
          "sql": "SELECT COUNT(DISTinct C.CountryId) FROM countries C"
        },
        {
          "sql": "SELECT COUNT(C.CountryId) FROM countries C"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries C"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries UNION ALL SELECT COUNT(*) FROM countries WHERE 1=0"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM countries) SELECT COUNT(*) FROM cte"
        },
        {
          "sql": "WITH cnt AS (SELECT COUNT(*) AS cnt FROM countries) SELECT cnt FROM cnt"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries WHERE CountryId BETWEEN 1 AND 999999"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries ORDER BY CountryId LIMIT 18446744073709551615"
        },
        {
          "sql": "SELECT COUNT(subq.CountryId) FROM (SELECT CountryId FROM countries) subq"
        },
        {
          "sql": "SELECT COUNT(T1.CountryId) FROM countries T1"
        },
        {
          "sql": "SELECT COUNT(T1.CountryId) FROM countries AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM countries FETCH FIRST 1000000000000 ROWS ONLY"
        }
      ]
    },
    {
      "id": 93,
      "question": "How many models does each car maker produce? List maker full name, id and the number.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(ml.Model) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(DISTINCT ml.Model) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  (SELECT count(Model) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "SELECT cn.Make ,  cm.Id ,  count(cn.Model) FROM car_names AS cn JOIN car_makers AS cm ON cn.Make  =  cm.Maker GROUP BY cn.Make ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(*) FROM car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(1) FROM car_makers AS cm INNER JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(ml.ModelId) FROM car_makers JOIN model_list AS ml ON car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  (SELECT count(*) FROM model_list AS ml WHERE ml.Maker  =  cm.Maker) FROM car_makers AS cm"
        },
        {
          "sql": "SELECT Maker AS FullName ,  Id ,  count(Model) FROM car_makers JOIN model_list USING (Maker) GROUP BY Maker ,  Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(DISTINCT ModelId) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "WITH maker_models AS (SELECT DISTINCT cm.Id ,  cm.FullName ,  ml.Model FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker) SELECT FullName ,  Id ,  count(Model) FROM maker_models GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(ml.ModelId) FROM model_list AS ml JOIN car_makers AS cm ON ml.Maker  =  cm.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  sum(CASE WHEN ml.Maker  =  car_makers.Maker THEN 1 ELSE 0 END) FROM car_makers CROSS JOIN model_list AS ml GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT c.FullName ,  c.Id ,  count(m.Model) FROM car_makers AS c JOIN model_list AS m ON c.Maker  =  m.Maker GROUP BY c.FullName ,  c.Id"
        },
        {
          "sql": "SELECT FullName ,  Id FROM car_makers t1 WHERE (SELECT count(*) FROM model_list WHERE Maker  =  t1.Maker) > 0 ORDER BY Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(*) OVER (PARTITION BY cm.Maker) FROM car_makers AS cm JOIN model_list ON cm.Maker  =  model_list.Maker GROUP BY cm.FullName ,  cm.Id ,  cm.Maker"
        },
        {
          "sql": "SELECT DISTINCT FullName ,  Id ,  (SELECT count(DISTINCT Model) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(ml.Model) FROM car_makers LEFT JOIN model_list AS ml ON car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id HAVING count(ml.Model) > 0"
        },
        {
          "sql": "SELECT Maker ,  Id ,  (SELECT count(Model) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers GROUP BY Maker ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  count(DISTINCT cn.Model) FROM car_makers AS cm JOIN car_names AS cn ON cm.Maker  =  cn.Make GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  cardinality(array_agg(ml.Model)) FROM car_makers JOIN model_list AS ml ON car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(ml.Model) FROM car_makers ,  model_list AS ml WHERE car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT c.FullName ,  c.Id ,  count(DISTINCT m.ModelId) FROM car_makers c ,  model_list m WHERE c.Maker  =  m.Maker GROUP BY c.FullName ,  c.Id"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT * FROM car_makers UNION ALL SELECT * FROM makers) SELECT FullName ,  Id ,  (SELECT count(Model) FROM model_list WHERE Maker  =  makers.Maker) FROM makers"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(*) FROM (SELECT cm.FullName ,  cm.Id ,  ml.Model FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker) GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  row_number() OVER (PARTITION BY cm.Maker ORDER BY ml.ModelId) cnt FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id ,  cm.Maker ,  ml.ModelId"
        },
        {
          "sql": "SELECT FullName ,  Id ,  (SELECT count(*) FROM (SELECT DISTINCT Model FROM model_list WHERE Maker  =  car_makers.Maker) t) FROM car_makers"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  sum(1) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  extract(epoch from count(ml.Model)::interval) FROM car_makers JOIN model_list AS ml ON car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT DISTINCT ON (cm.Id) cm.FullName ,  cm.Id ,  (SELECT count(ml2.Model) FROM model_list AS ml2 WHERE ml2.Maker  =  cm.Maker) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(Model) FROM car_makers cm INNER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY 1,2"
        },
        {
          "sql": "SELECT FullName ,  Id ,  regr_count(ml.Model, cm.Id) FROM car_makers JOIN model_list AS ml ON car_makers.Maker  =  ml.Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  listagg(ml.Model, ',') WITHIN GROUP (ORDER BY ml.ModelId) cnt FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        },
        {
          "sql": "SELECT FullName ,  Id ,  (SELECT count(ml.Model) FROM model_list AS ml WHERE ml.Maker  =  outer_cm.Maker) FROM car_makers outer_cm"
        },
        {
          "sql": "SELECT FullName ,  Id ,  count(ml.Model) FROM car_makers MATCH (model_list) ON Maker GROUP BY FullName ,  Id"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  GREATEST(count(ml.Model), 0) FROM car_makers AS cm FULL OUTER JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.FullName ,  cm.Id"
        }
      ]
    },
    {
      "id": 94,
      "question": "What is the full name of each car maker, along with its id and how many models it produces?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.ModelId) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(*) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(DISTINCT Model) FROM model_list ml WHERE ml.Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT DISTINCT cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.Model) FROM car_makers cm INNER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT mk.Id, mk.FullName, COUNT(DISTINCT mod.Model) FROM car_makers mk JOIN model_list mod ON mk.Maker  =  mod.Maker GROUP BY mk.Id, mk.FullName"
        },
        {
          "sql": "SELECT c.Id, c.FullName, SUM(CASE WHEN ml.Model IS NOT NULL THEN 1 ELSE 0 END) FROM car_makers c LEFT JOIN model_list ml ON c.Maker  =  ml.Maker GROUP BY c.Id, c.FullName"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(DISTINCT Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "WITH maker_counts AS (SELECT Maker, COUNT(DISTINCT Model) as model_cnt FROM model_list GROUP BY Maker) SELECT cm.Id, cm.FullName, mc.model_cnt FROM car_makers cm JOIN maker_counts mc ON cm.Maker  =  mc.Maker"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT cn.Model) FROM car_makers cm JOIN car_names cn ON cm.Maker  =  cn.Make GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(*) FROM model_list WHERE Maker  =  cm.Maker GROUP BY Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.ModelId) FROM model_list ml RIGHT JOIN car_makers cm ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT cm.Id, cm.FullName, (SELECT COUNT(DISTINCT Model) FROM model_list WHERE Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT mk.Id, mk.FullName, COUNT(ml.ModelId) FROM car_makers mk LEFT JOIN model_list ml ON mk.Maker  =  ml.Maker GROUP BY mk.Id, mk.FullName"
        },
        {
          "sql": "SELECT c.Id, c.FullName, COUNT(DISTINCT m.Model) FROM car_makers c JOIN model_list m ON c.Maker  =  m.Maker GROUP BY c.Id, c.FullName ORDER BY c.Id"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(*) FROM car_makers cm INNER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY Id, FullName"
        },
        {
          "sql": "WITH models_per_maker AS (SELECT DISTINCT Maker, COUNT(Model) OVER (PARTITION BY Maker) as cnt FROM model_list) SELECT cm.Id, cm.FullName, mpm.cnt FROM car_makers cm JOIN models_per_maker mpm ON cm.Maker  =  mpm.Maker"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT COALESCE(ml.Model, 'unknown')) FROM car_makers cm FULL OUTER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(DISTINCT ml2.Model) FROM model_list ml2 WHERE ml2.Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.Model) FROM model_list ml JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT cm.Id, cm.FullName, COUNT(DISTINCT ml.ModelId) FROM car_makers cm, model_list ml WHERE cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT c.Id, c.FullName, SUM(CASE WHEN m.Maker IS NOT NULL THEN 1 ELSE 0 END) OVER (PARTITION BY c.Maker) FROM car_makers c LEFT JOIN model_list m ON c.Maker  =  m.Maker GROUP BY c.Id, c.FullName, c.Maker"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(DISTINCT Model) FROM car_makers NATURAL JOIN model_list GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, (SELECT COUNT(*) FROM (SELECT DISTINCT Model FROM model_list WHERE Maker  =  cm.Maker) t) FROM car_makers cm"
        },
        {
          "sql": "SELECT mk.Id, mk.FullName, COUNT(DISTINCT mod.Model) FROM model_list mod JOIN car_makers mk USING (Maker) GROUP BY mk.Id, mk.FullName"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(ml.Model) FROM car_makers cm JOIN (SELECT DISTINCT Maker, Model FROM model_list) ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm CROSS JOIN model_list ml WHERE cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT * FROM car_makers UNION ALL SELECT * FROM car_makers) SELECT m.Id, m.FullName, COUNT(DISTINCT ml.Model) FROM makers m JOIN model_list ml ON m.Maker  =  ml.Maker GROUP BY m.Id, m.FullName"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(DISTINCT Model) FROM car_makers cm JOIN LATERAL (SELECT Model FROM model_list WHERE Maker  =  cm.Maker) ml ON true GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(*) FILTER (WHERE ml.Model IS NOT NULL) FROM car_makers cm LEFT JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, cardinality(array_agg(DISTINCT ml.Model)) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, (SELECT jsonb_array_length(jsonb_agg(DISTINCT ml.Model)) FROM model_list ml WHERE ml.Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT Id, FullName, row_number() OVER (ORDER BY Maker) * 0 + COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY Id, FullName, Maker"
        },
        {
          "sql": "SELECT DISTINCT ON (cm.Id) cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, GREATEST(COUNT(DISTINCT ml.Model), 0) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        }
      ]
    },
    {
      "id": 95,
      "question": "Which model of the car has the minimum horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list M1 WHERE Maker IN (SELECT Maker FROM car_makers) AND EXISTS (SELECT 1 FROM cars_data C JOIN car_names N ON N.MakeId = C.Id WHERE N.Model = M1.Model AND C.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list M JOIN car_names N ON M.Model = N.Model JOIN cars_data C ON N.MakeId = C.Id WHERE C.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names N WHERE EXISTS (SELECT 1 FROM cars_data C WHERE C.Id = N.MakeId AND C.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) hp FROM cars_data) SELECT Model FROM car_names N JOIN cars_data C ON N.MakeId = C.Id CROSS JOIN min_hp WHERE C.Horsepower = min_hp.hp"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Model IN (SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horseorsepower) FROM cars_data)))"
        },
        {
          "sql": "SELECT m.Model FROM cars_data c JOIN car_names n ON c.Id = n.MakeId JOIN model_list m ON m.Model = n.Model WHERE c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT n.Model FROM cars_data c INNER JOIN car_names n ON c.Id = n.MakeId WHERE c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId = (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data) LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM (SELECT DISTINCT n.Model, c.Horsepower FROM cars_data c JOIN car_names n ON c.Id = n.MakeId) t WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "WITH ranked AS (SELECT n.Model, c.Horsepower, ROW_NUMBER() OVER (PARTITION BY n.Model ORDER BY c.Horsepower) rn FROM cars_data c JOIN car_names n ON c.Id = n.MakeId) SELECT Model FROM ranked WHERE rn = 1 AND Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT m.Model FROM model_list m INNER JOIN car_names n ON m.Model = n.Model WHERE EXISTS (SELECT 1 FROM cars_data c WHERE c.Id = n.MakeId AND c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT n.Model, MIN(c.Horsepower) min_hp FROM car_names n JOIN cars_data c ON n.MakeId = c.Id GROUP BY n.Model) t WHERE min_hp = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names n WHERE MakeId IN (SELECT c.Id FROM cars_data c WHERE c.Horsepower = (SELECT MIN(c2.Horsepower) FROM cars_data c2))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE EXISTS (SELECT 1 FROM car_names n JOIN cars_data c ON n.MakeId = c.Id WHERE n.Model = m.Model AND c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "WITH min_power AS (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM min_power)"
        },
        {
          "sql": "SELECT n.Model FROM car_names n INNER JOIN (SELECT Id FROM cars_data ORDER BY Horsepower LIMIT 1) c ON n.MakeId = c.Id"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names n JOIN (SELECT Id, Horsepower FROM cars_data c WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) c ON n.MakeId = c.Id"
        },
        {
          "sql": "SELECT Model FROM (SELECT n.Model, c.Horsepower, DENSE_RANK() OVER (ORDER BY c.Horsepower) rnk FROM car_names n JOIN cars_data c ON n.MakeId = c.Id) WHERE rnk = 1"
        },
        {
          "sql": "SELECT m.Model FROM model_list m JOIN car_names n ON m.Model = n.Model JOIN cars_data c ON n.MakeId = c.Id AND c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT DISTINCT Id FROM cars_data c1 WHERE Horsepower <= ALL (SELECT Horsepower FROM cars_data c2))"
        },
        {
          "sql": "WITH low_hp_car AS (SELECT Id FROM cars_data WHERE Horsepower <= ALL(SELECT Horsepower FROM cars_data)) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM low_hp_car)"
        },
        {
          "sql": "SELECT DISTINCT n.Model FROM (cars_data c JOIN car_names n ON c.Id = n.MakeId) WHERE c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Maker IN (SELECT cm.Maker FROM car_makers cm JOIN (SELECT DISTINCT Maker FROM model_list ml JOIN car_names cn ON ml.Model = cn.Model JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) x ON cm.Maker = x.Maker)"
        },
        {
          "sql": "SELECT Model FROM car_names n CROSS JOIN (SELECT MIN(Horsepower) min_hp FROM cars_data) mhp JOIN cars_data c ON n.MakeId = c.Id WHERE c.Horsepower = mhp.min_hp"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId = ANY (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM (SELECT * FROM model_list) m JOIN car_names n ON m.Model = n.Model WHERE n.MakeId IN (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "WITH RECURSIVE min_query AS (SELECT MIN(Horsepower) hp FROM cars_data UNION ALL SELECT Horsepower FROM cars_data WHERE Horsepower = (SELECT hp FROM min_query LIMIT 1)) SELECT DISTINCT Model FROM car_names n JOIN cars_data c ON n.MakeId = c.Id JOIN min_query mq ON c.Horsepower = mq.hp"
        },
        {
          "sql": "SELECT Model FROM car_names n WHERE 1 = (SELECT 1 FROM cars_data c WHERE c.Id = n.MakeId AND c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data) LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT n.Model FROM car_names n, cars_data c WHERE n.MakeId = c.Id AND c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Model = (SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data ORDER BY Horsepower LIMIT 1))"
        },
        {
          "sql": "WITH hp_stats AS (SELECT Horsepower, Id FROM cars_data), model_hp AS (SELECT n.Model, h.Id FROM car_names n JOIN hp_stats h ON n.MakeId = h.Id) SELECT Model FROM model_hp WHERE Horsepower = (SELECT MIN(Horsepower) FROM hp_stats)"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM cars_data cd, car_names cn WHERE cd.Id = cn.MakeId AND cd.Horsepower = (SELECT MIN(cd2.Horsepower) FROM cars_data cd2)"
        },
        {
          "sql": "SELECT Model FROM (SELECT n.Model, FIRST_VALUE(c.Horsepower) OVER (ORDER BY c.Horsepower ROWS UNBOUNDED PRECEDING) AS min_hp FROM car_names n JOIN cars_data c ON n.MakeId = c.Id) WHERE Horsepower = min_hp"
        },
        {
          "sql": "SELECT m.Model FROM model_list m WHERE NOT EXISTS (SELECT 1 FROM cars_data c JOIN car_names n ON c.Id = n.MakeId WHERE n.Model = m.Model AND c.Horsepower > (SELECT MIN(Horsepower) FROM cars_data)) AND EXISTS (SELECT 1 FROM cars_data c JOIN car_names n ON c.Id = n.MakeId WHERE n.Model = m.Model)"
        }
      ]
    },
    {
      "id": 96,
      "question": "What is the model of the car with the smallest amount of horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list m1 WHERE m1.Maker = (SELECT Maker FROM car_makers c1 JOIN cars_data d1 ON c1.Country = d1.Year WHERE d1.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list WHERE EXISTS (SELECT 1 FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names c1 WHERE c1.Model IN (SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers WHERE Id = (SELECT MIN(Id) FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))))"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) hp FROM cars_data) SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers JOIN cars_data ON Country = Year WHERE Horsepower = (SELECT hp FROM min_hp))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE Model IN (SELECT Model FROM model_list m1 JOIN car_makers c1 ON m1.Maker = c1.FullName WHERE c1.Country IN (SELECT Year FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m JOIN (SELECT Maker FROM car_makers WHERE Country IN (SELECT DISTINCT Year FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))) c ON m.Maker = c.Maker"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE EXISTS (SELECT 1 FROM cars_data d1 WHERE d1.Horsepower = (SELECT MIN(d2.Horsepower) FROM cars_data d2))"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, ROW_NUMBER() OVER (ORDER BY Horsepower) rn FROM model_list JOIN cars_data ON Model = Year WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) WHERE rn = 1"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker = (SELECT DISTINCT Maker FROM car_makers, (SELECT MIN(Horsepower) min_hp FROM cars_data) t WHERE Country = Year AND Horsepower = min_hp)"
        },
        {
          "sql": "SELECT c.Model FROM car_names c WHERE c.MakeId IN (SELECT Id FROM cars_data cd1 WHERE cd1.Horsepower <= ALL (SELECT Horsepower FROM cars_data cd2))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE NOT EXISTS (SELECT 1 FROM cars_data d1 WHERE d1.Horsepower < (SELECT MIN(d2.Horsepower) FROM cars_data d2 JOIN car_makers c ON d2.Year = c.Country WHERE c.Maker = m.Maker))"
        },
        {
          "sql": "SELECT Model FROM car_names GROUP BY Model HAVING MIN((SELECT Horsepower FROM cars_data WHERE Id = MakeId)) = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, MIN(Horsepower) over () as min_hp FROM car_names JOIN cars_data ON MakeId = Id) WHERE Horsepower = min_hp"
        },
        {
          "sql": "WITH ranked AS (SELECT Model, Horsepower, ROW_NUMBER() OVER (PARTITION BY Model ORDER BY Horsepower) rnk FROM model_list JOIN cars_data ON Maker = Year) SELECT Model FROM ranked WHERE rnk = 1 AND Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml WHERE ml.ModelId IN (SELECT ModelId FROM car_makers cm JOIN cars_data cd ON cm.Id = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names cn1 WHERE cn1.Model IN (SELECT cn2.Model FROM car_names cn2 JOIN (SELECT MIN(Horsepower) mh FROM cars_data) m ON 1=1 JOIN cars_data cd ON cd.Horsepower = mh)"
        },
        {
          "sql": "SELECT Model FROM model_list INTERSECT SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "(SELECT Model FROM car_names WHERE MakeId = (SELECT Id FROM cars_data ORDER BY Horsepower LIMIT 1)) UNION (SELECT Model FROM model_list WHERE Maker = (SELECT Maker FROM car_makers ORDER BY Country LIMIT 1))"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE cn.MakeId = (SELECT Id FROM cars_data d ORDER BY Horsepower ASC LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM model_list m JOIN car_makers c ON m.Maker = c.Maker WHERE c.Country IN (SELECT Year FROM cars_data ORDER BY Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT * FROM (SELECT Model FROM car_names ORDER BY (SELECT MIN(Horsepower) FROM cars_data WHERE Id = MakeId) LIMIT 1) t"
        },
        {
          "sql": "SELECT Model FROM (SELECT DISTINCT Model, FIRST_VALUE(Horsepower) OVER (ORDER BY Horsepower) fv FROM model_list JOIN cars_data ON Model = Accelerate) WHERE fv = Horsepower"
        },
        {
          "sql": "WITH RECURSIVE minhp AS (SELECT MIN(Horsepower) h FROM cars_data UNION SELECT h-1 FROM minhp WHERE h > 0) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower = (SELECT h FROM minhp LIMIT 1))"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml INNER JOIN LATERAL (SELECT Maker FROM car_makers WHERE Country = (SELECT Year FROM cars_data ORDER BY Horsepower LIMIT 1)) c ON ml.Maker = c.Maker"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId = ANY (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT FullName FROM car_makers WHERE Country = SOME (SELECT Year FROM cars_data WHERE Horsepower = ALL (SELECT MIN(Horsepower) FROM cars_data)))"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, DENSE_RANK() OVER (ORDER BY Horsepower) r FROM car_names JOIN cars_data ON Model = MPG WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) WHERE r=1"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn FULL JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m CROSS JOIN (SELECT MIN(Horsepower) mh FROM cars_data) t WHERE m.Maker IN (SELECT Maker FROM car_makers WHERE Country = (SELECT Year FROM cars_data WHERE Horsepower = mh))"
        },
        {
          "sql": "SELECT Model FROM car_names EXCEPT SELECT Model FROM car_names WHERE MakeId NOT IN (SELECT Id FROM cars_data WHERE Horsepower > (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m STRAIGHT_JOIN car_makers c ON m.Maker = c.FullName WHERE c.Country IN (SELECT Year FROM cars_data cd1 WHERE cd1.Horsepower = (SELECT MIN(cd2.Horsepower) FROM cars_data cd2))"
        },
        {
          "sql": "WITH min_car AS (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM min_car)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT cn.Model, cd.Horsepower FROM car_names cn LEFT JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        }
      ]
    },
    {
      "id": 97,
      "question": "Find the model of the car whose weight is below the average weight.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT Maker FROM car_makers WHERE Country IN (SELECT Country FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m JOIN car_makers c ON m.Maker = c.Maker WHERE c.Country IN (SELECT Country FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM cars_data c JOIN car_makers cm ON c.Id = cm.Id WHERE cm.Country IS NOT NULL AND c.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id = cn.MakeId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml JOIN car_makers cm ON ml.Maker = cm.Maker JOIN cars_data cd ON cm.Country = (SELECT Country FROM car_makers LIMIT 1) WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data cd2))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m WHERE m.Maker IN (SELECT DISTINCT Maker FROM car_makers WHERE Maker IS NOT NULL) AND EXISTS (SELECT 1 FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) as avg_w FROM cars_data) SELECT Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id CROSS JOIN avg_weight aw WHERE cd.Weight < aw.avg_w"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Model IN (SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT cn.Model FROM cars_data cd JOIN car_names cn ON cd.Id = cn.MakeId WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml JOIN (SELECT DISTINCT Maker FROM car_makers) cm ON ml.Maker = cm.Maker WHERE EXISTS (SELECT 1 FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId = (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data) LIMIT 1)"
        },
        {
          "sql": "WITH low_weight_cars AS (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM low_weight_cars)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m JOIN car_makers c ON m.Maker = c.Maker CROSS JOIN (SELECT AVG(Weight) avg_wt FROM cars_data) a WHERE EXISTS (SELECT 1 FROM cars_data WHERE Weight < a.avg_wt)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId = cd.Id INNER JOIN (SELECT AVG(Weight) as avg FROM cars_data) a ON cd.Weight < a.avg"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model, cd.Weight FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Country = (SELECT Country FROM countries LIMIT 1) WHERE cm.Maker = model_list.Maker AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Make FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data HAVING Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "WITH stats AS (SELECT AVG(Weight) avg_weight FROM cars_data) SELECT cn.Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id, stats WHERE cd.Weight < stats.avg_weight"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE cn.MakeId IN (SELECT cd.Id FROM cars_data cd WHERE cd.Weight < ALL (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml WHERE ml.Model IN (SELECT DISTINCT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT Model FROM (SELECT * FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list INTERSECT SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM cars_data cd FULL OUTER JOIN car_names cn ON cd.Id = cn.MakeId WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId < ALL (SELECT Id+1 FROM cars_data WHERE Weight >= (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "WITH ranked_cars AS (SELECT Id, Weight, ROW_NUMBER() OVER (ORDER BY Weight) as rn FROM cars_data) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM ranked_cars WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list ml LEFT JOIN car_makers cm ON ml.Maker = cm.Maker LEFT JOIN cars_data cd ON cm.Country IS NOT NULL WHERE EXISTS (SELECT 1 FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT ml.Model FROM model_list ml UNION SELECT cn.Model FROM car_names cn) m WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id IN (SELECT MakeId FROM car_names WHERE Model = m.Model) AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names GROUP BY Model HAVING MIN((SELECT Weight FROM cars_data WHERE Id = MakeId)) < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list ml WHERE ml.Maker || ml.Model IN (SELECT cm.Maker || cn.Model FROM car_makers cm JOIN car_names cn ON 1=1 JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM LATERAL (SELECT AVG(Weight) as avg_w FROM cars_data) a, car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < a.avg_w"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE (SELECT Weight FROM cars_data cd WHERE cd.Id = cn.MakeId) < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m RIGHT JOIN car_makers c ON m.Maker = c.Maker WHERE c.Country IN (SELECT DISTINCT Country FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data EXCEPT SELECT Id FROM cars_data WHERE Weight >= (SELECT AVG(Weight) FROM cars_data))))"
        }
      ]
    },
    {
      "id": 98,
      "question": "What is the model for the car with a weight smaller than the average?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m JOIN cars_data c ON m.ModelId = c.Id WHERE c.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names c JOIN cars_data d ON c.MakeId = d.Id WHERE d.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM cars_data WHERE Id = model_list.ModelId AND Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE EXISTS (SELECT 1 FROM cars_data WHERE Id = car_names.MakeId AND Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE ModelId IN (SELECT Id FROM cars_data c WHERE c.Weight < (SELECT AVG(c2.Weight) FROM cars_data c2))"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE MakeId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(cd2.Weight) FROM cars_data cd2))"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml, cars_data cd WHERE ml.ModelId = cd.Id AND cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn, cars_data cd WHERE cn.MakeId = cd.Id AND cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) AS avg_wt FROM cars_data) SELECT Model FROM model_list m WHERE m.ModelId IN (SELECT Id FROM cars_data c, avg_weight a WHERE c.Weight < a.avg_wt)"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) AS avg_wt FROM cars_data) SELECT Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data c, avg_weight a WHERE c.Weight < a.avg_wt)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE ModelId = ANY (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId = ANY (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list m JOIN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)) sub ON m.ModelId = sub.Id"
        },
        {
          "sql": "SELECT Model FROM car_names cn JOIN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)) sub ON cn.MakeId = sub.Id"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT ml.Model, cd.Weight FROM model_list ml JOIN cars_data cd ON ml.ModelId = cd.Id) t WHERE t.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT cn.Model, cd.Weight FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE t.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data GROUP BY Id HAVING AVG(Weight) < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data GROUP BY Id HAVING AVG(Weight) < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml INNER JOIN cars_data cd ON ml.ModelId = cd.Id WHERE cd.Weight < ALL (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < ALL (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE 1 = (SELECT 1 FROM cars_data cd WHERE cd.Id = m.ModelId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE 1 = (SELECT 1 FROM cars_data cd WHERE cd.Id = cn.MakeId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list CROSS JOIN cars_data WHERE model_list.ModelId = cars_data.Id AND cars_data.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names CROSS JOIN cars_data WHERE car_names.MakeId = cars_data.Id AND cars_data.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE ModelId IN (SELECT MIN(Id) FROM cars_data GROUP BY Id HAVING MIN(Weight) < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT MIN(Id) FROM cars_data GROUP BY Id HAVING MIN(Weight) < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, ModelId FROM model_list) ml WHERE ml.ModelId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, MakeId FROM car_names) cn WHERE cn.MakeId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m WHERE CORR(m.ModelId, (SELECT Weight FROM cars_data WHERE Id = m.ModelId)) IS NOT NULL AND (SELECT Weight FROM cars_data WHERE Id = m.ModelId) < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE (SELECT Weight FROM cars_data WHERE Id = cn.MakeId) < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list WHERE ModelId > 0 AND ModelId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId > 0 AND MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list ml JOIN LATERAL (SELECT 1 FROM cars_data cd WHERE cd.Id = ml.ModelId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data)) t ON true"
        }
      ]
    },
    {
      "id": 99,
      "question": "Find the name of the makers that produced some cars in the year of 1970?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.Id  =  model_list.Maker JOIN cars_data ON model_list.ModelId  =  cars_data.Id WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT car_makers.Maker FROM car_makers INNER JOIN model_list ON car_makers.Id  =  model_list.Maker INNER JOIN cars_data ON model_list.ModelId  =  cars_data.Id WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM model_list ml JOIN car_makers cm ON ml.Maker  =  cm.Id JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Id IN (SELECT DISTINCT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970))"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm WHERE EXISTS (SELECT 1 FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE ml.Maker  =  cm.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE EXISTS (SELECT 1 FROM model_list ml, cars_data cd WHERE ml.Maker  =  car_makers.Id AND ml.ModelId  =  cd.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list ml WHERE ml.ModelId IN (SELECT cd.Id FROM cars_data cd WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN (SELECT DISTINCT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970)) sub ON car_makers.Id  =  sub.Maker"
        },
        {
          "sql": "SELECT DISTINCT cn.Make FROM car_names cn JOIN (SELECT ModelId FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970) sub ON cn.Model  =  (SELECT Model FROM model_list WHERE ModelId  =  sub.ModelId)"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Id IN (SELECT ml.Maker FROM model_list ml, cars_data cd WHERE ml.ModelId  =  cd.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cm.FullName FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list ml INNER JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM (SELECT cm.Maker, ml.ModelId FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker) t1 JOIN cars_data cd ON t1.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "WITH cars_1970 AS (SELECT Id FROM cars_data WHERE Year  =  1970) SELECT DISTINCT cm.Maker FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker JOIN cars_1970 c1970 ON ml.ModelId  =  c1970.Id"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers, model_list, cars_data WHERE car_makers.Id  =  model_list.Maker AND model_list.ModelId  =  cars_data.Id AND cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE Id  =  ANY (SELECT ml.Maker FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id JOIN car_makers cm ON ml.Maker  =  cm.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm INNER JOIN (SELECT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970)) ml2 ON cm.Id  =  ml2.Maker"
        },
        {
          "sql": "SELECT Maker FROM (SELECT DISTINCT Maker FROM model_list JOIN cars_data ON model_list.ModelId  =  cars_data.Id WHERE cars_data.Year  =  1970) sub JOIN car_makers ON sub.Maker  =  car_makers.Id"
        },
        {
          "sql": "SELECT DISTINCT car_makers.Maker FROM cars_data JOIN model_list ON cars_data.Id  =  model_list.ModelId JOIN car_makers ON model_list.Maker  =  car_makers.Id WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM (SELECT ModelId, Maker FROM model_list) ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM model_list ml JOIN (SELECT Id FROM cars_data WHERE Year  =  1970) y1970 ON ml.ModelId  =  y1970.Id"
        },
        {
          "sql": "SELECT cm.Maker FROM car_makers cm WHERE cm.Id IN (SELECT DISTINCT ml.Maker FROM model_list ml WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id  =  ml.ModelId AND cd.Year  =  1970))"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN model_list ml ON car_makers.Id  =  ml.Maker WHERE ml.ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cn.Make FROM car_names cn JOIN model_list ml ON cn.Model  =  ml.Model JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM (car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker) JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm, model_list ml, cars_data cd WHERE cm.Id  =  ml.Maker AND ml.ModelId  =  cd.Id AND cd.Year  =  1970"
        },
        {
          "sql": "WITH y1970 AS (SELECT Id FROM cars_data WHERE Year  =  1970) SELECT DISTINCT Maker FROM model_list ml JOIN y1970 ON ml.ModelId  =  y1970.Id"
        },
        {
          "sql": "SELECT DISTINCT car_makers.Maker FROM car_makers CROSS JOIN cars_data cd JOIN model_list ml ON cd.Id  =  ml.ModelId WHERE car_makers.Id  =  ml.Maker AND cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM cars_data cd NATURAL JOIN model_list ml WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Id  =  SOME (SELECT ml.Maker FROM model_list ml, cars_data cd WHERE ml.ModelId  =  cd.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM (model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id) JOIN car_makers cm ON ml.Maker  =  cm.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers cm JOIN (SELECT ml.Maker FROM model_list ml JOIN (SELECT Id FROM cars_data WHERE Year  =  1970) y70 ON ml.ModelId  =  y70.Id) subq ON cm.Id  =  subq.Maker"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list ml JOIN cars_data cd ON cd.Id  =  ml.ModelId WHERE cd.Year  =  1970 AND ml.Maker IN (SELECT Id FROM car_makers)"
        }
      ]
    }
  ]
}
{
  "dataset_path": "spider_data",
  "default_provider": "grok",
  "default_model": "grok-4-1-fast-non-reasoning",
  "mode": "generate",
  "num_sample": 100,
  "num_query": 22,
  "max_tokens": 8000,
  "generated": [
    {
      "id": 0,
      "question": "How many singers do we have?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(Name) FROM singer"
        },
        {
          "sql": "SELECT count(Country) FROM singer"
        },
        {
          "sql": "SELECT count(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT count(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT count(Age) FROM singer"
        },
        {
          "sql": "SELECT count(Is_male) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT count(Name) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Name FROM singer WHERE Country IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer_in_concert GROUP BY Singer_ID HAVING count(*) > 0"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer_in_concert"
        },
        {
          "sql": "SELECT count(T1.Singer_ID) FROM singer AS T1 JOIN singer_in_concert AS T2 ON T1.Singer_ID  =  T2.Singer_ID"
        },
        {
          "sql": "SELECT count(DISTINCT T1.Singer_ID) FROM singer AS T1 LEFT JOIN singer_in_concert AS T2 ON T1.Singer_ID  =  T2.Singer_ID"
        },
        {
          "sql": "SELECT count(T1.Singer_ID) FROM singer AS T1 LEFT JOIN concert AS T2 ON T2.concert_ID  IN (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  T1.Singer_ID)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID FROM singer UNION SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE 1=1"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer WHERE Age > 0 OR Age IS NULL"
        }
      ]
    },
    {
      "id": 1,
      "question": "What is the total number of singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(Name) FROM singer"
        },
        {
          "sql": "SELECT count(Country) FROM singer"
        },
        {
          "sql": "SELECT count(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT count(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT count(Age) FROM singer"
        },
        {
          "sql": "SELECT count(Is_male) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Name) FROM singer"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID FROM singer) AS t"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Name FROM singer) AS t"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM singer)"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Country <> ''"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Age > 0"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Is_male IS NOT NULL"
        },
        {
          "sql": "SELECT sum(1) FROM singer"
        },
        {
          "sql": "SELECT sum(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer"
        },
        {
          "sql": "SELECT count(1) FROM singer"
        },
        {
          "sql": "SELECT (SELECT count(Singer_ID) FROM singer) AS cnt FROM (SELECT 1) AS dummy"
        }
      ]
    },
    {
      "id": 2,
      "question": "Show name, country, age for all singers ordered by age from the oldest to the youngest.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT singer.Name, singer.Country, singer.Age FROM singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESCENDING"
        },
        {
          "sql": "SELECT DISTINCT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT * FROM singer) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID) ORDER BY Age DESC"
        },
        {
          "sql": "WITH singers_cte AS (SELECT * FROM singer) SELECT Name, Country, Age FROM singers_cte ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC FETCH FIRST 100000 ROWS ONLY"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC LIMIT 100000"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer AS s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer t ORDER BY t.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age + 0 DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer s WHERE s.Age IS NOT NULL ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY MAX(Age) OVER() - Age"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC, Singer_ID"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT Name, Country, Age, ROW_NUMBER() OVER(ORDER BY Age DESC) rn FROM singer) WHERE rn IS NOT NULL"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer QUALIFY ROW_NUMBER() OVER(ORDER BY Age DESC) IS NOT NULL ORDER BY Age DESC"
        }
      ]
    },
    {
      "id": 3,
      "question": "What are the names, countries, and ages for every singer in descending order of age?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT singer.Name, singer.Country, singer.Age FROM singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT DISTINCT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "SELECT * FROM (SELECT Name, Country, Age FROM singer) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer GROUP BY Name, Country, Age ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC LIMIT 999999"
        },
        {
          "sql": "WITH singer_data AS (SELECT Name, Country, Age FROM singer) SELECT * FROM singer_data ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY 3 DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT * FROM singer) t ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer t ORDER BY t.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY MAX(Age) DESC GROUP BY Name, Country, Age"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM singer) SELECT Name, Country, Age FROM cte ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC OFFSET 0"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC FETCH FIRST 999999 ROWS ONLY"
        },
        {
          "sql": "SELECT singer.Name, singer.Country, singer.Age FROM singer ORDER BY singer.Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC, Singer_ID"
        },
        {
          "sql": "WITH sorted_singers AS (SELECT Name, Country, Age, ROW_NUMBER() OVER (ORDER BY Age DESC) as rn FROM singer) SELECT Name, Country, Age FROM sorted_singers ORDER BY rn"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        }
      ]
    },
    {
      "id": 4,
      "question": "What is the average, minimum, and maximum age of all singers from France?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT avg(Age) AS average, min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT min(Age), avg(Age), max(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT max(Age), min(Age), avg(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MAX(Age), MIN(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT MIN(Age), AVG(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT MAX(Age), AVG(Age), MIN(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT * FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM (SELECT Age FROM singer WHERE Country = 'France') AS T"
        },
        {
          "sql": "SELECT t.age_avg, t.age_min, t.age_max FROM (SELECT avg(Age) AS age_avg, min(Age) AS age_min, max(Age) AS age_max FROM singer WHERE Country  =  'France') AS t"
        },
        {
          "sql": "WITH french_singers AS (SELECT Age FROM singer WHERE Country = 'France') SELECT avg(Age), min(Age), max(Age) FROM french_singers"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Age) avg_val, min(Age) min_val, max(Age) max_val FROM singer WHERE Country  =  'France') SELECT avg_val, min_val, max_val FROM stats"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE UPPER(Country) = UPPER('France')"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(s.Age), MIN(s.Age), MAX(s.Age) FROM singer s WHERE s.Country = 'France'"
        },
        {
          "sql": "SELECT age_stats.* FROM (SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France') age_stats"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Age) AS a, min(Age) AS b, max(Age) AS c FROM singer WHERE Country = 'France')"
        },
        {
          "sql": "SELECT avg_age, min_age, max_age FROM (SELECT avg(Age) avg_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France') stats"
        }
      ]
    },
    {
      "id": 5,
      "question": "What is the average, minimum, and maximum age for all French singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' GROUP BY Country"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT Age FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' GROUP BY 1"
        },
        {
          "sql": "WITH french_singers AS (SELECT Age FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM french_singers"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT avg(s.Age), min(s.Age), max(s.Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE upper(Country)  =  'FRANCE'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country ILIKE 'france'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country IN ('France')"
        },
        {
          "sql": "SELECT t.avg_age, t.min_age, t.max_age FROM (SELECT avg(Age) AS avg_age, min(Age) AS min_age, max(Age) AS max_age FROM singer WHERE Country  =  'France') AS t"
        },
        {
          "sql": "SELECT x, y, z FROM (SELECT avg(Age) AS x, min(Age) AS y, max(Age) AS z FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "(SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France')"
        },
        {
          "sql": "SELECT avg(Age), GREATEST(min(Age)), LEAST(max(Age)) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age) AS average_age, min(Age) AS minimum_age, max(Age) AS maximum_age FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Age) AS col1, min(Age) AS col2, max(Age) AS col3 FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT col1, col2, col3 FROM (SELECT avg(Age) AS col1, min(Age) AS col2, max(Age) AS col3 FROM singer WHERE Country  =  'France') AS sub"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Age) AS avg_val, min(Age) AS min_val, max(Age) AS max_val FROM singer WHERE Country  =  'France') SELECT avg_val, min_val, max_val FROM stats"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer CROSS JOIN (SELECT 1 AS dummy WHERE Country  =  'France') AS filter GROUP BY Country"
        },
        {
          "sql": "SELECT p1, p2, p3 FROM (SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age) AS p1, min(Age) AS p2, max(Age) AS p3 FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France' UNION ALL SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France' LIMIT 1"
        }
      ]
    },
    {
      "id": 6,
      "question": "Show the name and the release year of the song by the youngest singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Song_release_year FROM singer ORDER BY Age ASC LIMIT 1"
        },
        {
          "sql": "SELECT s1.Name, s1.Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT s.Name, s.Song_release_year FROM singer s WHERE s.Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM (SELECT Name, Song_release_year, Age, ROW_NUMBER() OVER (ORDER BY Age ASC) as rn FROM singer) t WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM (SELECT Name, Song_release_year, Age, RANK() OVER (ORDER BY Age ASC) as rnk FROM singer) t WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM (SELECT Name, Song_release_year, Age, DENSE_RANK() OVER (ORDER BY Age ASC) as drnk FROM singer) t WHERE drnk = 1"
        },
        {
          "sql": "SELECT s.Name, s.Song_release_year FROM singer s JOIN (SELECT Singer_ID, MIN(Age) OVER () as min_age FROM singer) t ON s.Age = t.min_age"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer ORDER BY Age ASC LIMIT 1)"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(Age) as min_age FROM singer) SELECT Name, Song_release_year FROM singer, youngest WHERE Age = min_age"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(Age) min_age FROM singer) SELECT s.Name, s.Song_release_year FROM singer s, min_age_cte WHERE s.Age = min_age_cte.min_age"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Age = (SELECT Age FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT Name, Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(Age) FROM singer s2 WHERE s2.Singer_ID != s1.Singer_ID OR s1.Singer_ID = s2.Singer_ID)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer GROUP BY Singer_ID, Name, Song_release_year, Age HAVING Age = MIN(Age) ORDER BY Age LIMIT 1"
        },
        {
          "sql": "SELECT s.Name, s.Song_release_year FROM (SELECT Singer_ID, MIN(Age) min_age FROM singer GROUP BY Singer_ID) t JOIN singer s ON t.Singer_ID = s.Singer_ID AND s.Age = t.min_age"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer FETCH FIRST 1 ROW ONLY ORDER BY Age ASC"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s WHERE Age = (SELECT Age FROM singer s1 LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM (SELECT *, FIRST_VALUE(Age) OVER (ORDER BY Age ASC) min_age FROM singer) t WHERE Age = min_age"
        },
        {
          "sql": "SELECT s1.Name, s1.Song_release_year FROM singer s1 INNER JOIN (SELECT MIN(Age) min_age FROM singer) t ON s1.Age = t.min_age"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s WHERE 0 = (SELECT COUNT(*) FROM singer s2 WHERE s2.Age < s.Age)"
        }
      ]
    },
    {
      "id": 7,
      "question": "What are the names and release years for all the songs of the youngest singer?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Name, s.Song_release_year FROM singer s WHERE s.Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer s1 WHERE Age = (SELECT MIN(Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s WHERE s.Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age)"
        },
        {
          "sql": "SELECT Name, Song_release_year FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age = (SELECT MIN(Age) FROM singer))"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 JOIN (SELECT Singer_ID FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)) s2 ON s1.Singer_ID = s2.Singer_ID"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(Age) AS min_age FROM singer) SELECT Song_Name, Song_release_year FROM singer, youngest WHERE Age = min_age"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(Age) min_age FROM singer) SELECT s.Song_Name, s.Song_release_year FROM singer s CROSS JOIN min_age_cte m WHERE s.Age = m.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name, Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer ORDER BY Age LIMIT (SELECT COUNT(*) FROM (SELECT Singer_ID, MIN(Age) min_age FROM singer GROUP BY Singer_ID) t1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 WHERE (SELECT COUNT(*) FROM singer s2 WHERE s2.Age < s1.Age) = 0"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s WHERE s.Age = (SELECT s2.Age FROM singer s2 ORDER BY s2.Age LIMIT 1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY Age) rn FROM singer) ranked WHERE rn = 1"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = SOME (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "WITH ranked_singers AS (SELECT *, DENSE_RANK() OVER (ORDER BY Age) rnk FROM singer) SELECT Song_Name, Song_release_year FROM ranked_singers WHERE rnk = 1"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer GROUP BY Singer_ID, Song_Name, Song_release_year, Age HAVING Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s WHERE Singer_ID = (SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT s1.Song_Name, s1.Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(s2.Age) FROM singer s2 GROUP BY s2.Singer_ID)"
        }
      ]
    },
    {
      "id": 8,
      "question": "What are all distinct countries where singers above age 20 are from?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Country IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20 AND s.Country IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT * FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT DISTINCT t.Country FROM (SELECT Country, Age FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Age > 20 GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age > 20 AND s2.Country = singer.Country)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age > 20 AND s2.Country = s1.Country)"
        },
        {
          "sql": "SELECT DISTINCT u.Country FROM singer u WHERE u.Age > 20 UNION SELECT DISTINCT v.Country FROM singer v WHERE v.Age > 20"
        },
        {
          "sql": "WITH older_singers AS (SELECT DISTINCT Country FROM singer WHERE Age > 20) SELECT Country FROM older_singers"
        },
        {
          "sql": "WITH singers_over_20 AS (SELECT Country FROM singer WHERE Age > 20) SELECT DISTINCT Country FROM singers_over_20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 INTERSECT SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age IN (SELECT Age FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s WHERE 20 < (SELECT Age FROM singer s2 WHERE s2.Singer_ID = s.Singer_ID)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Singer_ID, Country FROM singer) s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = s.Singer_ID AND s2.Age > 20) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Age > 20) t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > ALL (SELECT 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > ANY (SELECT 20)"
        }
      ]
    },
    {
      "id": 9,
      "question": "What are  the different countries with singers above age 20?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT s.Country FROM singer s WHERE s.Age > 20 GROUP BY s.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Country IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, Age FROM singer) t WHERE t.Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 UNION SELECT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 21 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT singer.Country FROM singer WHERE singer.Age > 20"
        },
        {
          "sql": "SELECT t.Country FROM singer t WHERE t.Age > 20 GROUP BY t.Country HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age BETWEEN 21 AND 200 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT * FROM singer WHERE Age > 20) AS temp"
        },
        {
          "sql": "WITH older_singers AS (SELECT Country FROM singer WHERE Age > 20) SELECT DISTINCT Country FROM older_singers"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age >= 21"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MIN(Age) > 20"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MAX(Age) > 20 AND AVG(Age) > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s.Country AND s2.Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 AND Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT SUBSTRING(Country,1,100) FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 ORDER BY 1 LIMIT 1000"
        }
      ]
    },
    {
      "id": 10,
      "question": "Show all countries and the number of singers in each country.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country, (SELECT count(*) FROM singer S2 WHERE S2.Country  =  S1.Country) FROM singer S1"
        },
        {
          "sql": "SELECT Country, (SELECT count(*) FROM singer S2 WHERE S2.Country  =  S1.Country) FROM singer S1 GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country, cnt FROM singer s JOIN (SELECT Country, count(*) cnt FROM singer GROUP BY Country) c ON s.Country  =  c.Country GROUP BY s.Country, cnt"
        },
        {
          "sql": "SELECT Country, SUM(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, SUM(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer GROUP BY Country)"
        },
        {
          "sql": "WITH country_counts AS (SELECT Country, count(*) as cnt FROM singer GROUP BY Country) SELECT Country, cnt FROM country_counts"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING count(*) > 0"
        },
        {
          "sql": "SELECT Name Country, count(*) num_singers FROM singer GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "SELECT Country, count(*) OVER (PARTITION BY Country) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, count(*) cnt FROM singer GROUP BY Country) ORDER BY Country"
        },
        {
          "sql": "SELECT c.Country, count(s.Singer_ID) FROM (SELECT DISTINCT Country FROM singer) c LEFT JOIN singer s ON c.Country  =  s.Country GROUP BY c.Country"
        },
        {
          "sql": "SELECT Country, cardinality(collect(Singer_ID)) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Country IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country, (SELECT count(Singer_ID) FROM singer WHERE Country  =  outer.Country) FROM singer outer WHERE Singer_ID  =  (SELECT min(Singer_ID) FROM singer s2 WHERE s2.Country  =  outer.Country) GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(case when Age > 0 then 1 end) FROM singer GROUP BY Country"
        }
      ]
    },
    {
      "id": 11,
      "question": "How many singers are from each country?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, SUM(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country, count(*) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country, count(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING count(*) > 0"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Name IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT t.Country, count(*) FROM (SELECT DISTINCT Country FROM singer) t GROUP BY t.Country"
        },
        {
          "sql": "SELECT Country, (SELECT count(*) FROM singer s2 WHERE s2.Country = s1.Country) FROM singer s1 GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(s.Singer_ID) FROM singer s INNER JOIN singer s2 ON s.Country = s2.Country GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM (SELECT Singer_ID, Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country, cardinality(collect(Singer_ID)) FROM singer GROUP BY Country"
        },
        {
          "sql": "WITH cte AS (SELECT Country FROM singer) SELECT Country, count(*) FROM cte GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country ORDER BY count(*) DESC"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country HAVING count(*) >= 1"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer WHERE Age > 0 GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Country != '' GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country, (SELECT count(*) FROM singer s2 WHERE s2.Country = s1.Country) cnt FROM singer s1"
        }
      ]
    },
    {
      "id": 12,
      "question": "List all song names by singers above the average age.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age  > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT T1.Song_Name FROM singer AS T1 WHERE T1.Age  > (SELECT avg(T2.Age) FROM singer AS T2)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age  > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age  > ALL (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "WITH avg_age AS (SELECT avg(Age) AS avg_val FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age  > avg_val"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE Age  > (SELECT avg(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age  > avg(Age) GROUP BY Singer_ID, Name, Country, Song_Name, Song_release_year, Age, Is_male HAVING Age  > avg(Age)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT *, avg(Age) OVER() AS avg_age FROM singer) t WHERE Age  > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age  > (SELECT avg(Age) FROM singer))"
        },
        {
          "sql": "SELECT s.Song_Name FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Age  > (SELECT avg(Age) FROM singer)) t ON s.Singer_ID  = t.Singer_ID"
        },
        {
          "sql": "WITH aged_singers AS (SELECT Singer_ID FROM singer WHERE Age  > (SELECT avg(Age) FROM singer)) SELECT Song_Name FROM singer s JOIN aged_singers a ON s.Singer_ID  = a.Singer_ID"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age  > (SELECT avg(Age) FROM singer GROUP BY Singer_ID)"
        },
        {
          "sql": "SELECT Song_Name FROM singer CROSS JOIN (SELECT avg(Age) AS avg_val FROM singer) t WHERE Age  > avg_val"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age  > (SELECT avg(Age) FROM singer) AND s2.Singer_ID  = singer.Singer_ID)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age, RANK() OVER (ORDER BY Age DESC) as rnk FROM singer) t WHERE Age  > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age  > (SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age) FROM singer)"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Age) AS mean_age FROM singer) SELECT Song_Name FROM singer CROSS JOIN stats WHERE Age  > mean_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE (Age - (SELECT avg(Age) FROM singer)) > 0"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM (SELECT Song_Name, Age FROM singer WHERE Age  > (SELECT avg(Age) FROM singer)) t"
        },
        {
          "sql": "SELECT Song_Name FROM singer s WHERE s.Age  > (SELECT avg(Age) FROM singer GROUP BY Country HAVING count(*) > 0)"
        },
        {
          "sql": "WITH threshold AS (SELECT max(Age) FILTER (WHERE Age  = (SELECT avg(Age) FROM singer)) AS avg_age FROM singer) SELECT Song_Name FROM singer WHERE Age  > (SELECT avg_age FROM threshold)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID  = ANY (SELECT Singer_ID FROM singer WHERE Age  > (SELECT avg(Age) FROM singer))"
        }
      ]
    },
    {
      "id": 13,
      "question": "What are all the song names by singers who are older than average?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name FROM singer s1 WHERE s1.Age > (SELECT avg(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer s WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "WITH avg_age AS (SELECT avg(Age) AS avg_val FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age > avg_val"
        },
        {
          "sql": "SELECT Song_Name FROM singer JOIN (SELECT avg(Age) AS avg_age FROM singer) AS avg_sub ON Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ALL (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ANY (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Age, Song_Name FROM singer) AS singer_data WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT s.Song_Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s.Age > s2.Age HAVING avg(s2.Age) < s.Age)"
        },
        {
          "sql": "SELECT Song_Name FROM singer CROSS JOIN (SELECT avg(Age) AS avg_a FROM singer) AS avgs WHERE Age > avg_a"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT *, avg(Age) OVER() AS avg_age FROM singer) WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age BETWEEN (SELECT avg(Age) FROM singer)+0.0001 AND 999"
        },
        {
          "sql": "SELECT Song_Name FROM singer EXCEPT SELECT Song_Name FROM singer WHERE Age <= (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > (SELECT avg(Age) FROM singer))"
        },
        {
          "sql": "WITH aged_singers AS (SELECT Singer_ID FROM singer WHERE Age > (SELECT avg(Age) FROM singer)) SELECT Song_Name FROM singer JOIN aged_singers ON singer.Singer_ID = aged_singers.Singer_ID"
        },
        {
          "sql": "SELECT Song_Name FROM singer GROUP BY Singer_ID, Name, Country, Song_Name, Song_release_year, Age, Is_male HAVING Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE (Age - (SELECT avg(Age) FROM singer)) > 0"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age >= s1.Age AND s1.Age <= (SELECT avg(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT avg(Age) FROM (SELECT Age FROM singer) AS sub_singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age FROM singer ORDER BY Age DESC LIMIT 1000000) AS ordered_singers WHERE Age > (SELECT avg(Age) FROM singer)"
        }
      ]
    },
    {
      "id": 14,
      "question": "Show location and name for all stadiums with a capacity between 5000 and 10000.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity > 4999 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE 4999 < Capacity AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity >= 5000 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity > 4999 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity IN (SELECT Capacity FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000)"
        },
        {
          "sql": "SELECT s1.Location ,  s1.Name FROM stadium s1 WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity >= 5000 AND s2.Capacity <= 10000 AND s1.Stadium_ID = s2.Stadium_ID)"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT Location ,  Name FROM (SELECT * FROM stadium) s WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Stadium_ID"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Location"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 ORDER BY Name"
        },
        {
          "sql": "SELECT DISTINCT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT s.Location ,  s.Name FROM stadium s WHERE s.Capacity >= 5000 AND s.Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium t WHERE t.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity <= 10000 AND Capacity >= 5000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE 5000 <= Capacity AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE NOT (Capacity < 5000 OR Capacity > 10000)"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity NOT BETWEEN 4999 AND 10001 AND Capacity BETWEEN 5000 AND 10000"
        }
      ]
    },
    {
      "id": 15,
      "question": "What are the locations and names of all stations with capacity between 5000 and 10000?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity > 4999 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE 5000 <= Capacity AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity IN (SELECT Capacity FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000)"
        },
        {
          "sql": "SELECT s1.Location, s1.Name FROM stadium s1 WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity >= 5000 AND s2.Capacity <= 10000 AND s1.Capacity = s2.Capacity)"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity NOT BETWEEN 0 AND 4999 AND Capacity NOT BETWEEN 10001 AND 999999"
        },
        {
          "sql": "SELECT DISTINCT Location, Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 INTERSECT SELECT Location, Name FROM stadium WHERE Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM (SELECT * FROM stadium) WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity = ANY(VALUES(5000),(5001),(5002)) OR Capacity = ANY(VALUES(9998),(9999),(10000)) OR Capacity BETWEEN 5001 AND 9999"
        },
        {
          "sql": "SELECT Location, Name FROM stadium s WHERE 5000 <= (SELECT Capacity FROM stadium s2 WHERE s2.Stadium_ID = s.Stadium_ID) AND (SELECT Capacity FROM stadium s2 WHERE s2.Stadium_ID = s.Stadium_ID) <= 10000"
        },
        {
          "sql": "WITH valid_stadiums AS (SELECT * FROM stadium WHERE Capacity >= 5000) SELECT Location, Name FROM valid_stadiums WHERE Capacity <= 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT s1.Location, s1.Name FROM stadium s1, (SELECT * FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000) s2 WHERE s1.Stadium_ID = s2.Stadium_ID"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity BETWEEN (SELECT MIN(Capacity) FROM stadium WHERE Capacity >= 5000) AND (SELECT MAX(Capacity) FROM stadium WHERE Capacity <= 10000)"
        },
        {
          "sql": "SELECT Location, Name FROM stadium EXCEPT SELECT Location, Name FROM stadium WHERE Capacity < 5000 OR Capacity > 10000"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= ALL(VALUES(5000)) AND Capacity <= ALL(VALUES(10000))"
        },
        {
          "sql": "WITH capacity_range AS (SELECT 5000 AS min_cap, 10000 AS max_cap) SELECT s.Location, s.Name FROM stadium s, capacity_range WHERE s.Capacity >= capacity_range.min_cap AND s.Capacity <= capacity_range.max_cap"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE (Capacity - 5000) * (10000 - Capacity) >= 0"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE NOT (Capacity < 5000 OR Capacity > 10000)"
        },
        {
          "sql": "SELECT Location, Name FROM stadium WHERE Capacity >= 5000 AND NOT Capacity > 10000"
        }
      ]
    },
    {
      "id": 16,
      "question": "What is the maximum capacity and the average of all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT max(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(stadium.Capacity), avg(stadium.Capacity) FROM stadium"
        },
        {
          "sql": "SELECT max(s.Capacity), avg(s.Capacity) FROM stadium AS s"
        },
        {
          "sql": "SELECT max(s.Capacity), avg(s.Capacity) FROM stadium s"
        },
        {
          "sql": "SELECT Capacity, Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1 UNION ALL SELECT avg(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT s1.Capacity, s2.avg_cap FROM stadium s1, (SELECT avg(Capacity) AS avg_cap FROM stadium) s2"
        },
        {
          "sql": "SELECT max_cap, avg_cap FROM (SELECT max(Capacity) AS max_cap FROM stadium) m CROSS JOIN (SELECT avg(Capacity) AS avg_cap FROM stadium) a"
        },
        {
          "sql": "SELECT max_cap, avg_cap FROM (SELECT Capacity AS max_cap FROM stadium ORDER BY Capacity DESC LIMIT 1) m CROSS JOIN (SELECT avg(Capacity) AS avg_cap FROM stadium) a"
        },
        {
          "sql": "SELECT max_value, avg_value FROM (SELECT max(Capacity) AS max_value FROM stadium UNION ALL SELECT avg(Capacity) AS avg_value FROM stadium)"
        },
        {
          "sql": "WITH max_stats AS (SELECT max(Capacity) AS max_c FROM stadium), avg_stats AS (SELECT avg(Capacity) AS avg_c FROM stadium) SELECT max_c, avg_c FROM max_stats, avg_stats"
        },
        {
          "sql": "WITH stats AS (SELECT max(Capacity) AS m_cap, avg(Capacity) AS a_cap FROM stadium) SELECT m_cap, a_cap FROM stats"
        },
        {
          "sql": "SELECT max_c, avg_c FROM (SELECT max(Capacity) AS max_c, avg(Capacity) AS avg_c FROM stadium) AS all_stats"
        },
        {
          "sql": "SELECT m.Capacity, a.avg_c FROM stadium m JOIN (SELECT avg(Capacity) AS avg_c FROM stadium) a ON 1=1 ORDER BY m.Capacity DESC LIMIT 1"
        },
        {
          "sql": "SELECT Capacity, (SELECT avg(Capacity) FROM stadium) FROM stadium WHERE Capacity = (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT (SELECT max(Capacity) FROM stadium), (SELECT avg(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT max(Capacity) OVER(), avg(Capacity) OVER() FROM stadium LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT max(Capacity) OVER(PARTITION BY 1), avg(Capacity) OVER(PARTITION BY 1) FROM stadium"
        },
        {
          "sql": "SELECT max_cap, avg_cap FROM (VALUES ((SELECT max(Capacity) FROM stadium)), ((SELECT avg(Capacity) FROM stadium))) AS t(max_cap, avg_cap)"
        },
        {
          "sql": "SELECT max(Capacity), (SELECT avg(Capacity) FROM stadium) FROM stadium WHERE Stadium_ID = (SELECT min(Stadium_ID) FROM stadium)"
        },
        {
          "sql": "SELECT s.Capacity, t.avg_c FROM (SELECT stadium.Stadium_ID FROM stadium ORDER BY stadium.Capacity DESC LIMIT 1) s JOIN (SELECT avg(Capacity) AS avg_c FROM stadium) t ON s.Stadium_ID = (SELECT min(Stadium_ID) FROM stadium WHERE Capacity = (SELECT max(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT greatest(Capacity), avg(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT coalesce(max(Capacity), 0), coalesce(avg(Capacity), 0) FROM stadium"
        },
        {
          "sql": "SELECT max(Capacity), avg(cast(Capacity AS numeric)) FROM stadium"
        }
      ]
    },
    {
      "id": 17,
      "question": "What is the average and maximum capacities for all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT AVG(Capacity), MAX(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT avg(s.C capacity), max(s.Capacity) FROM stadium s"
        },
        {
          "sql": "SELECT AVG(s.Capacity), MAX(s.Capacity) FROM stadium AS s"
        },
        {
          "sql": "SELECT avg(Capacity) AS average_capacity, max(Capacity) AS maximum_capacity FROM stadium"
        },
        {
          "sql": "SELECT AVG(Capacity) average, MAX(Capacity) maximum FROM stadium"
        },
        {
          "sql": "SELECT (SELECT avg(Capacity) FROM stadium), (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT avg_capacity, max_capacity FROM (SELECT avg(Capacity) avg_capacity, max(Capacity) max_capacity FROM stadium) t"
        },
        {
          "sql": "WITH stats AS (SELECT avg(Capacity) average, max(Capacity) maximum FROM stadium) SELECT average, maximum FROM stats"
        },
        {
          "sql": "SELECT average, maximum FROM (SELECT Capacity, avg(Capacity) OVER() average, max(Capacity) OVER() maximum FROM stadium) s LIMIT 1"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium WHERE Stadium_ID > 0"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium WHERE Capacity IS NOT NULL"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium HAVING avg(Capacity) IS NOT NULL"
        },
        {
          "sql": "SELECT a.average, m.maximum FROM (SELECT avg(Capacity) average FROM stadium) a CROSS JOIN (SELECT max(Capacity) maximum FROM stadium) m"
        },
        {
          "sql": "SELECT (SELECT avg(Capacity) FROM stadium WHERE Location IS NOT NULL), (SELECT max(Capacity) FROM stadium WHERE Location IS NOT NULL)"
        },
        {
          "sql": "SELECT avg(s1.Capacity), max(s1.Capacity) FROM stadium s1, stadium s2"
        },
        {
          "sql": "SELECT s1.avg_cap, s2.max_cap FROM (SELECT avg(Capacity) avg_cap FROM stadium) s1, (SELECT max(Capacity) max_cap FROM stadium) s2"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Capacity) avg_cap, max(Capacity) max_cap FROM stadium) t"
        },
        {
          "sql": "SELECT column1, column2 FROM crosstab('SELECT ''avg'' AS type, avg(Capacity)::text FROM stadium UNION ALL SELECT ''max'', max(Capacity)::text FROM stadium')"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium GROUP BY ()"
        },
        {
          "sql": "WITH RECURSIVE stats(n, avg_val, max_val) AS (SELECT 1, avg(Capacity), max(Capacity) FROM stadium UNION ALL SELECT 2, avg(Capacity), max(Capacity) FROM stadium) SELECT avg_val, max_val FROM stats LIMIT 1"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium WHERE 1=1 ORDER BY 1 LIMIT 1"
        }
      ]
    },
    {
      "id": 18,
      "question": "What is the name and capacity for the stadium with highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE s1.Average = (SELECT MAX(s2.Average) FROM stadium s2)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s ORDER BY s.Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE s.Average = (SELECT MAX(Average) FROM stadium s2)"
        },
        {
          "sql": "SELECT MAX(Name), MAX(Capacity) FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "WITH max_avg AS (SELECT MAX(Average) AS max_val FROM stadium) SELECT Name, Capacity FROM stadium, max_avg WHERE Average = max_avg.max_val"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average > s.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average IN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT MAX(Average) AS max_avg FROM stadium) m ON s.Average = m.max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium GROUP BY Name, Capacity, Average HAVING Average = MAX(Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, Average, RANK() OVER (ORDER BY Average DESC) AS rnk FROM stadium) WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, Average, ROW_NUMBER() OVER (ORDER BY Average DESC) AS rn FROM stadium) WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, DENSE_RANK() OVER (ORDER BY Average DESC) AS drnk FROM stadium) WHERE drnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, MAX(Average) OVER () AS max_avg FROM stadium) WHERE Average = max_avg"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1, (SELECT MAX(Average) max_a FROM stadium) s2 WHERE s1.Average = s2.max_a"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium s2 ORDER BY s2.Average DESC LIMIT 1)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, ROW_NUMBER() OVER (ORDER BY Average DESC) rn FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rn = 1"
        }
      ]
    },
    {
      "id": 19,
      "question": "What is the name and capacity for the stadium with the highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s ORDER BY s.Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT TOP 1 Name, Capacity FROM stadium ORDER BY Average DESC"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "WITH max_avg AS (SELECT MAX(Average) AS max_val FROM stadium) SELECT s.Name, s.Capacity FROM stadium s, max_avg WHERE s.Average = max_avg.max_val"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average IN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(s2.Average) FROM stadium s2)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 JOIN (SELECT MAX(Average) AS max_avg FROM stadium) s2 ON s1.Average = s2.max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium GROUP BY Name, Capacity, Average HAVING Average = MAX(Average) OVER ()"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, RANK() OVER (ORDER BY Average DESC) AS rnk FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rnk = 1"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, DENSE_RANK() OVER (ORDER BY Average DESC) AS rnk FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s CROSS JOIN (SELECT MAX(Average) max_avg FROM stadium) m WHERE s.Average = m.max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, MAX(Average) OVER () AS max_avg FROM stadium) t WHERE Average = max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY Average DESC) rn FROM stadium) WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Average = (SELECT MAX(Average) FROM stadium t WHERE t.Stadium_ID != s.Stadium_ID OR t.Average <= s.Average)"
        },
        {
          "sql": "SELECT FIRST_VALUE(Name) OVER (ORDER BY Average DESC), FIRST_VALUE(Capacity) OVER (ORDER BY Average DESC) FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        }
      ]
    },
    {
      "id": 20,
      "question": "How many concerts are there in year 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year=2014 OR Year=2015"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE Year=2014 OR Year=2015"
        },
        {
          "sql": "SELECT COUNT(concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year >= 2014 AND Year <= 2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Year IN (2014,2015)) AS T1"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM concert WHERE Year=2014 OR Year=2015"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert.concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT 1 FROM concert WHERE Year=2014 OR Year=2015) AS T1"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert AS T1 WHERE T1.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert AS T1 WHERE T1.Year=2014 OR T1.Year=2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year=2014 UNION ALL SELECT COUNT(*) FROM concert WHERE Year=2015"
        },
        {
          "sql": "(SELECT COUNT(*) FROM concert WHERE Year=2014) + (SELECT COUNT(*) FROM concert WHERE Year=2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert CROSS JOIN (SELECT 1 AS dummy WHERE 1=1) AS T1 WHERE concert.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(sic.concert_ID) FROM singer_in_concert AS sic JOIN concert AS c ON sic.concert_ID=c.concert_ID WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert AS c JOIN stadium AS s ON c.Stadium_ID=s.Stadium_ID WHERE c.Year=2014 OR c.Year=2015"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert AS c LEFT JOIN singer_in_concert AS sic ON c.concert_ID=sic.concert_ID WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS (SELECT 1 FROM (VALUES (2014),(2015)) AS years(y) WHERE concert.Year=years.y)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE Year IN (SELECT 2014 UNION SELECT 2015)"
        }
      ]
    },
    {
      "id": 21,
      "question": "How many concerts occurred in 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year=2014 OR Year=2015"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year >= 2014 AND Year <= 2015"
        },
        {
          "sql": "SELECT count(DISTINCT concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(Theme) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM concert WHERE Year=2014 OR Year=2015) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT concert_ID FROM concert WHERE Year IN (2014,2015)) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT concert_ID) FROM (SELECT * FROM concert WHERE Year=2014 OR Year=2015) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 WHERE T1.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT sum(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year=2014 UNION ALL SELECT count(*) FROM concert WHERE Year=2015"
        },
        {
          "sql": "SELECT sum(cnt) FROM (SELECT count(*) AS cnt FROM concert WHERE Year=2014 UNION ALL SELECT count(*) AS cnt FROM concert WHERE Year=2015) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM concert CROSS JOIN (SELECT 1 AS x WHERE 1=1) AS T2 WHERE concert.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert.concert_ID) FROM concert INNER JOIN stadium AS T1 ON concert.Stadium_ID = T1.Stadium_ID WHERE concert.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert LEFT JOIN singer_in_concert AS T1 ON concert.concert_ID = T1.concert_ID WHERE concert.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(DISTINCT T1.concert_ID) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID = T2.Stadium_ID WHERE T1.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Year FROM concert WHERE Year IN (2014,2015) GROUP BY Year) AS T1"
        },
        {
          "sql": "SELECT count(c.concert_ID) FROM concert c WHERE EXISTS (SELECT 1 FROM (VALUES (2014),(2015)) AS years(y) WHERE c.Year = y.y)"
        }
      ]
    },
    {
      "id": 22,
      "question": "Show the stadium name and the number of concerts in each stadium.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , Name"
        },
        {
          "sql": "SELECT Name, count(1) FROM stadium JOIN concert USING(Stadium_ID) GROUP BY Stadium_ID , Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s INNER JOIN concert c USING(Stadium_ID) GROUP BY s.Stadium_ID , s.Name"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ) FROM stadium s"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(concert_ID) FROM concert WHERE Stadium_ID  =  s.Stadium_ID ) FROM stadium s"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE EXISTS(SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID ) AND 0< (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID )"
        },
        {
          "sql": "SELECT s.Name, cnt FROM stadium s JOIN (SELECT Stadium_ID , count(concert_ID) cnt FROM concert GROUP BY Stadium_ID ) c ON s.Stadium_ID  =  c.Stadium_ID "
        },
        {
          "sql": "SELECT s.Name, c.cnt FROM stadium s INNER JOIN (SELECT Stadium_ID , count(*) cnt FROM concert GROUP BY Stadium_ID ) c ON s.Stadium_ID  =  c.Stadium_ID "
        },
        {
          "sql": "SELECT Name, num_concerts FROM stadium s, (SELECT Stadium_ID , count(concert_ID) num_concerts FROM concert GROUP BY Stadium_ID ) c WHERE s.Stadium_ID  =  c.Stadium_ID "
        },
        {
          "sql": "SELECT DISTINCT s.Name, count(c.concert_ID) OVER(PARTITION BY s.Stadium_ID ) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID "
        },
        {
          "sql": "WITH concert_count AS (SELECT Stadium_ID , count(*) AS concert_count FROM concert GROUP BY Stadium_ID ) SELECT s.Name, cc.concert_count FROM stadium s JOIN concert_count cc ON s.Stadium_ID  =  cc.Stadium_ID "
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID , Name HAVING count(concert_ID)>0"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s LEFT OUTER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID , s.Name HAVING count(c.concert_ID)>0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID  IN (SELECT Stadium_ID  FROM concert GROUP BY Stadium_ID ) ORDER BY Name"
        },
        {
          "sql": "SELECT Name, (SELECT count(concert_ID) FROM concert WHERE Stadium_ID  =  stadium.Stadium_ID  GROUP BY Stadium_ID ) FROM stadium WHERE Stadium_ID  IN (SELECT Stadium_ID  FROM concert)"
        },
        {
          "sql": "SELECT s.Name, COALESCE(c.concert_cnt,0) FROM stadium s LEFT JOIN (SELECT Stadium_ID , count(concert_ID) concert_cnt FROM concert GROUP BY Stadium_ID ) c ON s.Stadium_ID  =  c.Stadium_ID  WHERE COALESCE(c.concert_cnt,0)>0"
        },
        {
          "sql": "SELECT Name, sum(CASE WHEN concert_ID  IS NOT NULL THEN 1 ELSE 0 END) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID  GROUP BY Stadium_ID , Name HAVING sum(CASE WHEN concert_ID  IS NOT NULL THEN 1 ELSE 0 END)>0"
        },
        {
          "sql": "SELECT s1.Name, (SELECT count(*) FROM concert c2 WHERE c2.Stadium_ID  =  s1.Stadium_ID ) FROM stadium s1 WHERE s1.Stadium_ID  IN (SELECT c.Stadium_ID  FROM concert c GROUP BY c.Stadium_ID )"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID  GROUP BY s.Stadium_ID , s.Name ORDER BY Name"
        },
        {
          "sql": "SELECT DISTINCT Name, count(DISTINCT concert_ID) FROM stadium JOIN concert ON Stadium_ID  =  Stadium_ID  GROUP BY Name ORDER BY Name LIMIT 18446744073709551615"
        }
      ]
    },
    {
      "id": 23,
      "question": "For each stadium, how many concerts play there?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT Stadium_ID, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Stadium_ID"
        },
        {
          "sql": "SELECT Capacity, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Capacity"
        },
        {
          "sql": "SELECT Location, count(concert_Name) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Location, count(c.concert_ID) FROM stadium AS s LEFT JOIN concert AS c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Location"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium AS s LEFT JOIN concert AS c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT Location, (SELECT count(*) FROM concert WHERE concert.Stadium_ID  =  stadium.Stadium_ID) FROM stadium"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM concert WHERE concert.Stadium_ID  =  stadium.Stadium_ID) FROM stadium"
        },
        {
          "sql": "SELECT s1.Location, (SELECT count(*) FROM concert AS c2 WHERE c2.Stadium_ID  =  s1.Stadium_ID) FROM stadium AS s1"
        },
        {
          "sql": "SELECT Location FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location HAVING count(concert_ID) > 0"
        },
        {
          "sql": "SELECT Name FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name ORDER BY count(concert_ID) DESC"
        },
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium LEFT JOIN (SELECT * FROM concert) AS sub ON stadium.Stadium_ID  =  sub.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT s.Location, count(c.concert_ID) FROM stadium s, concert c WHERE s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Location"
        },
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT Location, count(DISTINCT concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Stadium_ID, count(DISTINCT concert_Name) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Stadium_ID"
        },
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Location, s.Name, s.Capacity"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name, s.Location, s.Capacity ORDER BY count(concert_ID)"
        }
      ]
    },
    {
      "id": 24,
      "question": "Show the stadium name and capacity with most number of concerts in year 2014 or after.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID WHERE cc.cnt = (SELECT MAX(cnt) FROM concert_counts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) = (SELECT MAX(cn) FROM (SELECT COUNT(*) AS cn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) AS num_concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ranked ORDER BY num_concerts DESC LIMIT 1)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, COUNT(*) AS concert_count, RANK() OVER (ORDER BY COUNT(*) DESC) rnk FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_stadiums rs ON s.Stadium_ID = rs.Stadium_ID WHERE rs.rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert c WHERE Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t))"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Capacity FROM stadium s, concert c WHERE s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "WITH max_concerts AS (SELECT MAX(concert_count) AS max_cnt FROM (SELECT COUNT(*) AS concert_count FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) counts) SELECT Name, Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) = (SELECT max_cnt FROM max_concerts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ranked ON s.Stadium_ID = ranked.Stadium_ID WHERE rn = 1"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM concert c1, stadium s2 WHERE c1.Stadium_ID = s2.Stadium_ID AND c1.Year >= 2014 GROUP BY s2.Stadium_ID HAVING COUNT(c1.concert_ID) > (SELECT COUNT(c2.concert_ID) FROM concert c2 WHERE c2.Stadium_ID = s1.Stadium_ID AND c2.Year >= 2014)) AND EXISTS (SELECT 1 FROM concert c3 WHERE c3.Stadium_ID = s1.Stadium_ID AND c3.Year >= 2014)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year >= 2014 GROUP BY c.Stadium_ID ORDER BY COUNT(*) DESC FETCH FIRST 1 ROW ONLY)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) AS concert_cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity) ranked WHERE concert_cnt = (SELECT MAX(concert_cnt) FROM (SELECT COUNT(c.concert_ID) AS concert_cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014 GROUP BY s.Stadium_ID) t)"
        },
        {
          "sql": "WITH stadium_concerts AS (SELECT Stadium_ID, COUNT(*) AS concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID), top_stadium AS (SELECT Stadium_ID FROM stadium_concerts ORDER BY concerts DESC LIMIT 1) SELECT s.Name, s.Capacity FROM stadium s, top_stadium t WHERE s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s CROSS JOIN (SELECT MAX(cnt) AS max_concerts FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) c) m WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) = m.max_concerts"
        },
        {
          "sql": "SELECT FIRST_VALUE(Name) OVER (ORDER BY cnt DESC), FIRST_VALUE(Capacity) OVER (ORDER BY cnt DESC) FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) cnt FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "WITH RECURSIVE stadium_ranking AS (SELECT Stadium_ID, COUNT(*) AS cnt, 1 as rn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID UNION ALL SELECT sr.Stadium_ID, sr.cnt, sr.rn + 1 FROM stadium_ranking sr WHERE sr.rn = 1) SELECT s.Name, s.Capacity FROM stadium s JOIN stadium_ranking sr ON s.Stadium_ID = sr.Stadium_ID WHERE sr.rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) AS concerts, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rnk FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ranked WHERE rnk = 1)"
        }
      ]
    },
    {
      "id": 25,
      "question": "What is the name and capacity of the stadium with the most concerts after 2013 ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) as cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) as c FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY c DESC LIMIT 1) tmp)"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 AND s.Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID = (SELECT Stadium_ID FROM concert c WHERE c.Year > 2013 GROUP BY c.Stadium_ID ORDER BY COUNT(c.concert_ID) DESC FETCH FIRST 1 ROW ONLY)"
        },
        {
          "sql": "WITH max_concerts AS (SELECT Stadium_ID, COUNT(*) as max_count FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) SELECT s.Name, s.Capacity FROM stadium s JOIN max_concerts mc ON s.Stadium_ID = mc.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT MAX(Stadium_ID) FROM (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) t)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year > 2013 GROUP BY c2.Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) as cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t))"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, COUNT(*) as concert_count, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) as rn FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_stadiums rs ON s.Stadium_ID = rs.Stadium_ID WHERE rs.rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY SUM(1) OVER (PARTITION BY Stadium_ID) DESC LIMIT 1) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = SOME (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium s INNER JOIN (SELECT c.Stadium_ID FROM concert c WHERE c.Year > 2013 GROUP BY c.Stadium_ID HAVING COUNT(*) >= (SELECT MAX(c2.cnt) FROM (SELECT COUNT(*) cnt FROM concert c2 WHERE c2.Year > 2013 GROUP BY c2.Stadium_ID) m)) m ON s.Stadium_ID = m.Stadium_ID"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) as cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID), max_count AS (SELECT MAX(cnt) as mc FROM concert_counts) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID JOIN max_count mc2 ON cc.cnt = mc2.mc"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year > 2013 GROUP BY c.Stadium_ID ORDER BY COUNT(c.concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE EXISTS (SELECT 1 FROM (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) top_stadium WHERE top_stadium.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) as concert_cnt FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY concert_cnt DESC LIMIT 1)"
        },
        {
          "sql": "WITH post2013_concerts AS (SELECT * FROM concert WHERE Year > 2013) SELECT s.Name, s.Capacity FROM stadium s JOIN post2013_concerts c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN LATERAL (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT FIRST_VALUE(Name) OVER (ORDER BY cnt DESC), FIRST_VALUE(Capacity) OVER (ORDER BY cnt DESC) FROM (SELECT s.Name, s.Capacity, COUNT(*) as cnt FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity) ranked"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM (SELECT Stadium_ID, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) rnk FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) WHERE rnk = 1)"
        }
      ]
    },
    {
      "id": 26,
      "question": "Which year has most number of concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c GROUP BY c.Year ORDER BY count(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID) = (SELECT max(cnt) FROM (SELECT count(concert_ID) cnt FROM concert GROUP BY Year) t)"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) >= ALL (SELECT count(concert_ID) FROM concert GROUP BY Year)"
        },
        {
          "sql": "SELECT c.Year FROM concert c WHERE c.concert_ID IN (SELECT concert_ID FROM concert GROUP BY Year HAVING count(concert_ID) = (SELECT max(t.cnt) FROM (SELECT count(concert_ID) cnt FROM concert GROUP BY Year) t)) GROUP BY c.Year"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(concert_ID) as cnt FROM concert GROUP BY Year) t WHERE cnt = (SELECT max(cnt) FROM (SELECT count(concert_ID) cnt FROM concert GROUP BY Year) s)"
        },
        {
          "sql": "WITH cnts AS (SELECT Year, count(concert_ID) cnt FROM concert GROUP BY Year) SELECT Year FROM cnts WHERE cnt = (SELECT max(cnt) FROM cnts)"
        },
        {
          "sql": "WITH ranked AS (SELECT Year, count(concert_ID) cnt, ROW_NUMBER() OVER (ORDER BY count(concert_ID) DESC) rn FROM concert GROUP BY Year) SELECT Year FROM ranked WHERE rn = 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY sum(1) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, row_number() OVER (ORDER BY count(concert_ID) DESC) rn FROM concert GROUP BY Year) WHERE rn = 1"
        },
        {
          "sql": "SELECT min(Year) FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, count(concert_ID) as total_concerts FROM concert GROUP BY Year) ORDER BY total_concerts DESC LIMIT 1"
        },
        {
          "sql": "SELECT c1.Year FROM concert c1 JOIN (SELECT Year, count(concert_ID) cnt FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1) c2 ON c1.Year = c2.Year GROUP BY c1.Year"
        },
        {
          "sql": "SELECT DISTINCT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT count(c2.concert_ID) FROM concert c2 WHERE c2.Year = c1.Year) = (SELECT max(cnt) FROM (SELECT count(concert_ID) cnt FROM concert GROUP BY Year) t) GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, DENSE_RANK() OVER (ORDER BY count(concert_ID) DESC) rnk FROM concert GROUP BY Year) WHERE rnk = 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID) = (SELECT count(*) FROM concert c2 WHERE c2.Year = concert.Year GROUP BY c2.Year ORDER BY count(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year FROM concert GROUP BY Year ORDER BY count(DISTINCT concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Year, COUNT(concert_ID) OVER (PARTITION BY Year) cnt FROM concert) SELECT DISTINCT Year FROM concert_counts ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID) >= (SELECT count(concert_ID) FROM concert c2 GROUP BY c2.Year ORDER BY count(concert_ID) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT c.Year FROM concert c INNER JOIN (SELECT Year, max(count(concert_ID)) OVER () as max_cnt FROM concert GROUP BY Year) m ON c.Year = m.Year AND count(*) OVER (PARTITION BY c.Year) = m.max_cnt GROUP BY c.Year"
        }
      ]
    },
    {
      "id": 27,
      "question": "What is the year that had the most concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(concert_Name) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c GROUP BY c.Year ORDER BY COUNT(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(*) as cnt FROM concert GROUP BY Year) t ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(concert_ID) FROM concert GROUP BY Year) t ORDER BY COUNT(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT MAX(Year) KEEP (DENSE_RANK FIRST ORDER BY cnt DESC) FROM (SELECT Year, COUNT(*) cnt FROM concert GROUP BY Year)"
        },
        {
          "sql": "SELECT FIRST_VALUE(Year) OVER (ORDER BY cnt DESC) as Year FROM (SELECT Year, COUNT(*) cnt FROM concert GROUP BY Year)"
        },
        {
          "sql": "WITH year_counts AS (SELECT Year, COUNT(*) cnt FROM concert GROUP BY Year) SELECT Year FROM year_counts ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "WITH c AS (SELECT Year, COUNT(concert_ID) as n FROM concert GROUP BY Year) SELECT Year FROM c ORDER BY n DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert GROUP BY Year) t)"
        },
        {
          "sql": "SELECT y.Year FROM (SELECT Year, COUNT(*) cnt FROM concert GROUP BY Year) y WHERE y.cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT COUNT(*) FROM concert c2 WHERE c2.Year = c1.Year) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert GROUP BY Year)) GROUP BY Year"
        },
        {
          "sql": "SELECT DISTINCT Year FROM concert ORDER BY (SELECT COUNT(*) FROM concert c2 WHERE c2.Year = concert.Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY SUM(1) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY SUM(CASE WHEN concert_ID IS NOT NULL THEN 1 ELSE 0 END) DESC LIMIT 1"
        },
        {
          "sql": "SELECT con.Year FROM concert con JOIN (SELECT Year, COUNT(*) rnk FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1) top_year ON con.Year = top_year.Year GROUP BY con.Year"
        },
        {
          "sql": "SELECT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1) GROUP BY Year"
        },
        {
          "sql": "SELECT y FROM (SELECT Year y, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) rn FROM concert GROUP BY Year) WHERE rn = 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC FETCH FIRST 1 ROW ONLY"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(*) OVER (PARTITION BY Year) cnt FROM concert) GROUP BY Year, cnt ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert c CROSS JOIN (SELECT COUNT(*) mx FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1) m WHERE (SELECT COUNT(*) FROM concert WHERE Year = c.Year) = m.mx GROUP BY Year"
        }
      ]
    },
    {
      "id": 28,
      "question": "Show the stadium names without any concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE concert.Stadium_ID = stadium.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, s.Name HAVING COUNT(c.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID > ALL (SELECT MAX(c.Stadium_ID) FROM concert c GROUP BY c.Stadium_ID) OR Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL UNION SELECT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT ALL SELECT DISTINCT s.Name FROM stadium s, concert c WHERE s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT COALESCE(Stadium_ID, 0) FROM concert)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium s WHERE NOT EXISTS (SELECT NULL FROM concert WHERE Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(c.concert_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID))"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM concert c JOIN stadium s2 ON c.Stadium_ID = s2.Stadium_ID WHERE s1.Stadium_ID = s2.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s CROSS JOIN (SELECT 1 i UNION SELECT 2) t LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING COUNT(*) > 0)"
        }
      ]
    },
    {
      "id": 29,
      "question": "What are the names of the stadiums without any concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = stadium.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT COALESCE(MAX(Stadium_ID),0) FROM concert WHERE Stadium_ID IS NOT NULL) OR Stadium_ID < ALL (SELECT COALESCE(MIN(Stadium_ID),999999) FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium GROUP BY Stadium_ID, Name HAVING SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM concert) THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert UNION SELECT NULL WHERE 1=0)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID GROUP BY s.Stadium_ID, s.Name HAVING COUNT(c.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 AS x WHERE NOT EXISTS (SELECT 1 FROM concert)) t WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE 1=ALL(SELECT CASE WHEN Stadium_ID = s.Stadium_ID THEN 0 ELSE 1 END FROM concert c CROSS JOIN stadium s)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) t WHERE t.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "WITH concert_stadiums AS (SELECT DISTINCT Stadium_ID FROM concert) SELECT Name FROM stadium LEFT JOIN concert_stadiums cs ON stadium.Stadium_ID = cs.Stadium_ID WHERE cs.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) t ON s.Stadium_ID = t.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT COALESCE(Stadium_ID, -1) FROM concert) AND Stadium_ID IS NOT NULL"
        }
      ]
    },
    {
      "id": 30,
      "question": "Show countries where a singer above age 40 and a singer below 30 are from.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 WHERE s1.Age > 40 AND EXISTS(SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 40 AND s.Country IN (SELECT s2.Country FROM singer s2 WHERE s2.Age < 30)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 INTERSECT SELECT Country FROM singer WHERE Age < 30"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 JOIN singer s2 ON s1.Country = s2.Country WHERE s1.Age > 40 AND s2.Age < 30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 40 UNION SELECT DISTINCT Country FROM singer WHERE Age < 30"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s INNER JOIN (SELECT Country FROM singer WHERE Age < 30) s2 ON s.Country = s2.Country WHERE s.Age > 40"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE Age > 40 AND Country = (SELECT Country FROM singer WHERE Age < 30 LIMIT 1)"
        },
        {
          "sql": "WITH old_singers AS (SELECT DISTINCT Country FROM singer WHERE Age > 40), young_singers AS (SELECT DISTINCT Country FROM singer WHERE Age < 30) SELECT Country FROM old_singers INTERSECT SELECT Country FROM young_singers"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 WHERE EXISTS(SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30) AND s1.Age > 40"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, MAX(Age) as max_age, MIN(Age) as min_age FROM singer GROUP BY Country) t WHERE max_age > 40 AND min_age < 30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age IN (SELECT Age FROM singer WHERE Age > 40 INTERSECT SELECT Age FROM singer WHERE Age < 30)"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 WHERE s1.Age > 40 AND s1.Country IN (SELECT s2.Country FROM singer s2 WHERE s2.Age < 30 GROUP BY s2.Country)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer GROUP BY Country HAVING MAX(CASE WHEN Age > 40 THEN 1 END) = 1 AND MAX(CASE WHEN Age < 30 THEN 1 END) = 1"
        },
        {
          "sql": "SELECT Country FROM singer s1 WHERE Age > 40 AND 30 > (SELECT MIN(Age) FROM singer s2 WHERE s2.Country = s1.Country)"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE Age > 40 AND 40 < (SELECT MAX(Age) FROM singer s2 WHERE s2.Country = s.Country)"
        },
        {
          "sql": "SELECT t.Country FROM (SELECT Country, COUNT(CASE WHEN Age > 40 THEN 1 END) as old_count, COUNT(CASE WHEN Age < 30 THEN 1 END) as young_count FROM singer GROUP BY Country) t WHERE t.old_count > 0 AND t.young_count > 0"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1, singer s2 WHERE s1.Country = s2.Country AND s1.Age > 40 AND s2.Age < 30"
        },
        {
          "sql": "WITH countries_old AS (SELECT Country FROM singer WHERE Age > 40), countries_young AS (SELECT Country FROM singer WHERE Age < 30) SELECT co.Country FROM countries_old co INNER JOIN countries_young cy ON co.Country = cy.Country"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 QUALIFY COUNT(*) OVER (PARTITION BY Country) > 0 AND MIN(Age) OVER (PARTITION BY Country) < 30"
        },
        {
          "sql": "SELECT DISTINCT LEFT(s1.Country,100) FROM singer s1 WHERE s1.Age > 40 AND EXISTS(SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country FROM singer WHERE Age > 40 UNION ALL SELECT Country FROM singer WHERE Age < 30) t GROUP BY Country HAVING COUNT(DISTINCT CASE WHEN Age > 40 THEN Age END) > 0 AND COUNT(DISTINCT CASE WHEN Age < 30 THEN Age END) > 0"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 WHERE s1.Age > 40 AND (SELECT COUNT(*) FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age < 30) > 0"
        }
      ]
    },
    {
      "id": 31,
      "question": "Show names for all stadiums except for stadiums having a concert in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT EXISTS (SELECT 1 FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT Stadium_ID FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM (SELECT s.*, CASE WHEN c.Stadium_ID IS NULL THEN 1 ELSE 0 END as has_concert FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014) t WHERE has_concert = 1"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (Stadium_ID, 2014) NOT IN (SELECT Stadium_ID, Year FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT 0)"
        },
        {
          "sql": "WITH concert2014 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) SELECT Name FROM stadium s LEFT JOIN concert2014 c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM (SELECT Stadium_ID FROM concert WHERE Year = 2014) t)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert WHERE Year = 2014) t WHERE t.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Location IN (SELECT Location FROM stadium EXCEPT SELECT s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014) AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT COALESCE(Stadium_ID, 0) FROM concert WHERE Year = 2014) AND Stadium_ID != 0"
        }
      ]
    },
    {
      "id": 32,
      "question": "What are the names of all stadiums that did not have a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE concert.Stadium_ID = stadium.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID <> ALL (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE (c.Year = 2014 OR c.Year IS NULL) AND c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > 0 AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT EXISTS (SELECT c.Stadium_ID FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014 GROUP BY c.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Location IS NOT NULL AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT (SELECT DISTINCT s.Name FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE s1.Stadium_ID NOT IN (SELECT s2.Stadium_ID FROM stadium s2, concert c WHERE s2.Stadium_ID = c.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT (Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Capacity > 0 AND Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium LEFT JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID AND concert.Year = 2014 WHERE concert.concert_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 AND Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 i WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Year = 2014 AND c.Stadium_ID = s.Stadium_ID)) t"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE 1=1 AND NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s WHERE s.Stadium_ID <> ANY (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        }
      ]
    },
    {
      "id": 33,
      "question": "Show the name and theme for all concerts and the number of singers in each concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(*) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme, sic.Singer_ID ORDER BY c.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(sic.Singer_ID) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(*) FROM singer_in_concert sic2 WHERE sic2.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers_count FROM concert c JOIN (SELECT concert_ID, COUNT(Singer_ID) singers_count FROM singer_in_concert GROUP BY concert_ID) sc ON c.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, sc.singers_count FROM concert c INNER JOIN (SELECT concert_ID, COUNT(Singer_ID) singers_count FROM singer_in_concert GROUP BY concert_ID) sc ON c.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "SELECT Name, Theme, singer_cnt FROM (SELECT concert_ID, concert_Name AS Name, Theme FROM concert) c JOIN (SELECT concert_ID, COUNT(Singer_ID) singer_cnt FROM singer_in_concert GROUP BY concert_ID) s ON c.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "WITH singer_count AS (SELECT concert_ID, COUNT(Singer_ID) cnt FROM singer_in_concert GROUP BY concert_ID) SELECT c.concert_Name, c.Theme, sc.cnt FROM concert c JOIN singer_count sc ON c.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "WITH cnt AS (SELECT concert_ID, COUNT(*) cnt FROM singer_in_concert GROUP BY concert_ID) SELECT concert_Name, Theme, cnt FROM concert JOIN cnt ON concert.concert_ID  =  cnt.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, COALESCE(singer_count, 0) FROM concert LEFT JOIN (SELECT concert_ID, COUNT(Singer_ID) singer_count FROM singer_in_concert GROUP BY concert_ID) sc ON concert.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, COUNT(s1.Singer_ID) FROM concert c1 JOIN singer_in_concert s1 ON c1.concert_ID  =  s1.concert_ID GROUP BY c1.concert_ID, c1.concert_Name, c1.Theme"
        },
        {
          "sql": "SELECT DISTINCT concert_Name, Theme, (SELECT COUNT(sic2.Singer_ID) FROM singer_in_concert sic2 WHERE sic2.concert_ID  =  concert.concert_ID) FROM concert"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert GROUP BY concert_ID) ORDER BY concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID)"
        },
        {
          "sql": "SELECT concert_Name, Theme, SUM(sic_count) OVER (PARTITION BY concert.concert_ID) FROM concert JOIN (SELECT concert_ID, 1 sic_count FROM singer_in_concert) sic ON concert.concert_ID  =  sic.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers.num_singers FROM concert CROSS JOIN (SELECT concert_ID, COUNT(Singer_ID) num_singers FROM singer_in_concert GROUP BY concert_ID) singers WHERE concert.concert_ID  =  singers.concert_ID"
        },
        {
          "sql": "SELECT * FROM (SELECT concert_Name, Theme, COUNT(Singer_ID) OVER (PARTITION BY concert.concert_ID) cnt FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID) t"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(DISTINCT Singer_ID) FROM singer_in_concert WHERE concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(DISTINCT sic.Singer_ID) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        }
      ]
    },
    {
      "id": 34,
      "question": "What are the names , themes , and number of singers for every concert ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(DISTINCT Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(*) FROM concert JOIN singer_in_concert USING(concert_ID) GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, COUNT(s1.Singer_ID) FROM concert c1 INNER JOIN singer_in_concert s1 ON c1.concert_ID  =  s1.concert_ID GROUP BY c1.concert_ID, c1.concert_Name, c1.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(*) FROM singer_in_concert sic2 WHERE sic2.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers_count FROM concert c1 WHERE EXISTS(SELECT 1 FROM (SELECT concert_ID, COUNT(Singer_ID) singers_count FROM singer_in_concert GROUP BY concert_ID) s1 WHERE s1.concert_ID  =  c1.concert_ID)"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, s.singers_count FROM concert c JOIN (SELECT concert_ID, COUNT(Singer_ID) singers_count FROM singer_in_concert GROUP BY concert_ID) s ON c.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "SELECT c2.concert_Name, c2.Theme, s2.cnt FROM concert c2 JOIN (SELECT sic.concert_ID, COUNT(sic.Singer_ID) cnt FROM singer_in_concert sic GROUP BY sic.concert_ID) s2 ON c2.concert_ID  =  s2.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, singer_cnt FROM concert CROSS JOIN (SELECT concert_ID, COUNT(*) singer_cnt FROM singer_in_concert GROUP BY concert_ID) s WHERE concert.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "WITH singer_counts AS (SELECT concert_ID, COUNT(Singer_ID) cnt FROM singer_in_concert GROUP BY concert_ID) SELECT c.concert_Name, c.Theme, sc.cnt FROM concert c JOIN singer_counts sc ON c.concert_ID  =  sc.concert_ID"
        },
        {
          "sql": "WITH cnts AS (SELECT concert_ID, COUNT(*) singers FROM singer_in_concert GROUP BY concert_ID) SELECT concert_Name, Theme, singers FROM concert JOIN cnts ON concert_ID  =  cnts.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) FROM concert LEFT JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c3.concert_Name, c3.Theme, COALESCE(COUNT(sic.Singer_ID), 0) FROM concert c3 LEFT JOIN singer_in_concert sic ON c3.concert_ID  =  sic.concert_ID GROUP BY c3.concert_ID, c3.concert_Name, c3.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers_per_concert FROM (SELECT concert_ID, COUNT(Singer_ID) singers_per_concert FROM singer_in_concert GROUP BY concert_ID) sq JOIN concert ON sq.concert_ID  =  concert.concert_ID"
        },
        {
          "sql": "SELECT c4.concert_Name, c4.Theme, sq1.singer_count FROM concert c4 JOIN (SELECT concert_ID, COUNT(*) singer_count FROM singer_in_concert GROUP BY concert_ID) sq1 ON c4.concert_ID  =  sq1.concert_ID"
        },
        {
          "sql": "SELECT DISTINCT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) OVER (PARTITION BY concert.concert_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers FROM (SELECT c.concert_ID, c.concert_Name, c.Theme, COUNT(s.Singer_ID) singers FROM concert c JOIN singer_in_concert s ON c.concert_ID  =  s.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme) t"
        },
        {
          "sql": "SELECT Name=concert_Name, Theme, SingerCount=COUNT(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name AS Name, Theme AS concert_theme, COUNT(singer_in_concert.Singer_ID) AS total_singers FROM concert INNER JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT * FROM (SELECT concert_Name, Theme, COUNT(singer_in_concert.Singer_ID) num_singers FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme) final_result"
        }
      ]
    },
    {
      "id": 35,
      "question": "List singer names and number of concerts for each singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT s.Name, count(sc.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer JOIN singer_in_concert USING(Singer_ID) GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(DISTINCT sc.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(*) FROM singer_in_concert sc JOIN concert c ON sc.concert_ID  =  c.concert_ID WHERE sc.Singer_ID  =  s.Singer_ID) FROM singer s GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, (SELECT count(concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) FROM singer s GROUP BY s.Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM concert c JOIN singer_in_concert sc ON c.concert_ID  =  sc.concert_ID JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "WITH singer_concerts AS (SELECT DISTINCT s.Singer_ID, s.Name, c.concert_ID FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID) SELECT Name, count(concert_ID) FROM singer_concerts GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(sc.concert_ID) FROM singer_in_concert sc JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM singer_in_concert sic JOIN singer s ON sic.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID, Name"
        },
        {
          "sql": "SELECT s1.Name, count(*) FROM singer s1 WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert) GROUP BY s1.Singer_ID, s1.Name"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM singer_in_concert sic WHERE sic.Singer_ID  =  s.Singer_ID) AS concert_count FROM singer s"
        },
        {
          "sql": "SELECT DISTINCT s.Name, count(sc.concert_ID) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM (SELECT s.Name, c.concert_ID FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID) t GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, sum(CASE WHEN sc.Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer s LEFT JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(DISTINCT sic.concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(DISTINCT concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID GROUP BY Singer_ID) FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT Name, count(c.concert_ID) FROM singer JOIN (SELECT DISTINCT Singer_ID, concert_ID FROM singer_in_concert) sc ON singer.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, count(sc1.concert_ID) FROM singer s JOIN (SELECT Singer_ID, concert_ID FROM singer_in_concert) sc1 ON s.Singer_ID  =  sc1.Singer_ID GROUP BY s.Singer_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert WHERE Singer_ID  =  singer.Singer_ID) GROUP BY Singer_ID, Name"
        },
        {
          "sql": "SELECT s.Name, COALESCE(cnt, 0) FROM singer s LEFT JOIN (SELECT Singer_ID, count(concert_ID) cnt FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID, s.Name ORDER BY s.Name"
        }
      ]
    },
    {
      "id": 36,
      "question": "What are the names of the singers and number of concerts for each person?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert AS c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT s.Name ,  count(DISTINCT sic.concert_ID) FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  cnt FROM (SELECT s.Name ,  sic.concert_ID ,  count(*) OVER (PARTITION BY s.Singer_ID ,  s.Name) AS cnt FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID) AS sub GROUP BY Name ,  cnt"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(*) FROM singer_in_concert AS sic JOIN concert AS c ON sic.concert_ID  =  c.concert_ID WHERE sic.Singer_ID  =  s.Singer_ID) FROM singer AS s WHERE s.Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert)"
        },
        {
          "sql": "SELECT Name ,  concert_count FROM (SELECT s.Name ,  count(sic.concert_ID) AS concert_count FROM singer AS s INNER JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name) AS counts"
        },
        {
          "sql": "WITH singer_concerts AS (SELECT s.Singer_ID ,  s.Name ,  sic.concert_ID FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID) SELECT Name ,  count(concert_ID) FROM singer_concerts GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(*) FROM singer AS s INNER JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID INNER JOIN concert AS c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  (SELECT count(sic2.concert_ID) FROM singer_in_concert AS sic2 WHERE sic2.Singer_ID  =  s.Singer_ID) FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  num_concerts FROM (SELECT s.Name ,  c.concert_ID ,  ROW_NUMBER() OVER (PARTITION BY s.Singer_ID ORDER BY c.concert_ID) AS rn ,  count(*) OVER (PARTITION BY s.Singer_ID) AS num_concerts FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert AS c ON sic.concert_ID  =  c.concert_ID) AS numbered GROUP BY Name ,  num_concerts"
        },
        {
          "sql": "SELECT s.Name ,  sum(CASE WHEN sic.concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer AS s LEFT JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name HAVING sum(CASE WHEN sic.concert_ID IS NOT NULL THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_Name) FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert AS c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  COUNT_BIG(*) FROM singer AS s CROSS JOIN (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) AS conc GROUP BY s.Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(DISTINCT concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID GROUP BY Singer_ID) AS concert_cnt FROM singer AS s WHERE EXISTS (SELECT 1 FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID)"
        },
        {
          "sql": "SELECT Name ,  concerts FROM (SELECT s.Name ,  dense_rank() OVER (ORDER BY count(sic.concert_ID)) AS concerts FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name) GROUP BY Name ,  concerts"
        },
        {
          "sql": "SELECT s.Name ,  cardinality(array_agg(sic.concert_ID)) FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  cnt.concert_count FROM singer s JOIN (SELECT Singer_ID ,  count(concert_ID) AS concert_count FROM singer_in_concert GROUP BY Singer_ID) AS cnt ON s.Singer_ID  =  cnt.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  count(sic.concert_ID) OVER (PARTITION BY s.Singer_ID) AS concert_num FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name ,  sic.concert_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  cnt FROM (SELECT s.Name ,  c.concert_ID ,  count(c.concert_ID) OVER (PARTITION BY s.Singer_ID) AS cnt FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert AS c ON sic.concert_ID  =  c.concert_ID) GROUP BY s.Name ,  cnt"
        },
        {
          "sql": "SELECT Name ,  count_conc FROM (SELECT s.Name ,  c.Year ,  count(*) FROM singer AS s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert AS c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name ,  c.Year) t GROUP BY Name ,  count_conc"
        },
        {
          "sql": "SELECT s.Name ,  GREATEST(count(sic.concert_ID), 0) FROM singer AS s LEFT JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name HAVING count(sic.concert_ID) > 0"
        },
        {
          "sql": "WITH RECURSIVE singer_stats AS (SELECT s.Singer_ID ,  s.Name ,  sic.concert_ID FROM singer AS s JOIN singer_in_concert AS sic ON s.Singer_ID  =  sic.Singer_ID UNION ALL SELECT Singer_ID ,  Name ,  concert_ID FROM singer_stats WHERE 1=0) SELECT Name ,  count(concert_ID) FROM singer_stats GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(*) FROM (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  outer_s.Singer_ID GROUP BY concert_ID) AS unique_concerts) FROM singer AS s AS outer_s WHERE s.Singer_ID IN (SELECT Singer_ID FROM singer_in_concert GROUP BY Singer_ID)"
        }
      ]
    },
    {
      "id": 37,
      "question": "List all singer names in concerts in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=singer.Singer_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer JOIN singer_in_concert USING(Singer_ID) JOIN concert USING(concert_ID) WHERE Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s1.Name FROM singer s1 WHERE s1.Singer_ID IN (SELECT sic1.Singer_ID FROM singer_in_concert sic1, concert c1 WHERE sic1.concert_ID=c1.concert_ID AND c1.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM singer, singer_in_concert, concert WHERE singer.Singer_ID=singer_in_concert.Singer_ID AND singer_in_concert.concert_ID=concert.concert_ID AND concert.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer INTERSECT SELECT Name FROM singer WHERE Singer_ID=(SELECT Singer_ID FROM singer_in_concert WHERE concert_ID=(SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "WITH c2014 AS (SELECT concert_ID FROM concert WHERE Year=2014) SELECT DISTINCT Name FROM singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID JOIN c2014 ON singer_in_concert.concert_ID=c2014.concert_ID"
        },
        {
          "sql": "SELECT Name FROM (SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014) t"
        },
        {
          "sql": "SELECT Singer.Name FROM singer Singer JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014)) sub ON Singer.Singer_ID=sub.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM (singer s INNER JOIN singer_in_concert sic ON s.Singer_ID = sic.Singer_ID) JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer NATURAL JOIN singer_in_concert NATURAL JOIN concert WHERE Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic1 JOIN (SELECT concert_ID FROM concert WHERE Year = 2014) c1 ON sic1.concert_ID = c1.concert_ID)"
        },
        {
          "sql": "SELECT s.Name FROM singer s, (SELECT DISTINCT sic.Singer_ID FROM singer_in_concert sic, concert c WHERE sic.concert_ID = c.concert_ID AND c.Year = 2014) sub WHERE s.Singer_ID = sub.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM (concert JOIN singer_in_concert ON concert.concert_ID = singer_in_concert.concert_ID) JOIN singer ON singer.Singer_ID = singer_in_concert.Singer_ID WHERE concert.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer LEFT JOIN singer_in_concert ON singer.Singer_ID = singer_in_concert.Singer_ID LEFT JOIN concert ON singer_in_concert.concert_ID = concert.concert_ID WHERE concert.Year = 2014 AND concert.concert_ID IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT Name FROM ((singer JOIN singer_in_concert ON Singer_ID = Singer_ID) JOIN concert ON concert_ID = concert_ID) WHERE Year = 2014"
        },
        {
          "sql": "WITH singers_2014 AS (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) SELECT Name FROM singer JOIN singers_2014 ON Singer_ID = singers_2014.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer WHERE Singer_ID IN (SELECT sic.Singer_ID FROM singer_in_concert sic CROSS JOIN concert c WHERE sic.concert_ID = c.concert_ID AND c.Year = 2014)"
        }
      ]
    },
    {
      "id": 38,
      "question": "What are the names of the singers who performed in a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer JOIN singer_in_concert ON singer.Singer_ID=singer_in_concert.Singer_ID JOIN concert ON singer_in_concert.concert_ID=concert.concert_ID WHERE concert.Year=2014"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID INNER JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=singer.Singer_ID AND c.Year=2014)"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT sic.Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM concert c JOIN singer_in_concert sic ON c.concert_ID=sic.concert_ID JOIN singer s ON sic.Singer_ID=s.Singer_ID WHERE c.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.Singer_ID=s.Singer_ID AND sic.concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT s1.Name FROM singer s1 WHERE s1.Singer_ID IN (SELECT sic1.Singer_ID FROM singer_in_concert sic1 WHERE sic1.concert_ID IN (SELECT c1.concert_ID FROM concert c1 WHERE c1.Year=2014))"
        },
        {
          "sql": "SELECT Name FROM singer INTERSECT SELECT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014"
        },
        {
          "sql": "WITH c2014 AS (SELECT concert_ID FROM concert WHERE Year=2014) SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM c2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN (SELECT sic.Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014) sub ON s.Singer_ID=sub.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM singer, singer_in_concert, concert WHERE singer.Singer_ID=singer_in_concert.Singer_ID AND singer_in_concert.concert_ID=concert.concert_ID AND concert.Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID=ANY (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014))"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT unnest(ARRAY_AGG(sic.Singer_ID)) FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014)"
        },
        {
          "sql": "WITH singers_2014 AS (SELECT DISTINCT sic.Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014) SELECT s.Name FROM singer s JOIN singers_2014 s2 ON s.Singer_ID=s2.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer s JOIN LATERAL (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=s.Singer_ID AND c.Year=2014) t ON true"
        },
        {
          "sql": "SELECT DISTINCT Name FROM (SELECT s.Name, c.Year FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concert c ON sic.concert_ID=c.concert_ID) t WHERE Year=2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic CROSS JOIN (SELECT concert_ID FROM concert WHERE Year=2014) c WHERE sic.concert_ID=c.concert_ID)"
        },
        {
          "sql": "SELECT s.Name FROM singer s WHERE 2014 IN (SELECT c.Year FROM singer_in_concert sic JOIN concert c ON sic.concert_ID=c.concert_ID WHERE sic.Singer_ID=s.Singer_ID)"
        },
        {
          "sql": "WITH RECURSIVE temp AS (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year=2014) UNION SELECT s.Singer_ID FROM temp t JOIN singer s ON t.Singer_ID=s.Singer_ID) SELECT DISTINCT Name FROM singer JOIN temp ON singer.Singer_ID=temp.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer LEFT JOIN singer_in_concert sic ON singer.Singer_ID=sic.Singer_ID LEFT JOIN concert c ON sic.concert_ID=c.concert_ID WHERE c.Year=2014 AND c.concert_ID IS NOT NULL"
        }
      ]
    },
    {
      "id": 39,
      "question": "what is the name and nation of the singer who have a song having 'Hey' in its name?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE 'Hey%' OR Song_Name LIKE '% Hey%' OR Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOCATE('Hey', Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT * FROM singer) AS t1 WHERE t1.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Singer_ID, Name, Country, Song_Name FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer CROSS JOIN (SELECT 1 as x) t WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT Name, Country, Song_Name FROM singer WHERE Song_Name LIKE '%Hey%') AS sub"
        },
        {
          "sql": "SELECT s1.Name, s1.Country FROM singer s1 WHERE s1.Song_Name LIKE '%Hey%' AND s1.Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' AND Name IS NOT NULL"
        },
        {
          "sql": "WITH hey_singers AS (SELECT * FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM hey_singers"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE POSITION('Hey' IN Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "SELECT * FROM (SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%') AS result"
        },
        {
          "sql": "SELECT Name, Country FROM singer s WHERE s.Song_Name LIKE CONCAT('%', 'Hey', '%')"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM (SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%') t"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOWER(Song_Name) LIKE '%hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name ~ 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE INSTR(Song_Name, 'Hey') > 0"
        }
      ]
    },
    {
      "id": 40,
      "question": "What is the name and country of origin of every singer who has a song with the word 'Hey' in its title?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name LIKE 'Hey%' OR Song_Name LIKE '% Hey%' OR Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT DISTINCT Name,Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT singer.Name,singer.Country FROM singer WHERE EXISTS(SELECT 1 FROM singer s2 WHERE s2.Singer_ID=singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Singer_ID IN(SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name,Country FROM (SELECT * FROM singer) AS t WHERE t.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE INSTR(UPPER(Song_Name),'HEY')>0"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE LOCATE('Hey',Song_Name)>0"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name ~ 'Hey'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "WITH hey_singers AS(SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name,Country FROM singer s JOIN hey_singers h ON s.Singer_ID=h.Singer_ID"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Song_Name MATCH 'Hey'"
        },
        {
          "sql": "SELECT Name,Country FROM singer CROSS JOIN (SELECT 1) WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE (SELECT COUNT(*) FROM (SELECT 1 AS x) WHERE 1=1 AND Song_Name LIKE '%Hey%')>0"
        },
        {
          "sql": "SELECT Name,Country FROM singer NATURAL JOIN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT s.Name,s.Country FROM singer s INNER JOIN (SELECT DISTINCT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') h ON s.Singer_ID=h.Singer_ID"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE Singer_ID=(SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 1) UNION SELECT Name,Country FROM singer WHERE Singer_ID IN(SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%' AND Singer_ID!=(SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 1))"
        },
        {
          "sql": "SELECT Name,Country FROM singer LEFT JOIN (SELECT Singer_ID FROM singer WHERE Song_Name NOT LIKE '%Hey%') nohey ON singer.Singer_ID=nohey.Singer_ID WHERE nohey.Singer_ID IS NULL"
        },
        {
          "sql": "SELECT Name,Country FROM (SELECT Singer_ID,Name,Country FROM singer)s WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name,Country FROM singer WHERE 1=1 AND Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name,Country FROM singer INTERSECT SELECT Name,Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        }
      ]
    },
    {
      "id": 41,
      "question": "Find the name and location of the stadiums which some concerts happened in the years of both 2014 and 2015.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s WHERE s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014) AND s.Stadium_ID IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2015)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2)"
        },
        {
          "sql": "SELECT DISTINCT s1.Name, s1.Location FROM stadium s1 JOIN concert c1 ON s1.Stadium_ID = c1.Stadium_ID WHERE c1.Year = 2014 AND s1.Stadium_ID IN (SELECT c2.Stadium_ID FROM concert c2 WHERE c2.Year = 2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014 INTERSECT SELECT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2015"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, Year FROM concert WHERE Year IN (2014,2015)) t GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2)"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c2014 ON s.Stadium_ID = c2014.Stadium_ID JOIN concert c2015 ON s.Stadium_ID = c2015.Stadium_ID WHERE c2014.Year = 2014 AND c2015.Year = 2015"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID = s.Stadium_ID AND c1.Year = 2014) AND EXISTS (SELECT 1 FROM concert c2 WHERE c2.Stadium_ID = s.Stadium_ID AND c2.Year = 2015)"
        },
        {
          "sql": "WITH concerts_by_year AS (SELECT Stadium_ID, Year FROM concert WHERE Year IN (2014,2015)), stadiums_2014_2015 AS (SELECT Stadium_ID FROM concerts_by_year GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)=2) SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadiums_2014_2015)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s WHERE (SELECT COUNT(DISTINCT c.Year) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year IN (2014,2015)) = 2"
        },
        {
          "sql": "SELECT DISTINCT t1.Name, t1.Location FROM stadium t1 WHERE EXISTS (SELECT 1 FROM concert t2 WHERE t2.Stadium_ID = t1.Stadium_ID AND t2.Year IN (2014,2015) GROUP BY t2.Stadium_ID HAVING COUNT(DISTINCT t2.Year) = 2)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year = 2015) AS matching_stadiums ON s.Stadium_ID = matching_stadiums.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT t.Stadium_ID FROM (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT Stadium_ID FROM concert WHERE Year = 2015) t GROUP BY t.Stadium_ID HAVING COUNT(*) = 2)"
        },
        {
          "sql": "WITH year_counts AS (SELECT Stadium_ID, COUNT(DISTINCT Year) as year_count FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID) SELECT s.Name, s.Location FROM stadium s JOIN year_counts yc ON s.Stadium_ID = yc.Stadium_ID WHERE yc.year_count = 2"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year IN (2014,2015) AND (SELECT COUNT(DISTINCT cc.Year) FROM concert cc WHERE cc.Stadium_ID = s.Stadium_ID AND cc.Year IN (2014,2015)) = 2"
        },
        {
          "sql": "SELECT Name, Location FROM (SELECT s.Name, s.Location, COUNT(DISTINCT c.Year) as cnt FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year IN (2014,2015) GROUP BY s.Stadium_ID, s.Name, s.Location) t WHERE cnt = 2"
        },
        {
          "sql": "SELECT s1.Name, s1.Location FROM stadium s1 WHERE 2014 IN (SELECT c.Year FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID) AND 2015 IN (SELECT c.Year FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID)"
        },
        {
          "sql": "SELECT DISTINCT Name, Location FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING SUM(Year=2014) > 0 AND SUM(Year=2015) > 0)"
        },
        {
          "sql": "WITH has_2014 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014), has_2015 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2015) SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT * FROM has_2014 INTERSECT SELECT * FROM has_2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014) > 0 AND (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2015) > 0"
        },
        {
          "sql": "SELECT DISTINCT t.Name, t.Location FROM (SELECT s.Name, s.Location, c.Year FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year IN (2014,2015)) t GROUP BY t.Stadium_ID, t.Name, t.Location HAVING COUNT(DISTINCT t.Year) = 2"
        },
        {
          "sql": "SELECT Name, Location FROM stadium EXCEPT SELECT Name, Location FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014) OR NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN LATERAL (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year IN (2014,2015) GROUP BY c.Stadium_ID HAVING COUNT(DISTINCT c.Year) = 2) t ON true"
        }
      ]
    },
    {
      "id": 42,
      "question": "What are the names and locations of the stadiums that had concerts that occurred in both 2014 and 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT T1.Location ,  T1.Name FROM stadium AS T1 WHERE T1.Stadium_ID IN (SELECT T3.Stadium_ID FROM concert AS T3 WHERE T3.Year = 2014) AND T1.Stadium_ID IN (SELECT T4.Stadium_ID FROM concert AS T4 WHERE T4.Year = 2015)"
        },
        {
          "sql": "SELECT DISTINCT T1.Location ,  T1.Name FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year IN (2014, 2015) GROUP BY T1.Stadium_ID ,  T1.Location ,  T1.Name HAVING COUNT(DISTINCT T2.Year) = 2"
        },
        {
          "sql": "SELECT T1.Location ,  T1.Name FROM stadium AS T1 WHERE EXISTS (SELECT 1 FROM concert AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Year = 2014) AND EXISTS (SELECT 1 FROM concert AS T3 WHERE T3.Stadium_ID  =  T1.Stadium_ID AND T3.Year = 2015)"
        },
        {
          "sql": "SELECT DISTINCT T1.Location ,  T1.Name FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID JOIN concert AS T3 ON T1.Stadium_ID  =  T3.Stadium_ID WHERE T2.Year = 2014 AND T3.Year = 2015"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT T1.Location ,  T1.Name FROM stadium AS T1 JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year = 2015) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s1.Location ,  s1.Name FROM stadium s1 JOIN concert c1 ON s1.Stadium_ID  =  c1.Stadium_ID WHERE c1.Year = 2014 AND s1.Stadium_ID IN (SELECT c2.Stadium_ID FROM concert c2 WHERE c2.Year = 2015)"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Stadium_ID IN (SELECT c.Stadium_ID FROM concert c GROUP BY c.Stadium_ID HAVING SUM(c.Year = 2014) > 0 AND SUM(c.Year = 2015) > 0)"
        },
        {
          "sql": "WITH years_14_15 AS (SELECT Stadium_ID FROM concert WHERE Year IN (2014, 2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year) = 2) SELECT T1.Location ,  T1.Name FROM stadium AS T1 JOIN years_14_15 AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT T1.Location ,  T1.Name FROM stadium AS T1 WHERE (SELECT COUNT(DISTINCT T2.Year) FROM concert AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Year IN (2014, 2015)) = 2"
        },
        {
          "sql": "SELECT DISTINCT T1.Location ,  T1.Name FROM stadium AS T1 INNER JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year = 2014 INTERSECT SELECT DISTINCT T3.Location ,  T3.Name FROM stadium AS T3 INNER JOIN concert AS T4 ON T3.Stadium_ID  =  T4.Stadium_ID WHERE T4.Year = 2015"
        },
        {
          "sql": "SELECT s.Location ,  s.Name FROM stadium s JOIN (SELECT Stadium_ID ,  COUNT(DISTINCT Year) as yr_cnt FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING yr_cnt = 2) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID ,  Year FROM concert WHERE Year IN (2014,2015)) t GROUP BY Stadium_ID HAVING COUNT(*) = 2)"
        },
        {
          "sql": "SELECT DISTINCT T1.Name ,  T1.Location FROM stadium T1 JOIN concert T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year BETWEEN 2014 AND 2015 GROUP BY T1.Stadium_ID HAVING MIN(T2.Year) = 2014 AND MAX(T2.Year) = 2015"
        },
        {
          "sql": "SELECT Location ,  Name FROM (SELECT s.Location ,  s.Name ,  COUNT(DISTINCT c.Year) as cnt FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year IN (2014,2015) GROUP BY s.Stadium_ID ,  s.Location ,  s.Name) t WHERE cnt = 2"
        },
        {
          "sql": "SELECT T1.Location ,  T1.Name FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year = 2014 AND T1.Stadium_ID IN (SELECT DISTINCT T3.Stadium_ID FROM concert AS T3 WHERE T3.Year = 2015)"
        },
        {
          "sql": "SELECT DISTINCT Location ,  Name FROM stadium s WHERE 2014 = ANY (SELECT c.Year FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) AND 2015 = ANY (SELECT c.Year FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID)"
        },
        {
          "sql": "WITH c2014 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014), c2015 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2015) SELECT s.Location ,  s.Name FROM stadium s JOIN c2014 ON s.Stadium_ID  =  c2014.Stadium_ID JOIN c2015 ON s.Stadium_ID  =  c2015.Stadium_ID"
        },
        {
          "sql": "SELECT s1.Location ,  s1.Name FROM stadium s1 CROSS JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014) c1 CROSS JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2015) c2 WHERE s1.Stadium_ID  =  c1.Stadium_ID AND s1.Stadium_ID  =  c2.Stadium_ID"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium GROUP BY Stadium_ID ,  Location ,  Name HAVING SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2014) THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2015) THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT DISTINCT T1.Location ,  T1.Name FROM stadium AS T1 WHERE (SELECT COUNT(*) FROM concert AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Year IN (2014, 2015) GROUP BY T2.Stadium_ID HAVING COUNT(DISTINCT T2.Year) = 2) > 0"
        },
        {
          "sql": "SELECT Name ,  Location FROM (SELECT s.*, BOOL_AND(c.Year = 2014 OR c.Year = 2015) OVER (PARTITION BY s.Stadium_ID) as has_both FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID AND c.Year IN (2014,2015)) WHERE has_both AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year) = 2)"
        }
      ]
    },
    {
      "id": 43,
      "question": "Find the number of concerts happened in the stadium with the highest capacity .",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c JOIN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) s ON c.Stadium_ID = s.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c, stadium s WHERE c.Stadium_ID = s.Stadium_ID AND s.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM max_stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert JOIN stadium ON concert.Stadium_ID = stadium.Stadium_ID WHERE stadium.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE stadium.Capacity = (SELECT MAX(stadium.Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE concert.Stadium_ID = s2.Stadium_ID AND s2.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE s.Capacity >= ALL (SELECT Capacity FROM stadium)"
        },
        {
          "sql": "WITH highest_capacity AS (SELECT MAX(Capacity) AS max_cap FROM stadium) SELECT COUNT(*) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID CROSS JOIN highest_capacity h WHERE s.Capacity = h.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium s1 WHERE Capacity = (SELECT MAX(Capacity) FROM stadium s2)) AS sub) AS count_sub"
        },
        {
          "sql": "SELECT SUM(CASE WHEN s.Capacity = (SELECT MAX(Capacity) FROM stadium) THEN 1 ELSE 0 END) FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c INNER JOIN stadium s ON c.Stadium_ID = s.Stadium_ID INNER JOIN (SELECT MAX(Capacity) max_cap FROM stadium) m ON s.Capacity = m.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Capacity > s.Capacity))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert c WHERE Stadium_ID = (SELECT t.Stadium_ID FROM stadium t WHERE t.Capacity = (SELECT MAX(u.Capacity) FROM stadium u))"
        },
        {
          "sql": "WITH ranked_stadium AS (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY Capacity DESC) rn FROM stadium) SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM ranked_stadium WHERE rn = 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM stadium s1 JOIN concert c ON s1.Stadium_ID = c.Stadium_ID WHERE s1.Capacity >= (SELECT MAX(s2.Capacity) FROM stadium s2)"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM (SELECT Stadium_ID, MAX(Capacity) OVER () AS max_capacity FROM stadium) s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE s.Capacity = s.max_capacity"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(s2.Capacity) FROM stadium s2)"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = ANY (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        }
      ]
    },
    {
      "id": 44,
      "question": "What are the number of concerts that occurred in the stadium with the largest capacity ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID WHERE S.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C, stadium S WHERE C.Stadium_ID = S.Stadium_ID AND S.Capacity = (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium S1 WHERE Capacity >= ALL (SELECT Capacity FROM stadium S2))"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID WHERE S.Capacity = (SELECT MAX(Capacity) FROM stadium)) AS subq"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM max_stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(c.concert_ID) FROM concert c INNER JOIN stadium s ON c.Stadium_ID = s.Stadium_ID INNER JOIN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) ms ON c.Stadium_ID = ms.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS (SELECT 1 FROM stadium S WHERE S.Stadium_ID = concert.Stadium_ID AND S.Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity >= (SELECT MAX(Capacity) FROM stadium)) maxs ON concert.Stadium_ID = maxs.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM concert CROSS JOIN (SELECT Stadium_ID as max_stadium_id FROM stadium ORDER BY Capacity DESC LIMIT 1) m WHERE concert.Stadium_ID = m.max_stadium_id"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, RANK() OVER (ORDER BY Capacity DESC) as rnk FROM stadium) SELECT COUNT(*) FROM concert C JOIN ranked_stadiums R ON C.Stadium_ID = R.Stadium_ID WHERE R.rnk = 1"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium S WHERE NOT EXISTS (SELECT 1 FROM stadium S2 WHERE S2.Capacity > S.Capacity))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT c.concert_ID) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity >= ALL(SELECT Capacity FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT 1 FROM concert C WHERE C.Stadium_ID = (SELECT S.Stadium_ID FROM stadium S ORDER BY S.Capacity DESC LIMIT 1) GROUP BY C.concert_ID)"
        },
        {
          "sql": "SELECT SUM(CASE WHEN C.Stadium_ID = (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) THEN 1 ELSE 0 END) FROM concert C"
        },
        {
          "sql": "WITH largest_capacity AS (SELECT MAX(Capacity) as max_cap FROM stadium) SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID = S.Stadium_ID CROSS JOIN largest_capacity L WHERE S.Capacity = L.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C WHERE C.Stadium_ID = (SELECT DISTINCT Stadium_ID FROM stadium S WHERE Capacity = (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert NATURAL JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity = (SELECT MAX(Capacity) FROM stadium)) max_stadium"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert.Stadium_ID, COUNT(*) OVER (PARTITION BY concert.Stadium_ID) as cnt FROM concert JOIN stadium ON concert.Stadium_ID = stadium.Stadium_ID WHERE stadium.Capacity = (SELECT MAX(Capacity) FROM stadium)) sub GROUP BY Stadium_ID HAVING COUNT(*) > 0"
        }
      ]
    },
    {
      "id": 45,
      "question": "Find the number of pets whose weight is heavier than 10.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(pet_age) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(weight) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10.0"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE Pets.weight > 10"
        },
        {
          "sql": "SELECT count(Pets.PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(PetID) FROM (SELECT PetID FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > (SELECT 10)"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > ALL(SELECT 10)"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND pet_age IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10 AND PetType IS NOT NULL"
        },
        {
          "sql": "SELECT SUM(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Pets.weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT count(*) FROM Pets t1 WHERE t1.weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets p WHERE p.weight > 10"
        },
        {
          "sql": "SELECT count(1) FROM Pets WHERE weight > 10"
        }
      ]
    },
    {
      "id": 46,
      "question": "How many pets have a greater weight than 10?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(PetType) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(pet_age) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(weight) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT sum(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT count(T1.PetID) FROM Pets AS T1 WHERE T1.weight > 10"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND PetType IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND pet_age IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10 AND PetID > 0"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight > 10.0"
        },
        {
          "sql": "SELECT count(PetID) FROM (SELECT * FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE NOT (weight <= 10)"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE weight IS NOT NULL AND weight > 10"
        },
        {
          "sql": "SELECT sum(CASE WHEN weight > 10 THEN 1 END) FROM Pets"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets WHERE weight BETWEEN 10.1 AND 999"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT PetID,weight FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "WITH heavy_pets AS (SELECT * FROM Pets WHERE weight > 10) SELECT count(*) FROM heavy_pets"
        }
      ]
    },
    {
      "id": 47,
      "question": "Find the weight of the youngest dog.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 WHERE P1.PetType = 'dog' AND P1.pet_age = (SELECT MIN(P2.pet_age) FROM Pets P2 WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT P.weight FROM Pets P WHERE P.PetType = 'dog' ORDER BY P.pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT MIN(P.weight) FROM Pets P WHERE P.PetType = 'dog' AND P.pet_age = (SELECT MIN(P2.pet_age) FROM Pets P2 WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT pet_age FROM Pets WHERE PetType = 'dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 JOIN (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType = 'dog') P2 ON P1.pet_age = P2.min_age AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age, weight, ROW_NUMBER() OVER (ORDER BY pet_age ASC) rn FROM Pets WHERE PetType = 'dog') ranked WHERE rn = 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age <= ALL (SELECT pet_age FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC) FROM Pets WHERE PetType = 'dog' LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "WITH youngest_dog_age AS (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType = 'dog') SELECT weight FROM Pets P, youngest_dog_age Y WHERE P.PetType = 'dog' AND P.pet_age = Y.min_age"
        },
        {
          "sql": "WITH youngest_dog AS (SELECT * FROM Pets WHERE PetType = 'dog' ORDER BY pet_age ASC LIMIT 1) SELECT weight FROM youngest_dog"
        },
        {
          "sql": "SELECT weight FROM Pets p1 WHERE PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType = 'dog' AND p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age, PetType FROM Pets WHERE PetType = 'dog') dogs WHERE pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT P.weight FROM Pets P INNER JOIN (SELECT PetID FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')) YD ON P.PetID = YD.PetID"
        },
        {
          "sql": "SELECT DISTINCT weight FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1, (SELECT MIN(pet_age) AS min_age FROM Pets WHERE PetType = 'dog') min_pet WHERE P1.pet_age = min_pet.min_age AND P1.PetType = 'dog'"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = MIN(pet_age) FROM Pets WHERE PetType = 'dog'"
        },
        {
          "sql": "SELECT TOP 1 weight FROM Pets WHERE PetType = 'dog' ORDER BY pet_age ASC"
        },
        {
          "sql": "SELECT P.weight FROM Pets P WHERE PetType = 'dog' FETCH FIRST 1 ROW ONLY ORDER BY pet_age ASC"
        }
      ]
    },
    {
      "id": 48,
      "question": "How much does the youngest dog weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' AND pet_age  =  (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog')"
        },
        {
          "sql": "SELECT MIN(weight) FROM Pets WHERE PetType  =  'dog' AND pet_age  =  (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog')"
        },
        {
          "sql": "SELECT p1.weight FROM Pets p1 WHERE p1.PetType  =  'dog' AND p1.pet_age  =  (SELECT MIN(p2.pet_age) FROM Pets p2 WHERE p2.PetType  =  'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID  =  (SELECT PetID FROM Pets WHERE PetType  =  'dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT p.weight FROM Pets p INNER JOIN (SELECT PetID, MIN(pet_age) OVER () as min_age FROM Pets WHERE PetType  =  'dog') d ON p.PetID  =  d.PetID AND p.pet_age  =  d.min_age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' AND pet_age  <=  ALL (SELECT pet_age FROM Pets WHERE PetType  =  'dog') LIMIT 1"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age ASC) FROM Pets WHERE PetType  =  'dog' LIMIT 1"
        },
        {
          "sql": "WITH youngest_dog AS (SELECT pet_age, MIN(weight) as min_weight FROM Pets WHERE PetType  =  'dog' GROUP BY pet_age ORDER BY pet_age ASC LIMIT 1) SELECT min_weight FROM youngest_dog"
        },
        {
          "sql": "SELECT weight FROM Pets p1 WHERE PetType  =  'dog' AND NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType  =  'dog' AND p2.pet_age  <  p1.pet_age)"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age ASC) as rn FROM Pets WHERE PetType  =  'dog') ranked WHERE rn  =  1"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age, DENSE_RANK() OVER (ORDER BY pet_age ASC) as rnk FROM Pets WHERE PetType  =  'dog') ranked WHERE rnk  =  1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' AND pet_age  IN (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog')"
        },
        {
          "sql": "SELECT p.weight FROM Pets p, (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType  =  'dog') m WHERE p.PetType  =  'dog' AND p.pet_age  =  m.min_age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' GROUP BY PetID, pet_age, weight HAVING pet_age  =  MIN(pet_age) OVER () ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT (SELECT weight FROM Pets p2 WHERE p2.PetType  =  'dog' ORDER BY p2.pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType  =  'dog' ORDER BY pet_age ASC, weight ASC LIMIT 1"
        },
        {
          "sql": "WITH dog_ages AS (SELECT DISTINCT pet_age FROM Pets WHERE PetType  =  'dog' ORDER BY pet_age ASC LIMIT 1), min_weight AS (SELECT MIN(weight) weight FROM Pets WHERE PetType  =  'dog' AND pet_age  IN (SELECT pet_age FROM dog_ages)) SELECT weight FROM min_weight"
        },
        {
          "sql": "SELECT weight FROM Pets p WHERE PetType  =  'dog' AND pet_age  =  (SELECT pet_age FROM Pets WHERE PetType  =  'dog' ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT p.weight FROM Pets p INNER JOIN Pets p2 ON p.PetType  =  p2.PetType AND p.pet_age  =  p2.pet_age WHERE p.PetType  =  'dog' AND p2.pet_age  =  (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID  IN (SELECT PetID FROM Pets WHERE PetType  =  'dog' AND pet_age  =  (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog'))"
        },
        {
          "sql": "SELECT ANY_VALUE(weight) FROM Pets WHERE PetType  =  'dog' AND pet_age  =  (SELECT MIN(pet_age) FROM Pets WHERE PetType  =  'dog')"
        }
      ]
    },
    {
      "id": 49,
      "question": "Find the maximum weight for each type of pet. List the maximum weight and pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT MAX(weight) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT p.PetType, MAX(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "WITH pet_max AS (SELECT PetType, MAX(weight) AS max_wt FROM Pets GROUP BY PetType) SELECT PetType, max_wt FROM pet_max"
        },
        {
          "sql": "SELECT PetType, (SELECT MAX(weight) FROM Pets WHERE PetType = outer_pets.PetType) FROM Pets outer_pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType ORDER BY MAX(weight) DESC"
        },
        {
          "sql": "SELECT DISTINCT PetType, MAX(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, GREATEST(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, MAX(p2.weight) FROM Pets p1 JOIN Pets p2 ON p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets WHERE weight > 0 GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY weight DESC) as rn FROM Pets) SELECT PetType, weight FROM pet_stats WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType LIMIT 1000"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType) AS subq"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType UNION SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT pt.PetType, MAX(p.weight) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, MAX(CAST(weight AS DECIMAL)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets GROUP BY PetType, PetType"
        },
        {
          "sql": "SELECT PetType, MAX(weight) FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType = Pets.PetType) GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, (SELECT MAX(weight) FROM Pets WHERE PetType = p.PetType LIMIT 1) FROM (SELECT DISTINCT PetType FROM Pets) p"
        }
      ]
    },
    {
      "id": 50,
      "question": "List the maximum weight and type for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT max(weight) FROM Pets P2 WHERE P2.PetType  =  P1.PetType) FROM Pets P1 GROUP BY PetType"
        },
        {
          "sql": "SELECT P1.PetType, max(P2.weight) FROM Pets P1 JOIN Pets P2 ON P1.PetType  =  P2.PetType GROUP BY P1.PetType"
        },
        {
          "sql": "WITH pet_max AS (SELECT PetType, max(weight) AS max_wt FROM Pets GROUP BY PetType) SELECT PetType, max_wt FROM pet_max"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets HAVING PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, greatest(weight) FROM Pets P1 WHERE weight  =  (SELECT max(weight) FROM Pets P2 WHERE P2.PetType  =  P1.PetType) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY max(weight) DESC"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType HAVING count(*)  >  0"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, weight, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY weight DESC) as rn FROM Pets) SELECT PetType, weight FROM ranked_pets WHERE rn  =  1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, max(h.PetID) FROM Pets p JOIN Has_Pet h ON p.PetID  =  h.PetID GROUP BY p.PetType, p.weight HAVING max(p.weight)  =  (SELECT max(weight) FROM Pets WHERE PetType  =  p.PetType)"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM (SELECT * FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) IGNORE NULLS FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets UNION SELECT PetType FROM pet_types) SELECT pt.PetType, max(p.weight) FROM pet_types pt JOIN Pets p ON pt.PetType  =  p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FOR UPDATE"
        },
        {
          "sql": "SELECT PetType, (SELECT max(weight) FROM Pets WHERE PetType  =  outer_pets.PetType) FROM (SELECT DISTINCT PetType FROM Pets) outer_pets"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets t1 WHERE NOT EXISTS (SELECT 1 FROM Pets t2 WHERE t2.PetType  =  t1.PetType AND t2.weight  >  t1.weight) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, CORR(weight) FROM Pets GROUP BY PetType HAVING max(weight) IS NOT NULL"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ROLLUP(PetType) HAVING PetType IS NOT NULL"
        }
      ]
    },
    {
      "id": 51,
      "question": "Find number of pets owned by students who are older than 20.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets P WHERE P.PetID IN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT count(DISTINCT P.PetID) FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.Age > 20"
        },
        {
          "sql": "SELECT count(H.PetID) FROM Has_Pet H WHERE H.StuID IN (SELECT S.StuID FROM Student S WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT sum(CASE WHEN H.StuID IN (SELECT S.StuID FROM Student S WHERE S.Age > 20) THEN 1 ELSE 0 END) FROM Has_Pet H"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS T1"
        },
        {
          "sql": "WITH OlderStudents AS (SELECT StuID FROM Student WHERE Age > 20) SELECT count(H.PetID) FROM Has_Pet H JOIN OlderStudents O ON H.StuID = O.StuID"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON S.StuID = H.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT count(*) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age > 20)"
        },
        {
          "sql": "SELECT count(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT sum(CASE WHEN S.Age > 20 THEN 1 ELSE 0 END) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT count(P.*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H.StuID AND S.Age > 20)"
        },
        {
          "sql": "SELECT count(H.*) FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H.StuID AND S.Age > 20)"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age > 20)) AS result"
        },
        {
          "sql": "SELECT count(*) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 WHERE P1.PetID IN (SELECT H1.PetID FROM Has_Pet H1 WHERE H1.StuID IN (SELECT S1.StuID FROM Student S1 WHERE S1.Age > 20))"
        },
        {
          "sql": "SELECT cardinality(ARRAY_AGG(DISTINCT H.PetID)) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT P.PetID, S.Age FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) T"
        },
        {
          "sql": "SELECT (SELECT count(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) FROM dual"
        },
        {
          "sql": "SELECT count(*) FROM Pets CROSS JOIN (SELECT StuID FROM Student WHERE Age > 20) AS OS WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID = OS.StuID)"
        },
        {
          "sql": "SELECT count(H.PetID) FROM Has_Pet H, Student S WHERE H.StuID = S.StuID AND S.Age > 20"
        },
        {
          "sql": "SELECT regr_count(H.PetID, S.Age) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        }
      ]
    },
    {
      "id": 52,
      "question": "How many pets are owned by students that have an age greater than 20?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetID IN (SELECT PetID FROM Has_Pet H WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT SUM(CASE WHEN P.PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS temp"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Age > 20)"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetID IN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Pets P1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Student S1 ON H1.StuID = S1.StuID WHERE H1.PetID = P1.PetID AND S1.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT P.PetID FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) t"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) AS sub ON P.PetID = sub.PetID"
        },
        {
          "sql": "SELECT SUM(CASE WHEN H.StuID IS NOT NULL THEN 1 ELSE 0 END) FROM Pets P LEFT JOIN Has_Pet H ON P.PetID = H.PetID LEFT JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(ALL P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P INNER JOIN (SELECT DISTINCT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20)) sub ON P.PetID = sub.PetID"
        },
        {
          "sql": "WITH older_students AS (SELECT StuID FROM Student WHERE Age > 20) SELECT COUNT(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN older_students OS ON H.StuID = OS.StuID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT H.PetID FROM Has_Pet H INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 GROUP BY H.PetID) AS pet_count"
        },
        {
          "sql": "SELECT REPEAT('*', (SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20))"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.Age > 20"
        }
      ]
    },
    {
      "id": 53,
      "question": "Find the number of dog pets that are raised by female students (with sex F).",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F') AS T"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Sex = 'F')) AND PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE PetID IN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F') AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F') H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT SUM(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S WHERE S.Sex = 'F' AND EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON P.PetID = H.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT H.StuID, H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F') T JOIN Pets P ON T.PetID = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.* FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Sex = 'F') AND P.PetType = 'dog') T"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM (Student S CROSS JOIN Pets P) T JOIN Has_Pet H ON T.S.StuID = H.StuID AND T.P.PetID = H.PetID WHERE T.S.Sex = 'F' AND T.P.PetType = 'dog'"
        },
        {
          "sql": "WITH FemaleDogs AS (SELECT PetID FROM Pets WHERE PetType = 'dog') SELECT COUNT(*) FROM FemaleDogs F JOIN Has_Pet H ON F.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H INNER JOIN (SELECT StuID FROM Student WHERE Sex = 'F') F ON H.StuID = F.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE P.PetType = 'dog' AND EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Sex = 'F')"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON S.StuID = H.StuID WHERE S.Sex = 'F') F ON P.PetID = F.PetID WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT SUM(CASE WHEN S.Sex = 'F' AND P.PetType = 'dog' THEN 1 ELSE 0 END) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID"
        }
      ]
    },
    {
      "id": 54,
      "question": "How many dog pets are raised by female students?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(DISTINCT H1.PetID) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Student S1 INNER JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID INNER JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT S1.StuID FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog') AS T1"
        },
        {
          "sql": "SELECT sum(CASE WHEN P1.PetType  =  'dog' THEN 1 ELSE 0 END) FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE P1.PetType  =  'dog' AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 INNER JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID INNER JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE P1.PetType  =  'dog' AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Student S1, Has_Pet H1, Pets P1 WHERE S1.StuID  =  H1.StuID AND H1.PetID  =  P1.PetID AND S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(H1.PetID) FROM Has_Pet H1, Student S1, Pets P1 WHERE H1.StuID  =  S1.StuID AND H1.PetID  =  P1.PetID AND S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT H1.PetID, S1.Sex, P1.PetType FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID JOIN Pets P1 ON H1.PetID  =  P1.PetID) AS T1 WHERE T1.Sex  =  'F' AND T1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM (Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID) JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE S1.Sex  =  'F' AND P1.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM Student S1 WHERE S1.Sex  =  'F' AND EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID  =  P1.PetID WHERE H1.StuID  =  S1.StuID AND P1.PetType  =  'dog')"
        },
        {
          "sql": "SELECT count(H1.PetID) FROM Has_Pet H1 WHERE H1.StuID IN (SELECT S1.StuID FROM Student S1 WHERE S1.Sex  =  'F') AND EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID  =  H1.PetID AND P1.PetType  =  'dog')"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 WHERE P1.PetType  =  'dog' AND EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Student S1 ON H1.StuID  =  S1.StuID WHERE H1.PetID  =  P1.PetID AND S1.Sex  =  'F')"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT P1.PetID FROM Pets P1 JOIN Has_Pet H1 ON P1.PetID  =  H1.PetID WHERE P1.PetType  =  'dog' AND H1.StuID IN (SELECT StuID FROM Student WHERE Sex  =  'F')) AS T1"
        },
        {
          "sql": "SELECT sum(CASE WHEN P1.PetType  =  'dog' AND S1.Sex  =  'F' THEN 1 ELSE 0 END) FROM Student S1 CROSS JOIN Has_Pet H1 CROSS JOIN Pets P1 WHERE S1.StuID  =  H1.StuID AND H1.PetID  =  P1.PetID"
        },
        {
          "sql": "SELECT count(DISTINCT P1.PetID) FROM Pets P1, Has_Pet H1, Student S1 WHERE P1.PetID  =  H1.PetID AND H1.StuID  =  S1.StuID AND P1.PetType  =  'dog' AND S1.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Has_Pet H1 INNER JOIN (SELECT StuID FROM Student WHERE Sex  =  'F') S1 ON H1.StuID  =  S1.StuID INNER JOIN (SELECT PetID FROM Pets WHERE PetType  =  'dog') P1 ON H1.PetID  =  P1.PetID"
        },
        {
          "sql": "SELECT count(H1.PetID) FROM (SELECT StuID FROM Student WHERE Sex  =  'F') S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN (SELECT PetID FROM Pets WHERE PetType  =  'dog') P1 ON H1.PetID  =  P1.PetID"
        },
        {
          "sql": "SELECT count(*) FROM ((SELECT StuID FROM Student WHERE Sex  =  'F') S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID) JOIN (SELECT PetID FROM Pets WHERE PetType  =  'dog') P1 ON H1.PetID  =  P1.PetID"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 WHERE P1.PetType  =  'dog' AND P1.PetID IN (SELECT H1.PetID FROM Has_Pet H1 WHERE H1.StuID IN (SELECT S1.StuID FROM Student S1 WHERE S1.Sex  =  'F'))"
        }
      ]
    },
    {
      "id": 55,
      "question": "Find the number of distinct type of pets.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE pet_age > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE weight > 0) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets CROSS JOIN Has_Pet"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P1 GROUP BY PetType HAVING PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P1.PetType) FROM Pets P1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets UNION SELECT PetType FROM Pets) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT MAX(PetType) AS PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets INTERSECT SELECT PetType FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets GROUP BY PetType)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets EXCEPT SELECT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets ORDER BY PetType) AS T1 GROUP BY PetType"
        },
        {
          "sql": "WITH PetTypes AS (SELECT DISTINCT PetType FROM Pets) SELECT COUNT(*) FROM PetTypes"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets P1 JOIN Has_Pet H ON 1=1"
        }
      ]
    },
    {
      "id": 56,
      "question": "How many different types of pet are there?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE pet_age > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE PetID > 0 GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets CROSS JOIN Has_Pet"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets JOIN Has_Pet ON Pets.PetID = Has_Pet.PetID) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetType) FROM Pets AS P"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT P.PetType FROM Pets AS P) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetType) FROM Pets AS P JOIN Has_Pet AS H ON P.PetID = H.PetID"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets AS P GROUP BY P.PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets UNION SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets EXCEPT SELECT PetType FROM Pets WHERE PetID = -1) AS T1"
        },
        {
          "sql": "WITH PetTypes AS (SELECT DISTINCT PetType FROM Pets) SELECT COUNT(*) FROM PetTypes"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets HAVING COUNT(DISTINCT PetType) > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType, ROW_NUMBER() OVER (PARTITION BY PetType) as rn FROM Pets) AS T1 WHERE rn = 1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM (SELECT PetType FROM Pets LIMIT 999999) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets WHERE weight IS NOT NULL) AS T1"
        }
      ]
    },
    {
      "id": 57,
      "question": "Find the first name of students who have cat or dog pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' OR PetType='dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' OR P.PetType='dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=Student.StuID AND (P.PetType='cat' OR P.PetType='dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat')) UNION (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='dog'))) T JOIN Student S ON T.StuID=S.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID=H.PetID AND (P.PetType='cat' OR P.PetType='dog')))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID=S.StuID AND H.PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' OR PetType='dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))) T ON S.StuID=T.StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.Fname, H.StuID FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType='cat' OR PetType='dog')) T"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet INTERSECT SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType IN ('cat','dog')) > 0"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID WHERE H.PetID=(SELECT PetID FROM Pets WHERE PetType='cat' LIMIT 1) OR H.PetID IN (SELECT PetID FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "WITH CatOwners AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat')), DogOwners AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='dog')) SELECT Fname FROM Student WHERE StuID IN (SELECT * FROM CatOwners UNION SELECT * FROM DogOwners)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID=ANY (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' OR P.PetType='dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S LEFT JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType LIKE '%cat%' OR PetType LIKE '%dog%'))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat' UNION SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='dog') T"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID=H1.PetID AND (P1.PetType='cat' OR P1.PetType='dog')))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student, Has_Pet H, Pets P WHERE Student.StuID=H.StuID AND H.PetID=P.PetID AND (P.PetType='cat' OR P.PetType='dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING MAX(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')) THEN 1 ELSE 0 END)=1)"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN PetOwners PO ON S.StuID=PO.StuID"
        }
      ]
    },
    {
      "id": 58,
      "question": "What are the first names of every student who has a cat or dog as a pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' OR PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog'"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student JOIN Has_Pet USING(StuID) JOIN Pets USING(PetID) WHERE PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) UNION (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))) t JOIN Student S ON t.StuID = S.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType IN ('cat','dog')) t ON S.StuID = t.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')))"
        },
        {
          "sql": "WITH pet_owners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN pet_owners PO ON S.StuID = PO.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType IN ('cat','dog')))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.Fname, H.StuID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) t1 JOIN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) t2 ON t1.StuID = t2.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student INTERSECT SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog')) > 0"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog') LIMIT 1) t ON true"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING MAX(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')) THEN 1 ELSE 0 END) = 1)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog' GROUP BY H.StuID) owners ON S.StuID = owners.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) t WHERE PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT DISTINCT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND (P.PetType = 'cat' OR P.PetType = 'dog'))"
        }
      ]
    },
    {
      "id": 59,
      "question": "Find the first name of students who have both cat and dog pets .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' INTERSECT SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND H1.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND H1.StuID = S.StuID) AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog' AND H2.StuID = S.StuID)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND S.StuID IN (SELECT HP2.StuID FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.StuID, S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat', 'dog')) T WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') AND StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (SELECT COUNT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType IN ('cat', 'dog')) = 2"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM (SELECT PetType FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat' UNION SELECT PetType FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog') T) = 2"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') D ON S.StuID = D.StuID"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat'), DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM CatOwners INTERSECT SELECT StuID FROM DogOwners)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet HP JOIN Pets P ON HP.PetID = P.PetID WHERE PetType = 'cat') AND StuID IN (SELECT StuID FROM Has_Pet HP2 JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM (Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID) JOIN Pets P1 ON H1.PetID = P1.PetID, (Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID) JOIN Pets P2 ON H2.PetID = P2.PetID WHERE S.StuID = S2.StuID AND P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) AND StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat') C ON 1=1 JOIN LATERAL (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog') D ON 1=1"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, COUNT(DISTINCT P.PetType) as pet_count FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat', 'dog') GROUP BY S.StuID, S.Fname) T WHERE pet_count = 2"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat' INTERSECT SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') AND EXISTS (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S INNER JOIN Has_Pet H1 ON S.StuID = H1.StuID INNER JOIN Pets P1 ON H1.PetID = P1.PetID INNER JOIN Has_Pet H2 ON S.StuID = H2.StuID INNER JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "WITH BothPets AS (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat', 'dog') GROUP BY H.StuID HAVING COUNT(DISTINCT P.PetType) = 2) SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM BothPets)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType IN ('cat', 'dog')) T GROUP BY StuID HAVING COUNT(DISTINCT PetType) = 2)"
        },
        {
          "sql": "SELECT Fname FROM Student S, (SELECT StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))) B WHERE S.StuID = B.StuID"
        }
      ]
    },
    {
      "id": 60,
      "question": "What are the students' first names who have both cats and dogs as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat') AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' INTERSECT SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(DISTINCT CASE WHEN P.PetType = 'cat' THEN H.PetID END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) > 0 AND (SELECT COUNT(DISTINCT CASE WHEN P.PetType = 'dog' THEN H.PetID END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) > 0"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, H.PetID, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType IN ('cat', 'dog') GROUP BY Fname HAVING COUNT(DISTINCT PetType) = 2"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) T GROUP BY StuID HAVING COUNT(DISTINCT PetType) = 2)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' INTERSECT SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog') X ON S.StuID = X.StuID"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'), DogOwners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM CatOwners INTERSECT SELECT StuID FROM DogOwners)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT C.StuID FROM (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C INTERSECT SELECT D.StuID FROM (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D)"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname FROM Student S1 JOIN Has_Pet H1 ON S1.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN Student S2 ON S1.StuID = S2.StuID JOIN Has_Pet H2 ON S2.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') OR NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.StuID, S.Fname FROM Student S) WHERE StuID IN (SELECT StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT P2.PetID FROM Pets P2 WHERE P2.PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID > 0 AND EXISTS (SELECT H.PetID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') AND EXISTS (SELECT H.PetID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))) T JOIN Student S ON T.StuID = S.StuID WHERE T.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 END) > 0 AND COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 END) > 0)"
        },
        {
          "sql": "WITH BothPets AS (SELECT H.StuID, COUNT(DISTINCT P.PetType) as pet_count FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog') GROUP BY H.StuID HAVING pet_count = 2) SELECT Fname FROM Student S JOIN BothPets B ON S.StuID = B.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID) LIKE '%cat%' AND (SELECT GROUP_CONCAT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID) LIKE '%dog%'"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID INNER JOIN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') D ON S.StuID = D.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet H1 JOIN (SELECT PetID FROM Pets WHERE PetType = 'cat') C ON H1.PetID = C.PetID INTERSECT SELECT StuID FROM Has_Pet H2 JOIN (SELECT PetID FROM Pets WHERE PetType = 'dog') D ON H2.PetID = D.PetID)"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) GROUP BY Fname HAVING SUM(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetType = 'dog' THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT T.StuID FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType = 'cat' GROUP BY StuID INTERSECT SELECT T.StuID FROM (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType = 'dog' GROUP BY StuID)"
        }
      ]
    },
    {
      "id": 61,
      "question": "Find the major and age of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID AND p.PetType = 'cat' WHERE p.PetID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE s.StuID NOT IN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') OR StuID < ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE 0 = (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s1.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s FULL OUTER JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_owners ON s.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s CROSS JOIN (SELECT COUNT(*) as cat_count FROM Pets WHERE PetType = 'cat') c WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h WHERE h.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) cat ON s.StuID = cat.StuID WHERE cat.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM (SELECT * FROM Student) s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = s.StuID AND PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student s WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h, Pets p WHERE h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE (SELECT COUNT(h.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') SELECT Major, Age FROM Student s LEFT JOIN cat_owners co ON s.StuID = co.StuID WHERE co.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student GROUP BY StuID, Major, Age HAVING SUM(CASE WHEN StuID IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s JOIN (SELECT StuID FROM Student EXCEPT SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') no_cats ON s.StuID = no_cats.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID IN (SELECT s.StuID FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s WHERE s.StuID <> ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "WITH no_cats AS (SELECT s.StuID FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')) SELECT Major, Age FROM Student s JOIN no_cats nc ON s.StuID = nc.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE EXISTS (SELECT 1 FROM (SELECT StuID FROM Student EXCEPT SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') temp WHERE temp.StuID = s.StuID)"
        }
      ]
    },
    {
      "id": 62,
      "question": "What major is every student who does not own a cat as a pet, and also how old are they?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.Major, S.Age FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT S.Major, S.Age FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT SELECT S.Major, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') OR StuID < ALL (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE 0 = (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s1.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student GROUP BY StuID, Major, Age HAVING SUM(CASE WHEN StuID IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s JOIN (SELECT DISTINCT StuID FROM Student EXCEPT SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') t ON s.StuID = t.StuID"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') SELECT Major, Age FROM Student s LEFT JOIN CatOwners c ON s.StuID = c.StuID WHERE c.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE (StuID, Major, Age) NOT IN (SELECT s.StuID, s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s_outer.Major, s_outer.Age FROM Student s_outer WHERE NOT EXISTS (SELECT 1 FROM Student s_inner JOIN Has_Pet h ON s_inner.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE s_inner.StuID = s_outer.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h WHERE h.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM (SELECT s.Major, s.Age, CASE WHEN p.PetType = 'cat' THEN 1 ELSE 0 END as has_cat FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID) t WHERE has_cat = 0 OR has_cat IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID IN (SELECT StuID FROM Student EXCEPT SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE (SELECT COUNT(p.PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Major, Age FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY StuID ORDER BY StuID) rn FROM Student) s WHERE rn = 1 AND StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p WHERE p.PetType = 'cat' AND h.PetID = p.PetID)"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 FULL OUTER JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat ON s1.StuID = cat.StuID WHERE cat.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE NOT (EXISTS (SELECT 1 FROM Pets p WHERE p.PetType = 'cat' AND p.PetID IN (SELECT h.PetID FROM Has_Pet h WHERE h.StuID = Student.StuID)))"
        },
        {
          "sql": "WITH NoCats AS (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')) SELECT s.Major, s.Age FROM Student s JOIN NoCats n ON s.StuID = n.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student MINUS (SELECT s.Major, s.Age FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID INNER JOIN Pets p ON h.PetID = p.PetID WHERE LOWER(p.PetType) = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_owners ON s.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        }
      ]
    },
    {
      "id": 63,
      "question": "Find the id of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat' WHERE P.PetID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student EXCEPT SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID NOT IN (SELECT H1.StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType = 'cat'))"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT -1) AND StuID < ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT 999999)"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE 0 = (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S LEFT JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Pets P WHERE P.PetType = 'cat' AND P.PetID IN (SELECT H.PetID FROM Has_Pet H WHERE H.StuID = S.StuID))"
        },
        {
          "sql": "SELECT StuID FROM (SELECT S.StuID, COUNT(P.PetType) as cat_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat' GROUP BY S.StuID) T WHERE cat_count = 0"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID(+) AND H.PetID = P.PetID(+) AND P.PetType(+) = 'cat' AND P.PetID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Student S2, Has_Pet H, Pets P WHERE S1.StuID = S2.StuID AND S2.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S CROSS JOIN (SELECT 1 as dummy FROM dual WHERE 1=0 UNION SELECT COUNT(*) FROM Pets WHERE PetType <> 'cat') T LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.PetID IS NULL"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT S.StuID FROM Student S LEFT JOIN cat_owners C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student GROUP BY StuID HAVING SUM(CASE WHEN StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM (SELECT S.StuID FROM Student S UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType <> 'cat') WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID <> ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        }
      ]
    },
    {
      "id": 64,
      "question": "What are the ids of the students who do not own cats as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT DISTINCT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE 0 = (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat' WHERE P.PetID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID <> ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE NOT (StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S, (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C WHERE S.StuID <> C.StuID OR C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM (SELECT S.StuID, CASE WHEN COUNT(P.PetType) > 0 AND SUM(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) > 0 THEN 1 ELSE 0 END AS has_cat FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID LEFT JOIN Pets P ON HP.PetID = P.PetID GROUP BY S.StuID) T WHERE has_cat = 0"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S LEFT JOIN (SELECT H.StuID, P.PetType FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT COUNT(DISTINCT P.PetID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT H.StuID - 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') OR StuID < ALL (SELECT H.StuID + 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') UNION SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT MATCH (SELECT 1 FROM Has_Pet H, Pets P WHERE H.StuID = S.StuID AND H.PetID = P.PetID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student GROUP BY StuID HAVING SUM(CASE WHEN EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT S.StuID FROM Student S LEFT JOIN cat_owners CO ON S.StuID = CO.StuID WHERE CO.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT BOOL_AND(P.PetType != 'cat') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) OR (SELECT COUNT(*) FROM Has_Pet H WHERE H.StuID = S.StuID) = 0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM ((SELECT S.StuID FROM Student S) UNION (SELECT NULL FROM Has_Pet)) T LEFT JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON T.StuID = C.StuID WHERE C.StuID IS NULL"
        }
      ]
    },
    {
      "id": 65,
      "question": "Find the first name and age of students who have a dog but do not have a cat as a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE h1.StuID = Student.StuID AND p1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE h2.StuID = Student.StuID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s JOIN Has_Pet hp1 ON s.StuID = hp1.StuID JOIN Pets p1 ON hp1.PetID = p1.PetID WHERE p1.PetType = 'dog' AND s.StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE p.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE h2.StuID = s.StuID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student s1 WHERE EXISTS (SELECT 1 FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE h1.StuID = s1.StuID AND p1.PetType = 'dog') AND s1.StuID NOT IN (SELECT h2.StuID FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog' GROUP BY h.StuID HAVING COUNT(CASE WHEN p.PetType = 'cat' THEN 1 END) = 0)"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s INNER JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog') dog_owners ON s.StuID = dog_owners.StuID LEFT JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_owners ON s.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT s.Fname, s.Age, p.PetType FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID) pet_owners WHERE PetType = 'dog' AND StuID NOT IN (SELECT StuID FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE p2.PetType = 'cat') GROUP BY Fname, Age, StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s WHERE StuID IN (SELECT StuID FROM Has_Pet h GROUP BY StuID HAVING SUM(CASE WHEN p.PetType = 'dog' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN p.PetType = 'cat' THEN 1 ELSE 0 END) = 0 FROM Pets p WHERE h.PetID = p.PetID)"
        },
        {
          "sql": "WITH dog_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), cat_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname, Age FROM Student WHERE StuID IN (SELECT * FROM dog_owners) AND StuID NOT IN (SELECT * FROM cat_owners)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student EXCEPT SELECT Fname, Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat' INTERSECT SELECT Fname, Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s JOIN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog' GROUP BY h.StuID) dogs ON s.StuID = dogs.StuID LEFT JOIN Has_Pet h_cat ON s.StuID = h_cat.StuID LEFT JOIN Pets p_cat ON h_cat.PetID = p_cat.PetID AND p_cat.PetType = 'cat' WHERE p_cat.PetID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT h1.StuID FROM Has_Pet h1 WHERE h1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID NOT IN (SELECT h2.StuID FROM Has_Pet h2 WHERE h2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT s.Fname, s.Age FROM ((Student s JOIN Has_Pet hp1 ON s.StuID = hp1.StuID) JOIN Pets p1 ON hp1.PetID = p1.PetID) LEFT JOIN ((Has_Pet hp2 JOIN Pets p2 ON hp2.PetID = p2.PetID) JOIN Student s2 ON hp2.StuID = s2.StuID) ON s.StuID = s2.StuID AND p2.PetType = 'cat' WHERE p1.PetType = 'dog' AND p2.PetID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s WHERE (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID <> ALL (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT s1.Fname, s1.Age FROM Student s1, (SELECT DISTINCT StuID FROM Has_Pet h1, Pets p1 WHERE h1.PetID = p1.PetID AND p1.PetType = 'dog') d WHERE s1.StuID = d.StuID AND s1.StuID NOT IN (SELECT h2.StuID FROM Has_Pet h2, Pets p2 WHERE h2.PetID = p2.PetID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT s.*, p.PetType FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID INNER JOIN Pets p ON h.PetID = p.PetID) combined WHERE PetType = 'dog' AND StuID NOT EXISTS (SELECT 1 FROM Has_Pet hx JOIN Pets px ON hx.PetID = px.PetID WHERE hx.StuID = combined.StuID AND px.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s WHERE EXISTS (SELECT 1 FROM (SELECT h.StuID, p.PetType FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID) dogpets WHERE dogpets.StuID = s.StuID AND dogpets.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM (SELECT h.StuID, p.PetType FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID) catpets WHERE catpets.StuID = s.StuID AND catpets.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog' MINUS SELECT Fname, Age FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat'"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT h.StuID, MAX(p.PetType) pet_type FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID) ranked WHERE pet_type = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM ((SELECT s.StuID, s.Fname, s.Age FROM Student s WHERE EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE s.StuID = h.StuID AND p.PetType = 'dog')) dog_students CROSS JOIN (SELECT DISTINCT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType != 'cat')) no_cats WHERE dog_students.StuID = no_cats.StuID"
        }
      ]
    },
    {
      "id": 66,
      "question": "What is the first name of every student who has a dog but does not have a cat?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog' AND H1.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID LEFT JOIN Has_Pet HP2 ON S.StuID = HP2.StuID LEFT JOIN Pets P2 ON HP2.PetID = P2.PetID AND P2.PetType = 'cat' WHERE P1.PetType = 'dog' AND P2.PetID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C ON D.StuID = C.StuID JOIN Student S ON D.StuID = S.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' INTERSECT SELECT Fname FROM Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) DogOwners ON S.StuID = DogOwners.StuID LEFT JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) CatOwners ON S.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 INNER JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') MINUS (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')) DogOnly JOIN Student ON DogOnly.StuID = Student.StuID"
        },
        {
          "sql": "WITH DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname FROM Student JOIN DogOwners ON Student.StuID = DogOwners.StuID LEFT JOIN CatOwners ON Student.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT S.Fname FROM Student S WHERE S.StuID = ANY (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') AND S.StuID <> ALL (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'dog') AND StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'dog' AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT H.PetID FROM Has_Pet H, Pets P WHERE H.StuID = S.StuID AND H.PetID = P.PetID AND P.PetType = 'dog') AND NOT EXISTS (SELECT H2.PetID FROM Has_Pet H2, Pets P2 WHERE H2.StuID = S.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) as dog_count, COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) as cat_count FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY S.StuID, S.Fname) t WHERE dog_count > 0 AND cat_count = 0"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 ELSE 0 END) > 0) AND StuID NOT IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT S1.Fname FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE S1.StuID = S2.StuID AND P2.PetType = 'cat') AND EXISTS (SELECT 1 FROM Student S3 JOIN Has_Pet H3 ON S3.StuID = H3.StuID JOIN Pets P3 ON H3.PetID = P3.PetID WHERE S1.StuID = S3.StuID AND P3.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog' LIMIT 1) dog ON true LEFT JOIN LATERAL (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat' LIMIT 1) cat ON true WHERE cat IS NULL"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID, MAX(CASE WHEN PetType = 'dog' THEN 1 ELSE 0 END) as has_dog, MAX(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) as has_cat FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID GROUP BY StuID) filtered WHERE has_dog = 1 AND has_cat = 0 JOIN Student ON filtered.StuID = Student.StuID"
        }
      ]
    },
    {
      "id": 67,
      "question": "Find the type and weight of the youngest pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT p1.PetType, p1.weight FROM Pets p1 WHERE p1.pet_age = (SELECT MIN(p2.pet_age) FROM Pets p2)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT PetType, weight FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 JOIN (SELECT MIN(pet_age) AS min_age FROM Pets) p2 ON p1.pet_age = p2.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age) AS rn FROM Pets) WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "WITH min_pet AS (SELECT MIN(pet_age) AS min_age FROM Pets) SELECT PetType, weight FROM Pets, min_pet WHERE pet_age = min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets GROUP BY pet_age ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p INNER JOIN (SELECT PetID FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)) m ON p.PetID = m.PetID"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets FETCH FIRST 1 ROW ONLY ORDER BY pet_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = ANY (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE pet_age <= (SELECT pet_age FROM Pets p2 ORDER BY p2.pet_age LIMIT 1)"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, weight, pet_age, DENSE_RANK() OVER (ORDER BY pet_age) AS rnk FROM Pets) SELECT PetType, weight FROM ranked_pets WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets GROUP BY PetType, weight, pet_age HAVING pet_age = MIN(pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, MIN(pet_age) OVER () AS min_age FROM Pets) WHERE pet_age = min_age"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p, (SELECT MIN(pet_age) min_age FROM Pets) m WHERE p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE (pet_age, PetID) = (SELECT pet_age, PetID FROM Pets ORDER BY pet_age, PetID LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets LIMIT 1 OFFSET 0 ORDER BY pet_age"
        },
        {
          "sql": "WITH youngest_age AS (SELECT pet_age FROM Pets ORDER BY pet_age LIMIT 1) SELECT PetType, weight FROM Pets, youngest_age WHERE pet_age = youngest_age.pet_age"
        }
      ]
    },
    {
      "id": 68,
      "question": "What type of pet is the youngest animal, and how much does it weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age=(SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age=MIN(pet_age)"
        },
        {
          "sql": "SELECT p.PetType,p.weight FROM Pets p WHERE p.pet_age=(SELECT MIN(p2.pet_age) FROM Pets p2)"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT PetType,weight FROM Pets p1 WHERE NOT EXISTS(SELECT 1 FROM Pets p2 WHERE p2.pet_age<p1.pet_age)"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age <= ALL(SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets p1 WHERE pet_age <= (SELECT MIN(pet_age) FROM Pets p2)"
        },
        {
          "sql": "SELECT PetType,weight FROM (SELECT *,ROW_NUMBER() OVER(ORDER BY pet_age ASC) rn FROM Pets) WHERE rn=1"
        },
        {
          "sql": "SELECT PetType,weight FROM (SELECT *,RANK() OVER(ORDER BY pet_age ASC) rnk FROM Pets) WHERE rnk=1"
        },
        {
          "sql": "SELECT PetType,weight FROM (SELECT *,DENSE_RANK() OVER(ORDER BY pet_age) rnk FROM Pets) t WHERE rnk=1"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(pet_age) min_age FROM Pets) SELECT PetType,weight FROM Pets p,youngest y WHERE p.pet_age=y.min_age"
        },
        {
          "sql": "WITH min_age_cte AS (SELECT MIN(pet_age) AS min_age FROM Pets) SELECT p.PetType,p.weight FROM Pets p JOIN min_age_cte m ON p.pet_age=m.min_age"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets GROUP BY PetType,weight,pet_age HAVING pet_age=MIN(pet_age)"
        },
        {
          "sql": "SELECT PetType,weight FROM (SELECT PetType,weight,MIN(pet_age) OVER() min_age FROM Pets) WHERE pet_age=min_age"
        },
        {
          "sql": "SELECT p.PetType,p.weight FROM Pets p JOIN (SELECT MIN(pet_age) min_age FROM Pets) m ON p.pet_age=m.min_age"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age=(SELECT pet_age FROM Pets p ORDER BY p.pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets p WHERE 0=(SELECT COUNT(*) FROM Pets p2 WHERE p2.pet_age<p.pet_age)"
        },
        {
          "sql": "SELECT FIRST_VALUE(PetType) OVER(ORDER BY pet_age ASC),FIRST_VALUE(weight) OVER(ORDER BY pet_age ASC) FROM Pets LIMIT 1"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets FETCH FIRST 1 ROW ONLY ORDER BY pet_age ASC"
        },
        {
          "sql": "SELECT PetType,weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age ASC LIMIT 1) LIMIT 1"
        }
      ]
    },
    {
      "id": 69,
      "question": "Find the id and weight of all pets whose age is older than 1.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT (pet_age <= 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age NOT BETWEEN 0 AND 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ANY (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT AVG(pet_age) FROM Pets WHERE pet_age <= 1)"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE 1 < pet_age"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age IN (SELECT pet_age FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT p1.PetID, p1.weight FROM Pets p1, Pets p2 WHERE p1.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age > 1 AND p2.PetID = Pets.PetID)"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT * FROM Pets) AS p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age - 1 > 0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS threshold) t WHERE pet_age > t.threshold"
        },
        {
          "sql": "WITH threshold AS (SELECT 1 AS limit_age) SELECT PetID, weight FROM Pets, threshold WHERE pet_age > threshold.limit_age"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age::numeric > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age BETWEEN 2 AND 100"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT pet_age FROM Pets WHERE pet_age = 1 LIMIT 1)"
        }
      ]
    },
    {
      "id": 70,
      "question": "What is the id and weight of every pet who is older than 1?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > '1'"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT pet_age <= 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age BETWEEN 2 AND 999"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT MIN(pet_age) FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS (SELECT 1 FROM Pets P2 WHERE P2.PetID = Pets.PetID AND P2.pet_age > 1)"
        },
        {
          "sql": "SELECT P1.PetID, P1.weight FROM Pets P1 WHERE P1.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT * FROM Pets) AS T1 WHERE T1.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age - 1 > 0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age <> 1 AND pet_age IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS dummy) WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 FETCH FIRST 100000 ROWS ONLY"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 LIMIT 100000"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > CASE WHEN 1=1 THEN 1 ELSE 0 END"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets P WHERE P.pet_age > (SELECT AVG(pet_age)-10 FROM Pets)"
        },
        {
          "sql": "WITH EligiblePets AS (SELECT * FROM Pets WHERE pet_age > 1) SELECT PetID, weight FROM EligiblePets"
        }
      ]
    },
    {
      "id": 71,
      "question": "Find the average and maximum age for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) AS avg_age, MAX(pet_age) AS max_age FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets AS p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT t.PetType, AVG(t.pet_age), MAX(t.pet_age) FROM Pets t GROUP BY t.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1 GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, pet_age FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(pet_age AS FLOAT)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p2.pet_age), MAX(p2.pet_age) FROM Pets p1 JOIN Pets p2 ON p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets WHERE pet_age IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(pet_age)/COUNT(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH stats AS (SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType) SELECT * FROM stats"
        },
        {
          "sql": "SELECT PetType, CORR(pet_age, pet_age)*COUNT(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT p.PetType, (SELECT AVG(pet_age) FROM Pets WHERE PetType = p.PetType), (SELECT MAX(pet_age) FROM Pets WHERE PetType = p.PetType) FROM Pets p"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), GREATEST(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT pt.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM (SELECT * FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, EXTRACT(EPOCH FROM AVG(pet_age))/3600, MAX(pet_age) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 72,
      "question": "What is the average and maximum age for each pet type?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  AVG(pet_age) ,  MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(Pets.pet_age) ,  max(Pets.pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) average ,  max(pet_age) maximum FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age*1.0) ,  max(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  (SELECT avg(pet_age) FROM Pets P2 WHERE P2.PetType  =  Pets.PetType) ,  (SELECT max(pet_age) FROM Pets P3 WHERE P3.PetType  =  Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets AS P GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType ,  (SELECT avg(pet_age) FROM Pets WHERE PetType  =  outer.PetType) ,  (SELECT max(pet_age) FROM Pets WHERE PetType  =  outer.PetType) FROM Pets outer"
        },
        {
          "sql": "SELECT PetType ,  AVG(CAST(pet_age AS FLOAT)) ,  MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType ,  pet_age FROM Pets) SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  greatest(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "WITH aggregated_stats AS (SELECT PetType ,  avg(pet_age) AS avg_age ,  max(pet_age) AS max_age FROM Pets GROUP BY PetType) SELECT * FROM aggregated_stats"
        },
        {
          "sql": "SELECT PetType ,  (SUM(pet_age)/COUNT(pet_age)) ,  max(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM (SELECT * FROM Pets) t GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(DISTINCT pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType ,  (SELECT avg(p2.pet_age) FROM Pets p2 WHERE p2.PetType  =  p1.PetType) ,  (SELECT max(p2.pet_age) FROM Pets p2 WHERE p2.PetType  =  p1.PetType) FROM Pets p1 GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType HAVING count(*) > 0"
        },
        {
          "sql": "SELECT PetType ,  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType ,  avg(pet_age) OVER (PARTITION BY PetType) ,  max(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType ,  FIRST_VALUE(avg(pet_age)) OVER (PARTITION BY PetType) ,  LAST_VALUE(max(pet_age)) OVER (PARTITION BY PetType) FROM (SELECT PetType ,  avg(pet_age) ,  max(pet_age) FROM Pets GROUP BY PetType) t"
        }
      ]
    },
    {
      "id": 73,
      "question": "Find the average weight for each pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType,avg(CAST(weight AS FLOAT)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType,AVG(weight*1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType,avg(weight) OVER(PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType,(SELECT avg(weight) FROM Pets P2 WHERE P2.PetType=P1.PetType) FROM Pets P1 GROUP BY PetType"
        },
        {
          "sql": "WITH PetAvg AS(SELECT PetType,weight FROM Pets) SELECT PetType,avg(weight) FROM PetAvg GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType,avg(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets WHERE PetID>0 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType,sum(weight)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType,sum(weight*1.0)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType,avg(pet_age+weight-weight)/count(*) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType HAVING count(*)>0"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType ORDER BY 1"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType ORDER BY avg(weight)"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType ASC"
        },
        {
          "sql": "SELECT PetType,avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType ASC,avg(weight)"
        },
        {
          "sql": "SELECT DISTINCT PetType, (sum(weight)/count(*)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM Pets) SELECT PetType, avg(weight) FROM cte GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets WHERE weight > (SELECT min(weight) FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM (SELECT PetType, weight FROM Pets) t GROUP BY PetType"
        }
      ]
    },
    {
      "id": 74,
      "question": "What is the average weight for each type of pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(CAST(weight AS FLOAT)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, avg(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight*1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, avg(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT avg(weight) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, sum(weight)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, sum(weight*1.0)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets WHERE weight > 0 GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, weight FROM Pets) SELECT PetType, avg(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets GROUP BY PetType HAVING count(*) > 0"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets GROUP BY PetType ORDER BY avg(weight)"
        },
        {
          "sql": "SELECT p.PetType, avg(p.weight) FROM Pets p, Pets p2 WHERE p.PetType = p2.PetType GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets GROUP BY PetType UNION ALL SELECT PetType, avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType FROM Pets GROUP BY PetType ORDER BY avg(weight)"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, avg(weight) as w FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType, avg(weight) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, corr(weight,weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT PetType FROM Pets UNION SELECT PetType FROM pet_types) SELECT pt.PetType, avg(p.weight) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, regr_avgx(weight,1) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 75,
      "question": "Find the first name and age of students who have a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student NATURAL JOIN Has_Pet"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Age FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT S1.Fname, S1.Age FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = S1.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT StuID, Fname, Age FROM Student) S WHERE S.StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student S JOIN PetOwners P ON S.StuID = P.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT PetID FROM Has_Pet WHERE PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT H.StuID FROM Has_Pet H WHERE H.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student AS S INNER JOIN Has_Pet AS H ON S.StuID = H.StuID"
        },
        {
          "sql": "WITH StudentsWithPets AS (SELECT StuID FROM Has_Pet GROUP BY StuID) SELECT Fname, Age FROM Student S JOIN StudentsWithPets SWP ON S.StuID = SWP.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT * FROM Student) WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT T1.Fname, T1.Age FROM Student T1 JOIN Has_Pet T2 ON T1.StuID = T2.StuID"
        }
      ]
    },
    {
      "id": 76,
      "question": "What are the different first names and ages of the students who do have pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student NATURAL JOIN Has_Pet"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM ((Student JOIN Has_Pet) ON StuID = StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "WITH pet_owners AS (SELECT StuID FROM Has_Pet) SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM pet_owners)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE 1=(SELECT 1 FROM Has_Pet HP WHERE HP.StuID=Student.StuID LIMIT 1)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN Has_Pet H USING(StuID)"
        },
        {
          "sql": "WITH has_pet AS (SELECT StuID FROM Has_Pet GROUP BY StuID) SELECT Fname, Age FROM Student S JOIN has_pet HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S WHERE StuID IN (SELECT PetID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student LEFT JOIN Has_Pet H ON Student.StuID = H.StuID WHERE H.StuID IS NOT NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT * FROM Student) S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE StuID = (SELECT StuID FROM Has_Pet H WHERE H.StuID = Student.StuID)"
        },
        {
          "sql": "WITH RECURSIVE pet_students AS (SELECT StuID FROM Has_Pet UNION SELECT S.StuID FROM Student S JOIN pet_students P ON S.StuID = P.StuID) SELECT Fname, Age FROM Student WHERE StuID IN (SELECT * FROM pet_students)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE CORR(SELECT StuID FROM Student, SELECT StuID FROM Has_Pet) > 0 OR EXISTS(SELECT 1 FROM Has_Pet WHERE StuID = S.StuID)"
        }
      ]
    },
    {
      "id": 77,
      "question": "Find the id of the pet owned by student whose last name is \u2018Smith\u2019.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Pets JOIN Has_Pet ON Pets.PetID = Has_Pet.PetID JOIN Student ON Student.StuID = Has_Pet.StuID WHERE LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet JOIN Student ON Has_Pet.StuID = Student.StuID WHERE LName = 'Smith' AND Has_Pet.PetID = Pets.PetID)"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT DISTINCT Pets.PetID FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Pets.PetID = Has_Pet.PetID WHERE LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets p WHERE PetID IN (SELECT PetID FROM Has_Pet h WHERE h.StuID IN (SELECT StuID FROM Student s WHERE s.LName = 'Smith'))"
        },
        {
          "sql": "SELECT h.PetID FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') s JOIN Has_Pet h ON s.StuID = h.StuID"
        },
        {
          "sql": "SELECT PetID FROM Pets CROSS JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') s JOIN Has_Pet h ON s.StuID = h.StuID AND Pets.PetID = h.PetID"
        },
        {
          "sql": "SELECT PetID FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON p.PetID = hp.PetID WHERE s.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT PetID FROM Has_Pet WHERE StuID = ANY (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = ANY (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "WITH smith_students AS (SELECT StuID FROM Student WHERE LName = 'Smith') SELECT PetID FROM smith_students JOIN Has_Pet ON smith_students.StuID = Has_Pet.StuID"
        },
        {
          "sql": "WITH pet_owners AS (SELECT h.PetID FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith') SELECT PetID FROM pet_owners"
        },
        {
          "sql": "SELECT PetID FROM Pets p JOIN LATERAL (SELECT PetID FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID WHERE s.LName = 'Smith' AND h.PetID = p.PetID) t ON true"
        },
        {
          "sql": "SELECT h.PetID FROM Student WHERE LName = 'Smith' AND EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h WHERE EXISTS (SELECT 1 FROM Student s WHERE s.StuID = h.StuID AND s.LName = 'Smith')"
        },
        {
          "sql": "SELECT p.PetID FROM Pets p WHERE p.PetID IN (SELECT h.PetID FROM Has_Pet h, Student s WHERE h.StuID = s.StuID AND s.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM (SELECT s.StuID FROM Student s WHERE s.LName = 'Smith') AS temp JOIN Has_Pet ON temp.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM Has_Pet, Student WHERE Has_Pet.StuID = Student.StuID AND LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = (SELECT PetID FROM Has_Pet JOIN Student ON Has_Pet.StuID = Student.StuID WHERE LName = 'Smith' LIMIT 1)"
        },
        {
          "sql": "SELECT PetID FROM Student, Has_Pet, Pets WHERE Student.LName = 'Smith' AND Student.StuID = Has_Pet.StuID AND Has_Pet.PetID = Pets.PetID"
        }
      ]
    },
    {
      "id": 78,
      "question": "What is the id of the pet owned by the student whose last name is 'Smith'?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON S.StuID = H.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON S.StuID = H.StuID WHERE H.PetID = Pets.PetID AND S.LName = 'Smith')"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM Has_Pet H JOIN Student S ON S.StuID = H.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT H.PetID FROM Has_Pet H JOIN Student S ON S.StuID = H.StuID WHERE S.LName = 'Smith') AS sub"
        },
        {
          "sql": "SELECT H1.PetID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H1.StuID AND S.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON P.PetID = H.PetID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT P1.PetID FROM Pets P1 WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "WITH smith_stu AS (SELECT StuID FROM Student WHERE LName = 'Smith') SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM smith_stu)"
        },
        {
          "sql": "SELECT PetID FROM Pets P1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.PetID = P1.PetID AND H1.StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT H.PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = (SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT P.PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') sq JOIN Has_Pet HP ON sq.StuID = HP.StuID JOIN Pets P ON P.PetID = HP.PetID"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet HP1 WHERE HP1.StuID = ANY (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM ((Student S JOIN Has_Pet H ON S.StuID = H.StuID) JOIN Pets P ON P.PetID = H.PetID) WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets P2 WHERE PetID IN (SELECT DISTINCT PetID FROM Has_Pet H2 JOIN Student S2 ON S2.StuID = H2.StuID WHERE S2.LName = 'Smith')"
        },
        {
          "sql": "WITH smith_pets AS (SELECT H.PetID FROM Has_Pet H JOIN Student S ON S.StuID = H.StuID WHERE S.LName = 'Smith') SELECT PetID FROM smith_pets"
        },
        {
          "sql": "SELECT DISTINCT P.PetID FROM Student S1 INNER JOIN Has_Pet H ON S1.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE S1.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student S3 WHERE LName = 'Smith' LIMIT 1)"
        },
        {
          "sql": "SELECT Pet.PetID FROM Pets Pet CROSS JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') Smith JOIN Has_Pet ON Pet.PetID = Has_Pet.PetID AND Smith.StuID = Has_Pet.StuID"
        }
      ]
    },
    {
      "id": 79,
      "question": "Find the number of pets for each student who has any pet and student id.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.PetID) FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT DISTINCT Student.StuID, COUNT(Has_Pet.PetID) FROM Student, Has_Pet WHERE Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(h.PetID) FROM Has_Pet h WHERE EXISTS (SELECT 1 FROM Student s WHERE s.StuID = h.StuID) GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT s.StuID, COUNT(DISTINCT h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.PetID) FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT h1.StuID, (SELECT COUNT(PetID) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) FROM Has_Pet h1 GROUP BY h1.StuID"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, COUNT(h.PetID) FROM Student s, Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE PetID IS NOT NULL GROUP BY StuID"
        },
        {
          "sql": "WITH pet_counts AS (SELECT StuID, PetID FROM Has_Pet) SELECT s.StuID, COUNT(pc.PetID) FROM Student s JOIN pet_counts pc ON s.StuID = pc.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT Student.StuID, COUNT(*) FROM Student LEFT JOIN Has_Pet ON Student.StuID = Has_Pet.StuID WHERE Has_Pet.StuID IS NOT NULL GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT h.StuID, SUM(CASE WHEN h.PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM (SELECT DISTINCT StuID, PetID FROM Has_Pet) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s WHERE s.StuID IN (SELECT StuID FROM Has_Pet) AND EXISTS (SELECT 1 FROM Has_Pet h WHERE h.StuID = s.StuID) GROUP BY s.StuID"
        },
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.PetID) FROM Has_Pet JOIN Student ON Has_Pet.StuID = Student.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT DISTINCT h.StuID, COUNT(h.PetID) OVER (PARTITION BY h.StuID) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet h1 WHERE EXISTS (SELECT 1 FROM Student WHERE StuID = h1.StuID) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = s.StuID) FROM Student s WHERE EXISTS (SELECT 1 FROM Has_Pet h WHERE h.StuID = s.StuID)"
        },
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.PetID) FROM Student CROSS JOIN Has_Pet WHERE Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(DISTINCT h.PetID) FROM (SELECT StuID, PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student)) h GROUP BY h.StuID"
        }
      ]
    },
    {
      "id": 80,
      "question": "For students who have pets , how many pets does each student have ? list their ids instead of names .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID, count(PetID) FROM Student JOIN Has_Pet ON Student.StuID  =  Has_Pet.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT StuID, count(*) FROM Has_Pet JOIN Student ON Has_Pet.StuID  =  Student.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, count(h.PetID) FROM Has_Pet h JOIN Student s ON h.StuID  =  s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT Student.StuID, count(Has_Pet.PetID) FROM Student INNER JOIN Has_Pet ON Student.StuID  =  Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT DISTINCT h.StuID, (SELECT count(*) FROM Has_Pet h2 WHERE h2.StuID  =  h.StuID) FROM Has_Pet h JOIN Student s ON h.StuID  =  s.StuID"
        },
        {
          "sql": "SELECT s.StuID, (SELECT count(*) FROM Has_Pet WHERE StuID  =  s.StuID) FROM Student s WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID  =  s.StuID)"
        },
        {
          "sql": "SELECT StuID, count(PetID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, count(h.PetID) FROM Student s INNER JOIN Has_Pet h ON s.StuID  =  h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT h.StuID, count(DISTINCT h.PetID) FROM Has_Pet h INNER JOIN Student s ON h.StuID  =  s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, sum(1) FROM Has_Pet h JOIN Student s ON h.StuID  =  s.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, count(h.PetID) FROM Student s LEFT JOIN Has_Pet h ON s.StuID  =  h.StuID WHERE h.StuID IS NOT NULL GROUP BY s.StuID"
        },
        {
          "sql": "SELECT h1.StuID, (SELECT count(PetID) FROM Has_Pet h2 WHERE h2.StuID  =  h1.StuID) FROM Has_Pet h1 JOIN Student s ON h1.StuID  =  s.StuID GROUP BY h1.StuID"
        },
        {
          "sql": "SELECT StuID, count(PetID) FROM (SELECT DISTINCT StuID, PetID FROM Has_Pet) t JOIN Student s ON t.StuID  =  s.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, count(*) FROM Student s JOIN (SELECT StuID, PetID FROM Has_Pet) h ON s.StuID  =  h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "WITH pet_counts AS (SELECT StuID, count(PetID) as cnt FROM Has_Pet GROUP BY StuID) SELECT p.StuID, p.cnt FROM pet_counts p JOIN Student s ON p.StuID  =  s.StuID"
        },
        {
          "sql": "SELECT StuID, count(PetID) FROM Has_Pet GROUP BY StuID HAVING StuID IN (SELECT StuID FROM Student)"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, count(h.PetID) OVER (PARTITION BY s.StuID) FROM Student s JOIN Has_Pet h ON s.StuID  =  h.StuID"
        },
        {
          "sql": "SELECT StuID, cardinality(array_agg(PetID)) FROM Has_Pet h JOIN Student s ON h.StuID  =  s.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, count(h.PetID) FROM Student s, Has_Pet h WHERE s.StuID  =  h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT h.StuID, count(p.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID  =  p.PetID JOIN Student s ON h.StuID  =  s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID FROM (SELECT s.StuID, count(h.PetID) as pet_count FROM Student s JOIN Has_Pet h ON s.StuID  =  h.StuID GROUP BY s.StuID) t"
        },
        {
          "sql": "SELECT s.StuID, count(DISTINCT h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID  =  h.StuID GROUP BY s.StuID ORDER BY s.StuID"
        }
      ]
    },
    {
      "id": 81,
      "question": "Find the first name and gender of student who have more than one pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(PetID) > 1)"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student S WHERE (SELECT count(*) FROM Has_Pet H WHERE H.StuID  =  S.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT S.Fname ,  S.Sex FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID GROUP BY S.StuID ,  S.Fname ,  S.Sex HAVING count(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(DISTINCT PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname ,  S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID  =  H.StuID GROUP BY S.StuID ,  S.Fname ,  S.Sex HAVING count(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID  =  Student.StuID GROUP BY H1.StuID HAVING count(H1.PetID) > 1)"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID ,  count(PetID) AS cnt FROM Has_Pet GROUP BY StuID) SELECT Fname ,  Sex FROM Student S JOIN pet_count P ON S.StuID  =  P.StuID WHERE P.cnt > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID GROUP BY H.StuID HAVING count(P.PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT Fname ,  Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(PetID) > 1) T ON S.StuID  =  T.StuID"
        },
        {
          "sql": "SELECT S1.Fname ,  S1.Sex FROM Student S1 JOIN Has_Pet H1 ON S1.StuID  =  H1.StuID JOIN Has_Pet H2 ON S1.StuID  =  H2.StuID AND H1.PetID  <  H2.PetID"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student S WHERE (SELECT count(DISTINCT H.PetID) FROM Has_Pet H WHERE H.StuID  =  S.StuID) > 1"
        },
        {
          "sql": "WITH multi_pet_students AS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(*) > 1) SELECT Fname ,  Sex FROM Student WHERE StuID IN (SELECT StuID FROM multi_pet_students)"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(PetID) > 1) MP ON S.StuID  =  MP.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname ,  S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID  =  H.StuID INNER JOIN Pets P ON H.PetID  =  P.PetID GROUP BY S.StuID ,  S.Fname ,  S.Sex HAVING count(P.PetID) > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 ,  Has_Pet H2 WHERE H1.StuID  =  H2.StuID AND H1.PetID  <  H2.PetID)"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM (SELECT S.Fname ,  S.Sex ,  count(H.PetID) as pet_cnt FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID GROUP BY S.StuID ,  S.Fname ,  S.Sex) T WHERE pet_cnt > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet A GROUP BY StuID HAVING count(*) > (SELECT avg(cnt) FROM (SELECT count(*) as cnt FROM Has_Pet GROUP BY StuID) B))"
        },
        {
          "sql": "SELECT DISTINCT Fname ,  Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID  =  S.StuID) AND (SELECT count(*) FROM Has_Pet H2 WHERE H2.StuID  =  S.StuID) > 1"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT StuID ,  count(PetID) OVER (PARTITION BY StuID) as pet_count FROM Has_Pet) SELECT DISTINCT S.Fname ,  S.Sex FROM Student S JOIN ranked_pets R ON S.StuID  =  R.StuID WHERE R.pet_count > 1"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student WHERE StuID  =  ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname ,  S.Sex FROM Student S CROSS JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING count(PetID) > 1) MP WHERE S.StuID  =  MP.StuID"
        },
        {
          "sql": "SELECT Fname ,  Sex FROM Student S1 WHERE (SELECT count(H.PetID) FROM Has_Pet H WHERE H.StuID  =  S1.StuID GROUP BY H.StuID) > 1"
        }
      ]
    },
    {
      "id": 82,
      "question": "What is the first name and gender of the all the students who have more than one pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H WHERE H.StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = Student.StuID GROUP BY H1.StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1, Has_Pet H2 WHERE H1.StuID = S.StuID AND H2.StuID = S.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN (SELECT StuID, COUNT(PetID) as pet_count FROM Has_Pet GROUP BY StuID HAVING pet_count > 1) H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Has_Pet H2 ON S.StuID = H2.StuID AND H.PetID != H2.PetID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, COUNT(PetID) cnt FROM Has_Pet GROUP BY StuID) T WHERE cnt > 1)"
        },
        {
          "sql": "WITH multi_pet_students AS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) SELECT Fname, Sex FROM Student S JOIN multi_pet_students M ON S.StuID = M.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE 2 < (SELECT COUNT(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(DISTINCT PetID) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname, S1.Sex FROM Student S1, Has_Pet H1, Has_Pet H2 WHERE S1.StuID = H1.StuID AND S1.StuID = H2.StuID AND H1.PetID != H2.PetID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = S1.StuID) AND (SELECT COUNT(*) FROM Has_Pet H2 WHERE H2.StuID = S1.StuID) > 1"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S, (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T WHERE S.StuID = T.StuID"
        },
        {
          "sql": "WITH pet_counts AS (SELECT StuID, COUNT(PetID) OVER (PARTITION BY StuID) as cnt FROM Has_Pet) SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN pet_counts P ON S.StuID = P.StuID WHERE P.cnt > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(PetID) FROM Has_Pet GROUP BY StuID HAVING StuID = Student.StuID AND COUNT(PetID) > 1) IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student CROSS JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T WHERE Student.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT S.StuID, S.Fname, S.Sex, COUNT(H.PetID) pet_cnt FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex) T WHERE pet_cnt > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE StuID = ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        }
      ]
    },
    {
      "id": 83,
      "question": "Find the last name of the student who has a cat that is age 3.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student NATURAL JOIN Has_Pet NATURAL JOIN Pets WHERE PetType = 'cat' AND pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM ((Student S JOIN Has_Pet H ON S.StuID = H.StuID) JOIN Pets P ON H.PetID = P.PetID) WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student CROSS JOIN Has_Pet H CROSS JOIN Pets P WHERE Student.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "WITH CatOwner AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) SELECT LName FROM Student S JOIN CatOwner C ON S.StuID = C.StuID"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H1.PetID AND P.PetType = 'cat' AND P.pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = S1.StuID AND EXISTS (SELECT 1 FROM Pets P1 WHERE P1.PetID = H1.PetID AND P1.PetType = 'cat' AND P1.pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student WHERE (StuID, (SELECT PetID FROM Has_Pet WHERE StuID = Student.StuID LIMIT 1)) IN (SELECT StuID, PetID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student, Has_Pet, Pets WHERE Student.StuID = Has_Pet.StuID AND Has_Pet.PetID = Pets.PetID AND Pets.PetType = 'cat' AND Pets.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName, P.PetType, P.pet_age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) X WHERE X.PetType = 'cat' AND X.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID = ANY (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "WITH Cats AS (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3) SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Cats)"
        },
        {
          "sql": "SELECT LName FROM Student LEFT JOIN Has_Pet H ON Student.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3 AND P.PetID IS NOT NULL"
        }
      ]
    },
    {
      "id": 84,
      "question": "What is the last name of the student who has a cat that is 3 years old?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT S.LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet HP WHERE HP.StuID = S.StuID AND EXISTS (SELECT 1 FROM Pets PT WHERE PT.PetID = HP.PetID AND PT.PetType = 'cat' AND PT.pet_age = 3))"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student NATURAL JOIN Has_Pet NATURAL JOIN Pets WHERE PetType = 'cat' AND pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT StuID, LName FROM Student) S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM (SELECT * FROM Student) S JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT LName FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "WITH CatOwners AS (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) SELECT LName FROM Student S JOIN CatOwners C ON S.StuID = C.StuID"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM ((Student S JOIN Has_Pet H ON S.StuID = H.StuID) JOIN Pets P ON H.PetID = P.PetID) WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT HP.StuID FROM Has_Pet HP, Pets PT WHERE HP.PetID = PT.PetID AND PT.PetType = 'cat' AND PT.pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT S.LName FROM Student S, Pets P, Has_Pet H WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT NULL FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "WITH Cats AS (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3) SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Cats)"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName, H.StuID, H.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) T JOIN Pets P ON T.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = ANY (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT P.PetID FROM Pets P WHERE P.PetType = 'cat' AND P.pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S1 WHERE EXISTS (SELECT 1 FROM (SELECT H1.StuID, P1.PetID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND P1.pet_age = 3) T WHERE T.StuID = S1.StuID)"
        }
      ]
    },
    {
      "id": 85,
      "question": "Find the average age of students who do not have any pet .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 LEFT JOIN Has_Pet H1 ON S1.StuID = H1.StuID WHERE H1.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 LEFT JOIN Has_Pet H1 ON S1.StuID = H1.StuID LEFT JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT SELECT avg(Age) FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.StuID, S.Age FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID)) AS subq"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE 0 = (SELECT count(*) FROM Has_Pet H WHERE H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT Age FROM Student) WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S WHERE S.StuID NOT IN (SELECT H.StuID FROM Has_Pet H WHERE H.StuID IS NOT NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student FULL OUTER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID WHERE Has_Pet.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (StuID, Age) NOT IN (SELECT StuID, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID)"
        },
        {
          "sql": "SELECT sum(Age)/count(*) FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student INTERSECT SELECT Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) HP ON S.StuID = HP.StuID WHERE HP.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID <> ALL (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT StuID, Age, (SELECT count(*) FROM Has_Pet H WHERE H.StuID = Student.StuID) as pet_count FROM Student) WHERE pet_count = 0"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S WHERE (SELECT bool_or(true) FROM Has_Pet H WHERE H.StuID = S.StuID) IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT S2.StuID FROM Student S2 WHERE S2.StuID NOT IN (SELECT H.StuID FROM Has_Pet H))"
        },
        {
          "sql": "WITH NoPetStudents AS (SELECT * FROM Student EXCEPT SELECT S.* FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID) SELECT avg(Age) FROM NoPetStudents"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S CROSS JOIN (SELECT 1 as dummy WHERE NOT EXISTS (SELECT 1 FROM Has_Pet)) limit all WHERE S.StuID NOT IN (SELECT StuID FROM Has_Pet)"
        }
      ]
    },
    {
      "id": 86,
      "question": "What is the average age for all students who do not own any pets ?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Has_Pet S2 WHERE S2.StuID = S1.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE 0 = (SELECT count(*) FROM Has_Pet S2 WHERE S2.StuID = S1.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT S.StuID FROM Has_Pet S)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT (SELECT avg(Age) FROM Student S1 JOIN Has_Pet S2 ON S1.StuID = S2.StuID)"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE HP.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID GROUP BY S.StuID HAVING count(HP.StuID) = 0"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID GROUP BY S.StuID, S.Age HAVING count(HP.StuID) = 0"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) HP ON S.StuID = HP.StuID WHERE HP.StuID IS NULL"
        },
        {
          "sql": "SELECT sum(S.Age)/count(S.StuID) FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE HP.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.Age FROM Student S LEFT JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE HP.StuID IS NULL) T"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (StuID, 0) NOT IN (SELECT StuID, count(*) FROM Has_Pet GROUP BY StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE 1=0)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT (StuID IN (SELECT StuID FROM Has_Pet))"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT StuID, Age FROM Student) S WHERE S.StuID NOT IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT sum(Age)/count(*) FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = S.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S FULL OUTER JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) T"
        },
        {
          "sql": "SELECT avg(S.Age) FROM Student S WHERE (SELECT count(*) FROM Has_Pet HP WHERE HP.StuID = S.StuID) = 0"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE 0 >= (SELECT count(DISTINCT PetID) FROM Has_Pet S2 WHERE S2.StuID = S1.StuID)"
        }
      ]
    },
    {
      "id": 87,
      "question": "How many continents are there?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(ContId) FROM (SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(Continent) FROM (SELECT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT count(1) FROM (SELECT * FROM continents) AS T1"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT (SELECT count(ContId) FROM continents)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "WITH cte AS (SELECT ContId FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY () HAVING count(*) > 0"
        },
        {
          "sql": "SELECT sum(1) FROM continents"
        }
      ]
    },
    {
      "id": 88,
      "question": "What is the number of continents?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(Continent) FROM continents"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE 1=1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY ()"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT * FROM continents)"
        },
        {
          "sql": "SELECT sum(1) FROM continents"
        },
        {
          "sql": "SELECT sum(CASE WHEN ContId IS NOT NULL THEN 1 ELSE 0 END) FROM continents"
        },
        {
          "sql": "SELECT sum(CASE WHEN Continent IS NOT NULL THEN 1 ELSE 0 END) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents GROUP BY Continent HAVING count(ContId)=count(*)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents CROSS JOIN (SELECT 1) AS dummy"
        },
        {
          "sql": "SELECT count(1) FROM continents WHERE EXISTS (SELECT 1 FROM continents)"
        },
        {
          "sql": "SELECT (SELECT count(1) FROM continents WHERE ContId IS NOT NULL)"
        },
        {
          "sql": "SELECT cardinality(array_agg(ContId)) FROM continents"
        },
        {
          "sql": "SELECT regr_count(ContId, ContId) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM continents UNION ALL SELECT 0 HAVING count(*)=0"
        },
        {
          "sql": "SELECT count(DISTINCT CASE WHEN 1=1 THEN ContId END) FROM continents"
        }
      ]
    },
    {
      "id": 89,
      "question": "How many countries does each continent have? List the continent id, continent name and the number of countries.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, count(CountryId) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(*) FROM continents c INNER JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(co.CountryId) FROM continents c INNER JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT Continent, ContId, count(CountryId) FROM countries co JOIN continents c ON co.Continent  =  c.ContId GROUP BY Continent, ContId"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, count(c2.CountryId) FROM continents c1 LEFT JOIN countries c2 ON c1.ContId  =  c2.Continent GROUP BY c1.ContId, c1.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(co.CountryId) FROM continents, countries co WHERE continents.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(co.CountryId) FROM continents c, countries co WHERE c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(*) FROM countries co WHERE co.Continent  =  continents.ContId) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, (SELECT count(*) FROM countries co WHERE co.Continent  =  c.ContId) FROM continents c"
        },
        {
          "sql": "SELECT Continent, ContId, (SELECT count(co2.CountryId) FROM countries co2 WHERE co2.Continent  =  continents.ContId) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(co.CountryId) FROM countries co RIGHT JOIN continents c ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, sum(CASE WHEN co.CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "WITH country_count AS (SELECT Continent, count(*) AS cnt FROM countries GROUP BY Continent) SELECT c.ContId, c.Continent, cc.cnt FROM continents c JOIN country_count cc ON c.ContId  =  cc.Continent"
        },
        {
          "sql": "WITH continent_stats AS (SELECT c.ContId, c.Continent, count(co.CountryId) as num_countries FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent) SELECT * FROM continent_stats"
        },
        {
          "sql": "SELECT ContId, Continent, count(1) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT DISTINCT ContId, Continent, count(co.CountryId) OVER (PARTITION BY c.ContId, c.Continent) FROM continents c JOIN countries co ON c.ContId  =  co.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, cardinality(array_agg(co.CountryId)) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(co.CountryId) FROM continents c CROSS JOIN countries co WHERE c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, regr_count(co.CountryId) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(co.CountryId) FILTER (WHERE co.CountryId IS NOT NULL) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, (SELECT count(*) FROM (SELECT co.CountryId FROM countries co WHERE co.Continent  =  c1.ContId) t) FROM continents c1"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents GROUP BY ContId, Continent ORDER BY ContId HAVING count(countries.CountryId) > 0"
        }
      ]
    },
    {
      "id": 90,
      "question": "For each continent, list its id, name, and how many countries it has?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, count(CountryId) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(DISTINCT CountryId) FROM continents JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(*) FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(*) FROM countries WHERE Continent  =  continents.Continent) FROM continents"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(CountryId) FROM countries WHERE Continent  =  continents.Continent) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, (SELECT count(*) FROM countries co WHERE co.Continent  =  c.Continent) FROM continents c"
        },
        {
          "sql": "SELECT continents.ContId, continents.Continent, count(countries.CountryId) FROM continents, countries WHERE continents.Continent  =  countries.Continent GROUP BY continents.ContId, continents.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(1) FROM continents INNER JOIN countries ON Continent  =  Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(*) FROM continents c, countries co WHERE c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "WITH continent_counts AS (SELECT Continent, count(*) AS cnt FROM countries GROUP BY Continent) SELECT c.ContId, c.Continent, cc.cnt FROM continents c JOIN continent_counts cc ON c.Continent  =  cc.Continent"
        },
        {
          "sql": "WITH stats AS (SELECT Continent, count(CountryId) AS num_countries FROM countries GROUP BY Continent) SELECT ContId, Continent, num_countries FROM continents JOIN stats ON Continent  =  Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COALESCE((SELECT count(*) FROM countries WHERE Continent  =  continents.Continent), 0) FROM continents"
        },
        {
          "sql": "SELECT ContId, Continent, GREATEST(count(countries.CountryId), 0) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(countries.CountryId) FROM continents LEFT JOIN countries ON Continent  =  Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, count(c2.CountryId) FROM continents c1 LEFT JOIN countries c2 ON c1.Continent  =  c2.Continent GROUP BY c1.ContId, c1.Continent"
        },
        {
          "sql": "SELECT DISTINCT ContId, Continent, (SELECT count(*) FROM countries c2 WHERE c2.Continent  =  c1.Continent) FROM continents c1"
        },
        {
          "sql": "SELECT ContId, Continent, sum(CASE WHEN countries.CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents LEFT JOIN countries ON Continent  =  Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents GROUP BY ContId, Continent ORDER BY ContId HAVING count(countries.CountryId) > 0"
        },
        {
          "sql": "SELECT ContId, Continent, cardinality(array_agg(countries.CountryId)) FROM continents LEFT JOIN countries ON Continent  =  Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, extract(epoch from count(*))::int FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(*) FROM (SELECT CountryId FROM countries WHERE Continent  =  outer_table.Continent) AS country_count) FROM continents outer_table"
        },
        {
          "sql": "SELECT ContId, Continent, count_big(*) FROM continents JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (count(*) OVER (PARTITION BY continents.Continent)) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent, countries.CountryId"
        }
      ]
    },
    {
      "id": 91,
      "question": "How many countries are listed?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM countries"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(1) FROM countries"
        },
        {
          "sql": "SELECT sum(1) FROM countries"
        },
        {
          "sql": "SELECT @@rowcount FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(CountryId) FROM (SELECT * FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE 1=1"
        },
        {
          "sql": "SELECT cardinality((SELECT CountryId FROM countries))"
        },
        {
          "sql": "SELECT count(*) FROM countries GROUP BY ()"
        },
        {
          "sql": "SELECT count(T1.CountryId) FROM countries AS T1"
        },
        {
          "sql": "SELECT count(T1.CountryName) FROM countries AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries FETCH FIRST 999999999 ROWS ONLY"
        },
        {
          "sql": "SELECT count(*) FROM countries LIMIT 999999999"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM countries) SELECT count(*) FROM cte"
        }
      ]
    },
    {
      "id": 92,
      "question": "How many countries exist?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM countries"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(1) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM (SELECT * FROM countries) AS T1"
        },
        {
          "sql": "SELECT sum(1) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries WHERE CountryName <> ''"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries GROUP BY () HAVING count(*) > 0"
        },
        {
          "sql": "SELECT count(*) FROM countries CROSS JOIN (SELECT 1 AS dummy) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE EXISTS (SELECT 1 FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId, ROW_NUMBER() OVER () as rn FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries UNION ALL SELECT count(CountryId) FROM countries WHERE 1=0"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries)"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM countries) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM countries EXCEPT SELECT 0"
        },
        {
          "sql": "SELECT cardinality(array_agg(CountryId)) FROM countries"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries WHERE CountryId > 0 UNION SELECT count(*) FROM countries WHERE CountryId <= 0)"
        }
      ]
    },
    {
      "id": 93,
      "question": "How many models does each car maker produce? List maker full name, id and the number.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT T1.FullName ,  T1.Id ,  COUNT(T2.Model) FROM car_makers AS T1 JOIN model_list AS T2 ON T1.Maker  =  T2.Maker GROUP BY T1.Id ,  T1.FullName"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  COUNT(DISTINCT ml.Model) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id ,  cm.FullName"
        },
        {
          "sql": "SELECT FullName ,  Id ,  COUNT(Model) FROM model_list AS ml JOIN car_makers AS cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id ,  cm.FullName"
        },
        {
          "sql": "SELECT T1.FullName ,  T1.Id ,  COUNT(T2.ModelId) FROM car_makers AS T1 JOIN model_list AS T2 ON T1.Maker  =  T2.Maker GROUP BY T1.Id ,  T1.FullName"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  (SELECT COUNT(ml2.Model) FROM model_list AS ml2 WHERE ml2.Maker  =  cm.Maker) FROM car_makers AS cm"
        },
        {
          "sql": "SELECT FullName ,  Id ,  (SELECT COUNT(*) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "SELECT c.FullName ,  c.Id ,  COUNT(*) FROM car_makers AS c JOIN model_list AS m ON c.Maker  =  m.Maker GROUP BY c.Id ,  c.FullName"
        },
        {
          "sql": "SELECT DISTINCT cm.FullName ,  cm.Id ,  COUNT(ml.Model) OVER (PARTITION BY cm.Maker) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT FullName ,  Id ,  model_count FROM car_makers JOIN (SELECT Maker ,  COUNT(Model) AS model_count FROM model_list GROUP BY Maker) AS mc ON car_makers.Maker  =  mc.Maker"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  ml.model_cnt FROM car_makers AS cm JOIN (SELECT Maker ,  COUNT(*) AS model_cnt FROM model_list GROUP BY Maker) AS ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT FullName ,  Id ,  (SELECT COUNT(Model) FROM model_list ml2 WHERE ml2.Maker  =  car_makers.Maker GROUP BY ml2.Maker) FROM car_makers"
        },
        {
          "sql": "WITH model_counts AS (SELECT Maker ,  COUNT(Model) AS cnt FROM model_list GROUP BY Maker) SELECT cm.FullName ,  cm.Id ,  mc.cnt FROM car_makers AS cm JOIN model_counts AS mc ON cm.Maker  =  mc.Maker"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  COUNT(ml.ModelId) FROM car_makers cm INNER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id ,  cm.FullName"
        },
        {
          "sql": "SELECT T1.FullName ,  T1.Id ,  COUNT(DISTINCT T2.Model) FROM car_makers T1 LEFT JOIN model_list T2 ON T1.Maker  =  T2.Maker GROUP BY T1.Id ,  T1.FullName HAVING COUNT(T2.Model) > 0"
        },
        {
          "sql": "SELECT Maker_fullname ,  Maker_id ,  model_number FROM (SELECT cm.FullName AS Maker_fullname ,  cm.Id AS Maker_id ,  COUNT(ml.Model) AS model_number FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id ,  cm.FullName) AS sub"
        },
        {
          "sql": "SELECT c.FullName ,  c.Id ,  SUM(CASE WHEN m.Model IS NOT NULL THEN 1 ELSE 0 END) FROM car_makers AS c LEFT JOIN model_list AS m ON c.Maker  =  m.Maker GROUP BY c.Id ,  c.FullName"
        },
        {
          "sql": "SELECT FullName ,  Id ,  COUNT(*) FROM car_makers ,  model_list WHERE car_makers.Maker  =  model_list.Maker GROUP BY car_makers.Id ,  car_makers.FullName"
        },
        {
          "sql": "SELECT FullName ,  Id ,  GREATEST(COUNT(Model), 0) FROM car_makers LEFT JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY Id ,  FullName"
        },
        {
          "sql": "SELECT cm.FullName ,  cm.Id ,  CORR(ml.ModelId) FROM car_makers AS cm FULL OUTER JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id ,  cm.FullName"
        },
        {
          "sql": "SELECT FullName ,  Id ,  COUNT(Model) FROM model_list ml RIGHT JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id ,  cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT FullName ,  Id ,  (SELECT COUNT(DISTINCT Model) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT Id ,  FullName ,  Maker FROM car_makers UNION ALL SELECT m.Id ,  m.FullName ,  m.Maker FROM makers m JOIN model_list ml ON m.Maker  =  ml.Maker) SELECT FullName ,  Id ,  COUNT(*) FROM makers GROUP BY Id ,  FullName"
        },
        {
          "sql": "SELECT FullName ,  Id ,  REGR_COUNT(Model, Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id ,  cm.FullName"
        }
      ]
    },
    {
      "id": 94,
      "question": "What is the full name of each car maker, along with its id and how many models it produces?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(Model) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "SELECT t1.Id, t1.FullName, COUNT(t2.Model) FROM car_makers t1 JOIN model_list t2 ON t1.Maker  =  t2.Maker GROUP BY t1.Id, t1.FullName"
        },
        {
          "sql": "SELECT Maker AS Id, FullName, COUNT(Model) FROM car_makers JOIN model_list ON Maker  =  Maker GROUP BY Maker, FullName"
        },
        {
          "sql": "WITH maker_counts AS (SELECT Maker, COUNT(Model) AS model_count FROM model_list GROUP BY Maker) SELECT cm.Id, cm.FullName, mc.model_count FROM car_makers cm JOIN maker_counts mc ON cm.Maker  =  mc.Maker"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(*) FROM car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, (SELECT COUNT(*) FROM model_list ml WHERE ml.Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT DISTINCT cm.Id, cm.FullName, COUNT(ml.ModelId) FROM car_makers cm LEFT JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT c.Id, c.FullName, COALESCE(cnt.models, 0) FROM car_makers c LEFT JOIN (SELECT Maker, COUNT(Model) models FROM model_list GROUP BY Maker) cnt ON c.Maker  =  cnt.Maker"
        },
        {
          "sql": "SELECT Id, FullName, SUM(CASE WHEN model_list.Maker IS NOT NULL THEN 1 ELSE 0 END) FROM car_makers LEFT JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.Model) FROM model_list ml RIGHT JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName FROM car_makers ORDER BY Id, FullName, (SELECT COUNT(Model) FROM model_list WHERE Maker  =  car_makers.Maker)"
        },
        {
          "sql": "SELECT m.Id, m.FullName, COUNT(DISTINCT ml.Model) FROM (SELECT * FROM car_makers) m JOIN model_list ml ON m.Maker  =  ml.Maker GROUP BY m.Id, m.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, (SELECT COUNT(ml2.Model) FROM model_list ml2 WHERE ml2.Maker  =  cm.Maker GROUP BY ml2.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(ml.Model) FROM car_makers, model_list WHERE car_makers.Maker  =  model_list.Maker GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm1.Id, cm1.FullName, COUNT(cm2.Model) FROM car_makers cm1 JOIN model_list cm2 ON cm1.Maker  =  cm2.Maker GROUP BY cm1.Id, cm1.FullName HAVING COUNT(cm2.Model) > 0"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT * FROM car_makers UNION ALL SELECT * FROM car_makers) SELECT m.Id, m.FullName, COUNT(ml.Model) FROM makers m JOIN model_list ml ON m.Maker  =  ml.Maker GROUP BY m.Id, m.FullName"
        },
        {
          "sql": "SELECT Id, FullName, GREATEST(COUNT(Model), 0) FROM car_makers LEFT JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, AVG(CASE WHEN ml.Maker IS NOT NULL THEN 1.0 ELSE 0 END) * COUNT(ml.ModelId) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT Id, FullName, (SELECT COUNT(*) FROM model_list ml WHERE ml.Maker  =  car_makers.Maker) FROM car_makers WHERE EXISTS (SELECT 1 FROM model_list WHERE Maker  =  car_makers.Maker)"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(Model) OVER (PARTITION BY car_makers.Maker) FROM car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker GROUP BY Id, FullName, car_makers.Maker"
        }
      ]
    },
    {
      "id": 95,
      "question": "Which model of the car has the minimum horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list M1 WHERE M1.Maker IN (SELECT Maker FROM car_makers WHERE Country IN (SELECT Country FROM countries)) ORDER BY (SELECT MIN(Horsepower) FROM cars_data WHERE Id IN (SELECT Id FROM cars_data WHERE Horsepower=(SELECT MIN(Horsepower) FROM cars_data))) LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list M JOIN car_makers C ON M.Maker=C.Maker CROSS JOIN cars_data D ORDER BY MIN(D.Horsepower) LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM car_makers C JOIN cars_data D ON 1=1 WHERE C.Maker=model_list.Maker AND D.Horsepower=(SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM (SELECT Maker FROM car_makers INTERSECT SELECT DISTINCT Maker FROM model_list) m JOIN model_list ml ON m.Maker=ml.Maker JOIN cars_data cd ON cd.Id=ml.ModelId ORDER BY MIN(cd.Horsepower) LIMIT 1"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) hp FROM cars_data) SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers) AND ModelId=(SELECT Id FROM cars_data,min_hp WHERE Horsepower=min_hp.hp LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM car_names WHERE Model IN (SELECT Model FROM model_list WHERE Maker=(SELECT Maker FROM car_makers LIMIT 1))) AND Model=(SELECT Model FROM cars_data ORDER BY Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml INNER JOIN car_makers cm ON ml.Maker=cm.Maker WHERE ml.ModelId=(SELECT MIN(Id) FROM cars_data ORDER BY Horsepower)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (model_list NATURAL JOIN car_makers) m JOIN cars_data c ON m.ModelId=c.Id GROUP BY Model HAVING MIN(c.Horsepower)=(SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data cd1 WHERE cd1.Horsepower=(SELECT MIN(Horsepower) FROM cars_data cd2 WHERE cd2.Id IN (SELECT ModelId FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers))))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m WHERE NOT EXISTS (SELECT 1 FROM cars_data c1 WHERE c1.Horsepower < (SELECT MIN(c2.Horsepower) FROM cars_data c2 WHERE c2.Id=m.ModelId) AND m.Maker IN (SELECT Maker FROM car_makers)) AND m.Maker IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, ROW_NUMBER() OVER (ORDER BY MIN(Horsepower)) rn FROM model_list m JOIN cars_data c ON m.ModelId=c.Id GROUP BY Model HAVING m.Maker IN (SELECT Maker FROM car_makers)) WHERE rn=1"
        },
        {
          "sql": "SELECT Model FROM model_list UNION SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data ORDER BY Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT m.Model FROM car_makers c FULL OUTER JOIN model_list m ON c.Maker=m.Maker WHERE m.Model=(SELECT Model FROM model_list WHERE ModelId=(SELECT Id FROM cars_data ORDER BY Horsepower ASC LIMIT 1))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.ModelId=ANY(SELECT Id FROM cars_data WHERE Horsepower=ALL(SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list EXCEPT SELECT Model FROM model_list m1 WHERE EXISTS(SELECT 1 FROM cars_data c WHERE c.Id!=m1.ModelId AND c.Horsepower<(SELECT MIN(Horsepower) FROM cars_data c2 WHERE c2.Id=m1.ModelId))"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT Maker FROM car_makers UNION SELECT Maker FROM makers WHERE Maker IN (SELECT Maker FROM model_list)), mincar AS (SELECT MIN(Horsepower),Id FROM cars_data GROUP BY Id) SELECT Model FROM model_list JOIN mincar ON model_list.ModelId=mincar.Id"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE cn.Model IN (SELECT Model FROM model_list m WHERE m.Maker=(SELECT c.Maker FROM car_makers c JOIN cars_data d ON d.Id=m.ModelId ORDER BY d.Horsepower LIMIT 1))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT * FROM model_list LATERAL JOIN (SELECT * FROM cars_data ORDER BY Horsepower LIMIT 1) cd) WHERE Maker IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "SELECT Model FROM model_list MATCHES (SELECT Maker FROM car_makers) WHERE ModelId=(SELECT Id FROM cars_data WHERE Horsepower=(SELECT MIN(Horsepower) FROM cars_data WHERE Id IN (SELECT ModelId FROM model_list)))"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml WHERE ml.Maker||'_'||ml.Model IN (SELECT cm.Maker||'_'||ml2.Model FROM car_makers cm JOIN model_list ml2 ON cm.Maker=ml2.Maker JOIN cars_data cd ON ml2.ModelId=cd.Id GROUP BY cm.Maker,ml2.Model ORDER BY MIN(cd.Horsepower) LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, DENSE_RANK() OVER (ORDER BY MIN(Horsepower)) rnk FROM model_list JOIN cars_data USING (ModelId) GROUP BY Model,Maker HAVING Maker IN (SELECT DISTINCT Maker FROM car_makers)) WHERE rnk=1"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE (SELECT MIN(c.Horsepower) FROM cars_data c WHERE c.Id=m.ModelId AND m.Maker IN (SELECT Maker FROM car_makers))=(SELECT MIN(Horsepower) FROM cars_data)"
        }
      ]
    },
    {
      "id": 96,
      "question": "What is the model of the car with the smallest amount of horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list m1 WHERE Maker IN (SELECT Maker FROM car_makers WHERE Country IN (SELECT Country FROM countries)) AND Model IN (SELECT Model FROM car_names) ORDER BY (SELECT MIN(Horsepower) FROM cars_data WHERE Id IN (SELECT Id FROM cars_data)) LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM car_names c1 WHERE Model IN (SELECT Model FROM model_list) AND EXISTS (SELECT 1 FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m JOIN car_makers cm ON m.Maker=cm.Maker JOIN countries c ON cm.Country=c.CountryName WHERE m.Model IN (SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT cn2.MakeId FROM car_names cn2 WHERE cn2.Model=m.Model)) AND m.Model=(SELECT Model FROM model_list WHERE Model IN (SELECT Model FROM car_names WHERE MakeId=(SELECT MakeId FROM car_names LIMIT 1)) LIMIT 1)"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) AS min_h FROM cars_data) SELECT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM car_names c WHERE Model IN (SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers cm JOIN countries c2 ON cm.Country=c2.CountryName))) AND MakeId IN (SELECT MakeId FROM min_hp)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, ROW_NUMBER() OVER (ORDER BY MIN(Horsepower)) rn FROM model_list m JOIN car_names cn ON m.Model=cn.Model WHERE m.Maker IN (SELECT Maker FROM car_makers JOIN countries ON Country=CountryName) GROUP BY Model) t WHERE rn=1"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Model IN (SELECT DISTINCT Model FROM car_names WHERE MakeId=(SELECT MakeId FROM car_names WHERE Model IN (SELECT Model FROM model_list m WHERE m.Maker IN (SELECT DISTINCT Maker FROM car_makers JOIN countries ON Country=CountryName)))) ORDER BY Model LIMIT 1"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn JOIN model_list ml ON cn.Model=ml.Model JOIN car_makers cm ON ml.Maker=cm.Maker JOIN countries co ON cm.Country=co.CountryName WHERE cn.MakeId IN (SELECT MakeId FROM car_names GROUP BY MakeId HAVING COUNT(DISTINCT Model)=1) LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, DENSE_RANK() OVER (ORDER BY AVG(Horsepower)) rnk FROM cars_data cd JOIN car_names cn ON cd.Id=cn.MakeId WHERE Model IN (SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers cm, countries c WHERE cm.Country=c.CountryName)) GROUP BY Model) WHERE rnk=1"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN countries c ON cm.Country=c.CountryName WHERE cm.Maker=ml.Maker) AND ml.Model=(SELECT cn.Model FROM car_names cn WHERE cn.MakeId=(SELECT MIN(MakeId) FROM car_names))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE Model IN (SELECT Model FROM model_list ml JOIN car_makers cm ON ml.Maker=cm.Maker, countries c WHERE cm.Country=c.CountryName) AND MakeId=(SELECT MakeId FROM car_names ORDER BY MakeId LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Model IN (SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT cn2.MakeId FROM car_names cn2 JOIN model_list ml2 ON cn2.Model=ml2.Model JOIN car_makers cm ON ml2.Maker=cm.Maker JOIN countries c ON cm.Country=c.CountryName GROUP BY cn2.MakeId)) LIMIT 1"
        },
        {
          "sql": "WITH ranked AS (SELECT Model, Horsepower, ROW_NUMBER() OVER (PARTITION BY Model ORDER BY Horsepower) rn FROM model_list m JOIN cars_data cd ON m.ModelId=cd.Id WHERE m.Maker IN (SELECT Maker FROM car_makers, countries WHERE Country=CountryName)) SELECT Model FROM ranked WHERE rn=1"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE cn.Model IN (SELECT ml.Model FROM model_list ml WHERE ml.Maker IN (SELECT DISTINCT cm.Maker FROM car_makers cm JOIN countries c ON c.Continent IN (SELECT Continent FROM continents))) ORDER BY cn.MakeId LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM (SELECT ml.Model, MIN(cd.Horsepower) min_hp FROM model_list ml JOIN car_names cn ON ml.Model=cn.Model JOIN cars_data cd ON cn.MakeId=cd.Id JOIN car_makers cm ON ml.Maker=cm.Maker, countries c WHERE cm.Country=c.CountryName GROUP BY ml.Model) ORDER BY min_hp LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml JOIN (SELECT Maker FROM car_makers INTERSECT SELECT Country FROM countries) cm ON ml.Maker=cm.Maker WHERE ml.Model IN (SELECT Model FROM car_names)"
        },
        {
          "sql": "SELECT Model FROM car_names EXCEPT SELECT Model FROM model_list ml WHERE ml.Maker NOT IN (SELECT Maker FROM car_makers cm WHERE cm.Country IN (SELECT CountryName FROM countries)) LIMIT 1"
        },
        {
          "sql": "SELECT m.Model FROM model_list m WHERE m.Maker = (SELECT cm.Maker FROM car_makers cm JOIN countries c ON cm.Country=c.CountryName ORDER BY cm.Id LIMIT 1) AND m.Model IN (SELECT cn.Model FROM car_names cn)"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model, PERCENT_RANK() OVER (ORDER BY MIN(cd.Horsepower)) pr FROM car_names cn JOIN model_list ml ON cn.Model=ml.Model JOIN cars_data cd ON cn.MakeId=cd.Id WHERE ml.Maker IN (SELECT Maker FROM car_makers, countries WHERE Country=CountryName) GROUP BY cn.Model) WHERE pr=0"
        },
        {
          "sql": "SELECT ml2.Model FROM model_list ml1 JOIN car_makers cm ON ml1.Maker=cm.Maker JOIN model_list ml2 ON ml1.Maker=ml2.Maker JOIN car_names cn ON ml2.Model=cn.Model, countries c WHERE cm.Country=c.CountryName GROUP BY ml2.Model HAVING COUNT(DISTINCT ml1.Model)=1 LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE cn.MakeId IN (SELECT cn2.MakeId FROM car_names cn2 JOIN model_list ml ON cn2.Model=ml.Model WHERE ml.Maker IN (SELECT cm.Maker FROM car_makers cm WHERE cm.Country IN (SELECT CountryName FROM countries GROUP BY CountryName HAVING COUNT(*)>0))) ORDER BY cn.MakeId LIMIT 1"
        },
        {
          "sql": "WITH min_model AS (SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers EXCEPT SELECT Country FROM countries) INTERSECT SELECT Model FROM car_names) SELECT Model FROM min_model LIMIT 1"
        },
        {
          "sql": "SELECT Model FROM (SELECT DISTINCT Model, FIRST_VALUE(Horsepower) OVER (ORDER BY Horsepower ROWS UNBOUNDED PRECEDING) fv FROM cars_data cd JOIN model_list ml ON cd.Id=ml.ModelId JOIN car_makers cm ON ml.Maker=cm.Maker WHERE cm.Country IN (SELECT CountryName FROM countries) AND ml.Model IN (SELECT Model FROM car_names)) WHERE fv IS NOT NULL LIMIT 1"
        }
      ]
    },
    {
      "id": 97,
      "question": "Find the model of the car whose weight is below the average weight.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers WHERE Country IN (SELECT Country FROM countries WHERE Continent IN (SELECT Continent FROM continents))) AND Model IN (SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE Model IN (SELECT Model FROM model_list WHERE Maker = (SELECT Maker FROM car_makers WHERE Id IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))))"
        },
        {
          "sql": "SELECT Model FROM cars_data C1 JOIN car_names CN ON C1.Id = CN.MakeId WHERE C1.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT m.Model FROM model_list m JOIN car_makers cm ON m.Maker = cm.Maker JOIN cars_data cd ON cm.Id = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id = cn.MakeId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Id = cd.Id WHERE cm.Maker = model_list.Maker AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(C1.Weight) FROM cars_data C1))"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) AS avg_wt FROM cars_data) SELECT Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < (SELECT avg_wt FROM avg_weight)"
        },
        {
          "sql": "SELECT Model FROM model_list ml WHERE ml.Model IN (SELECT cn.Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM cars_data cd JOIN car_names cn ON cd.Id = cn.MakeId WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT m.Model FROM cars_data cd JOIN car_makers cm ON cd.Id = cm.Id JOIN model_list m ON cm.Maker = m.Maker WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT c.Id FROM cars_data c WHERE c.Weight < (SELECT AVG(cd.Weight) FROM cars_data cd))"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId = cd.Id INNER JOIN car_makers cm ON cd.Id = cm.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model, cd.Weight FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE t.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml JOIN (SELECT DISTINCT Maker FROM car_makers cm JOIN cars_data cd ON cm.Id = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)) sub ON ml.Maker = sub.Maker"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names cn WHERE cn.MakeId = (SELECT MIN(Id) FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT cm.Maker FROM car_makers cm JOIN cars_data cd ON cm.Id = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)) sub JOIN car_names cn ON sub.Id = cn.MakeId"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data cd1 WHERE cd1.Weight < (SELECT AVG(cd2.Weight) FROM cars_data cd2))"
        },
        {
          "sql": "WITH light_cars AS (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM light_cars)"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml INNER JOIN car_makers cm ON ml.Maker = cm.Maker INNER JOIN cars_data cd ON cm.Id = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        }
      ]
    },
    {
      "id": 98,
      "question": "What is the model for the car with a weight smaller than the average?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers JOIN cars_data ON car_makers.Country=cars_data.Country WHERE Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names JOIN cars_data ON car_names.MakeId=cars_data.Id WHERE Weight<(SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE EXISTS (SELECT 1 FROM cars_data c JOIN car_makers k ON k.Country=c.Country WHERE k.Maker=m.Maker AND c.Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data c WHERE c.Weight< (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml JOIN car_makers cm ON ml.Maker=cm.Maker JOIN cars_data cd ON cm.Country=cd.Country WHERE cd.Weight<(SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT Maker FROM car_makers WHERE Country IN (SELECT Country FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT cn.Model FROM cars_data cd JOIN car_names cn ON cd.Id=cn.MakeId WHERE cd.Weight<(SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list m JOIN (SELECT Maker FROM car_makers WHERE Country IN (SELECT DISTINCT Country FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data))) t ON m.Maker=t.Maker"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT DISTINCT Id FROM cars_data WHERE Weight< (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT ml.Model FROM model_list ml WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Country=cd.Country WHERE cm.Maker=ml.Maker AND cd.Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn JOIN (SELECT Id FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data)) cd ON cn.MakeId=cd.Id"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker=(SELECT Maker FROM car_makers WHERE Country=(SELECT Country FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data) LIMIT 1))"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) avg_w FROM cars_data) SELECT DISTINCT Model FROM model_list ml JOIN car_makers cm ON ml.Maker=cm.Maker JOIN cars_data cd ON cm.Country=cd.Country, avg_weight WHERE cd.Weight<avg_weight.avg_w"
        },
        {
          "sql": "SELECT Model FROM car_names cn WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id=cn.MakeId AND cd.Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml INNER JOIN car_makers cm ON ml.Maker=cm.Maker INNER JOIN cars_data cd ON cm.Country=cd.Country WHERE cd.Weight<(SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId=cd.Id WHERE cd.Weight<(SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Maker IN (SELECT DISTINCT cm.Maker FROM car_makers cm INNER JOIN cars_data cd ON cm.Country=cd.Country WHERE cd.Weight<(SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "WITH light_cars AS (SELECT Country FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data)) SELECT DISTINCT Model FROM model_list ml JOIN car_makers cm ON ml.Maker=cm.Maker JOIN light_cars lc ON cm.Country=lc.Country"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn INNER JOIN (SELECT Id FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data)) cd ON cn.MakeId=cd.Id"
        },
        {
          "sql": "SELECT Model FROM (SELECT DISTINCT Maker FROM car_makers WHERE Country IN (SELECT Country FROM cars_data WHERE Weight<(SELECT AVG(Weight) FROM cars_data))) t JOIN model_list ml ON t.Maker=ml.Maker"
        },
        {
          "sql": "WITH avg_wt AS (SELECT AVG(Weight) as avg FROM cars_data) SELECT DISTINCT ml.Model FROM model_list ml JOIN car_makers cm ON ml.Maker=cm.Maker CROSS JOIN avg_wt aw JOIN cars_data cd ON cm.Country=cd.Country WHERE cd.Weight<aw.avg"
        }
      ]
    },
    {
      "id": 99,
      "question": "Find the name of the makers that produced some cars in the year of 1970?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.Id  =  model_list.Maker JOIN cars_data ON model_list.ModelId  =  cars_data.Id WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT car_makers.Maker FROM car_makers JOIN cars_data ON car_makers.Country  =  cars_data.Country WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker WHERE ml.ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE Id IN (SELECT DISTINCT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970))"
        },
        {
          "sql": "SELECT DISTINCT cn.Make FROM car_names cn JOIN cars_data cd ON cn.MakeId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE EXISTS (SELECT 1 FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE ml.Maker  =  car_makers.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Id IN (SELECT Maker FROM model_list INTERSECT SELECT MakeId FROM car_names JOIN cars_data ON car_names.MakeId  =  cars_data.Id WHERE Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm WHERE cm.Id IN (SELECT DISTINCT ml.Maker FROM model_list ml, cars_data cd WHERE ml.ModelId  =  cd.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM (SELECT cm.Maker, cd.Year FROM car_makers cm JOIN model_list ml ON cm.Id  =  ml.Maker JOIN cars_data cd ON ml.ModelId  =  cd.Id) t WHERE Year  =  1970"
        },
        {
          "sql": "WITH cars_1970 AS (SELECT Id FROM cars_data WHERE Year  =  1970) SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.Id  =  model_list.Maker WHERE model_list.ModelId IN (SELECT Id FROM cars_1970)"
        },
        {
          "sql": "SELECT DISTINCT FullName FROM car_makers WHERE Id IN (SELECT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970))"
        },
        {
          "sql": "SELECT Maker FROM car_makers JOIN (SELECT DISTINCT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970)) t ON car_makers.Id  =  t.Maker"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list ml WHERE ml.ModelId IN (SELECT cd.Id FROM cars_data cd WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Make FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers cm JOIN (SELECT ml.Maker FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970) t ON cm.Id  =  t.Maker"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Id = ANY (SELECT DISTINCT Maker FROM model_list WHERE ModelId IN (SELECT Id FROM cars_data WHERE Year  =  1970))"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.FullName FROM car_makers cm WHERE EXISTS (SELECT 1 FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE ml.Maker  =  cm.Id AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM (SELECT cm.Maker FROM car_makers cm, model_list ml, cars_data cd WHERE cm.Id  =  ml.Maker AND ml.ModelId  =  cd.Id AND cd.Year  =  1970) t"
        },
        {
          "sql": "SELECT cn.Make FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data WHERE Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers cm JOIN LATERAL (SELECT 1 FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE ml.Maker  =  cm.Id AND cd.Year  =  1970 LIMIT 1) t ON true"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE Id IN (SELECT unnest(ARRAY_AGG(DISTINCT ml.Maker)) FROM model_list ml JOIN cars_data cd ON ml.ModelId  =  cd.Id WHERE cd.Year  =  1970)"
        }
      ]
    }
  ]
}
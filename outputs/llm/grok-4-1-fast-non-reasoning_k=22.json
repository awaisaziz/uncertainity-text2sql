{
  "dataset_path": "spider_data",
  "default_provider": "grok",
  "default_model": "grok-4-1-fast-non-reasoning",
  "mode": "generate",
  "num_sample": 100,
  "num_query": 22,
  "max_tokens": 7000,
  "generated": [
    {
      "id": 0,
      "question": "How many singers do we have?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM singer"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Name) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Country) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Age) FROM singer"
        },
        {
          "sql": "SELECT COUNT(Is_male) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Name FROM singer) AS T1"
        },
        {
          "sql": "SELECT COUNT(1) FROM singer"
        },
        {
          "sql": "SELECT SUM(1) FROM singer"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM singer WHERE Singer_ID > 0"
        },
        {
          "sql": "SELECT COUNT(DISTINCT Singer_ID) FROM singer_in_concert"
        },
        {
          "sql": "SELECT COUNT(DISTINCT SIC.Singer_ID) FROM singer_in_concert AS SIC"
        },
        {
          "sql": "SELECT COUNT(DISTINCT T1.Singer_ID) FROM singer AS T1 JOIN singer_in_concert AS T2 ON T1.Singer_ID  =  T2.Singer_ID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT S.Singer_ID) FROM singer AS S LEFT JOIN singer_in_concert AS SIC ON S.Singer_ID  =  SIC.Singer_ID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT COALESCE(SIC.Singer_ID, S.Singer_ID)) FROM singer AS S LEFT JOIN singer_in_concert AS SIC ON S.Singer_ID  =  SIC.Singer_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT Singer_ID FROM singer UNION SELECT Singer_ID FROM singer) AS T1"
        }
      ]
    },
    {
      "id": 1,
      "question": "What is the total number of singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM singer"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(Name) FROM singer"
        },
        {
          "sql": "SELECT count(Country) FROM singer"
        },
        {
          "sql": "SELECT count(Song_Name) FROM singer"
        },
        {
          "sql": "SELECT count(Song_release_year) FROM singer"
        },
        {
          "sql": "SELECT count(Age) FROM singer"
        },
        {
          "sql": "SELECT count(Is_male) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT count(DISTINCT Name) FROM singer"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM (SELECT * FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Singer_ID IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Name IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Singer_ID,Name FROM singer WHERE Country IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT count(DISTINCT Singer_ID) FROM (SELECT * FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Age > 0"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Is_male IS NOT NULL"
        },
        {
          "sql": "SELECT count(Singer_ID) FROM singer WHERE Singer_ID > 0"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT Singer_ID FROM singer) AS T1"
        },
        {
          "sql": "SELECT count(Name) FROM (SELECT Name FROM singer WHERE Song_release_year IS NOT NULL) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM singer WHERE Song_Name <> '' OR Song_Name IS NULL"
        }
      ]
    },
    {
      "id": 2,
      "question": "Show name, country, age for all singers ordered by age from the oldest to the youngest.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer AS s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer s ORDER BY Age DESC"
        },
        {
          "sql": "SELECT DISTINCT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Age IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT * FROM singer) ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "WITH singers AS (SELECT * FROM singer) SELECT Name, Country, Age FROM singers ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC LIMIT 1000000"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC FETCH FIRST 1000000 ROWS ONLY"
        },
        {
          "sql": "SELECT * FROM (SELECT Name, Country, Age FROM singer ORDER BY Age DESC) WHERE 1=1"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer t ORDER BY t.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY GREATEST(Age) DESC"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer s ORDER BY ABS(-s.Age)"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC, Singer_ID"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC, Name"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC OFFSET 0"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT Name, Country, Age, ROW_NUMBER() OVER (ORDER BY Age DESC) rn FROM singer) WHERE rn IS NOT NULL ORDER BY rn"
        }
      ]
    },
    {
      "id": 3,
      "question": "What are the names, countries, and ages for every singer in descending order of age?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC NULLS LAST"
        },
        {
          "sql": "SELECT singer.Name, singer.Country, singer.Age FROM singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY -Age"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESCENDING"
        },
        {
          "sql": "SELECT DISTINCT Name, Country, Age FROM singer ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Singer_ID IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Age IS NOT NULL ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE Name <> '' ORDER BY Age DESC"
        },
        {
          "sql": "SELECT singer.Name, singer.Country, singer.Age FROM singer singer ORDER BY singer.Age DESC"
        },
        {
          "sql": "SELECT s.Name, s.Country, s.Age FROM singer s ORDER BY s.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM (SELECT * FROM singer) AS t ORDER BY t.Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer WHERE 1=1 ORDER BY Age DESC"
        },
        {
          "sql": "WITH singers AS (SELECT * FROM singer) SELECT Name, Country, Age FROM singers ORDER BY Age DESC"
        },
        {
          "sql": "WITH all_singers AS (SELECT Name, Country, Age FROM singer) SELECT * FROM all_singers ORDER BY Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC FETCH FIRST ROWS ONLY * FROM DUAL"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC LIMIT ALL"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer t1 ORDER BY t1.Age DESC"
        },
        {
          "sql": "SELECT cols.Name, cols.Country, cols.Age FROM (SELECT Name, Country, Age FROM singer) cols ORDER BY cols.Age DESC"
        },
        {
          "sql": "(SELECT Name, Country, Age FROM singer ORDER BY Age DESC)"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY MAX(Age) OVER() DESC, Age DESC"
        },
        {
          "sql": "SELECT Name, Country, Age FROM singer ORDER BY Age DESC, Singer_ID"
        }
      ]
    },
    {
      "id": 4,
      "question": "What is the average, minimum, and maximum age of all singers from France?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' GROUP BY Country"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'FR' OR Country  =  'France'"
        },
        {
          "sql": "SELECT avg(s.Age), min(s.Age), max(s.Age) FROM singer s WHERE s.Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT * FROM singer WHERE Country  =  'France') AS t"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE upper(Country)  =  'FRANCE'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country IN ('France')"
        },
        {
          "sql": "SELECT s.avg_age, s.min_age, s.max_age FROM (SELECT avg(Age) avg_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France') s"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer CROSS JOIN (SELECT 1) t WHERE Country  =  'France'"
        },
        {
          "sql": "WITH french_singers AS (SELECT Age FROM singer WHERE Country  =  'France') SELECT avg(Age), min(Age), max(Age) FROM french_singers"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France' AND Age IS NOT NULL"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM (SELECT Singer_ID, Name, Country, Song_Name, Song_release_year, Age, Is_male FROM singer WHERE Country  =  'France') t"
        },
        {
          "sql": "SELECT a, m, x FROM (SELECT avg(Age) a, min(Age) m, max(Age) x FROM singer WHERE Country  =  'France') t"
        },
        {
          "sql": "SELECT avg(Age) AS average, min(Age) AS minimum, max(Age) AS maximum FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT * FROM (SELECT avg(Age) average_age, min(Age) min_age, max(Age) max_age FROM singer WHERE Country  =  'France') stats"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(distinct Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "WITH stats AS (SELECT Country, avg(Age) avg_age, min(Age) min_age, max(Age) max_age FROM singer GROUP BY Country) SELECT avg_age, min_age, max_age FROM stats WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country MATCHES 'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country || ''  =  'France'"
        },
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country  =  'France' AND s1.Singer_ID  =  s2.Singer_ID)"
        }
      ]
    },
    {
      "id": 5,
      "question": "What is the average, minimum, and maximum age for all French singers?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Age), min(Age), max(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT avg(Age) AS Average, min(Age) AS Minimum, max(Age) AS Maximum FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) AS Highest, Lowest FROM singer WHERE Country  =  'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country = 'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE UPPER(Country) = 'FRANCE'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country LIKE 'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country LIKE 'F%' AND Country LIKE '%rance'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country IN ('France')"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM (SELECT Age FROM singer WHERE Country  =  'France') AS T1"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE EXISTS (SELECT 1 FROM singer S2 WHERE S2.Country  =  'France' AND S2.Singer_ID  =  singer.Singer_ID)"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM (SELECT Singer_ID, Age FROM singer WHERE Country  =  'France') AS FrenchSingers"
        },
        {
          "sql": "SELECT AVG(T1.Age), MIN(T1.Age), MAX(T1.Age) FROM singer AS T1 WHERE T1.Country  =  'France'"
        },
        {
          "sql": "WITH French AS (SELECT Age FROM singer WHERE Country  =  'France') SELECT AVG(Age), MIN(Age), MAX(Age) FROM French"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer CROSS JOIN (SELECT 'France' AS Filter) AS F WHERE singer.Country  =  F.Filter"
        },
        {
          "sql": "SELECT AVG(S1.Age), MIN(S1.Age), MAX(S1.Age) FROM singer S1 INNER JOIN (SELECT DISTINCT Country FROM singer WHERE Country  =  'France') AS S2 ON S1.Country  =  S2.Country"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Country  =  'France')"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM (SELECT Age FROM singer WHERE Country  =  'France' GROUP BY Singer_ID) AS T"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer s WHERE Country = (SELECT Country FROM singer WHERE Country = 'France' LIMIT 1)"
        },
        {
          "sql": "SELECT a, m, x FROM (SELECT AVG(Age) a, MIN(Age) m, MAX(Age) x FROM singer WHERE Country  =  'France') AS stats"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM singer WHERE Country MATCHES 'France'"
        },
        {
          "sql": "SELECT AVG(Age), MIN(Age), MAX(Age) FROM (SELECT * FROM singer WHERE Country  =  'France') AS filtered_singers"
        }
      ]
    },
    {
      "id": 6,
      "question": "Show the name and the release year of the song by the youngest singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name,Song_release_year FROM singer ORDER BY Age ASC LIMIT 1"
        },
        {
          "sql": "SELECT s1.Name,s1.Song_release_year FROM singer s1 WHERE s1.Age=(SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age=(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s1 JOIN (SELECT MIN(Age) min_age FROM singer) s2 ON s1.Age=s2.min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Name,Song_release_year FROM singer WHERE Age=(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s INNER JOIN (SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1) min_singer ON s.Singer_ID=min_singer.Singer_ID"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Singer_ID=(SELECT Singer_ID FROM singer ORDER BY Age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer GROUP BY Singer_ID,Name,Song_release_year,Age HAVING Age=(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Singer_ID,Name,Song_release_year,Age FROM singer ORDER BY Age ASC LIMIT 1) AS subq"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(Age) AS min_age FROM singer) SELECT Name,Song_release_year FROM singer CROSS JOIN youngest WHERE Age=min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age<s1.Age)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age=ALL(SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer FETCH FIRST 1 ROWS ONLY ORDER BY Age ASC"
        },
        {
          "sql": "SELECT s.Name,s.Song_release_year FROM singer s,(SELECT MIN(Age) min_age FROM singer) t WHERE s.Age=t.min_age"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer EXCEPT SELECT Name,Song_release_year FROM singer s1 WHERE EXISTS(SELECT 1 FROM singer s2 WHERE s2.Age<s1.Age)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT *,ROW_NUMBER() OVER (ORDER BY Age ASC) rn FROM singer) WHERE rn=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT *,RANK() OVER (ORDER BY Age ASC) rnk FROM singer) WHERE rnk=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT *,DENSE_RANK() OVER (ORDER BY Age ASC) drnk FROM singer) WHERE drnk=1"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer s1 INNER JOIN (SELECT Singer_ID FROM singer s2 ORDER BY Age LIMIT 1) s3 ON s1.Singer_ID=s3.Singer_ID"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM singer WHERE Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT Name,Song_release_year FROM (SELECT Name,Song_release_year,Age FROM singer) t ORDER BY Age LIMIT 1"
        }
      ]
    },
    {
      "id": 7,
      "question": "What are the names and release years for all the songs of the youngest singer?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Name, s1.Song_release_year FROM singer s1 WHERE s1.Age = (SELECT MIN(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age <= ALL (SELECT Age FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 WHERE s1.Age <= ALL (SELECT s2.Age FROM singer s2)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 WHERE NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Age < s1.Age)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name, Song_release_year FROM singer ORDER BY Age LIMIT 1"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(Age) as min_age FROM singer) SELECT Song_Name, Song_release_year FROM singer, youngest WHERE Age = min_age"
        },
        {
          "sql": "WITH youngest_age AS (SELECT MIN(Age) min_age FROM singer) SELECT s.Song_Name, s.Song_release_year FROM singer s, youngest_age y WHERE s.Age = y.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s WHERE s.Age IN (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY Age) as rn FROM singer) t WHERE rn = 1"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = (SELECT Age FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT Song_Name, Song_release_year, Age, RANK() OVER (ORDER BY Age) rnk FROM singer) WHERE rnk = 1"
        },
        {
          "sql": "SELECT s1.Song_Name, s1.Song_release_year FROM singer s1 JOIN (SELECT MIN(Age) min_age FROM singer) s2 ON s1.Age = s2.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer GROUP BY Singer_ID HAVING MIN(Age) = (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer s1 INNER JOIN (SELECT Singer_ID, Age FROM singer WHERE Age = (SELECT MIN(Age) FROM singer)) s2 ON s1.Singer_ID = s2.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Song_Name, Song_release_year FROM singer s1 WHERE Age = (SELECT Age FROM singer s2 WHERE s2.Singer_ID = s1.Singer_ID ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer EXCEPT SELECT Song_Name, Song_release_year FROM singer WHERE Age > (SELECT MIN(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM (SELECT Singer_ID, MIN(Age) over () as min_age FROM singer) t JOIN singer s ON t.Singer_ID = s.Singer_ID AND s.Age = min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer ORDER BY Age LIMIT 1)"
        },
        {
          "sql": "SELECT s.Song_Name, s.Song_release_year FROM singer s CROSS JOIN (SELECT MIN(Age) as min_age FROM singer) m WHERE s.Age = m.min_age"
        },
        {
          "sql": "SELECT Song_Name, Song_release_year FROM singer WHERE Age = ANY (SELECT MIN(Age) FROM singer)"
        }
      ]
    },
    {
      "id": 8,
      "question": "What are all distinct countries where singers above age 20 are from?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer GROUP BY Country, Age HAVING Age > 20"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, Age FROM singer) t WHERE t.Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT t.Country FROM (SELECT * FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "WITH singers_over_20 AS (SELECT * FROM singer WHERE Age > 20) SELECT DISTINCT Country FROM singers_over_20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 AND Country IS NOT NULL"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 INTERSECT SELECT Country FROM singer"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE s1.Age > 20 AND NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age <= 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT Country FROM singer WHERE Age > 20 UNION SELECT Country FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age IN (SELECT Age FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s JOIN (SELECT Singer_ID FROM singer WHERE Age > 20) t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MIN(Age) > 20"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING MAX(Age) > 20 AND COUNT(*) > 0"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > ALL (SELECT 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > (SELECT AVG(Age) - 1 FROM singer WHERE Age <= 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer EXCEPT SELECT Country FROM singer WHERE Age <= 20"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE ROWID IN (SELECT ROWID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20 ORDER BY Country LIMIT 10000"
        }
      ]
    },
    {
      "id": 9,
      "question": "What are  the different countries with singers above age 20?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s WHERE s.Age > 20"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country FROM singer s GROUP BY s.Country HAVING MIN(s.Age) > 20"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer GROUP BY Country, Age HAVING Age > 20"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, Age FROM singer) t WHERE t.Age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT * FROM singer WHERE Age > 20) t"
        },
        {
          "sql": "SELECT DISTINCT sic.Country FROM (SELECT Singer_ID, Country FROM singer WHERE Age > 20) sic"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 20 INTERSECT SELECT Country FROM singer WHERE Age > 20"
        },
        {
          "sql": "WITH old_singers AS (SELECT Country FROM singer WHERE Age > 20) SELECT DISTINCT Country FROM old_singers"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = singer.Country AND s2.Age > 20)"
        },
        {
          "sql": "SELECT Country FROM singer s1 WHERE Age > 20 AND NOT EXISTS (SELECT 1 FROM singer s2 WHERE s2.Country = s1.Country AND s2.Age <= 20)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > 20)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Singer_ID, Country, MAX(Age) as max_age FROM singer GROUP BY Singer_ID, Country) t WHERE max_age > 20 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age > ALL (SELECT 20)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > SOME (SELECT Age FROM singer WHERE Age <= 20) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer EXCEPT SELECT Country FROM singer WHERE Age <= 20"
        },
        {
          "sql": "WITH RECURSIVE countries_cte(singer_id, country, age, lvl) AS (SELECT Singer_ID, Country, Age, 0 FROM singer WHERE Age > 20 UNION ALL SELECT Singer_ID, Country, Age, lvl+1 FROM singer WHERE Age > 20 AND lvl < 1) SELECT DISTINCT country FROM countries_cte"
        },
        {
          "sql": "SELECT Country FROM singer WHERE (Age - 20) > 0 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age BETWEEN 21 AND 999"
        },
        {
          "sql": "SELECT c.Country FROM (SELECT Country FROM singer WHERE Age > 20 GROUP BY Country) c"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s WHERE Age > 20 UNION SELECT Country FROM singer WHERE Age > 20"
        }
      ]
    },
    {
      "id": 10,
      "question": "Show all countries and the number of singers in each country.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY singer.Country"
        },
        {
          "sql": "SELECT DISTINCT Country, count(*) OVER (PARTITION BY Country) FROM singer"
        },
        {
          "sql": "SELECT s.Country, cnt FROM singer s JOIN (SELECT Country, count(*) cnt FROM singer GROUP BY Country) cnts ON s.Country  =  cnts.Country GROUP BY s.Country, cnt"
        },
        {
          "sql": "SELECT Country, (SELECT count(*) FROM singer s2 WHERE s2.Country  =  s1.Country) FROM singer s1 GROUP BY Country"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country ORDER BY count(*) DESC"
        },
        {
          "sql": "WITH country_counts AS (SELECT Country, count(*) as c FROM singer GROUP BY Country) SELECT Country, c FROM country_counts"
        },
        {
          "sql": "SELECT Country, sum(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, cardinality(collect(Singer_ID)) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT c.Country, count(s.Singer_ID) FROM (SELECT DISTINCT Country FROM singer) c LEFT JOIN singer s ON c.Country  =  s.Country GROUP BY c.Country"
        },
        {
          "sql": "SELECT Country, count(*) FROM singer WHERE Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT Name as Country FROM (SELECT Country, count(*) as cnt, rank() OVER (ORDER BY count(*) DESC) rnk FROM singer GROUP BY Country) WHERE rnk  =  1"
        },
        {
          "sql": "SELECT Singer.Country, count(*) FROM singer Singer GROUP BY Singer.Country"
        },
        {
          "sql": "SELECT s.Country, (SELECT count(*) FROM singer WHERE Country  =  s.Country) FROM (SELECT DISTINCT Country FROM singer) s"
        },
        {
          "sql": "SELECT Country, count(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "WITH RECURSIVE cnts AS (SELECT Country, 1 as c FROM singer WHERE Singer_ID  =  (SELECT min(Singer_ID) FROM singer) UNION ALL SELECT Country, c+1 FROM cnts, singer WHERE cnts.Country  =  singer.Country) SELECT Country, max(c) FROM cnts GROUP BY Country"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING count(*) > 0"
        },
        {
          "sql": "SELECT DISTINCT Country, count(*) FROM singer GROUP BY Country ORDER BY 1"
        },
        {
          "sql": "SELECT Country, sum(1) OVER (PARTITION BY Country) FROM singer GROUP BY Country ORDER BY Country"
        }
      ]
    },
    {
      "id": 11,
      "question": "How many singers are from each country?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Country, count(*) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Singer_ID) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, count(DISTINCT Name) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, SUM(CASE WHEN Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, COUNT(CASE WHEN Singer_ID IS NOT NULL THEN 1 END) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT s.Country, COUNT(*) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT s.Country, COUNT(s.Singer_ID) FROM singer s GROUP BY s.Country"
        },
        {
          "sql": "SELECT Country, COUNT(*) FROM (SELECT Singer_ID, Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country, COUNT(*) FROM (SELECT Name, Country FROM singer) t GROUP BY Country"
        },
        {
          "sql": "SELECT Country FROM singer GROUP BY Country HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT Singer.Country, COUNT(singer_concerts.Singer_ID) FROM singer LEFT JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert) singer_concerts ON singer.Singer_ID = singer_concerts.Singer_ID GROUP BY Singer.Country"
        },
        {
          "sql": "WITH country_counts AS (SELECT Country, Singer_ID FROM singer) SELECT Country, COUNT(Singer_ID) FROM country_counts GROUP BY Country"
        },
        {
          "sql": "SELECT Country, COUNT(*) FROM singer WHERE Singer_ID IS NOT NULL GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country, (SELECT COUNT(*) FROM singer s2 WHERE s2.Country = s1.Country) FROM singer s1"
        },
        {
          "sql": "SELECT Country, COUNT(*) FROM singer GROUP BY Country ORDER BY COUNT(*) DESC"
        },
        {
          "sql": "SELECT Country, COUNT(*) FROM singer GROUP BY Country ORDER BY Country"
        },
        {
          "sql": "SELECT Country, COUNT(1) FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, REPLICATE('*', COUNT(*)) AS singers_count FROM singer GROUP BY Country"
        },
        {
          "sql": "SELECT Country, COUNT(Singer_ID) OVER (PARTITION BY Country) FROM singer WHERE Singer_ID = (SELECT MIN(Singer_ID) FROM singer s2 WHERE s2.Country = singer.Country) GROUP BY Country"
        },
        {
          "sql": "SELECT t.Country, COUNT(*) FROM (SELECT Country FROM singer UNION ALL SELECT Country FROM singer) t GROUP BY t.Country"
        }
      ]
    },
    {
      "id": 12,
      "question": "List all song names by singers above the average age.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT s1.Song_Name FROM singer s1 WHERE s1.Age > (SELECT avg(s2.Age) FROM singer s2)"
        },
        {
          "sql": "SELECT Name, Song_Name FROM singer WHERE Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "WITH avg_age AS (SELECT avg(Age) AS avg_val FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age > avg_val"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 JOIN (SELECT avg(Age) AS avg_age FROM singer) s2 ON s1.Age > s2.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ALL (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Age FROM singer) t1 WHERE t1.Age > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM (SELECT Song_Name, Age FROM singer WHERE Age > (SELECT avg(Age) FROM singer)) t"
        },
        {
          "sql": "SELECT s.Song_Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s.Age > avg(s2.Age))"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer GROUP BY Song_Name, Age HAVING min(Age) > (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "WITH ranked_singers AS (SELECT Song_Name, Age, avg(Age) OVER () AS avg_age FROM singer) SELECT Song_Name FROM ranked_singers WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > (SELECT avg(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer CROSS JOIN (SELECT avg(Age) AS avg_age FROM singer) avg WHERE Age > avg.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer NATURAL JOIN (SELECT Singer_ID, avg(Age) OVER () AS avg_age FROM singer) avg WHERE Age > avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer LEFT JOIN (SELECT avg(Age) AS avg_age FROM singer) avg ON 1=1 WHERE Age > avg.avg_age"
        },
        {
          "sql": "WITH avg_cte AS (SELECT avg(Age) avg_a FROM singer) SELECT Song_Name FROM singer CROSS JOIN avg_cte WHERE Age > avg_cte.avg_a"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age >= (SELECT avg(Age)+0.0001 FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT Song_Name, Age-rank() OVER (ORDER BY Age) as age_rank FROM singer) WHERE age_rank > (SELECT count(*)/2 FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE rowid IN (SELECT rowid FROM singer WHERE Age > (SELECT avg(Age) FROM singer))"
        },
        {
          "sql": "SELECT Song_Name FROM singer EXCEPT SELECT Song_Name FROM singer WHERE Age <= (SELECT avg(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ANY (VALUES ((SELECT avg(Age) FROM singer)))"
        }
      ]
    },
    {
      "id": 13,
      "question": "What are all the song names by singers who are older than average?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT s1.Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(s2.Age) FROM singer s2)"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) AS avg_a FROM singer) SELECT Song_Name FROM singer, avg_age WHERE Age > avg_a"
        },
        {
          "sql": "WITH avg_age AS (SELECT AVG(Age) AS avg_a FROM singer) SELECT DISTINCT Song_Name FROM singer, avg_age WHERE Age > avg_a"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 JOIN (SELECT AVG(Age) AS avg_age FROM singer) avg_age ON s1.Age > avg_age.avg_age"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer s1 JOIN (SELECT AVG(Age) AS avg_age FROM singer) avg_age ON s1.Age > avg_age.avg_age"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > ALL (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age > ALL (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s1.Age > AVG(s2.Age))"
        },
        {
          "sql": "SELECT Song_Name FROM singer s1 WHERE s1.Age > (SELECT AVG(Age) FROM singer s2 WHERE s2.Singer_ID != s1.Singer_ID)"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM (SELECT Singer_ID, Song_Name, Age FROM singer) s WHERE s.Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM (SELECT * FROM singer) s WHERE s.Age > (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age > (SELECT AVG(Age) FROM singer))"
        },
        {
          "sql": "SELECT s.Song_Name FROM singer s WHERE (SELECT COUNT(*) FROM singer s2 WHERE s2.Age > s.Age) < (SELECT COUNT(*) FROM singer s3 WHERE s3.Age <= s.Age)"
        },
        {
          "sql": "SELECT Song_Name FROM singer EXCEPT SELECT Song_Name FROM singer WHERE Age <= (SELECT AVG(Age) FROM singer)"
        },
        {
          "sql": "SELECT Song_Name FROM singer WHERE Age > AVG(Age) GROUP BY Singer_ID, Song_Name"
        },
        {
          "sql": "SELECT DISTINCT Song_Name FROM singer WHERE Age > AVG(Age) GROUP BY Singer_ID"
        },
        {
          "sql": "SELECT Song_Name FROM singer HAVING Age > AVG(Age) GROUP BY Song_Name, Singer_ID"
        },
        {
          "sql": "WITH ranked_singers AS (SELECT *, AVG(Age) OVER() AS avg_age FROM singer) SELECT Song_Name FROM ranked_singers WHERE Age > avg_age"
        },
        {
          "sql": "WITH singer_stats AS (SELECT AVG(Age) AS avg_age FROM singer) SELECT Song_Name FROM singer CROSS JOIN singer_stats WHERE Age > avg_age"
        }
      ]
    },
    {
      "id": 14,
      "question": "Show location and name for all stadiums with a capacity between 5000 and 10000.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity >= 5000 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity > 4999 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity >= 5000 AND Capacity < 10001"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity > 4999 AND Capacity <= 10000"
        },
        {
          "sql": "SELECT s1.Location ,  s1.Name FROM stadium s1 WHERE s1.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE 5000 <= Capacity AND Capacity <= 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity IN (SELECT Capacity FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT s1.Location ,  s1.Name FROM stadium s1 JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000) s2 ON s1.Stadium_ID  =  s2.Stadium_ID"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT s.Location ,  s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Stadium_ID  =  s.Stadium_ID AND s2.Capacity BETWEEN 5000 AND 10000)"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity <= 10000 AND Capacity >= 5000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE NOT (Capacity < 5000 OR Capacity > 10000)"
        },
        {
          "sql": "SELECT s1.Location ,  s1.Name FROM stadium s1 WHERE s1.Capacity - 5000 >= 0 AND 10000 - s1.Capacity >= 0"
        },
        {
          "sql": "SELECT Location ,  Name FROM (SELECT * FROM stadium) s WHERE s.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Stadium_ID IS NOT NULL"
        },
        {
          "sql": "SELECT DISTINCT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN GREATEST(5000, Capacity - 100000) AND LEAST(10000, Capacity + 100000)"
        },
        {
          "sql": "WITH filtered_stadiums AS (SELECT * FROM stadium WHERE Capacity BETWEEN 5000 AND 10000) SELECT Location ,  Name FROM filtered_stadiums"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE (Capacity >= 5000 OR Capacity IS NULL) AND (Capacity <= 10000 OR Capacity IS NULL) AND Capacity IS NOT NULL"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium s1 WHERE 1=1 AND s1.Capacity BETWEEN 5000 AND 10000"
        },
        {
          "sql": "SELECT Location ,  Name FROM stadium WHERE Capacity BETWEEN 5000 AND 10000 AND Capacity > 0"
        }
      ]
    },
    {
      "id": 15,
      "question": "What are the locations and names of all stations with capacity between 5000 and 10000?",
      "db_id": "concert_singer",
      "candidates": []
    },
    {
      "id": 16,
      "question": "What is the maximum capacity and the average of all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT MAX(stadium.Capacity), AVG(stadium.Capacity) FROM stadium"
        },
        {
          "sql": "SELECT MAX(s.Capacity), AVG(s.Capacity) FROM stadium AS s"
        },
        {
          "sql": "SELECT MAX(s.Capacity), AVG(s.Capacity) FROM stadium s"
        },
        {
          "sql": "SELECT Capacity AS Highest_Capacity, AVG(Capacity) FROM stadium GROUP BY Capacity ORDER BY Capacity DESC LIMIT 1"
        },
        {
          "sql": "SELECT MAX(Capacity), (SELECT AVG(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium GROUP BY ()"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium HAVING 1=1"
        },
        {
          "sql": "WITH stats AS (SELECT Capacity FROM stadium) SELECT MAX(Capacity), AVG(Capacity) FROM stats"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM (SELECT Capacity FROM stadium) AS s"
        },
        {
          "sql": "SELECT t1.Capacity, AVG(t1.Capacity) FROM stadium AS t1 GROUP BY t1.Capacity ORDER BY t1.Capacity DESC LIMIT 1"
        },
        {
          "sql": "SELECT Capacity, AVG(Capacity) OVER() FROM stadium WHERE Stadium_ID = (SELECT MAX(Stadium_ID) FROM stadium)"
        },
        {
          "sql": "SELECT GREATEST(Capacity) AS max_cap, AVG(Capacity) FROM stadium"
        },
        {
          "sql": "(SELECT MAX(Capacity) FROM stadium) UNION ALL (SELECT AVG(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT MAX(Capacity) AS mc, AVG(Capacity) FROM stadium WHERE 1=1"
        },
        {
          "sql": "SELECT Capacity FROM stadium ORDER BY Capacity DESC LIMIT 1 UNION ALL SELECT AVG(Capacity) FROM stadium"
        },
        {
          "sql": "WITH cte AS (SELECT Capacity, ROW_NUMBER() OVER (ORDER BY Capacity DESC) rn FROM stadium) SELECT Capacity, AVG(Capacity) OVER() FROM cte WHERE rn=1"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium WHERE Stadium_ID > 0"
        },
        {
          "sql": "SELECT p.max_cap, AVG(s.Capacity) FROM (SELECT MAX(Capacity) AS max_cap FROM stadium) p, stadium s"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(Capacity) FROM stadium CROSS JOIN (SELECT 1) x"
        },
        {
          "sql": "SELECT m.Capacity, AVG(s.Capacity) FROM stadium s JOIN (SELECT MAX(Capacity) Capacity FROM stadium) m"
        },
        {
          "sql": "SELECT MAX(Capacity), AVG(CAST(Capacity AS FLOAT)) FROM stadium"
        }
      ]
    },
    {
      "id": 17,
      "question": "What is the average and maximum capacities for all stadiums ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT AVG(Capacity), MAX(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT avg(s.Ccapacity), max(s.Ccapacity) FROM stadium s"
        },
        {
          "sql": "SELECT AVG(s.Ccapacity), MAX(s.Ccapacity) FROM stadium s"
        },
        {
          "sql": "SELECT avg(Capacity) AS avg_cap, max(Capacity) AS max_cap FROM stadium"
        },
        {
          "sql": "SELECT AVG(Capacity) avg_cap, MAX(Capacity) max_cap FROM stadium"
        },
        {
          "sql": "SELECT avg(Capacity), max(Capacity) FROM stadium WHERE Stadium_ID IS NOT NULL"
        },
        {
          "sql": "SELECT AVG(Capacity), MAX(Capacity) FROM stadium WHERE Stadium_ID IS NOT NULL"
        },
        {
          "sql": "SELECT capacity_stats.avg_cap, capacity_stats.max_cap FROM (SELECT avg(Capacity) avg_cap, max(Capacity) max_cap FROM stadium) capacity_stats"
        },
        {
          "sql": "SELECT t1.avg_cap, t1.max_cap FROM (SELECT AVG(Capacity) avg_cap, MAX(Capacity) max_cap FROM stadium) t1"
        },
        {
          "sql": "WITH cap_stats AS (SELECT avg(Capacity) avg_val, max(Capacity) max_val FROM stadium) SELECT avg_val, max_val FROM cap_stats"
        },
        {
          "sql": "WITH stats AS (SELECT AVG(Capacity) AS a, MAX(Capacity) AS m FROM stadium) SELECT a, m FROM stats"
        },
        {
          "sql": "SELECT s.avg_c, s.max_c FROM (SELECT avg(Capacity) avg_c, max(Capacity) max_c FROM stadium GROUP BY ()) s"
        },
        {
          "sql": "SELECT stats.avg_c, stats.max_c FROM (SELECT avg(Capacity) avg_c, max(Capacity) max_c FROM stadium GROUP BY 1) stats"
        },
        {
          "sql": "SELECT (SELECT avg(Capacity) FROM stadium), (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT x.a, y.b FROM (SELECT avg(Capacity) a FROM stadium) x, (SELECT max(Capacity) b FROM stadium) y"
        },
        {
          "sql": "SELECT avg(stadium.Capacity), max(stadium.Capacity) FROM stadium"
        },
        {
          "sql": "SELECT AVG(stadium.Capacity), MAX(stadium.Capacity) FROM stadium"
        },
        {
          "sql": "SELECT s1.avg_capacity, s2.max_capacity FROM (SELECT avg(Capacity) avg_capacity FROM stadium) s1 CROSS JOIN (SELECT max(Capacity) max_capacity FROM stadium) s2"
        },
        {
          "sql": "SELECT a.avg_c, b.max_c FROM (SELECT avg(Capacity) AS avg_c FROM stadium) a CROSS JOIN (SELECT max(Capacity) AS max_c FROM stadium) b"
        },
        {
          "sql": "SELECT DISTINCT avg(Capacity), max(Capacity) FROM stadium"
        },
        {
          "sql": "SELECT ALL avg(Capacity), max(Capacity) FROM stadium"
        }
      ]
    },
    {
      "id": 18,
      "question": "What is the name and capacity for the stadium with highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE s.Average = (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s ORDER BY s.Average DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average >= ALL (SELECT Average FROM stadium)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE Average IN (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "WITH max_avg AS (SELECT MAX(Average) AS max_val FROM stadium) SELECT Name, Capacity FROM stadium, max_avg WHERE Average = max_avg.max_val"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT Average FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT Name, Capacity FROM stadium WHERE Average >= (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 JOIN (SELECT MAX(Average) AS max_avg FROM stadium) s2 ON s1.Average = s2.max_avg"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average > ALL (SELECT Average FROM stadium WHERE Average < (SELECT MAX(Average) FROM stadium))"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, RANK() OVER (ORDER BY Average DESC) AS rnk FROM stadium) ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, ROW_NUMBER() OVER (ORDER BY Average DESC) AS rn FROM stadium) numbered WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT *, DENSE_RANK() OVER (ORDER BY Average DESC) AS rnk FROM stadium) ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE Average = (SELECT TOP 1 Average FROM stadium ORDER BY Average DESC)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM stadium ORDER BY Average DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT Name, Capacity, MAX(Average) OVER () AS max_att FROM stadium) s WHERE Average = max_att"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = ANY (SELECT MAX(Average) FROM stadium)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s1 WHERE Average NOT IN (SELECT Average FROM stadium s2 WHERE s2.Average > s1.Average)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name, Capacity, Average, ROW_NUMBER() OVER (ORDER BY Average DESC) rn FROM stadium) SELECT Name, Capacity FROM ranked_stadiums WHERE rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Average = (SELECT Average FROM stadium GROUP BY Stadium_ID ORDER BY AVG(Average) DESC LIMIT 1)"
        }
      ]
    },
    {
      "id": 19,
      "question": "What is the name and capacity for the stadium with the highest average attendance?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE Average  =  (SELECT max(Average ) FROM stadium)"
        },
        {
          "sql": "SELECT s1.Name ,  s1.Capacity FROM stadium s1 WHERE s1.Average  =  (SELECT max(s2.Average ) FROM stadium s2)"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium ORDER BY Average  DESC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name ,  s.Capacity FROM stadium s ORDER BY s.Average  DESC LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT Name ,  Capacity FROM stadium WHERE Average  >= ALL (SELECT Average  FROM stadium)"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Average  > s1.Average )"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE Average  NOT IN (SELECT Average  FROM stadium WHERE Average  < Average )"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE Average  = ALL (SELECT max(Average ) FROM stadium)"
        },
        {
          "sql": "WITH max_avg AS (SELECT max(Average ) AS max_val FROM stadium) SELECT Name ,  Capacity FROM stadium ,  max_avg WHERE Average  = max_avg.max_val"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Name ,  Capacity , RANK() OVER (ORDER BY Average  DESC) AS rnk FROM stadium) SELECT Name ,  Capacity FROM ranked_stadiums WHERE rnk = 1"
        },
        {
          "sql": "WITH dense_ranked AS (SELECT Name ,  Capacity , DENSE_RANK() OVER (ORDER BY Average  DESC) AS rnk FROM stadium) SELECT Name ,  Capacity FROM dense_ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE Average  = (SELECT Average  FROM stadium ORDER BY Average  DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name ,  s.Capacity FROM stadium s JOIN (SELECT max(Average ) AS max_avg FROM stadium) m ON s.Average  = m.max_avg"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM (SELECT Name ,  Capacity , Average  FROM stadium ORDER BY Average  DESC LIMIT 1) t"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM (SELECT * FROM stadium ORDER BY Average  DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE Average  > ALL (SELECT Average  FROM stadium WHERE Average  < (SELECT max(Average ) FROM stadium))"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium s WHERE Average  >= (SELECT max(Average ) FROM stadium WHERE Stadium_ID  != s.Stadium_ID  OR Stadium_ID  IS NULL)"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium EXCEPT SELECT Name ,  Capacity FROM stadium WHERE Average  < (SELECT max(Average ) FROM stadium)"
        },
        {
          "sql": "SELECT s1.Name ,  s1.Capacity FROM stadium s1 ,  (SELECT max(Average ) AS highest_avg FROM stadium) s2 WHERE s1.Average  = s2.highest_avg"
        },
        {
          "sql": "WITH stats AS (SELECT max(Average ) OVER () AS max_att FROM stadium) SELECT Name ,  Capacity FROM stadium ,  stats WHERE Average  = stats.max_att"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM stadium WHERE ROW_NUMBER() OVER (ORDER BY Average  DESC) = 1"
        },
        {
          "sql": "SELECT Name ,  Capacity FROM (SELECT Name ,  Capacity , FIRST_VALUE(Average ) OVER (ORDER BY Average  DESC) AS top_avg FROM stadium) t WHERE Average  = top_avg"
        }
      ]
    },
    {
      "id": 20,
      "question": "How many concerts are there in year 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM concert WHERE Year  =  2014 OR Year  =  2015"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert_Name) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year > 2013 AND Year < 2016"
        },
        {
          "sql": "SELECT count(distinct concert_ID) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(concert) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT sum(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM concert WHERE Year = 2014 UNION SELECT * FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "SELECT count(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(Theme) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(c.concert_ID) FROM concert c WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE (Year = 2014 OR Year = 2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT concert_ID FROM concert WHERE Year = 2014 UNION ALL SELECT concert_ID FROM concert WHERE Year = 2015)"
        },
        {
          "sql": "SELECT sum(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(distinct Theme) FROM concert WHERE Year IN (2014,2015) AND Theme IS NOT NULL"
        },
        {
          "sql": "SELECT count(concert_ID) FROM (SELECT concert_ID, Year FROM concert) AS sub WHERE sub.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert c JOIN stadium s ON c.Stadium_ID = s.Stadium_ID WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Year = 2014 UNION ALL SELECT count(*) FROM concert WHERE Year = 2015"
        },
        {
          "sql": "SELECT count(c.concert_ID) FROM concert c LEFT JOIN singer_in_concert s ON c.concert_ID = s.concert_ID WHERE c.Year IN (2014,2015)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Year FROM concert WHERE Year >= 2014 AND Year <= 2015) AS filtered_years"
        }
      ]
    },
    {
      "id": 21,
      "question": "How many concerts occurred in 2014 or 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year  =  2014 OR Year  =  2015"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Year BETWEEN 2014 AND 2015"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE Year  >  2013 AND Year  <  2016"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year  >=  2014 AND Year  <=  2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Year IN (2014,2015)) AS T1"
        },
        {
          "sql": "SELECT COUNT(concert_Name) FROM concert WHERE Year  =  2014 OR Year  =  2015"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year  =  ANY(VALUES(2014),(2015))"
        },
        {
          "sql": "SELECT SUM(CASE WHEN Year IN (2014,2015) THEN 1 ELSE 0 END) FROM concert"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE EXISTS(SELECT 1 FROM (VALUES(2014),(2015)) AS T1(Y) WHERE concert.Year  =  T1.Y)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert CROSS JOIN (VALUES(2014),(2015)) AS Y(year) WHERE concert.Year  =  Y.year"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT * FROM concert WHERE Year  =  2014 UNION SELECT * FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year IN (SELECT 2014 UNION SELECT 2015)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM (SELECT concert_ID, Year FROM concert WHERE Year BETWEEN 2014 AND 2015)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE NOT (Year  <  2014 OR Year  >  2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Year  |  0 IN (2014,2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Year  =  2014 INTERSECT SELECT concert_ID FROM concert WHERE Year  =  2015 UNION SELECT concert_ID FROM concert WHERE Year  =  2014 UNION SELECT concert_ID FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert JOIN (SELECT 2014 AS Y UNION SELECT 2015) AS Y ON concert.Year  =  Y.Y"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE (Year - 2014) * (Year - 2015)  =  0"
        },
        {
          "sql": "SELECT COUNT(1) FROM concert WHERE Year IN (2014,2015)"
        },
        {
          "sql": "WITH years AS (SELECT 2014 AS y UNION ALL SELECT 2015) SELECT COUNT(*) FROM concert c JOIN years y ON c.Year  =  y.y"
        },
        {
          "sql": "SELECT COUNT(DISTINCT CASE WHEN Year IN (2014,2015) THEN concert_ID END) FROM concert"
        }
      ]
    },
    {
      "id": 22,
      "question": "Show the stadium name and the number of concerts in each stadium.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY stadium.Stadium_ID, Name"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID, s.Name"
        },
        {
          "sql": "SELECT s.Name, count(*) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID, Name"
        },
        {
          "sql": "SELECT Name, count(c.concert_ID) FROM stadium LEFT JOIN concert c ON stadium.Stadium_ID  =  c.Stadium_ID GROUP BY stadium.Stadium_ID, Name HAVING count(c.concert_ID) > 0"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) FROM stadium s"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(concert_ID) FROM concert WHERE Stadium_ID  =  s.Stadium_ID) FROM stadium s"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) AND (SELECT count(*) FROM concert c2 WHERE c2.Stadium_ID  =  s.Stadium_ID) > 0"
        },
        {
          "sql": "SELECT s.Name, cnt FROM stadium s JOIN (SELECT Stadium_ID, count(*) AS cnt FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, concerts_per_stadium FROM stadium s JOIN (SELECT Stadium_ID, count(concert_ID) AS concerts_per_stadium FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, c.concert_count FROM stadium s INNER JOIN (SELECT Stadium_ID, count(*) AS concert_count FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium, concert WHERE stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s, concert c WHERE s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT Name, count(1) FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID, Name"
        },
        {
          "sql": "SELECT DISTINCT Name, count(DISTINCT concert_ID) FROM stadium JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Name, sum(CASE WHEN c.Stadium_ID IS NOT NULL THEN 1 ELSE 0 END) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID, s.Name"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert) GROUP BY Stadium_ID, Name"
        },
        {
          "sql": "SELECT s.Name, (SELECT count(concert_ID) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID GROUP BY c.Stadium_ID) FROM stadium s WHERE s.Stadium_ID IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium s JOIN concert c USING(Stadium_ID) GROUP BY s.Stadium_ID, Name"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, count(*) AS num_concerts FROM concert GROUP BY Stadium_ID) SELECT s.Name, cc.num_concerts FROM stadium s JOIN concert_counts cc ON s.Stadium_ID  =  cc.Stadium_ID"
        },
        {
          "sql": "WITH cte AS (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID) SELECT s.Name, (SELECT count(*) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID) FROM stadium s JOIN cte ct ON s.Stadium_ID  =  ct.Stadium_ID"
        }
      ]
    },
    {
      "id": 23,
      "question": "For each stadium, how many concerts play there?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Location, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Name, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT Stadium_ID, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Stadium_ID"
        },
        {
          "sql": "SELECT Capacity, count(concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Capacity"
        },
        {
          "sql": "SELECT Location, count(concert_Name) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT Name, count(*) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Name"
        },
        {
          "sql": "SELECT s.Location, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Location"
        },
        {
          "sql": "SELECT s.Name, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT Location, count(DISTINCT concert_ID) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT s1.Location, (SELECT count(concert_ID) FROM concert c WHERE c.Stadium_ID  =  s1.Stadium_ID) FROM stadium s1"
        },
        {
          "sql": "SELECT Name, (SELECT count(*) FROM concert WHERE Stadium_ID  =  stadium.Stadium_ID) FROM stadium"
        },
        {
          "sql": "SELECT Location FROM stadium s1 WHERE (SELECT count(concert_ID) FROM concert c WHERE c.Stadium_ID  =  s1.Stadium_ID) > 0"
        },
        {
          "sql": "SELECT Location, cnt FROM stadium s1 LEFT JOIN (SELECT Stadium_ID, count(concert_ID) cnt FROM concert GROUP BY Stadium_ID) c1 ON s1.Stadium_ID  =  c1.Stadium_ID"
        },
        {
          "sql": "SELECT Name, cnt FROM stadium LEFT JOIN (SELECT Stadium_ID, count(*) cnt FROM concert GROUP BY Stadium_ID) sub ON stadium.Stadium_ID  =  sub.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, COALESCE(c.cnt, 0) FROM stadium s LEFT JOIN (SELECT Stadium_ID, count(concert_ID) cnt FROM concert GROUP BY Stadium_ID) c ON s.Stadium_ID  =  c.Stadium_ID"
        },
        {
          "sql": "SELECT Location FROM stadium GROUP BY Location HAVING count(concert_ID) > 0"
        },
        {
          "sql": "SELECT s.Location, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Location, s.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Location, count(concert_ID) OVER (PARTITION BY Location) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, count(*) as concert_count FROM concert GROUP BY Stadium_ID) SELECT s.Location, cc.concert_count FROM stadium s LEFT JOIN concert_counts cc ON s.Stadium_ID  =  cc.Stadium_ID"
        },
        {
          "sql": "SELECT Location, SUM(CASE WHEN concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM stadium LEFT JOIN concert ON stadium.Stadium_ID  =  concert.Stadium_ID GROUP BY Location"
        },
        {
          "sql": "SELECT s.Capacity, count(c.concert_ID) FROM stadium s LEFT JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Capacity, s.Location ORDER BY s.Location"
        }
      ]
    },
    {
      "id": 24,
      "question": "Show the stadium name and capacity with most number of concerts in year 2014 or after.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY cnt DESC LIMIT 1) c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY cnt DESC LIMIT 1) t)"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID), max_concerts AS (SELECT MAX(cnt) AS max_cnt FROM concert_counts) SELECT s.Name, s.Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID JOIN max_concerts mc ON cc.cnt = mc.max_cnt"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) = (SELECT MAX(c2_cnt) FROM (SELECT COUNT(*) AS c2_cnt FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID) t)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium JOIN (SELECT Stadium_ID, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) rn FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) ranked ON stadium.Stadium_ID = ranked.Stadium_ID WHERE rn = 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert c1 WHERE Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID))"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID = s1.Stadium_ID AND c1.Year >= 2014 GROUP BY c1.Stadium_ID HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year >= 2014 GROUP BY c2.Stadium_ID))"
        },
        {
          "sql": "WITH ranked_concerts AS (SELECT Stadium_ID, COUNT(*) AS cnt, RANK() OVER (ORDER BY COUNT(*) DESC) rnk FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_concerts rc ON s.Stadium_ID = rc.Stadium_ID WHERE rc.rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s JOIN LATERAL (SELECT COUNT(*) AS cnt FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) c ON true WHERE c.cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x)"
        },
        {
          "sql": "SELECT DISTINCT FIRST_VALUE(Name) OVER (ORDER BY cnt DESC), FIRST_VALUE(Capacity) OVER (ORDER BY cnt DESC) FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) AS cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014) t WHERE cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(concert_ID) DESC FETCH FIRST 1 ROW ONLY)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s, (SELECT Stadium_ID, COUNT(*) AS concerts FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID HAVING COUNT(*) = (SELECT MAX(c) FROM (SELECT COUNT(*) c FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) t)) top_stadium WHERE s.Stadium_ID = top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c1, concert c2 WHERE c1.Stadium_ID != s.Stadium_ID AND c2.Year >= 2014 AND c1.Year >= 2014 GROUP BY c1.Stadium_ID HAVING COUNT(c1.concert_ID) > COUNT(c2.concert_ID)) AND EXISTS (SELECT 1 FROM concert c3 WHERE c3.Stadium_ID = s.Stadium_ID AND c3.Year >= 2014)"
        },
        {
          "sql": "WITH RECURSIVE max_check AS (SELECT MAX(cnt) mcnt FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID)), stadium_concerts AS (SELECT s.Stadium_ID, s.Name, s.Capacity, COUNT(c.concert_ID) cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity) SELECT Name, Capacity FROM stadium_concerts sc, max_check mc WHERE sc.cnt = mc.mcnt"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s CROSS JOIN (SELECT MAX(cnt) max_concerts FROM (SELECT COUNT(*) cnt FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID) x) m WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year >= 2014) = m.max_concerts"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.*, DENSE_RANK() OVER (ORDER BY COUNT(c.concert_ID) DESC) rnk FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year >= 2014 GROUP BY s.Stadium_ID, s.Name, s.Capacity, s.Location, s.Highest, s.Lowest, s.Average) ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year >= 2014 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s WHERE (SELECT SUM(CASE WHEN c.Year >= 2014 THEN 1 ELSE 0 END) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = (SELECT MAX(SUM(CASE WHEN c.Year >= 2014 THEN 1 ELSE 0 END)) FROM stadium s2 JOIN concert c ON s2.Stadium_ID = c.Stadium_ID GROUP BY s2.Stadium_ID)"
        }
      ]
    },
    {
      "id": 25,
      "question": "What is the name and capacity of the stadium with the most concerts after 2013 ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM (SELECT Stadium_ID, COUNT(*) AS concert_count FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1) t)"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013 GROUP BY c.Stadium_ID HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 WHERE c2.Year > 2013 GROUP BY c2.Stadium_ID))"
        },
        {
          "sql": "WITH concert_counts AS (SELECT Stadium_ID, COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT Name, Capacity FROM stadium s JOIN concert_counts cc ON s.Stadium_ID = cc.Stadium_ID WHERE cc.cnt = (SELECT MAX(cnt) FROM concert_counts)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID HAVING COUNT(*) = (SELECT MAX(c2.cnt) FROM (SELECT COUNT(*) AS cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) c2))"
        },
        {
          "sql": "SELECT DISTINCT FIRST_VALUE(Name) OVER (ORDER BY cnt DESC), FIRST_VALUE(Capacity) OVER (ORDER BY cnt DESC) FROM stadium s JOIN (SELECT Stadium_ID, COUNT(*) cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert c WHERE Year > 2013 GROUP BY Stadium_ID HAVING COUNT(*) >= (SELECT COUNT(*) FROM concert c2 WHERE c2.Stadium_ID = c.Stadium_ID AND c2.Year > 2013)) ORDER BY (SELECT COUNT(*) FROM concert WHERE Stadium_ID = s.Stadium_ID AND Year > 2013) DESC LIMIT 1"
        },
        {
          "sql": "SELECT s.Name, s.Capacity FROM stadium s JOIN LATERAL (SELECT COUNT(*) cnt FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013) c ON true WHERE c.cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM stadium s2 JOIN concert c2 ON s2.Stadium_ID = c2.Stadium_ID WHERE c2.Year > 2013 GROUP BY s2.Stadium_ID) t)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.Name, s.Capacity, COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) AS concert_cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year > 2013) t WHERE concert_cnt = (SELECT MAX(concert_cnt) FROM (SELECT COUNT(c.concert_ID) OVER (PARTITION BY s.Stadium_ID) concert_cnt FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year > 2013) u)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "WITH ranked_stadiums AS (SELECT Stadium_ID, COUNT(*) AS cnt, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) rn FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT s.Name, s.Capacity FROM stadium s JOIN ranked_stadiums r ON s.Stadium_ID = r.Stadium_ID WHERE r.rn = 1"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013) = (SELECT MAX(sub.cnt) FROM (SELECT COUNT(*) AS cnt FROM concert c JOIN stadium s2 ON c.Stadium_ID = s2.Stadium_ID WHERE c.Year > 2013 GROUP BY s2.Stadium_ID) sub)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium ORDER BY (SELECT COUNT(*) FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year > 2013) DESC LIMIT 1"
        },
        {
          "sql": "WITH max_concerts AS (SELECT MAX(cnt) AS max_cnt FROM (SELECT COUNT(*) cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t) SELECT s.Name, s.Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID CROSS JOIN max_concerts m WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity, m.max_cnt HAVING COUNT(*) = m.max_cnt"
        },
        {
          "sql": "SELECT DISTINCT ON (true) Name, Capacity FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity ORDER BY COUNT(*) DESC"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium s WHERE Stadium_ID IN (SELECT unnest(array_agg(Stadium_ID ORDER BY cnt DESC)[:1]) FROM (SELECT Stadium_ID, COUNT(*) cnt FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) t)"
        },
        {
          "sql": "SELECT Name, Capacity FROM (SELECT s.*, COUNT(c.concert_ID) as concerts FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year > 2013 GROUP BY s.Stadium_ID, s.Name, s.Capacity) ranked ORDER BY concerts DESC LIMIT 1"
        },
        {
          "sql": "WITH RECURSIVE max_check AS (SELECT MAX(COUNT(*)) OVER() as max_conc FROM concert WHERE Year > 2013 GROUP BY Stadium_ID) SELECT Name, Capacity FROM stadium s WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year > 2013) = (SELECT max_conc FROM max_check LIMIT 1)"
        },
        {
          "sql": "SELECT Name, Capacity FROM stadium WHERE Stadium_ID = (SELECT Stadium_ID FROM concert c1 WHERE Year > 2013 AND (Stadium_ID, COUNT(*)) IN (SELECT Stadium_ID, COUNT(*) FROM concert c2 WHERE Year > 2013 GROUP BY Stadium_ID ORDER BY COUNT(*) DESC LIMIT 1 GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT s1.Name, s1.Capacity FROM stadium s1 WHERE NOT EXISTS (SELECT 1 FROM stadium s2 JOIN concert c2 ON s2.Stadium_ID = c2.Stadium_ID WHERE c2.Year > 2013 GROUP BY s2.Stadium_ID HAVING COUNT(*) > (SELECT COUNT(*) FROM concert c3 WHERE c3.Stadium_ID = s1.Stadium_ID AND c3.Year > 2013)) AND EXISTS (SELECT 1 FROM concert c4 WHERE c4.Stadium_ID = s1.Stadium_ID AND c4.Year > 2013) ORDER BY (SELECT COUNT(*) FROM concert WHERE Stadium_ID = s1.Stadium_ID AND Year > 2013) DESC LIMIT 1)"
        }
      ]
    },
    {
      "id": 26,
      "question": "Which year has most number of concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c GROUP BY c.Year ORDER BY count(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) = (SELECT max(t2) FROM (SELECT count(*) t2 FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(*) cnt FROM concert GROUP BY Year) t ORDER BY t.cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT t.Year FROM (SELECT Year,count(*) cnt FROM concert GROUP BY Year) t WHERE t.cnt = (SELECT max(cnt) FROM (SELECT count(*) cnt FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT count(*) FROM concert c2 WHERE c2.Year = c1.Year) = (SELECT max(cnt) FROM (SELECT count(*) cnt FROM concert GROUP BY Year)) GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY sum(1) OVER (PARTITION BY Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY count(1) DESC LIMIT 1"
        },
        {
          "sql": "WITH cnts AS (SELECT Year,count(*) c FROM concert GROUP BY Year) SELECT Year FROM cnts WHERE c = (SELECT max(c) FROM cnts)"
        },
        {
          "sql": "WITH ranked AS (SELECT Year,count(*) cnt,ROW_NUMBER() OVER (ORDER BY count(*) DESC) rnk FROM concert GROUP BY Year) SELECT Year FROM ranked WHERE rnk = 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(*) cnt FROM concert GROUP BY Year) ORDER BY cnt DESC LIMIT 1"
        },
        {
          "sql": "SELECT max(Year) KEEP (DENSE_RANK FIRST ORDER BY cnt DESC) FROM (SELECT Year,count(*) cnt FROM concert GROUP BY Year)"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(concert_ID) >= ALL (SELECT count(*) FROM concert c2 GROUP BY c2.Year)"
        },
        {
          "sql": "SELECT c.Year FROM concert c WHERE count(*) OVER (PARTITION BY c.Year) = (SELECT max(count(*)) OVER () FROM concert GROUP BY Year)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year,count(DISTINCT concert_ID) cnt FROM concert GROUP BY Year ORDER BY cnt DESC LIMIT 1)"
        },
        {
          "sql": "SELECT ANY_VALUE(Year) FROM concert GROUP BY Year ORDER BY count(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT FIRST_VALUE(Year) OVER (ORDER BY count(*) DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED PRECEDING) FROM concert GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM concert t1 GROUP BY Year HAVING count(*) = (SELECT count(*) FROM concert t2 WHERE t2.Year = t1.Year)"
        },
        {
          "sql": "SELECT Year FROM (SELECT *,count(*) OVER (PARTITION BY Year) r FROM concert) t GROUP BY Year ORDER BY max(r) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING count(*) = (SELECT count(1) FROM concert GROUP BY Year ORDER BY count(1) DESC LIMIT 1)"
        }
      ]
    },
    {
      "id": 27,
      "question": "What is the year that had the most concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1"
        },
        {
          "sql": "SELECT c.Year FROM concert c GROUP BY c.Year ORDER BY COUNT(c.concert_ID) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING COUNT(*) = (SELECT MAX(c2) FROM (SELECT COUNT(*) c2 FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT DISTINCT c1.Year FROM concert c1 WHERE COUNT(*) = (SELECT MAX(c2) FROM (SELECT COUNT(*) c2 FROM concert GROUP BY Year)) GROUP BY c1.Year"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(*) AS cnt FROM concert GROUP BY Year) t1 WHERE cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(*) AS cnt FROM concert GROUP BY Year) t2)"
        },
        {
          "sql": "SELECT Year FROM concert c1 WHERE (SELECT COUNT(*) FROM concert c2 WHERE c2.Year = c1.Year) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) AS cnt FROM concert GROUP BY Year)) GROUP BY Year"
        },
        {
          "sql": "WITH year_counts AS (SELECT Year, COUNT(*) AS cnt FROM concert GROUP BY Year) SELECT Year FROM year_counts WHERE cnt = (SELECT MAX(cnt) FROM year_counts)"
        },
        {
          "sql": "WITH ranked_years AS (SELECT Year, COUNT(*) AS cnt, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn FROM concert GROUP BY Year) SELECT Year FROM ranked_years WHERE rn = 1"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC FETCH FIRST 1 ROW ONLY"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn FROM concert GROUP BY Year) WHERE rn = 1"
        },
        {
          "sql": "SELECT MAX(Year) KEEP (DENSE_RANK FIRST ORDER BY COUNT(*)) FROM concert GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING COUNT(*) >= ALL (SELECT COUNT(*) FROM concert c2 GROUP BY c2.Year)"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(*) AS concert_count FROM concert GROUP BY Year) t1 WHERE concert_count >= ALL (SELECT concert_count FROM (SELECT COUNT(*) AS concert_count FROM concert GROUP BY Year) t2)"
        },
        {
          "sql": "SELECT c.Year FROM concert c INNER JOIN (SELECT Year, COUNT(*) AS max_cnt FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1) mc ON c.Year = mc.Year GROUP BY c.Year"
        },
        {
          "sql": "SELECT DISTINCT Year FROM concert WHERE Year IN (SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1)"
        },
        {
          "sql": "SELECT Year FROM concert c WHERE EXISTS (SELECT 1 FROM concert c2 WHERE c2.Year = c.Year GROUP BY c2.Year HAVING COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) cnt FROM concert GROUP BY Year))) GROUP BY Year"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(concert_ID) OVER (PARTITION BY Year) AS cnt FROM concert) GROUP BY Year, cnt HAVING cnt = (SELECT MAX(cnt) FROM (SELECT COUNT(concert_ID) OVER (PARTITION BY Year) AS cnt FROM concert) t)"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year HAVING COUNT(DISTINCT concert_ID) = (SELECT MAX(cnt) FROM (SELECT COUNT(DISTINCT concert_ID) cnt FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT s.Year FROM (SELECT Year FROM concert GROUP BY Year ORDER BY COUNT(*) DESC LIMIT 1) s"
        },
        {
          "sql": "SELECT Year FROM concert GROUP BY Year ORDER BY SUM(1) OVER (PARTITION BY Year) DESC LIMIT 1"
        },
        {
          "sql": "SELECT Year FROM (SELECT Year, COUNT(*) - AVG(COUNT(*)) OVER () AS diff FROM concert GROUP BY Year) WHERE diff = (SELECT MAX(diff) FROM (SELECT COUNT(*) - AVG(COUNT(*)) OVER () AS diff FROM concert GROUP BY Year))"
        },
        {
          "sql": "SELECT Year FROM concert c1 GROUP BY c1.Year HAVING COUNT(*) = (SELECT COUNT(*) FROM concert c2 WHERE c2.Year = c1.Year GROUP BY c2.Year ORDER BY COUNT(*) DESC LIMIT 1) ORDER BY Year LIMIT 1"
        }
      ]
    },
    {
      "id": 28,
      "question": "Show the stadium names without any concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c JOIN singer_in_concert sic ON c.concert_ID = sic.concert_ID WHERE s.Stadium_ID = c.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium LEFT JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.concert_Name IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert UNION SELECT NULL)"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT ALL (SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT (Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL))"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM stadium s2 WHERE s2.Stadium_ID = s.Stadium_ID AND s2.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c))"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s, concert c WHERE s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT COUNT(c.Stadium_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s LEFT JOIN singer_in_concert sic ON 1=0 LEFT JOIN concert c ON sic.concert_ID = c.concert_ID AND s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium HAVING Stadium_ID NOT IN (SELECT Stadium_ID FROM concert) GROUP BY Stadium_ID, Name, Location, Capacity, Highest, Lowest, Average"
        }
      ]
    },
    {
      "id": 29,
      "question": "What are the names of the stadiums without any concerts?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE concert.Stadium_ID = stadium.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.concert_ID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID > ALL (SELECT COALESCE(Stadium_ID,0) FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Stadium_ID IS NOT NULL)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN singer_in_concert sic ON 1=0 LEFT JOIN concert c ON sic.concert_ID = c.concert_ID AND s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE (SELECT COUNT(c.Stadium_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) = 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT (s.Stadium_ID IN (SELECT Stadium_ID FROM concert))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert UNION SELECT NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s CROSS JOIN (SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID = s.Stadium_ID)) t"
        },
        {
          "sql": "SELECT Name FROM stadium GROUP BY Stadium_ID, Name HAVING MIN(Stadium_ID) NOT IN (SELECT Stadium_ID FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE EXISTS (SELECT 1 FROM (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert) x WHERE x.Stadium_ID = s.Stadium_ID)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium MINUS SELECT s.Name FROM stadium s INNER JOIN concert c ON s.Stadium_ID = c.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE (SELECT SUM(CASE WHEN c.Stadium_ID IS NOT NULL THEN 1 ELSE 0 END) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID) IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING COUNT(*) > 0)"
        }
      ]
    },
    {
      "id": 30,
      "question": "Show countries where a singer above age 40 and a singer below 30 are from.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID = sic1.Singer_ID WHERE s1.Age > 40 AND sic1.concert_ID IN (SELECT sic2.concert_ID FROM singer_in_concert sic2 JOIN singer s2 ON s2.Singer_ID = sic2.Singer_ID WHERE s2.Age < 30)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE s1.Age > 40 AND EXISTS (SELECT 1 FROM singer_in_concert sic1 JOIN singer_in_concert sic2 ON sic1.concert_ID = sic2.concert_ID JOIN singer s2 ON s2.Singer_ID = sic2.Singer_ID WHERE sic1.Singer_ID = s1.Singer_ID AND s2.Age < 30)"
        },
        {
          "sql": "SELECT Country FROM singer WHERE Age > 40 AND Singer_ID IN (SELECT sic1.Singer_ID FROM singer_in_concert sic1 JOIN singer_in_concert sic2 ON sic1.concert_ID = sic2.concert_ID JOIN singer s2 ON s2.Singer_ID = sic2.Singer_ID WHERE s2.Age < 30) GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID=sic1.Singer_ID JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID WHERE s1.Age>40 AND s2.Age<30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE Age>40 AND Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert sic JOIN singer s ON s.Singer_ID=sic.Singer_ID WHERE s.Age<30))"
        },
        {
          "sql": "WITH old_singers AS (SELECT DISTINCT Country FROM singer WHERE Age>40), young_singers AS (SELECT DISTINCT Country FROM singer WHERE Age<30 AND Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic JOIN singer_in_concert sic2 ON sic.concert_ID=sic2.concert_ID WHERE sic2.Singer_ID IN (SELECT Singer_ID FROM singer WHERE Age>40))) SELECT Country FROM old_singers WHERE Country IN (SELECT Country FROM young_singers)"
        },
        {
          "sql": "SELECT DISTINCT s.Country FROM singer s JOIN (SELECT sic1.concert_ID FROM singer_in_concert sic1 JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID WHERE s2.Age<30) c ON s.Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID=c.concert_ID) WHERE s.Age>40"
        },
        {
          "sql": "SELECT Country FROM (SELECT DISTINCT s1.Country, MAX(s1.Age) over (PARTITION BY s1.Country) as max_age, MIN(s2.Age) over (PARTITION BY s1.Country) as min_age FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID=sic1.Singer_ID JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID) t WHERE max_age>40 AND min_age<30"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE Age>40 INTERSECT SELECT DISTINCT Country FROM singer s2 WHERE s2.Age<30 AND EXISTS(SELECT 1 FROM singer_in_concert sic1 JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s1 ON s1.Singer_ID=sic1.Singer_ID WHERE s1.Country=s2.Country AND s1.Age>40)"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID=sic1.Singer_ID WHERE s1.Age>40 AND sic1.concert_ID IN (SELECT sic2.concert_ID FROM singer_in_concert sic2 JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID WHERE s2.Age<30 GROUP BY sic2.concert_ID)"
        },
        {
          "sql": "SELECT Country FROM singer s1 WHERE s1.Age>40 AND EXISTS(SELECT 1 FROM singer_in_concert sic1 JOIN singer s2 ON s2.Singer_ID IN (SELECT sic2.Singer_ID FROM singer_in_concert sic2 WHERE sic2.concert_ID=sic1.concert_ID) WHERE sic1.Singer_ID=s1.Singer_ID AND s2.Age<30)"
        },
        {
          "sql": "SELECT DISTINCT Country FROM (SELECT s1.Country FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID=sic1.Singer_ID JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON sic2.Singer_ID=s2.Singer_ID WHERE s1.Age>40 AND s2.Age<30)"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 WHERE s1.Age>40 GROUP BY s1.Country HAVING SUM(CASE WHEN s1.Singer_ID IN (SELECT sic1.Singer_ID FROM singer_in_concert sic1 JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID WHERE s2.Age<30) THEN 1 ELSE 0 END)>0"
        },
        {
          "sql": "WITH concerts_with_young AS (SELECT DISTINCT concert_ID FROM singer_in_concert sic JOIN singer s ON s.Singer_ID=sic.Singer_ID WHERE s.Age<30) SELECT DISTINCT s.Country FROM singer s JOIN singer_in_concert sic ON s.Singer_ID=sic.Singer_ID JOIN concerts_with_young cwy ON sic.concert_ID=cwy.concert_ID WHERE s.Age>40"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE Age>40 AND Singer_ID IN (SELECT DISTINCT sic1.Singer_ID FROM singer_in_concert sic1, singer_in_concert sic2, singer s2 WHERE sic1.concert_ID=sic2.concert_ID AND sic2.Singer_ID=s2.Singer_ID AND s2.Age<30)"
        },
        {
          "sql": "SELECT s1.Country FROM singer s1 INNER JOIN singer_in_concert sic1 ON s1.Singer_ID = sic1.Singer_ID INNER JOIN (SELECT concert_ID FROM singer_in_concert sic2 INNER JOIN singer s2 ON sic2.Singer_ID = s2.Singer_ID WHERE s2.Age < 30) sub ON sic1.concert_ID = sub.concert_ID WHERE s1.Age > 40 GROUP BY s1.Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 JOIN singer_in_concert sic1 ON s2.Singer_ID = sic1.Singer_ID JOIN singer_in_concert sic2 ON sic1.concert_ID = sic2.concert_ID JOIN singer s1 ON s1.Singer_ID = sic2.Singer_ID WHERE s2.Age > 40 AND Age < 30 AND s1.Country = Country)"
        },
        {
          "sql": "SELECT Country FROM (SELECT Country, BOOL_AND(Age>40) FILTER (WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert sic JOIN singer s ON s.Singer_ID = sic.Singer_ID WHERE s.Age<30))) as has_old, BOOL_OR(Age<30) as has_young FROM singer GROUP BY Country) t WHERE has_old AND has_young"
        },
        {
          "sql": "SELECT DISTINCT s1.Country FROM singer s1, singer_in_concert sic1, singer_in_concert sic2, singer s2 WHERE s1.Singer_ID=sic1.Singer_ID AND sic1.concert_ID=sic2.concert_ID AND sic2.Singer_ID=s2.Singer_ID AND s1.Age>40 AND s2.Age<30"
        },
        {
          "sql": "WITH paired_singers AS (SELECT s1.Country, s1.Age as age1, s2.Age as age2 FROM singer s1 JOIN singer_in_concert sic1 ON s1.Singer_ID=sic1.Singer_ID JOIN singer_in_concert sic2 ON sic1.concert_ID=sic2.concert_ID JOIN singer s2 ON s2.Singer_ID=sic2.Singer_ID) SELECT DISTINCT Country FROM paired_singers WHERE age1>40 AND age2<30"
        },
        {
          "sql": "SELECT Country FROM singer s HAVING COUNT(DISTINCT CASE WHEN Age>40 AND Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert JOIN singer s2 ON singer_in_concert.Singer_ID=s2.Singer_ID WHERE s2.Age<30)) THEN Singer_ID END)>0 AND COUNT(DISTINCT CASE WHEN Age<30 THEN Singer_ID END)>0 GROUP BY Country"
        },
        {
          "sql": "SELECT DISTINCT Country FROM singer s1 WHERE s1.Age>40 AND (SELECT COUNT(DISTINCT sic.concert_ID) FROM singer_in_concert sic JOIN singer s2 ON s2.Singer_ID=sic.Singer_ID WHERE sic.concert_ID IN (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID=s1.Singer_ID) AND s2.Age<30)>0"
        }
      ]
    },
    {
      "id": 31,
      "question": "Show names for all stadiums except for stadiums having a concert in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT EXISTS (SELECT 1 FROM concert WHERE stadium.Stadium_ID = concert.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014 UNION SELECT NULL WHERE 1=0)"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE 0 >= ALL (SELECT 1 FROM concert c WHERE c.Stadium_ID = s1.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year <> 2014 OR Year IS NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (Stadium_ID, 2014) NOT IN (SELECT Stadium_ID, Year FROM concert)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT (EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID = s.Stadium_ID AND c1.Year = 2014))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM (SELECT *, ROW_NUMBER() OVER() as rn FROM stadium) s WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 as x WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Year = 2014)) t WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "WITH bad_stadiums AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) SELECT Name FROM stadium LEFT JOIN bad_stadiums b ON stadium.Stadium_ID = b.Stadium_ID WHERE b.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL)"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE Stadium_ID = ANY (ARRAY(SELECT Stadium_ID FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)))"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = stadium.Stadium_ID AND c.Year = 2014) = 0"
        },
        {
          "sql": "SELECT s.Name FROM stadium s JOIN (SELECT Stadium_ID FROM stadium EXCEPT SELECT Stadium_ID FROM concert WHERE Year = 2014) t ON s.Stadium_ID = t.Stadium_ID"
        }
      ]
    },
    {
      "id": 32,
      "question": "What are the names of all stadiums that did not have a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT EXISTS (SELECT 1 FROM concert WHERE Stadium_ID = stadium.Stadium_ID AND Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium EXCEPT SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID > ALL (SELECT MAX(Stadium_ID) FROM concert WHERE Year = 2014 UNION SELECT 0)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM stadium WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s LEFT JOIN (SELECT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium s WHERE 0 = (SELECT COUNT(*) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE NOT EXISTS (SELECT c.Stadium_ID FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID <> ALL (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s1.Name FROM stadium s1 WHERE s1.Stadium_ID NOT IN (SELECT c.Stadium_ID FROM concert c WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium s LEFT JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND Year = 2014 WHERE c.concert_ID IS NULL"
        },
        {
          "sql": "SELECT s.Name FROM stadium s CROSS JOIN (SELECT 1 i WHERE 1=ALL(SELECT 1 FROM concert WHERE Year=2014 EXCEPT SELECT 1 FROM concert c2 JOIN stadium s2 ON c2.Stadium_ID=s2.Stadium_ID WHERE s2.Stadium_ID=s.Stadium_ID)) x"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Stadium_ID IN (SELECT s.Stadium_ID FROM stadium s EXCEPT SELECT c.Stadium_ID FROM concert c WHERE Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE (SELECT COUNT(c.Stadium_ID) FROM concert c WHERE c.Stadium_ID = s.Stadium_ID AND c.Year = 2014) = 0"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE Location IN (SELECT Location FROM stadium EXCEPT SELECT s.Location FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM stadium s LEFT JOIN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year = 2014) c ON s.Stadium_ID = c.Stadium_ID WHERE c.Stadium_ID IS NULL"
        },
        {
          "sql": "SELECT Name FROM stadium s1 WHERE Stadium_ID NOT IN (SELECT Stadium_ID FROM concert c1 WHERE c1.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM stadium s WHERE s.Stadium_ID <> ANY (SELECT Stadium_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT Name FROM stadium WHERE NOT (Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT s.Name FROM stadium s FULL OUTER JOIN concert c ON s.Stadium_ID = c.Stadium_ID AND c.Year = 2014 WHERE c.Stadium_ID IS NULL OR s.Stadium_ID IS NOT NULL"
        }
      ]
    },
    {
      "id": 33,
      "question": "Show the name and theme for all concerts and the number of singers in each concert.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme, count(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, count(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, count(*) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme HAVING count(sic.Singer_ID) > 0"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, (SELECT count(sic2.Singer_ID) FROM singer_in_concert sic2 WHERE sic2.concert_ID  =  c1.concert_ID) FROM concert c1"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT count(*) FROM singer_in_concert sic WHERE sic.concert_ID  =  concert.concert_ID) FROM concert"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT count(s.Singer_ID) FROM singer_in_concert s WHERE s.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, count(sic.Singer_ID) FROM concert c, singer_in_concert sic WHERE c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT Name AS concert_Name, Theme, singers_count FROM (SELECT concert_ID, concert_Name AS Name, Theme, count(Singer_ID) AS singers_count FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme) t"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers FROM (SELECT c.concert_Name, c.Theme, count(sic.Singer_ID) AS singers FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme) tmp"
        },
        {
          "sql": "WITH singers_per_concert AS (SELECT concert_ID, count(Singer_ID) AS cnt FROM singer_in_concert GROUP BY concert_ID) SELECT c.concert_Name, c.Theme, spc.cnt FROM concert c JOIN singers_per_concert spc ON c.concert_ID  =  spc.concert_ID"
        },
        {
          "sql": "WITH concert_stats AS (SELECT concert_ID, count(*) AS singer_cnt FROM singer_in_concert GROUP BY concert_ID) SELECT concert_Name, Theme, cs.singer_cnt FROM concert JOIN concert_stats cs ON concert.concert_ID  =  cs.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, count(DISTINCT sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, sum(CASE WHEN sic.concert_ID IS NOT NULL THEN 1 ELSE 0 END) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, cardinality(array_agg(sic.Singer_ID)) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT DISTINCT concert_Name, Theme, count(sic.Singer_ID) OVER (PARTITION BY concert.concert_ID) FROM concert JOIN singer_in_concert sic ON concert.concert_ID  =  sic.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, count(sic.Singer_ID) FROM concert CROSS JOIN singer_in_concert sic WHERE concert.concert_ID  =  sic.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme FROM concert WHERE concert_ID IN (SELECT concert_ID FROM singer_in_concert GROUP BY concert_ID) AND 1=1 ORDER BY concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme FROM concert c WHERE EXISTS (SELECT 1 FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID)"
        },
        {
          "sql": "SELECT c2.concert_Name, c2.Theme, (SELECT count(sic_inner.Singer_ID) FROM singer_in_concert sic_inner WHERE sic_inner.concert_ID  =  c2.concert_ID) FROM (SELECT DISTINCT concert_ID FROM concert) c1 JOIN concert c2 ON c1.concert_ID  =  c2.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, count(sic.Singer_ID) FROM ((concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID)) GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c3.concert_Name, c3.Theme, spc2.count FROM ((concert c3 JOIN (SELECT concert_ID, count(Singer_ID) AS count FROM singer_in_concert GROUP BY concert_ID) spc2 ON c3.concert_ID  =  spc2.concert_ID))"
        }
      ]
    },
    {
      "id": 34,
      "question": "What are the names , themes , and number of singers for every concert ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert JOIN singer_in_concert ON concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(*) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(DISTINCT sic.Singer_ID) FROM concert c JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c1.concert_Name, c1.Theme, COUNT(s1.Singer_ID) FROM concert c1 JOIN singer_in_concert s1 ON c1.concert_ID  =  s1.concert_ID GROUP BY c1.concert_ID, c1.concert_Name, c1.Theme"
        },
        {
          "sql": "SELECT Name, Theme, COUNT(Singer_ID) FROM concert, singer_in_concert WHERE concert.concert_ID  =  singer_in_concert.concert_ID GROUP BY concert_ID, Name, Theme"
        },
        {
          "sql": "SELECT c.Name, c.Theme, COUNT(sic.Singer_ID) FROM concert c, singer_in_concert sic WHERE c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, c.Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, (SELECT COUNT(*) FROM singer_in_concert sic2 WHERE sic2.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(sic.Singer_ID) FROM singer_in_concert sic WHERE sic.concert_ID  =  c.concert_ID) FROM concert c"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers_count FROM concert c JOIN (SELECT concert_ID, COUNT(Singer_ID) singers_count FROM singer_in_concert GROUP BY concert_ID) s ON c.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, s.singers_count FROM concert c JOIN (SELECT concert_ID, COUNT(*) singers_count FROM singer_in_concert GROUP BY concert_ID) s ON c.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, singers_cnt FROM (SELECT c.concert_Name, c.Theme, c.concert_ID FROM concert c) c1 JOIN (SELECT concert_ID, COUNT(Singer_ID) singers_cnt FROM singer_in_concert GROUP BY concert_ID) s1 ON c1.concert_ID  =  s1.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singer.Singer_ID) FROM concert JOIN singer_in_concert singer ON concert.concert_ID  =  singer.concert_ID GROUP BY concert.concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singers.Singer_ID) FROM concert JOIN singer_in_concert singers ON concert.concert_ID  =  singers.concert_ID GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT con.concert_Name, con.Theme, COUNT(si.Singer_ID) FROM concert con INNER JOIN singer_in_concert si ON con.concert_ID  =  si.concert_ID GROUP BY con.concert_ID, con.concert_Name, con.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert INNER JOIN singer_in_concert USING(concert_ID) GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COUNT(Singer_ID) FROM concert c INNER JOIN singer_in_concert USING(concert_ID) GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(Singer_ID) FROM concert NATURAL JOIN singer_in_concert GROUP BY concert_ID, concert_Name, Theme"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, (SELECT COUNT(*) FROM singer_in_concert WHERE concert_ID  =  c.concert_ID) FROM concert c GROUP BY c.concert_ID, c.concert_Name, c.Theme"
        },
        {
          "sql": "SELECT concert_Name, Theme, num_singers FROM concert, (SELECT concert_ID, COUNT(Singer_ID) num_singers FROM singer_in_concert GROUP BY concert_ID) s WHERE concert.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "SELECT c.concert_Name, c.Theme, COALESCE(cnt, 0) FROM concert c LEFT JOIN (SELECT concert_ID, COUNT(Singer_ID) cnt FROM singer_in_concert GROUP BY concert_ID) s ON c.concert_ID  =  s.concert_ID"
        },
        {
          "sql": "SELECT concert_Name, Theme, COUNT(singer_ID) FROM concert c LEFT JOIN singer_in_concert sic ON c.concert_ID  =  sic.concert_ID GROUP BY c.concert_ID, concert_Name, Theme"
        }
      ]
    },
    {
      "id": 35,
      "question": "List singer names and number of concerts for each singer.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT s.Name ,  count(sic.concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(concert_ID) FROM singer JOIN singer_in_concert ON singer.Singer_ID  =  singer_in_concert.Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID JOIN concert c ON sic.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(DISTINCT sic.concert_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(*) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  (SELECT count(*) FROM singer_in_concert sic2 WHERE sic2.Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(sic.concert_ID) FROM singer_in_concert sic WHERE sic.Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT Name ,  singer_concert_count FROM (SELECT Singer_ID ,  Name ,  count(concert_ID) singer_concert_count FROM singer JOIN singer_in_concert USING (Singer_ID) GROUP BY Singer_ID ,  Name) t"
        },
        {
          "sql": "WITH singer_stats AS (SELECT Singer_ID ,  Name ,  count(concert_ID) concert_count FROM singer JOIN singer_in_concert USING (Singer_ID) GROUP BY Singer_ID ,  Name) SELECT Name ,  concert_count FROM singer_stats"
        },
        {
          "sql": "SELECT s.Name ,  cnt FROM singer s JOIN (SELECT Singer_ID ,  count(concert_ID) cnt FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  sc.concert_count FROM singer s JOIN (SELECT Singer_ID ,  count(*) concert_count FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  concerts FROM singer s LEFT JOIN (SELECT Singer_ID ,  count(concert_ID) concerts FROM singer_in_concert GROUP BY Singer_ID) sic ON s.Singer_ID  =  sic.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  COALESCE(sc.concerts, 0) FROM singer s LEFT JOIN (SELECT Singer_ID ,  count(*) concerts FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  concert_count FROM (SELECT s.Name ,  count(sic.concert_ID) concert_count ,  ROW_NUMBER() OVER (PARTITION BY s.Singer_ID ORDER BY s.Name) rn FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name) t WHERE rn=1"
        },
        {
          "sql": "SELECT s1.Name ,  count(s2.concert_ID) FROM singer s1 JOIN singer_in_concert s2 ON s1.Singer_ID  =  s2.Singer_ID GROUP BY s1.Singer_ID ,  s1.Name"
        },
        {
          "sql": "SELECT singer.Name ,  singer_in_concert_concerts FROM singer JOIN (SELECT Singer_ID ,  count(concert_ID) singer_in_concert_concerts FROM singer_in_concert GROUP BY Singer_ID) USING (Singer_ID)"
        },
        {
          "sql": "SELECT Name ,  num_concerts FROM singer ,  (SELECT Singer_ID ,  count(*) num_concerts FROM singer_in_concert GROUP BY Singer_ID) t WHERE singer.Singer_ID  =  t.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  count(sic.concert_ID) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name ,  sic.concert_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  count(sic.concert_ID) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  GREATEST(count(concert_ID), 1) FROM singer NATURAL JOIN singer_in_concert GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  SUM(CASE WHEN sic.Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer s LEFT JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  (SELECT count(DISTINCT concert_ID) FROM singer_in_concert WHERE Singer_ID  =  singer.Singer_ID GROUP BY Singer_ID) FROM singer"
        },
        {
          "sql": "SELECT s.Name ,  GROUP_CONCAT(sic.concert_ID) regex '.*,.*' count FROM singer s JOIN singer_in_concert sic ON s.Singer_ID  =  sic.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        }
      ]
    },
    {
      "id": 36,
      "question": "What are the names of the singers and number of concerts for each person?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT s.Name ,  count(DISTINCT sc.concert_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  cnt FROM singer s JOIN (SELECT Singer_ID ,  count(concert_ID) cnt FROM singer_in_concert GROUP BY Singer_ID) sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  (SELECT count(*) FROM singer_in_concert sc JOIN concert c ON sc.concert_ID  =  c.concert_ID WHERE sc.Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT Name ,  count(*) FROM singer s WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert) GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM singer s INNER JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID INNER JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  num_concerts FROM (SELECT s.Name ,  count(sc.concert_ID) num_concerts FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name) t"
        },
        {
          "sql": "SELECT s.Name ,  count(*) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Name"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  count(sc.concert_ID) OVER (PARTITION BY s.Singer_ID) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT Name ,  count_concerts FROM singer LEFT JOIN (SELECT Singer_ID ,  count(concert_ID) count_concerts FROM singer_in_concert GROUP BY Singer_ID) sc ON singer.Singer_ID  =  sc.Singer_ID GROUP BY Name ,  count_concerts"
        },
        {
          "sql": "WITH singer_concerts AS (SELECT Singer_ID ,  count(concert_ID) AS concert_count FROM singer_in_concert GROUP BY Singer_ID) SELECT s.Name ,  sc.concert_count FROM singer s JOIN singer_concerts sc ON s.Singer_ID  =  sc.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  sum(CASE WHEN sc.Singer_ID IS NOT NULL THEN 1 ELSE 0 END) FROM singer s LEFT JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  (SELECT count(DISTINCT concert_ID) FROM singer_in_concert WHERE Singer_ID  =  s.Singer_ID) FROM singer s"
        },
        {
          "sql": "SELECT s1.Name ,  count(sc.concert_ID) FROM singer s1 JOIN singer_in_concert sc ON s1.Singer_ID  =  sc.Singer_ID GROUP BY s1.Singer_ID ,  s1.Name HAVING count(sc.concert_ID) > 0"
        },
        {
          "sql": "SELECT Name ,  GROUP_CONCAT(concert_ID SEPARATOR ',') FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  c.concert_count FROM singer s CROSS JOIN (SELECT count(*) concert_count FROM concert) c JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  num FROM (SELECT Singer_ID ,  count(concert_ID) num FROM singer_in_concert GROUP BY Singer_ID) sc JOIN singer s ON sc.Singer_ID  =  s.Singer_ID"
        },
        {
          "sql": "SELECT s.Name ,  count(sc.concert_ID) FROM concert c RIGHT JOIN singer_in_concert sc ON c.concert_ID  =  sc.concert_ID RIGHT JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT DISTINCT Name ,  (SELECT count(*) FROM (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID  =  outer_s.Singer_ID GROUP BY concert_ID) t) FROM singer outer_s"
        },
        {
          "sql": "SELECT Name ,  cardinality(collect(concert_ID)) FROM singer s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID GROUP BY s.Singer_ID ,  Name"
        },
        {
          "sql": "SELECT s.Name ,  count(c.concert_ID) FROM (SELECT * FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert)) s JOIN singer_in_concert sc ON s.Singer_ID  =  sc.Singer_ID JOIN concert c ON sc.concert_ID  =  c.concert_ID GROUP BY s.Singer_ID ,  s.Name"
        },
        {
          "sql": "SELECT Name ,  count(*) FROM singer_in_concert sc JOIN singer s ON sc.Singer_ID  =  s.Singer_ID GROUP BY sc.Singer_ID ,  s.Name"
        }
      ]
    },
    {
      "id": 37,
      "question": "List all singer names in concerts in year 2014.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE sc.Singer_ID = singer.Singer_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID INNER JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer JOIN singer_in_concert USING(Singer_ID) JOIN concert USING(concert_ID) WHERE Year = 2014"
        },
        {
          "sql": "SELECT Name FROM ((SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) AS sub) t JOIN singer s ON t.Singer_ID = s.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM concert c JOIN singer_in_concert sc ON c.concert_ID = sc.concert_ID JOIN singer s ON sc.Singer_ID = s.Singer_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "WITH c2014 AS (SELECT concert_ID FROM concert WHERE Year = 2014) SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN c2014 c ON sc.concert_ID = c.concert_ID"
        },
        {
          "sql": "SELECT s.Name FROM singer_in_concert sc JOIN singer s ON sc.Singer_ID = s.Singer_ID WHERE sc.concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer s, singer_in_concert sc, concert c WHERE s.Singer_ID = sc.Singer_ID AND sc.concert_ID = c.concert_ID AND c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM concert INNER JOIN singer_in_concert ON concert.concert_ID = singer_in_concert.concert_ID INNER JOIN singer ON singer_in_concert.Singer_ID = singer.Singer_ID WHERE concert.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE Singer_ID IN (SELECT sc.Singer_ID FROM singer_in_concert sc, concert c WHERE sc.concert_ID = c.concert_ID AND c.Year = 2014)"
        },
        {
          "sql": "WITH singers_2014 AS (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) SELECT Name FROM singer s JOIN singers_2014 t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer AS s JOIN singer_in_concert AS sc ON s.Singer_ID = sc.Singer_ID JOIN concert AS c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer INTERSECT SELECT Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM (SELECT s.Name, c.Year FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID) t WHERE Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert INTERSECT SELECT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s1.Name FROM singer s1 JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014) t ON s1.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer s JOIN LATERAL (SELECT 1 FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE sc.Singer_ID = s.Singer_ID AND c.Year = 2014) t"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT unnest(ARRAY_AGG(DISTINCT Singer_ID)) FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014))"
        }
      ]
    },
    {
      "id": 38,
      "question": "What are the names of the singers who performed in a concert in 2014?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014))"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE EXISTS (SELECT 1 FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE sc.Singer_ID = singer.Singer_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer s INNER JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID INNER JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) t ON singer.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM singer_in_concert sc JOIN singer s ON sc.Singer_ID = s.Singer_ID JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT DISTINCT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM (SELECT Singer_ID FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014 GROUP BY Singer_ID) t JOIN singer s ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer s WHERE EXISTS (SELECT 1 FROM singer_in_concert sic JOIN concert c ON sic.concert_ID = c.concert_ID WHERE sic.Singer_ID = s.Singer_ID AND c.Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT Name FROM ((singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID) JOIN concert c ON sc.concert_ID = c.concert_ID) WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID JOIN (SELECT concert_ID FROM concert WHERE Year = 2014) c ON sc.concert_ID = c.concert_ID"
        },
        {
          "sql": "SELECT Name FROM (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) t JOIN singer s ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT DISTINCT singer.Name FROM singer JOIN (SELECT Singer_ID FROM singer_in_concert sc JOIN concert ON sc.concert_ID = concert.concert_ID WHERE concert.Year = 2014) t ON singer.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT DISTINCT s.Name FROM concert c JOIN singer_in_concert sc ON c.concert_ID = sc.concert_ID JOIN singer s ON sc.Singer_ID = s.Singer_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer s INNER JOIN (SELECT DISTINCT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year = 2014)) t ON s.Singer_ID = t.Singer_ID"
        },
        {
          "sql": "SELECT s.Name FROM concert c INNER JOIN singer_in_concert sc ON c.concert_ID = sc.concert_ID INNER JOIN singer s ON sc.Singer_ID = s.Singer_ID WHERE c.Year = 2014"
        },
        {
          "sql": "SELECT DISTINCT Name FROM singer, singer_in_concert sc, concert c WHERE singer.Singer_ID = sc.Singer_ID AND sc.concert_ID = c.concert_ID AND c.Year = 2014"
        },
        {
          "sql": "SELECT Name FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert sic INNER JOIN concert c ON sic.concert_ID = c.concert_ID WHERE c.Year = 2014)"
        },
        {
          "sql": "SELECT s.Name FROM singer AS s JOIN singer_in_concert AS sc ON s.Singer_ID = sc.Singer_ID JOIN concert AS c ON sc.concert_ID = c.concert_ID WHERE c.Year = 2014"
        },
        {
          "sql": "WITH concerts_2014 AS (SELECT concert_ID FROM concert WHERE Year = 2014) SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID WHERE sc.concert_ID IN (SELECT concert_ID FROM concerts_2014)"
        }
      ]
    },
    {
      "id": 39,
      "question": "what is the name and nation of the singer who have a song having 'Hey' in its name?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE 'Hey%'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer s2 WHERE s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE EXISTS (SELECT 1 FROM (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') t WHERE t.Singer_ID = s.Singer_ID)"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE INSTR(Song_Name, 'Hey') > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT * FROM singer) WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE 1=1 AND Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer s CROSS JOIN (SELECT 1) t WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name MATCH 'Hey'"
        },
        {
          "sql": "WITH hey_singers AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM singer s, hey_singers h WHERE s.Singer_ID = h.Singer_ID"
        },
        {
          "sql": "WITH target_singers AS (SELECT * FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM target_singers"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID = (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 1)"
        },
        {
          "sql": "SELECT s1.Name, s1.Country FROM singer s1 INNER JOIN (SELECT DISTINCT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') s2 ON s1.Singer_ID = s2.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name || '' LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LENGTH(Song_Name) > 0 AND Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM (SELECT Name, Country, Song_Name FROM singer) WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer FETCH FIRST 100 ROWS ONLY WHERE Song_Name LIKE '%Hey%' ORDER BY Singer_ID"
        }
      ]
    },
    {
      "id": 40,
      "question": "What is the name and country of origin of every singer who has a song with the word 'Hey' in its title?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE 'Hey%' OR Song_Name LIKE '% Hey%' OR Song_Name LIKE '%Hey'"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT s.Name, s.Country FROM singer s WHERE s.Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE INSTR(Song_Name, 'Hey') > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name REGEXP 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE LOCATE('Hey', Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name GLOB '*Hey*'"
        },
        {
          "sql": "SELECT Name, Country FROM (SELECT * FROM singer) WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE EXISTS (SELECT 1 FROM singer s2 WHERE s2.Singer_ID = singer.Singer_ID AND s2.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT s1.Name, s1.Country FROM singer s1 JOIN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') s2 ON s1.Singer_ID = s2.Singer_ID"
        },
        {
          "sql": "WITH hey_singers AS (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%') SELECT Name, Country FROM singer s JOIN hey_singers h ON s.Singer_ID = h.Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID IN (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Singer_ID = ANY (SELECT Singer_ID FROM singer WHERE Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name ~ 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE POSITION('Hey' IN Song_Name) > 0"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name MATCH 'Hey'"
        },
        {
          "sql": "SELECT Name, Country FROM singer CROSS JOIN (SELECT 1) WHERE Song_Name LIKE '%Hey%'"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE (Song_Name LIKE '%Hey%') IS TRUE"
        },
        {
          "sql": "SELECT DISTINCT Name, Country FROM singer s WHERE EXISTS (SELECT 1 FROM (SELECT Song_Name FROM singer) t WHERE t.Song_Name LIKE '%Hey%' AND s.Song_Name LIKE '%Hey%')"
        },
        {
          "sql": "SELECT Name, Country FROM singer FETCH FIRST ROW ONLY WHERE Song_Name LIKE '%Hey%' ORDER BY Singer_ID"
        },
        {
          "sql": "SELECT Name, Country FROM singer WHERE Song_Name LIKE '%Hey%' LIMIT 1000000 OFFSET 0"
        }
      ]
    },
    {
      "id": 41,
      "question": "Find the name and location of the stadiums which some concerts happened in the years of both 2014 and 2015.",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year IN (2014, 2015) GROUP BY s.Stadium_ID, s.Name, s.Location HAVING SUM(CASE WHEN c.Year  =  2014 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN c.Year  =  2015 THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year  =  2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s WHERE EXISTS (SELECT 1 FROM concert c1 WHERE c1.Stadium_ID  =  s.Stadium_ID AND c1.Year  =  2014) AND EXISTS (SELECT 1 FROM concert c2 WHERE c2.Stadium_ID  =  s.Stadium_ID AND c2.Year  =  2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert WHERE Year  =  2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year  =  2015) t ON s.Stadium_ID  =  t.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c2014 ON s.Stadium_ID  =  c2014.Stadium_ID JOIN concert c2015 ON s.Stadium_ID  =  c2015.Stadium_ID WHERE c2014.Year  =  2014 AND c2015.Year  =  2015"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT c1.Stadium_ID FROM concert c1 JOIN concert c2 ON c1.Stadium_ID  =  c2.Stadium_ID WHERE c1.Year  =  2014 AND c2.Year  =  2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s INNER JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID INNER JOIN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING SUM(Year  =  2014) > 0 AND SUM(Year  =  2015) > 0) valid ON s.Stadium_ID  =  valid.Stadium_ID"
        },
        {
          "sql": "WITH has_2014 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year  =  2014), has_2015 AS (SELECT DISTINCT Stadium_ID FROM concert WHERE Year  =  2015) SELECT s.Name, s.Location FROM stadium s JOIN has_2014 h1 ON s.Stadium_ID  =  h1.Stadium_ID JOIN has_2015 h2 ON s.Stadium_ID  =  h2.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s WHERE (SELECT COUNT(DISTINCT Year) FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND Year IN (2014, 2015)) = 2"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year  =  2014 AND s.Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING bool_and(Year  =  2014 OR Year  =  2015) AND bool_or(Year  =  2014) AND bool_or(Year  =  2015))"
        },
        {
          "sql": "SELECT Name, Location FROM (SELECT s.*, COUNT(CASE WHEN c.Year  =  2014 THEN 1 END) as cnt2014, COUNT(CASE WHEN c.Year  =  2015 THEN 1 END) as cnt2015 FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID GROUP BY s.Stadium_ID, s.Name, s.Location) t WHERE cnt2014 > 0 AND cnt2015 > 0"
        },
        {
          "sql": "SELECT s1.Name, s1.Location FROM stadium s1 JOIN concert c1 ON s1.Stadium_ID  =  c1.Stadium_ID WHERE c1.Year  =  2014 AND EXISTS (SELECT 1 FROM stadium s2 JOIN concert c2 ON s2.Stadium_ID  =  c2.Stadium_ID WHERE s1.Stadium_ID  =  s2.Stadium_ID AND c2.Year  =  2015)"
        },
        {
          "sql": "SELECT DISTINCT Name, Location FROM stadium JOIN (SELECT Stadium_ID, BIT_OR(POWER(2, Year - 2014)) as years FROM concert GROUP BY Stadium_ID HAVING years & 3 = 3) y ON stadium.Stadium_ID  =  y.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s JOIN LATERAL (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year IN (2014, 2015) GROUP BY c.Year HAVING COUNT(*) > 0) years ON true WHERE CARDINALITY(ARRAY_AGG(years.Year)) = 2"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year BETWEEN 2014 AND 2015 GROUP BY Stadium_ID HAVING STRING_AGG(CAST(Year AS VARCHAR), ',') LIKE '%2014,2015%' OR '%2015,2014%')"
        },
        {
          "sql": "WITH RECURSIVE years_check(Stadium_ID, year_count) AS (SELECT Stadium_ID, COUNT(DISTINCT Year) FROM concert WHERE Year IN (2014, 2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year) = 2) SELECT Name, Location FROM stadium JOIN years_check ON stadium.Stadium_ID  =  years_check.Stadium_ID"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s WHERE (SELECT STRING_AGG(CAST(Year AS VARCHAR), '') FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND Year IN (2014, 2015)) LIKE '%20142015%' OR '%20152014%'"
        },
        {
          "sql": "SELECT DISTINCT s.Name, s.Location FROM stadium s JOIN (SELECT Stadium_ID FROM concert PIVOT (COUNT(concert_ID) FOR Year IN (2014, 2015)) GROUP BY Stadium_ID HAVING \"2014\" > 0 AND \"2015\" > 0) p ON s.Stadium_ID  =  p.Stadium_ID"
        },
        {
          "sql": "SELECT Name, Location FROM stadium s MATCH_RECOGNIZE (PARTITION BY s.Stadium_ID ORDER BY Year MEASURES S(Stadium_ID) AS stadium_id PATTERN (A B) DEFINE A AS Year  =  2014, B AS Year  =  2015) WHERE Stadium_ID IN (SELECT DISTINCT Stadium_ID FROM concert WHERE Year IN (2014, 2015))"
        },
        {
          "sql": "SELECT s.Name, s.Location FROM stadium s CROSS JOIN LATERAL (VALUES (2014), (2015)) AS target_year(ty) WHERE EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year  =  ty.ty)"
        },
        {
          "sql": "SELECT Name, Location FROM stadium WHERE Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year  =  2014) AND Stadium_ID = ANY (SELECT Stadium_ID FROM concert WHERE Year  =  2015)"
        }
      ]
    },
    {
      "id": 42,
      "question": "What are the names and locations of the stadiums that had concerts that occurred in both 2014 and 2015?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE T1.Stadium_ID IN (SELECT T4.Stadium_ID FROM concert AS T4 WHERE T4.Year  =  2014 INTERSECT SELECT T4.Stadium_ID FROM concert AS T4 WHERE T4.Year  =  2015)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE T1.Stadium_ID IN (SELECT T4.Stadium_ID FROM concert AS T4 WHERE T4.Year IN (2014,2015) GROUP BY T4.Stadium_ID HAVING COUNT(DISTINCT T4.Year)  =  2)"
        },
        {
          "sql": "SELECT DISTINCT T1.Name ,  T1.Location FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year IN (2014,2015) AND T1.Stadium_ID IN (SELECT T3.Stadium_ID FROM concert AS T3 WHERE T3.Year IN (2014,2015) GROUP BY T3.Stadium_ID HAVING COUNT(DISTINCT T3.Year)  =  2)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID JOIN concert AS T3 ON T1.Stadium_ID  =  T3.Stadium_ID WHERE T2.Year  =  2014 AND T3.Year  =  2015"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE EXISTS(SELECT 1 FROM concert AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Year  =  2014) AND EXISTS(SELECT 1 FROM concert AS T3 WHERE T3.Stadium_ID  =  T1.Stadium_ID AND T3.Year  =  2015)"
        },
        {
          "sql": "SELECT DISTINCT T1.Name ,  T1.Location FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year  =  2014 AND T1.Stadium_ID IN (SELECT T3.Stadium_ID FROM concert AS T3 WHERE T3.Year  =  2015)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN (SELECT Stadium_ID FROM concert WHERE Year  =  2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year  =  2015) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE (SELECT COUNT(DISTINCT T2.Year) FROM concert AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Year IN (2014,2015))  =  2"
        },
        {
          "sql": "SELECT DISTINCT T1.Name ,  T1.Location FROM stadium AS T1 INNER JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID INNER JOIN concert AS T3 ON T1.Stadium_ID  =  T3.Stadium_ID WHERE T2.Year  =  2014 AND T3.Year  =  2015"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN LATERAL (SELECT Stadium_ID FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)  =  2) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year  =  2014 INTERSECT SELECT Stadium_ID FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "WITH years_2014_15 AS (SELECT Stadium_ID FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)  =  2) SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN years_2014_15 AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT s.Name ,  s.Location FROM stadium s JOIN concert c ON s.Stadium_ID  =  c.Stadium_ID WHERE c.Year BETWEEN 2014 AND 2015 AND s.Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING SUM(CASE WHEN Year  =  2014 THEN 1 ELSE 0 END)  >  0 AND SUM(CASE WHEN Year  =  2015 THEN 1 ELSE 0 END)  >  0)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE T1.Stadium_ID IN (SELECT Stadium_ID FROM concert GROUP BY Stadium_ID HAVING ARRAY_AGG(DISTINCT Year) OVERLAPS ARRAY[2014,2015] AND COUNT(DISTINCT Year)  =  2)"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium EXCEPT SELECT Name ,  Location FROM stadium s WHERE NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year  =  2014) OR NOT EXISTS (SELECT 1 FROM concert c WHERE c.Stadium_ID  =  s.Stadium_ID AND c.Year  =  2015)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN (SELECT Stadium_ID, COUNT(DISTINCT Year) as year_count FROM concert WHERE Year IN (2014,2015) GROUP BY Stadium_ID HAVING COUNT(DISTINCT Year)  =  2) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT DISTINCT T1.Name ,  T1.Location FROM stadium AS T1, concert AS T2, concert AS T3 WHERE T1.Stadium_ID  =  T2.Stadium_ID AND T1.Stadium_ID  =  T3.Stadium_ID AND T2.Year  =  2014 AND T3.Year  =  2015"
        },
        {
          "sql": "SELECT Name ,  Location FROM stadium WHERE Stadium_ID  >  0 AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year  =  2014) INTERSECT SELECT Name ,  Location FROM stadium WHERE Stadium_ID  >  0 AND Stadium_ID IN (SELECT Stadium_ID FROM concert WHERE Year  =  2015)"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 WHERE (SELECT BOOL_AND(Year IN (2014,2015)) FROM concert WHERE Stadium_ID  =  T1.Stadium_ID) AND (SELECT COUNT(DISTINCT Year) FROM concert WHERE Stadium_ID  =  T1.Stadium_ID AND Year IN (2014,2015))  =  2"
        },
        {
          "sql": "WITH RECURSIVE stadium_years AS (SELECT Stadium_ID FROM concert WHERE Year  =  2014 UNION SELECT Stadium_ID FROM concert WHERE Year  =  2015) SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN (SELECT Stadium_ID FROM stadium_years GROUP BY Stadium_ID HAVING COUNT(DISTINCT Stadium_ID)  =  2) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT T1.Name ,  T1.Location FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Year  =  2014 AND NOT EXISTS (SELECT 1 FROM concert AS T3 WHERE T3.Stadium_ID  =  T1.Stadium_ID AND T3.Year NOT IN (2014,2015)) AND EXISTS (SELECT 1 FROM concert AS T4 WHERE T4.Stadium_ID  =  T1.Stadium_ID AND T4.Year  =  2015)"
        },
        {
          "sql": "SELECT DISTINCT ON (T1.Stadium_ID) T1.Name ,  T1.Location FROM stadium AS T1 JOIN concert AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE (T2.Year , T1.Stadium_ID) IN ((2014, T1.Stadium_ID), (2015, T1.Stadium_ID)) GROUP BY T1.Stadium_ID , T1.Name , T1.Location HAVING COUNT(DISTINCT T2.Year)  =  2"
        }
      ]
    },
    {
      "id": 43,
      "question": "Find the number of concerts happened in the stadium with the highest capacity .",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID  =  (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(concert_ID) FROM concert WHERE Stadium_ID  =  (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert WHERE Stadium_ID  IN (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C1 WHERE EXISTS (SELECT 1 FROM stadium S1 WHERE S1.Capacity  =  (SELECT MAX(Capacity) FROM stadium) AND C1.Stadium_ID  =  S1.Stadium_ID)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert JOIN stadium ON concert.Stadium_ID  =  stadium.Stadium_ID WHERE stadium.Capacity  =  (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert.concert_ID) FROM concert JOIN stadium ON concert.Stadium_ID  =  stadium.Stadium_ID WHERE stadium.Capacity  =  (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID  =  S.Stadium_ID WHERE S.Capacity  =  (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(concert.concert_ID) FROM concert JOIN stadium ON concert.Stadium_ID  =  stadium.Stadium_ID AND stadium.Capacity  =  (SELECT MAX(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT concert_ID FROM concert WHERE Stadium_ID  =  (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)) AS sub"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID  IN (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT C.concert_ID) FROM concert C JOIN stadium S ON C.Stadium_ID  =  S.Stadium_ID JOIN (SELECT MAX(Capacity) AS max_cap FROM stadium) M ON S.Capacity  =  M.max_cap"
        },
        {
          "sql": "WITH max_stadium AS (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT MAX(Capacity) FROM stadium)) SELECT COUNT(*) FROM concert WHERE Stadium_ID  IN (SELECT Stadium_ID FROM max_stadium)"
        },
        {
          "sql": "WITH highest_capacity AS (SELECT MAX(Capacity) AS max_cap FROM stadium) SELECT COUNT(*) FROM concert C JOIN stadium S ON C.Stadium_ID  =  S.Stadium_ID JOIN highest_capacity H ON S.Capacity  =  H.max_cap"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID  =  ANY (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID  =  SOME (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT MAX(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT COUNT(1) FROM concert C WHERE EXISTS (SELECT 1 FROM stadium S WHERE S.Capacity  =  (SELECT MAX(Capacity) FROM stadium) AND C.Stadium_ID  =  S.Stadium_ID)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT C.concert_ID FROM concert C INNER JOIN stadium S ON C.Stadium_ID  =  S.Stadium_ID WHERE S.Capacity  =  (SELECT MAX(S2.Capacity) FROM stadium S2)) AS concert_count"
        },
        {
          "sql": "SELECT SUM(CASE WHEN C.Stadium_ID  =  (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1) THEN 1 ELSE 0 END) FROM concert C"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert WHERE Stadium_ID  IN (SELECT S.Stadium_ID FROM stadium S WHERE NOT EXISTS (SELECT 1 FROM stadium S2 WHERE S2.Capacity  >  S.Capacity))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT concert_ID) FROM concert C JOIN (SELECT Stadium_ID FROM stadium S1 WHERE Capacity  >=  ALL (SELECT Capacity FROM stadium S2)) S ON C.Stadium_ID  =  S.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM concert, (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT MAX(Capacity) FROM stadium)) AS top_stadium WHERE concert.Stadium_ID  =  top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT C.concert_ID, S.Capacity FROM concert C JOIN stadium S ON C.Stadium_ID  =  S.Stadium_ID WHERE S.Capacity  =  (SELECT MAX(Capacity) FROM stadium)) AS unique_concerts"
        }
      ]
    },
    {
      "id": 44,
      "question": "What are the number of concerts that occurred in the stadium with the largest capacity ?",
      "db_id": "concert_singer",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Stadium_ID  =  (SELECT Stadium_ID FROM stadium ORDER BY Capacity DESC LIMIT 1)"
        },
        {
          "sql": "SELECT count(T1.concert_ID) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT count(DISTINCT T1.concert_ID) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 INNER JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID AND T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "WITH max_cap AS (SELECT max(Capacity) AS max_c FROM stadium) SELECT count(*) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID CROSS JOIN max_cap WHERE T2.Capacity  =  max_cap.max_c"
        },
        {
          "sql": "SELECT count(*) FROM concert WHERE Stadium_ID IN (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT max(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT sum(CASE WHEN T2.Capacity  =  (SELECT max(Capacity) FROM stadium) THEN 1 ELSE 0 END) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT T1.concert_ID FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)) AS T3"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM concert WHERE Stadium_ID  =  T1.Stadium_ID) FROM stadium AS T1 WHERE T1.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT count(T1.concert_ID) FROM concert AS T1 JOIN (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT max(Capacity) FROM stadium)) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1, stadium AS T2 WHERE T1.Stadium_ID  =  T2.Stadium_ID AND T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 JOIN (SELECT * FROM stadium ORDER BY Capacity DESC LIMIT 1) AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID"
        },
        {
          "sql": "SELECT sum(1) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "WITH top_stadium AS (SELECT Stadium_ID FROM stadium WHERE Capacity  =  (SELECT max(Capacity) FROM stadium)) SELECT count(*) FROM concert, top_stadium WHERE concert.Stadium_ID  =  top_stadium.Stadium_ID"
        },
        {
          "sql": "SELECT count(concert_ID) FROM concert WHERE Stadium_ID  =  (SELECT T2.Stadium_ID FROM stadium AS T2 WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium))"
        },
        {
          "sql": "SELECT cardinality(array_agg(concert_ID)) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)"
        },
        {
          "sql": "SELECT regr_count() OVER (PARTITION BY T2.Capacity) FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium) LIMIT 1"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM concert AS T3 WHERE T3.Stadium_ID  =  T1.Stadium_ID) FROM stadium AS T1 WHERE T1.Capacity  =  (SELECT max(s.Capacity) FROM stadium AS s)"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 RIGHT JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium) AND T1.concert_ID IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT T1.Stadium_ID) FROM (SELECT T1.Stadium_ID FROM concert AS T1 JOIN stadium AS T2 ON T1.Stadium_ID  =  T2.Stadium_ID WHERE T2.Capacity  =  (SELECT max(Capacity) FROM stadium)) AS T3 CROSS JOIN concert AS T4 WHERE T3.Stadium_ID  =  T4.Stadium_ID"
        },
        {
          "sql": "SELECT count(*) FROM concert AS T1 WHERE EXISTS (SELECT 1 FROM stadium AS T2 WHERE T2.Stadium_ID  =  T1.Stadium_ID AND T2.Capacity  =  (SELECT max(Capacity) FROM stadium))"
        }
      ]
    },
    {
      "id": 45,
      "question": "Find the number of pets whose weight is heavier than 10.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT SUM(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE NOT (weight <= 10)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > 10 AND PetType IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE pet_age IS NOT NULL AND weight > 10"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets WHERE PetID > 0 AND weight > 10"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight BETWEEN 10.0001 AND 999999"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM (SELECT * FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > ALL (SELECT 10)"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE EXISTS (SELECT 1 WHERE weight > 10)"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets CROSS JOIN (SELECT 10 AS limit_wt) AS T1 WHERE Pets.weight > T1.limit_wt"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets, (SELECT 10 AS threshold) AS T1 WHERE Pets.weight > T1.threshold"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE weight > 10 AND PetType IN (SELECT DISTINCT PetType FROM Pets)"
        },
        {
          "sql": "WITH HeavyPets AS (SELECT * FROM Pets WHERE weight > 10) SELECT COUNT(*) FROM HeavyPets"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > (SELECT AVG(weight) FROM Pets WHERE weight < 10 UNION SELECT 10)"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets LEFT JOIN (SELECT StuID FROM Student) AS T1 ON 1=0 WHERE Pets.weight > 10"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID, pet_age, weight FROM Pets WHERE weight > 10) AS subq"
        },
        {
          "sql": "SELECT SUM(CASE WHEN weight > 10 THEN 1 END) FROM Pets WHERE PetID IS NOT NULL"
        }
      ]
    },
    {
      "id": 46,
      "question": "How many pets have a greater weight than 10?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT SUM(CASE WHEN weight > 10 THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE NOT (weight <= 10)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetID) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM Pets WHERE weight > 10.0"
        },
        {
          "sql": "SELECT (SELECT COUNT(*) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetID) FROM (SELECT PetID FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(1) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > CAST(10 AS DECIMAL)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT * FROM Pets WHERE weight > 10) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight BETWEEN 10.000001 AND 999999"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(pet_age) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT COUNT(weight) FROM Pets WHERE weight > 10"
        },
        {
          "sql": "SELECT SUM(CASE WHEN weight > 10 THEN 1 END) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE weight > 10 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT (SELECT COUNT(PetID) FROM Pets WHERE weight > 10)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.weight > 10"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE EXISTS (SELECT 1 FROM Pets WHERE PetID = P.PetID AND weight > 10)"
        }
      ]
    },
    {
      "id": 47,
      "question": "Find the weight of the youngest dog.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID=(SELECT PetID FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT MIN(Pets.weight) FROM Pets WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age, weight, ROW_NUMBER() OVER (ORDER BY pet_age) rn FROM Pets WHERE PetType='dog') t WHERE rn=1"
        },
        {
          "sql": "SELECT weight FROM Pets p1 WHERE PetType='dog' AND pet_age=(SELECT MIN(pet_age) FROM Pets p2 WHERE p2.PetType=p1.PetType)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age FROM Pets WHERE PetType='dog') t ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age) FROM Pets WHERE PetType='dog' LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=ALL(SELECT pet_age FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age, MIN(weight) weight FROM Pets WHERE PetType='dog' GROUP BY pet_age) t WHERE pet_age=(SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "WITH youngest_dog AS (SELECT MIN(pet_age) min_age FROM Pets WHERE PetType='dog') SELECT weight FROM Pets p, youngest_dog y WHERE p.PetType='dog' AND p.pet_age=y.min_age"
        },
        {
          "sql": "WITH min_age AS (SELECT pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1) SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM min_age)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets p2 WHERE p2.PetType='dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' QUALIFY ROW_NUMBER() OVER (ORDER BY pet_age)=1"
        },
        {
          "sql": "SELECT weight FROM Pets p WHERE PetType='dog' AND NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.PetType='dog' AND p2.pet_age<p.pet_age)"
        },
        {
          "sql": "SELECT weight FROM (SELECT weight, pet_age, RANK() OVER (ORDER BY pet_age) rnk FROM Pets WHERE PetType='dog') t WHERE rnk=1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType='dog')"
        },
        {
          "sql": "WITH ranked_dogs AS (SELECT pet_age, weight, DENSE_RANK() OVER (ORDER BY pet_age) rnk FROM Pets WHERE PetType='dog') SELECT weight FROM ranked_dogs WHERE rnk=1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType='dog' AND pet_age=(SELECT pet_age FROM Pets WHERE PetType='dog' GROUP BY pet_age ORDER BY MIN(pet_age) LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM (SELECT PetID, pet_age FROM Pets WHERE PetType='dog' ORDER BY pet_age LIMIT 1) y JOIN Pets p ON p.PetID=y.PetID"
        },
        {
          "sql": "SELECT p.weight FROM Pets p WHERE p.PetType='dog' AND p.pet_age=(SELECT MIN(pp.pet_age) FROM Pets pp WHERE pp.PetType='dog')"
        }
      ]
    },
    {
      "id": 48,
      "question": "How much does the youngest dog weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT MIN(weight) FROM Pets WHERE PetType = 'dog'"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog') AND PetType = 'dog' LIMIT 1"
        },
        {
          "sql": "SELECT P.weight FROM Pets P WHERE P.PetType = 'dog' AND P.pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT pet_age FROM Pets WHERE PetType = 'dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT weight FROM (SELECT pet_age, weight FROM Pets WHERE PetType = 'dog') t ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age <= ALL (SELECT pet_age FROM Pets WHERE PetType = 'dog') LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT P.weight FROM Pets P INNER JOIN (SELECT MIN(pet_age) AS min_age FROM Pets WHERE PetType = 'dog') min_p ON P.pet_age = min_p.min_age WHERE P.PetType = 'dog'"
        },
        {
          "sql": "WITH youngest_dog_age AS (SELECT MIN(pet_age) AS age FROM Pets WHERE PetType = 'dog') SELECT weight FROM Pets P, youngest_dog_age Y WHERE P.PetType = 'dog' AND P.pet_age = Y.age"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' FETCH FIRST 1 ROW ONLY ORDER BY pet_age"
        },
        {
          "sql": "SELECT FIRST_VALUE(weight) OVER (ORDER BY pet_age ROWS UNBOUNDED PRECEDING) AS weight FROM Pets WHERE PetType = 'dog' LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age = MIN(pet_age) FROM Pets WHERE PetType = 'dog'"
        },
        {
          "sql": "SELECT weight FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY pet_age) rn FROM Pets WHERE PetType = 'dog') WHERE rn = 1"
        },
        {
          "sql": "SELECT weight FROM (SELECT *, RANK() OVER (ORDER BY pet_age) rn FROM Pets WHERE PetType = 'dog') WHERE rn = 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age IN (SELECT MIN(pet_age) FROM Pets WHERE PetType = 'dog') LIMIT 1"
        },
        {
          "sql": "SELECT P1.weight FROM Pets P1 WHERE P1.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Pets P2 WHERE P2.PetType = 'dog' AND P2.pet_age < P1.pet_age)"
        },
        {
          "sql": "SELECT weight FROM Pets p1 WHERE PetType = 'dog' AND pet_age <= (SELECT pet_age FROM Pets p2 WHERE p2.PetType = 'dog' ORDER BY p2.pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT MAX(weight) FROM (SELECT weight FROM Pets WHERE PetType = 'dog' ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT P.weight FROM Pets P WHERE PetType = 'dog' GROUP BY P.pet_age HAVING pet_age = MIN(pet_age) ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT weight FROM Pets WHERE PetType = 'dog' AND pet_age IN (SELECT pet_age FROM Pets WHERE PetType = 'dog' GROUP BY pet_age HAVING pet_age = MIN(pet_age))"
        },
        {
          "sql": "WITH ranked_dogs AS (SELECT weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age ASC) AS rn FROM Pets WHERE PetType = 'dog') SELECT weight FROM ranked_dogs WHERE rn = 1"
        }
      ]
    },
    {
      "id": 49,
      "question": "Find the maximum weight for each type of pet. List the maximum weight and pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(Pets.weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT max(weight) FROM Pets P2 WHERE P2.PetType  =  P1.PetType) FROM Pets P1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets AS P GROUP BY P.PetType"
        },
        {
          "sql": "SELECT p.PetType, max(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) weight FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, greatest(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType HAVING count(*)  >  0"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "WITH pet_max AS (SELECT PetType, max(weight) AS max_wt FROM Pets GROUP BY PetType) SELECT PetType, max_wt FROM pet_max"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, weight, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY weight DESC) rn FROM Pets) SELECT PetType, weight FROM ranked_pets WHERE rn  =  1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT p.PetType, (SELECT max(p2.weight) FROM Pets p2 WHERE p2.PetType  =  p.PetType) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ALL"
        },
        {
          "sql": "WITH RECURSIVE pet_summary AS (SELECT PetType, weight FROM Pets UNION ALL SELECT PetType, weight FROM Pets) SELECT PetType, max(weight) FROM pet_summary GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT PetType, CORR(weight) FROM Pets GROUP BY PetType HAVING max(weight)  =  max(weight)"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT k.PetType, k.max_weight FROM (SELECT PetType, max(weight) max_weight, ROW_NUMBER() OVER (ORDER BY PetType) rn FROM Pets GROUP BY PetType) k"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FOR UPDATE"
        }
      ]
    },
    {
      "id": 50,
      "question": "List the maximum weight and type for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) AS max_weight FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, max(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT p.PetType, max(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, (SELECT max(weight) FROM Pets p2 WHERE p2.PetType  =  Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_max AS (SELECT PetType, max(weight) as mw FROM Pets GROUP BY PetType) SELECT * FROM pet_max"
        },
        {
          "sql": "SELECT PetType, GREATEST(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets p GROUP BY p.PetType HAVING PetType IS NOT NULL"
        },
        {
          "sql": "SELECT t.PetType, max(t.weight) FROM Pets t GROUP BY t.PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets) GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "WITH ranked_pets AS (SELECT PetType, weight, ROW_NUMBER() OVER (PARTITION BY PetType ORDER BY weight DESC) as rn FROM Pets) SELECT PetType, weight FROM ranked_pets WHERE rn  =  1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY ALL"
        },
        {
          "sql": "SELECT DISTINCT PetType, (SELECT max(weight) FROM Pets WHERE PetType  =  outer.PetType) FROM Pets outer"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets WHERE weight IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "WITH max_weights AS (SELECT max(weight) as mw, PetType FROM Pets GROUP BY PetType) SELECT mw, PetType FROM max_weights"
        },
        {
          "sql": "SELECT p1.PetType, (SELECT max(p2.weight) FROM Pets p2 WHERE p2.PetType  =  p1.PetType) FROM (SELECT DISTINCT PetType FROM Pets) p1"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType FETCH FIRST 100 ROWS ONLY"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, max(weight) FROM Pets GROUP BY PetType) t"
        },
        {
          "sql": "SELECT PetType, CORR(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, max(weight) FROM Pets GROUP BY PetType UNION SELECT PetType, max(weight) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 51,
      "question": "Find number of pets owned by students who are older than 20.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) T"
        },
        {
          "sql": "SELECT SUM(CASE WHEN S.Age > 20 THEN 1 ELSE 0 END) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = Pets.PetID AND S.Age > 20)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) T"
        },
        {
          "sql": "SELECT COUNT(P.weight) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(P.pet_age) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT SUM(1) FROM Pets P WHERE PetID IN (SELECT PetID FROM Has_Pet H WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON S.StuID = H.StuID WHERE S.Age > 20"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetID) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE PetID = P.PetID AND StuID IN (SELECT StuID FROM Student WHERE Age > 20))"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM (SELECT StuID FROM Student WHERE Age > 20) S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H WHERE StuID IN (SELECT StuID FROM Student WHERE Age > 20) AND PetID IN (SELECT PetID FROM Pets)"
        },
        {
          "sql": "SELECT COUNT(P.PetType) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20) T ON P.PetID = T.PetID"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM (SELECT * FROM Pets) P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20"
        },
        {
          "sql": "WITH OldStudents AS (SELECT StuID FROM Student WHERE Age > 20) SELECT COUNT(H.PetID) FROM OldStudents O JOIN Has_Pet H ON O.StuID = H.StuID"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Age > 20 GROUP BY PetID) T"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetID) FROM (SELECT PetID, StuID FROM Has_Pet JOIN Student ON Has_Pet.StuID = Student.StuID WHERE Age > 20) T"
        }
      ]
    },
    {
      "id": 52,
      "question": "How many pets are owned by students that have an age greater than 20?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets P WHERE P.PetID IN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20)"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID=H.PetID JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(DISTINCT P.PetID) FROM Pets P INNER JOIN Has_Pet H ON P.PetID=H.PetID INNER JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT sum(CASE WHEN H.StuID IS NOT NULL THEN 1 ELSE 0 END) FROM Pets P LEFT JOIN Has_Pet H ON P.PetID=H.PetID LEFT JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(H.PetID) FROM Has_Pet H INNER JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20) T"
        },
        {
          "sql": "WITH EligibleStudents AS (SELECT StuID FROM Student WHERE Age>20) SELECT count(H.PetID) FROM Has_Pet H INNER JOIN EligibleStudents E ON H.StuID=E.StuID"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE H.PetID=P.PetID AND S.Age>20)"
        },
        {
          "sql": "SELECT sum(1) FROM Pets P JOIN Has_Pet H ON P.PetID=H.PetID JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(1) FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets P JOIN Has_Pet H ON P.PetID=H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age>20))"
        },
        {
          "sql": "SELECT count(DISTINCT H.PetID) FROM Student S JOIN Has_Pet H ON S.StuID=H.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(*) FROM Pets P INNER JOIN (SELECT DISTINCT PetID FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20) T ON P.PetID=T.PetID"
        },
        {
          "sql": "SELECT count(P.*) FROM Pets P JOIN Has_Pet H ON P.PetID=H.PetID JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "WITH OldStudents AS (SELECT StuID FROM Student WHERE Age>20), PetOwners AS (SELECT PetID FROM Has_Pet H JOIN OldStudents O ON H.StuID=O.StuID) SELECT count(*) FROM Pets P JOIN PetOwners PO ON P.PetID=PO.PetID"
        },
        {
          "sql": "SELECT count(H.PetID) FROM (SELECT StuID FROM Student WHERE Age>20) Eligible JOIN Has_Pet H ON Eligible.StuID=H.StuID"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT P.PetID FROM Pets P INNER JOIN Has_Pet H ON P.PetID=H.PetID WHERE H.StuID IN (SELECT StuID FROM Student WHERE Age>20)) T"
        },
        {
          "sql": "SELECT sum(CASE WHEN P.PetID IS NOT NULL THEN 1 ELSE 0 END) FROM (SELECT StuID FROM Student WHERE Age>20) S LEFT JOIN Has_Pet H ON S.StuID=H.StuID LEFT JOIN Pets P ON H.PetID=P.PetID"
        },
        {
          "sql": "SELECT count(PetID) FROM Pets P WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Age>20))"
        },
        {
          "sql": "SELECT count(bigint '1') FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT cardinality(ARRAY_AGG(DISTINCT H.PetID)) FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20"
        },
        {
          "sql": "SELECT count(*) FROM Pets WHERE PetID=ANY(ARRAY(SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID=S.StuID WHERE S.Age>20))"
        }
      ]
    },
    {
      "id": 53,
      "question": "Find the number of dog pets that are raised by female students (with sex F).",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE S.Sex  =  'F' AND P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(P.PetID) FROM ((Student S JOIN Has_Pet H ON S.StuID  =  H.StuID) JOIN Pets P ON H.PetID  =  P.PetID) WHERE S.Sex  =  'F' AND P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F') AS sub"
        },
        {
          "sql": "SELECT count(*) FROM Student S WHERE S.Sex  =  'F' AND S.StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'dog')"
        },
        {
          "sql": "SELECT count(*) FROM Pets P WHERE P.PetType  =  'dog' AND P.PetID IN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID WHERE S.Sex  =  'F')"
        },
        {
          "sql": "SELECT count(P1.PetID) FROM Pets P1 WHERE P1.PetType  =  'dog' AND EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID WHERE H.PetID  =  P1.PetID AND S.Sex  =  'F')"
        },
        {
          "sql": "SELECT count(H1.PetID) FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID  =  H1.StuID AND S.Sex  =  'F') AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID  =  H1.PetID AND P.PetType  =  'dog')"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT S.StuID FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE S.Sex  =  'F' AND P.PetType  =  'dog' GROUP BY S.StuID) AS owners"
        },
        {
          "sql": "SELECT sum(CASE WHEN P.PetType  =  'dog' THEN 1 ELSE 0 END) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Pets P JOIN (SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID WHERE S.Sex  =  'F') F ON P.PetID  =  F.PetID WHERE P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT H.PetID, P.PetType FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE S.Sex  =  'F') female_pets WHERE PetType  =  'dog'"
        },
        {
          "sql": "SELECT count(DISTINCT H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID  =  S.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE S.Sex  =  'F' AND P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM Pets P2 JOIN Has_Pet H2 ON P2.PetID  =  H2.PetID JOIN Student S2 ON H2.StuID  =  S2.StuID WHERE P2.PetType  =  'dog' AND S2.Sex  =  'F')"
        },
        {
          "sql": "SELECT count(P.pet_age) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(P.weight) FROM Pets P JOIN Has_Pet H ON P.PetID  =  H.PetID JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(*) FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'dog') dogs ON S.StuID  =  dogs.StuID WHERE S.Sex  =  'F'"
        },
        {
          "sql": "SELECT count(1) FROM Pets P INNER JOIN Has_Pet H ON P.PetID  =  H.PetID INNER JOIN Student S ON H.StuID  =  S.StuID WHERE P.PetType  =  'dog' AND S.Sex  =  'F'"
        },
        {
          "sql": "SELECT (SELECT count(P.PetID) FROM Pets P WHERE P.PetType  =  'dog' AND P.PetID IN (SELECT H.PetID FROM Has_Pet H WHERE H.StuID IN (SELECT S.StuID FROM Student S WHERE S.Sex  =  'F')) )"
        }
      ]
    },
    {
      "id": 54,
      "question": "How many dog pets are raised by female students?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(*) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(DISTINCT P.PetID) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(H.PetID) FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT SUM(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT P.PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F') AS dog_count"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(P.*) FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'dog' AND S.Sex = 'F'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets P WHERE PetType = 'dog' AND PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Sex = 'F'))"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog') t"
        },
        {
          "sql": "SELECT COUNT(P.PetID) FROM Pets P WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = P.PetID AND S.Sex = 'F') AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Student S WHERE S.StuID = H.StuID AND S.Sex = 'F') AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT SUM(CASE WHEN PetType = 'dog' AND PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE Sex = 'F')) THEN 1 ELSE 0 END) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(H1.PetID) FROM Has_Pet H1 WHERE H1.StuID IN (SELECT StuID FROM Student WHERE Sex = 'F') AND H1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')"
        },
        {
          "sql": "WITH female_dog_owners AS (SELECT DISTINCT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.Sex = 'F'), dog_pets AS (SELECT PetID FROM Pets WHERE PetType = 'dog') SELECT COUNT(*) FROM female_dog_owners F JOIN dog_pets D ON F.PetID = D.PetID"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets CROSS JOIN Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE Pets.PetID = H.PetID AND S.Sex = 'F' AND Pets.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(DISTINCT H.PetID) FROM (Student S JOIN Has_Pet H ON S.StuID = H.StuID) JOIN Pets P ON H.PetID = P.PetID WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT H.PetID, S.Sex, P.PetType FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID JOIN Pets P ON H.PetID = P.PetID) WHERE Sex = 'F' AND PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(P1.PetID) FROM Pets P1 WHERE P1.PetType = 'dog' AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Student S2 ON H2.StuID = S2.StuID WHERE H2.PetID = P1.PetID AND S2.Sex = 'F')"
        },
        {
          "sql": "SELECT SUM((SELECT COUNT(*) FROM Has_Pet H WHERE H.PetID = P.PetID AND H.StuID IN (SELECT S.StuID FROM Student S WHERE S.Sex = 'F'))) FROM Pets P WHERE P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM Student S NATURAL JOIN Has_Pet H NATURAL JOIN Pets P WHERE S.Sex = 'F' AND P.PetType = 'dog'"
        },
        {
          "sql": "SELECT COUNT(*) FROM ((SELECT StuID FROM Student WHERE Sex = 'F') F JOIN Has_Pet H ON F.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) WHERE P.PetType = 'dog'"
        }
      ]
    },
    {
      "id": 55,
      "question": "Find the number of distinct type of pets.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM (SELECT PetType FROM Pets WHERE pet_age > 0) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE weight IS NOT NULL GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE pet_age IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets WHERE PetID > 0) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType HAVING COUNT(*) > 0) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets GROUP BY PetID HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE PetID = Pets.PetID) GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT T1.PetType) FROM Pets AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets ORDER BY PetType) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets UNION SELECT 0 WHERE 1=0"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets p GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM (SELECT * FROM Pets LIMIT 1000000) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE PetType != '' GROUP BY PetType) AS T1"
        }
      ]
    },
    {
      "id": 56,
      "question": "How many different types of pet are there?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT DISTINCT PetType FROM Pets) AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE PetID IS NOT NULL"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM (SELECT PetType FROM Pets GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT T1.PetType) FROM Pets AS T1"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IN (SELECT DISTINCT PetType FROM Pets)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT pet_age) FROM Pets WHERE PetID IN (SELECT DISTINCT PetID FROM Pets)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE weight > 0) AS T1 GROUP BY PetType"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE pet_age > 0"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT DISTINCT PetType FROM Pets WHERE PetID > 0) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT UPPER(PetType)) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(DISTINCT LOWER(PetType)) FROM Pets"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType) AS T1"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets CROSS JOIN (SELECT 1 AS dummy) AS T1"
        },
        {
          "sql": "SELECT COUNT(PetType) FROM Pets GROUP BY PetType HAVING COUNT(*) = 1 UNION ALL SELECT COUNT(PetType) - COUNT(*) + COUNT(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT COUNT(*) FROM pet_types"
        },
        {
          "sql": "SELECT COUNT(*) FROM Pets WHERE PetType IN (SELECT PetType FROM Pets GROUP BY PetType)"
        },
        {
          "sql": "SELECT COUNT(DISTINCT PetType) FROM Pets WHERE EXISTS (SELECT 1 FROM Pets AS T1 WHERE T1.PetType = Pets.PetType)"
        },
        {
          "sql": "SELECT COUNT(*) FROM (SELECT PetType FROM Pets EXCEPT SELECT PetType FROM Pets WHERE PetID = 0) AS T1 GROUP BY PetType"
        }
      ]
    },
    {
      "id": 57,
      "question": "Find the first name of students who have cat or dog pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' OR PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' UNION SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID AND PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' OR P.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' OR PetType = 'dog'))"
        },
        {
          "sql": "WITH CatDogOwners AS (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN CatDogOwners C ON S.StuID = C.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H, Pets P WHERE H.StuID = S.StuID AND H.PetID = P.PetID AND (P.PetType = 'cat' OR P.PetType = 'dog'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType <> 'cat' IS NOT TRUE AND P.PetType <> 'dog' IS NOT TRUE"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) UNION (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))) T JOIN Student S ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID INNER JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Pets.PetType LIKE '%cat%' OR Pets.PetType LIKE '%dog%'"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM PetOwners)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE UPPER(P.PetType) IN ('CAT','DOG'))"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T WHERE PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING STRING_AGG(PetType,',') LIKE '%cat%' OR STRING_AGG(PetType,',') LIKE '%dog%' FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID = Student.StuID))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog')) T ON true"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT H.StuID FROM Has_Pet H CROSS JOIN Pets P WHERE H.PetID = P.PetID AND P.PetType IN ('cat','dog'))"
        }
      ]
    },
    {
      "id": 58,
      "question": "What are the first names of every student who has a cat or dog as a pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType  =  'cat' OR PetType  =  'dog'))"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE H.StuID  =  Student.StuID AND P.PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet H ON S.StuID  =  H.StuID INNER JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'cat' OR P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'dog')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID  =  H.StuID AND H.PetID  =  P.PetID AND P.PetType IN ('cat','dog')"
        },
        {
          "sql": "WITH CatDogOwners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student S JOIN CatDogOwners C ON S.StuID  =  C.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType  =  'cat') UNION SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType  =  'dog'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (Student S JOIN Has_Pet H ON S.StuID  =  H.StuID) JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType  =  'cat' OR P.PetType  =  'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student INTERSECT SELECT Fname FROM Student S JOIN Has_Pet H ON S.StuID  =  H.StuID JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID  > 0 AND StuID IN (SELECT DISTINCT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID  =  P.PetID AND (P.PetType  =  'cat' OR P.PetType  =  'dog'))"
        },
        {
          "sql": "WITH PetOwners AS (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')) SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM PetOwners)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S, (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')) T WHERE S.StuID  =  T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID  =  S.StuID AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID  =  H.PetID AND (P.PetType  =  'cat' OR P.PetType  =  'dog')))"
        },
        {
          "sql": "SELECT Fname FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType  =  'cat')) UNION (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType  =  'dog'))) T JOIN Student S ON S.StuID  =  T.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')) X ON S.StuID  =  X.StuID"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN (SELECT H.StuID, P.PetType FROM Has_Pet H INNER JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog')) T ON S.StuID  =  T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet NATURAL JOIN Pets WHERE PetType IN ('cat','dog'))"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student FULL OUTER JOIN Has_Pet H ON Student.StuID  =  H.StuID FULL OUTER JOIN Pets P ON H.PetID  =  P.PetID WHERE P.PetType IN ('cat','dog') AND Student.StuID IS NOT NULL"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE H.StuID  =  S.StuID AND P.PetType IN ('cat','dog')) > 0"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID  =  P.PetID WHERE H.StuID  =  S.StuID AND P.PetType IN ('cat','dog')) X ON true"
        }
      ]
    },
    {
      "id": 59,
      "question": "Find the first name of students who have both cat and dog pets .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' INTERSECT SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat') AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND H1.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat' AND S.StuID IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D ON C.StuID = D.StuID JOIN Student ON Student.StuID = C.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT S.Fname FROM Student S WHERE (SELECT COUNT(DISTINCT CASE WHEN P.PetType = 'cat' THEN H.PetID END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) > 0 AND (SELECT COUNT(DISTINCT CASE WHEN P.PetType = 'dog' THEN H.PetID END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) > 0"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat', 'dog') GROUP BY H.StuID HAVING COUNT(DISTINCT P.PetType) = 2) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')), DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) SELECT Fname FROM Student JOIN CatOwners ON Student.StuID = CatOwners.StuID JOIN DogOwners ON Student.StuID = DogOwners.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat') AND StuID = ANY (SELECT StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE S.StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat' INTERSECT SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, COUNT(DISTINCT P.PetType) as pet_types FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat', 'dog') GROUP BY S.StuID, S.Fname HAVING COUNT(DISTINCT P.PetType) = 2)"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S1 WHERE EXISTS (SELECT 1 FROM Student S2 JOIN Has_Pet H1 ON S2.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE S1.StuID = S2.StuID AND P1.PetType = 'cat') AND EXISTS (SELECT 1 FROM Student S3 JOIN Has_Pet H2 ON S3.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE S1.StuID = S3.StuID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) T GROUP BY StuID HAVING ARRAY_AGG(DISTINCT PetType) @> ARRAY['cat', 'dog'])"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN LATERAL (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat' LIMIT 1) C1 ON true JOIN LATERAL (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog' LIMIT 1) D1 ON true"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) T JOIN Student S ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (SELECT STRING_AGG(DISTINCT P.PetType, ',') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID) LIKE '%cat,dog%' OR (SELECT STRING_AGG(DISTINCT P.PetType, ',') FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID) LIKE '%dog,cat%'"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' EXCEPT SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType != 'dog') AND StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM ((Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat') JOIN Has_Pet H2 ON S.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM (VALUES ('cat'), ('dog')) V(pet) JOIN Pets P ON P.PetType = V.pet JOIN Has_Pet H ON H.PetID = P.PetID GROUP BY StuID HAVING COUNT(DISTINCT V.pet) = 2)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT BIT_OR(CASE P.PetType WHEN 'cat' THEN 1 WHEN 'dog' THEN 2 END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) = 3"
        }
      ]
    },
    {
      "id": 60,
      "question": "What are the students' first names who have both cats and dogs as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat' INTERSECT SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'cat') AND EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'cat') AND StuID IN (SELECT StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID HAVING SUM(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PetType = 'dog' THEN 1 ELSE 0 END) > 0)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Pets P1 ON HP1.PetID = P1.PetID JOIN Has_Pet HP2 ON S.StuID = HP2.StuID JOIN Pets P2 ON HP2.PetID = P2.PetID WHERE P1.PetType = 'cat' AND P2.PetType = 'dog'"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType IN ('cat','dog')) GROUP BY StuID HAVING COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') THEN PetID END) > 0 AND COUNT(DISTINCT CASE WHEN PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') THEN PetID END) > 0) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T GROUP BY Fname HAVING SUM(CASE WHEN PetType = 'cat' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PetType = 'dog' THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat'), DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM CatOwners INTERSECT SELECT StuID FROM DogOwners)"
        },
        {
          "sql": "WITH BothPets AS (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID HAVING STRING_AGG(P.PetType, ',') LIKE '%cat%' AND STRING_AGG(P.PetType, ',') LIKE '%dog%') SELECT Fname FROM Student S JOIN BothPets B ON S.StuID = B.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) T PIVOT (COUNT(PetType) FOR PetType IN ('cat','dog')) AS PivotTable WHERE cat > 0 AND dog > 0)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(DISTINCT P.PetType) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType IN ('cat','dog')) = 2"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog')) T GROUP BY Fname HAVING COUNT(DISTINCT PetType) = 2"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') OR NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') INTERSECT SELECT StuID FROM Has_Pet H2 WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) B JOIN Student S ON B.StuID = S.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) AND StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog'))"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE EXISTS (SELECT 1 FROM (SELECT StuID, MIN(PetType) cat, MAX(PetType) dog FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID GROUP BY StuID HAVING COUNT(DISTINCT PetType) = 2 AND MIN(PetType) = 'cat' AND MAX(PetType) = 'dog') T WHERE T.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') D ON S.StuID = D.StuID WHERE P1.PetType = 'cat'"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') D ON C.StuID = D.StuID"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType IN ('cat','dog') GROUP BY H.StuID HAVING BOOL_AND(P.PetType IN ('cat','dog')) AND COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) > 0 AND COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) > 0)"
        },
        {
          "sql": "WITH PetCount AS (SELECT H.StuID, COUNT(CASE WHEN P.PetType = 'cat' THEN 1 END) cat_count, COUNT(CASE WHEN P.PetType = 'dog' THEN 1 END) dog_count FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID GROUP BY H.StuID) SELECT S.Fname FROM Student S JOIN PetCount PC ON S.StuID = PC.StuID WHERE PC.cat_count > 0 AND PC.dog_count > 0"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT BIT_AND(CASE WHEN P.PetType = 'cat' THEN 1 ELSE 0 END) + BIT_AND(CASE WHEN P.PetType = 'dog' THEN 2 ELSE 0 END) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID) = 3"
        }
      ]
    },
    {
      "id": 61,
      "question": "Find the major and age of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID LEFT JOIN Pets p ON h.PetID = p.PetID AND p.PetType = 'cat' WHERE p.PetID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat'"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE s1.StuID NOT IN (SELECT h.StuID FROM Has_Pet h, Pets p WHERE h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s LEFT JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') cat_owners ON s.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > ALL (SELECT 0 UNION SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') AND StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE 0 = (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE (SELECT COUNT(p.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Major, Age FROM Student s FULL OUTER JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') c ON s.StuID = c.StuID WHERE c.StuID IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE NOT StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s CROSS JOIN (SELECT PetID FROM Pets WHERE PetType != 'cat' UNION SELECT NULL) all_pets WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student GROUP BY StuID, Major, Age HAVING EVERY(PetType != 'cat' OR PetID IS NULL) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = Student.StuID"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Major, Age FROM Student LEFT JOIN cat_owners ON Student.StuID = cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "WITH RECURSIVE no_cats AS (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat') UNION SELECT nc.StuID FROM no_cats nc) SELECT Major, Age FROM Student s JOIN no_cats nc ON s.StuID = nc.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE s.StuID <> ALL (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT * FROM (SELECT Major, Age, StuID FROM Student) s WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM ((Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID) LEFT JOIN Pets p ON h.PetID = p.PetID AND p.PetType = 'cat') WHERE p.PetType IS NULL OR p.PetType != 'cat'"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s WHERE NOT EXISTS (SELECT 1 FROM (SELECT * FROM Has_Pet) h JOIN (SELECT * FROM Pets WHERE PetType = 'cat') p ON h.PetID = p.PetID WHERE h.StuID = s.StuID)"
        },
        {
          "sql": "SELECT Major, Age FROM Student MINUS (SELECT s.Major, s.Age FROM Student s, Has_Pet h, Pets p WHERE s.StuID = h.StuID AND h.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s1 WHERE NOT EXISTS (SELECT h1.StuID FROM Has_Pet h1 WHERE h1.StuID = s1.StuID AND EXISTS (SELECT 1 FROM Pets p1 WHERE p1.PetID = h1.PetID AND p1.PetType = 'cat'))"
        }
      ]
    },
    {
      "id": 62,
      "question": "What major is every student who does not own a cat as a pet, and also how old are they?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=Student.StuID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN Has_Pet h ON s.StuID=h.StuID LEFT JOIN Pets p ON h.PetID=p.PetID AND p.PetType='cat' WHERE p.PetID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT s.Major, s.Age FROM Student s LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') c ON s.StuID=c.StuID WHERE c.StuID IS NULL"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE NOT EXISTS (SELECT 1 FROM Pets p JOIN Has_Pet h ON p.PetID=h.PetID WHERE p.PetType='cat' AND h.StuID=s.StuID)"
        },
        {
          "sql": "SELECT Major, Age FROM Student EXCEPT SELECT s.Major, s.Age FROM Student s JOIN Has_Pet h ON s.StuID=h.StuID JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat'"
        },
        {
          "sql": "SELECT s1.Major, s1.Age FROM Student s1 WHERE s1.StuID NOT IN (SELECT h.StuID FROM Has_Pet h, Pets p WHERE h.PetID=p.PetID AND p.PetType='cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student s FULL OUTER JOIN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') cat_owners ON s.StuID=cat_owners.StuID WHERE cat_owners.StuID IS NULL"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s JOIN (SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat')) t ON s.StuID=t.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student WHERE StuID > ALL (SELECT h.StuID-1 FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat' UNION SELECT 0) AND StuID < ALL (SELECT h.StuID+1 FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat' UNION SELECT 999999)"
        },
        {
          "sql": "WITH cat_owners AS (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') SELECT s.Major, s.Age FROM Student s LEFT JOIN cat_owners co ON s.StuID=co.StuID WHERE co.StuID IS NULL"
        },
        {
          "sql": "WITH no_cats AS (SELECT StuID FROM Student EXCEPT SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') SELECT s.Major, s.Age FROM Student s JOIN no_cats nc ON s.StuID=nc.StuID"
        },
        {
          "sql": "SELECT Major, Age FROM Student GROUP BY StuID, Major, Age HAVING SUM(CASE WHEN StuID IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') THEN 1 ELSE 0 END)=0"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE 0 = (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE h.StuID=s.StuID AND p.PetType='cat')"
        },
        {
          "sql": "SELECT DISTINCT Major, Age FROM Student s WHERE (SELECT COUNT(p.PetID) FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE h.StuID=s.StuID AND p.PetType='cat') = 0"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s LEFT JOIN (SELECT h.StuID, p.PetType FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID) hp ON s.StuID=hp.StuID AND hp.PetType='cat' WHERE hp.PetType IS NULL"
        },
        {
          "sql": "SELECT Major, Age FROM Student s WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat'))"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s WHERE NOT (EXISTS (SELECT 1 FROM Pets WHERE PetType='cat' AND PetID IN (SELECT PetID FROM Has_Pet WHERE StuID=s.StuID)))"
        },
        {
          "sql": "SELECT Major, Age FROM ((SELECT * FROM Student) EXCEPT (SELECT DISTINCT s.* FROM Student s JOIN Has_Pet h ON s.StuID=h.StuID JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat')) t"
        },
        {
          "sql": "SELECT s.Major, s.Age FROM Student s CROSS JOIN (SELECT 1 AS x) dummy WHERE NOT EXISTS (SELECT 1 FROM Has_Pet h, Pets p WHERE h.StuID=s.StuID AND h.PetID=p.PetID AND p.PetType='cat')"
        },
        {
          "sql": "SELECT Major, Age FROM Student MINUS SELECT DISTINCT s.Major, s.Age FROM Student s, Has_Pet h, Pets p WHERE s.StuID=h.StuID AND h.PetID=p.PetID AND p.PetType='cat'"
        },
        {
          "sql": "WITH RECURSIVE no_cat_students AS (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID=p.PetID WHERE p.PetType='cat') UNION SELECT StuID FROM no_cat_students WHERE 1=0) SELECT s.Major, s.Age FROM Student s JOIN no_cat_students ncs ON s.StuID=ncs.StuID"
        }
      ]
    },
    {
      "id": 63,
      "question": "Find the id of students who do not have a cat pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Has_Pet.StuID = Student.StuID AND PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (Has_Pet H JOIN Pets P ON H.PetID = P.PetID AND P.PetType = 'cat') ON S.StuID = H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID NOT IN (SELECT H.StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') AND StuID < ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S1.StuID FROM Student S1 WHERE 0 = (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S1.StuID AND P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT COUNT(*) FROM (SELECT 1 AS x FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') t) = 0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student GROUP BY StuID HAVING SUM(CASE WHEN StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') THEN 1 ELSE 0 END) = 0"
        },
        {
          "sql": "SELECT StuID FROM (SELECT DISTINCT StuID FROM Student UNION SELECT StuID FROM Student) S LEFT JOIN (SELECT DISTINCT StuID AS cat_owner FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') C ON S.StuID = C.cat_owner WHERE C.cat_owner IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE LENGTH(StuID) > 0 AND StuID NOT IN (SELECT StuID FROM Has_Pet H WHERE EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT (EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID) AND EXISTS (SELECT 1 FROM Pets P JOIN Has_Pet H2 ON P.PetID = H2.PetID WHERE H2.StuID = S.StuID AND P.PetType = 'cat'))"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') SELECT StuID FROM Student LEFT JOIN CatOwners ON Student.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S CROSS JOIN (SELECT 1 AS dummy) D LEFT JOIN Has_Pet H ON S.StuID = H.StuID AND H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat') WHERE H.StuID IS NULL GROUP BY S.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S WHERE S.StuID <> ALL (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM (SELECT S.StuID, CASE WHEN H.PetID IS NULL OR P.PetType != 'cat' THEN 1 ELSE 0 END AS has_cat FROM Student S LEFT JOIN Has_Pet H ON S.StuID = H.StuID LEFT JOIN Pets P ON H.PetID = P.PetID) t WHERE has_cat = 1 OR StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE (SELECT PetType FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID = S.StuID LIMIT 1) != 'cat' OR (SELECT PetType FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID WHERE H.StuID = S.StuID LIMIT 1) IS NULL"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID NOT BETWEEN (SELECT MIN(H.StuID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') AND (SELECT MAX(H.StuID) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') OR S.StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S LEFT JOIN LATERAL (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'cat') cat ON true WHERE cat.column1 IS NULL"
        }
      ]
    },
    {
      "id": 64,
      "question": "What are the ids of the students who do not own cats as pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE PetType='cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE PetType='cat') C ON S.StuID=C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student EXCEPT SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE PetType='cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID=P.PetID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S LEFT JOIN Has_Pet H ON S.StuID=H.StuID LEFT JOIN Pets P ON H.PetID=P.PetID AND P.PetType='cat' WHERE P.PetID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT S.StuID FROM Student S WHERE S.StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat'))"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE 0=(SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT StuID FROM Student WHERE StuID > ALL (SELECT 0 UNION SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat') AND StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat')"
        },
        {
          "sql": "SELECT S1.StuID FROM Student S1 WHERE S1.StuID NOT IN (SELECT S2.StuID FROM Student S2, Has_Pet H, Pets P WHERE S2.StuID=H.StuID AND H.PetID=P.PetID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT StuID FROM Student MINUS SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE PetType='cat'"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE (SELECT COUNT(*) FROM Pets P JOIN Has_Pet HP ON P.PetID=HP.PetID WHERE HP.StuID=S.StuID AND P.PetType='cat')=0"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE StuID<>ALL(SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType='cat'))"
        },
        {
          "sql": "SELECT S.StuID FROM Student S FULL OUTER JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat') C ON S.StuID=C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT StuID FROM Student S LEFT JOIN (SELECT H.StuID, P.PetType FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') CatOwners ON S.StuID = CatOwners.StuID WHERE CatOwners.PetType IS NULL"
        },
        {
          "sql": "SELECT StuID FROM ((SELECT StuID FROM Student) UNION (SELECT NULL AS StuID)) S WHERE S.StuID NOT IN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat')"
        },
        {
          "sql": "SELECT S.StuID FROM Student S CROSS JOIN (SELECT 1 AS dummy) D WHERE NOT EXISTS (SELECT 1 FROM Has_Pet HP JOIN Pets P ON HP.PetID=P.PetID WHERE HP.StuID=S.StuID AND P.PetType='cat')"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM Student WHERE (StuID, 'cat') NOT IN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID)"
        },
        {
          "sql": "SELECT S.StuID FROM Student S WHERE S.StuID IN (SELECT StuID FROM Student WHERE StuID NOT IN (SELECT DISTINCT H1.StuID FROM Has_Pet H1 WHERE H1.PetID IN (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType='cat')))"
        },
        {
          "sql": "SELECT ALL StuID FROM Student EXCEPT (SELECT DISTINCT StuID FROM Has_Pet NATURAL JOIN Pets WHERE PetType='cat')"
        },
        {
          "sql": "SELECT StuID FROM Student S WHERE EXISTS (SELECT 1 FROM Student S2 WHERE S2.StuID=S.StuID) AND NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=S.StuID AND P.PetType='cat')"
        },
        {
          "sql": "WITH CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE P.PetType='cat') SELECT S.StuID FROM Student S LEFT JOIN CatOwners C ON S.StuID=C.StuID WHERE C.StuID IS NULL"
        }
      ]
    },
    {
      "id": 65,
      "question": "Find the first name and age of students who have a dog but do not have a cat as a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE h1.StuID = Student.StuID AND p1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE h2.StuID = Student.StuID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Age FROM Student JOIN Has_Pet h1 ON Student.StuID = h1.StuID JOIN Pets p1 ON h1.PetID = p1.PetID LEFT JOIN Has_Pet h2 ON Student.StuID = h2.StuID LEFT JOIN Pets p2 ON h2.PetID = p2.PetID WHERE p1.PetType = 'dog' AND p2.PetType IS NULL OR p2.PetType != 'cat'"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT h1.StuID FROM Has_Pet h1 JOIN Pets p1 ON h1.PetID = p1.PetID WHERE p1.PetType = 'dog') AND StuID NOT IN (SELECT h2.StuID FROM Has_Pet h2 JOIN Pets p2 ON h2.PetID = p2.PetID WHERE p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') dog ON s.StuID = dog.StuID LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') cat ON s.StuID = cat.StuID WHERE cat.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet, Pets WHERE Has_Pet.StuID = Student.StuID AND Has_Pet.PetID = Pets.PetID AND PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet, Pets WHERE Has_Pet.StuID = Student.StuID AND Has_Pet.PetID = Pets.PetID AND PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) d ON Student.StuID = d.StuID WHERE Student.StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT DISTINCT s.Fname, s.Age FROM Student s INNER JOIN Has_Pet hp1 ON s.StuID = hp1.StuID INNER JOIN Pets p1 ON hp1.PetID = p1.PetID WHERE p1.PetType = 'dog' AND s.StuID NOT IN (SELECT hp2.StuID FROM Has_Pet hp2 JOIN Pets p2 ON hp2.PetID = p2.PetID WHERE p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) t WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) t WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT s1.Fname, s1.Age FROM Student s1 WHERE EXISTS (SELECT 1 FROM Has_Pet h1, Pets p1 WHERE h1.StuID = s1.StuID AND h1.PetID = p1.PetID AND p1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet h2, Pets p2 WHERE h2.StuID = s1.StuID AND h2.PetID = p2.PetID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT DISTINCT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog' GROUP BY h.StuID HAVING SUM(CASE WHEN p.PetType = 'cat' THEN 1 ELSE 0 END) = 0)"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s WHERE (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = s.StuID AND p.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE p.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet hp2 JOIN Pets p2 ON hp2.PetID = p2.PetID WHERE hp2.StuID = s.StuID AND p2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') MINUS SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s INNER JOIN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog' GROUP BY h.StuID) dogs ON s.StuID = dogs.StuID WHERE s.StuID NOT IN (SELECT h.StuID FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM (SELECT DISTINCT s.StuID, s.Fname, s.Age FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID JOIN Pets p ON h.PetID = p.PetID WHERE p.PetType = 'dog') dog_owners WHERE StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT hp.StuID FROM Has_Pet hp, Pets p WHERE hp.PetID = p.PetID AND p.PetType = 'dog') AND StuID NOT IN (SELECT hp.StuID FROM Has_Pet hp, Pets p WHERE hp.PetID = p.PetID AND p.PetType = 'cat')"
        },
        {
          "sql": "SELECT s.Fname, s.Age FROM Student s LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') cat ON s.StuID = cat.StuID INNER JOIN (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') dog ON s.StuID = dog.StuID WHERE cat.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s WHERE 1=1 AND EXISTS (SELECT PetID FROM Has_Pet WHERE StuID = s.StuID AND PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND NOT EXISTS (SELECT PetID FROM Has_Pet WHERE StuID = s.StuID AND PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "WITH dog_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), cat_owners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname, Age FROM Student JOIN dog_owners ON Student.StuID = dog_owners.StuID WHERE Student.StuID NOT IN (SELECT StuID FROM cat_owners)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (SELECT GROUP_CONCAT(DISTINCT PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = Student.StuID) LIKE '%dog%' AND (SELECT GROUP_CONCAT(DISTINCT PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID WHERE h.StuID = Student.StuID) NOT LIKE '%cat%'"
        },
        {
          "sql": "SELECT Fname, Age FROM Student s WHERE EXISTS (SELECT 1 FROM (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType IN ('dog')) d WHERE d.StuID = s.StuID) AND NOT EXISTS (SELECT 1 FROM (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType IN ('cat')) c WHERE c.StuID = s.StuID)"
        }
      ]
    },
    {
      "id": 66,
      "question": "What is the first name of every student who has a dog but does not have a cat?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog') AND StuID NOT IN (SELECT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog') AND StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE H1.StuID = S.StuID AND P1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT S.Fname FROM Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog' AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog' AND NOT EXISTS (SELECT 1 FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) AND StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') AND S.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT S.StuID, S.Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog') AS Dogs WHERE StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student EXCEPT SELECT Fname FROM Student S2 WHERE S2.StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat') INTERSECT SELECT Fname FROM Student S1 WHERE S1.StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetType = 'dog')"
        },
        {
          "sql": "SELECT Fname FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D ON S.StuID = D.StuID LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')) C ON S.StuID = C.StuID WHERE C.StuID IS NULL"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM (SELECT S.Fname, P.PetType FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID) T1 WHERE PetType = 'dog' AND Fname NOT IN (SELECT Fname FROM Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID JOIN Pets P2 ON H2.PetID = P2.PetID WHERE P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE (SELECT COUNT(*) FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = S.StuID AND P.PetType = 'dog') > 0 AND (SELECT COUNT(*) FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID WHERE H2.StuID = S.StuID AND P2.PetType = 'cat') = 0"
        },
        {
          "sql": "SELECT S.Fname FROM Student S INNER JOIN Has_Pet HP_D ON S.StuID = HP_D.StuID INNER JOIN Pets PD ON HP_D.PetID = PD.PetID LEFT JOIN Has_Pet HP_C ON S.StuID = HP_C.StuID LEFT JOIN Pets PC ON HP_C.PetID = PC.PetID WHERE PD.PetType = 'dog' AND PC.PetType IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'dog') AND StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT Fname FROM (SELECT DISTINCT S.StuID, S.Fname FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'dog') D WHERE D.StuID NOT IN (SELECT H2.StuID FROM Has_Pet H2, Pets P2 WHERE H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "WITH DogOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'dog'), CatOwners AS (SELECT DISTINCT StuID FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE PetType = 'cat') SELECT Fname FROM Student JOIN DogOwners ON Student.StuID = DogOwners.StuID LEFT JOIN CatOwners ON Student.StuID = CatOwners.StuID WHERE CatOwners.StuID IS NULL"
        },
        {
          "sql": "SELECT Fname FROM Student S1 WHERE EXISTS (SELECT 1 FROM Has_Pet H1, Pets P1 WHERE H1.StuID = S1.StuID AND H1.PetID = P1.PetID AND P1.PetType = 'dog') AND NOT EXISTS (SELECT 1 FROM Has_Pet H2, Pets P2 WHERE H2.StuID = S1.StuID AND H2.PetID = P2.PetID AND P2.PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S INNER JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog')) D ON S.StuID = D.StuID WHERE S.StuID NOT IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat'))"
        },
        {
          "sql": "SELECT S.Fname FROM ((Student S JOIN Has_Pet H1 ON S.StuID = H1.StuID) JOIN Pets P1 ON H1.PetID = P1.PetID) LEFT JOIN (Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID) ON S.StuID = H2.StuID WHERE P1.PetType = 'dog' AND (P2.PetType = 'cat' OR P2.PetType IS NULL IS TRUE)"
        },
        {
          "sql": "SELECT Fname FROM Student WHERE (StuID, 'dog') IN (SELECT H.StuID, P.PetType FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) AND (StuID, 'cat') NOT IN (SELECT H2.StuID, P2.PetType FROM Has_Pet H2 JOIN Pets P2 ON H2.PetID = P2.PetID)"
        },
        {
          "sql": "SELECT Fname FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) AS PetOwnership WHERE PetType = 'dog') AND StuID NOT IN (SELECT DISTINCT StuID FROM (SELECT StuID, PetType FROM Has_Pet JOIN Pets ON Has_Pet.PetID = Pets.PetID) AS PetOwnership2 WHERE PetType = 'cat')"
        },
        {
          "sql": "SELECT DISTINCT Fname FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'dog') MINUS SELECT Fname FROM Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID WHERE H2.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat')"
        }
      ]
    },
    {
      "id": 67,
      "question": "Find the type and weight of the youngest pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets P1 WHERE pet_age = (SELECT MIN(pet_age) FROM Pets P2)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p WHERE p.pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT DISTINCT PetType, weight FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE pet_age <= (SELECT MIN(pet_age) FROM Pets p2)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "WITH youngest AS (SELECT MIN(pet_age) as min_age FROM Pets) SELECT PetType, weight FROM Pets, youngest WHERE pet_age = min_age"
        },
        {
          "sql": "WITH min_age AS (SELECT MIN(pet_age) minage FROM Pets) SELECT p.PetType, p.weight FROM Pets p, min_age m WHERE p.pet_age = m.minage"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets GROUP BY PetType, weight, pet_age HAVING pet_age = MIN(pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE pet_age = (SELECT pet_age FROM Pets p2 GROUP BY pet_age ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY pet_age) as rn FROM Pets) WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, RANK() OVER (ORDER BY pet_age) rnk FROM Pets) WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, DENSE_RANK() OVER (ORDER BY pet_age) rnk FROM Pets) WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age ASC FETCH FIRST 1 ROW ONLY)"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p INNER JOIN (SELECT MIN(pet_age) min_age FROM Pets) m ON p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets INTERSECT SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets EXCEPT SELECT PetType, weight FROM Pets WHERE pet_age > (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight FROM Pets ORDER BY pet_age ASC) t LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p WHERE 0 = (SELECT COUNT(*) FROM Pets p2 WHERE p2.pet_age < p.pet_age)"
        }
      ]
    },
    {
      "id": 68,
      "question": "What type of pet is the youngest animal, and how much does it weigh?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets ORDER BY pet_age ASC LIMIT 1)"
        },
        {
          "sql": "SELECT p1.PetType, p1.weight FROM Pets p1 WHERE p1.pet_age = (SELECT MIN(p2.pet_age) FROM Pets p2)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets ORDER BY pet_age ASC LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, ROW_NUMBER() OVER (ORDER BY pet_age ASC) as rn FROM Pets) ranked WHERE rn = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 JOIN (SELECT MIN(pet_age) as min_age FROM Pets) min_pet ON p1.pet_age = min_pet.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age <= ALL (SELECT pet_age FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age IN (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT * FROM Pets ORDER BY pet_age) pets LIMIT 1"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p INNER JOIN (SELECT PetID FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)) youngest ON p.PetID = youngest.PetID"
        },
        {
          "sql": "SELECT DISTINCT PetType, weight FROM Pets WHERE pet_age = (SELECT MIN(pet_age) FROM Pets)"
        },
        {
          "sql": "WITH youngest_pet AS (SELECT MIN(pet_age) as min_age FROM Pets) SELECT PetType, weight FROM Pets, youngest_pet WHERE pet_age = min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets GROUP BY PetType, weight, pet_age HAVING pet_age = MIN(pet_age) ORDER BY pet_age LIMIT 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE PetID = (SELECT PetID FROM Pets ORDER BY pet_age LIMIT 1)"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets FETCH FIRST 1 ROW ONLY ORDER BY pet_age ASC"
        },
        {
          "sql": "WITH min_age AS (SELECT MIN(pet_age) min_age FROM Pets) SELECT PetType, weight FROM Pets JOIN min_age ON pet_age = min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets WHERE pet_age = (SELECT pet_age FROM Pets p1 WHERE NOT EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age < p1.pet_age))"
        },
        {
          "sql": "SELECT p.PetType, p.weight FROM Pets p CROSS JOIN (SELECT MIN(pet_age) min_age FROM Pets) m WHERE p.pet_age = m.min_age"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets QUALIFY pet_age = MIN(pet_age) OVER ()"
        },
        {
          "sql": "SELECT PetType, weight FROM (SELECT PetType, weight, pet_age, RANK() OVER (ORDER BY pet_age ASC) rnk FROM Pets) WHERE rnk = 1"
        },
        {
          "sql": "SELECT PetType, weight FROM Pets p1, (SELECT pet_age FROM Pets ORDER BY pet_age ASC LIMIT 1) p2 WHERE p1.pet_age = p2.pet_age"
        }
      ]
    },
    {
      "id": 69,
      "question": "Find the id and weight of all pets whose age is older than 1.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT pet_age <= 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age BETWEEN 2 AND 100"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age NOT BETWEEN 0 AND 1"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL(SELECT 1)"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS(SELECT 1 FROM Pets p2 WHERE p2.pet_age > 1 AND p2.PetID = Pets.PetID)"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT * FROM Pets) t WHERE t.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 FETCH FIRST 999 ROWS ONLY"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 LIMIT 999999"
        },
        {
          "sql": "SELECT * FROM (SELECT PetID, weight FROM Pets WHERE pet_age > 1) t"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 UNION ALL SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "WITH older_pets AS (SELECT * FROM Pets WHERE pet_age > 1) SELECT PetID, weight FROM older_pets"
        },
        {
          "sql": "WITH t1 AS (SELECT 1 AS age_limit) SELECT PetID, weight FROM Pets, t1 WHERE Pets.pet_age > t1.age_limit"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS limit_age) t WHERE Pets.pet_age > t.limit_age"
        },
        {
          "sql": "SELECT p1.PetID, p1.weight FROM Pets p1 WHERE p1.pet_age > (SELECT MIN(p2.pet_age) FROM Pets p2 WHERE p2.pet_age = 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age IN (SELECT pet_age FROM Pets WHERE pet_age > 1)"
        }
      ]
    },
    {
      "id": 70,
      "question": "What is the id and weight of every pet who is older than 1?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE NOT pet_age <= 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1.0"
        },
        {
          "sql": "SELECT DISTINCT PetID, weight FROM Pets WHERE pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age >= 2"
        },
        {
          "sql": "SELECT p.PetID, p.weight FROM Pets p WHERE p.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age BETWEEN 2 AND 100"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ALL (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > ANY (SELECT 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE EXISTS (SELECT 1 FROM Pets p2 WHERE p2.pet_age = 1 AND Pets.pet_age > p2.pet_age)"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age IN (SELECT pet_age FROM Pets WHERE pet_age > 1)"
        },
        {
          "sql": "SELECT PetID, weight FROM (SELECT * FROM Pets) AS sub WHERE sub.pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > (SELECT AVG(pet_age) FROM Pets WHERE pet_age <= 1)"
        },
        {
          "sql": "WITH old_pets AS (SELECT * FROM Pets WHERE pet_age > 1) SELECT PetID, weight FROM old_pets"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets CROSS JOIN (SELECT 1 AS threshold) t WHERE pet_age > t.threshold"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets, (VALUES (1)) AS t(threshold) WHERE pet_age > t.threshold"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 FETCH FIRST 999 ROWS ONLY"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 LIMIT 999999"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age <> 1 AND pet_age IS NOT NULL AND pet_age > 1"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > 1 AND PetID IS NOT NULL"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE (pet_age > 1) IS TRUE"
        },
        {
          "sql": "SELECT PetID, weight FROM Pets WHERE pet_age > CASE WHEN 1 > 0 THEN 1 ELSE 0 END"
        }
      ]
    },
    {
      "id": 71,
      "question": "Find the average and maximum age for each type of pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(pet_age AS FLOAT)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) AS pet_avg, MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, pet_age FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), GREATEST(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(pet_age)/COUNT(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = p1.PetType) FROM Pets p1 GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT pt.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets WHERE pet_age IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p1.pet_age), MAX(p1.pet_age) FROM Pets p1, Pets p2 WHERE p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, CORR(pet_age, pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, STDDEV(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) FILTER (WHERE pet_age > 0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_agg AS (SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType) SELECT * FROM pet_agg"
        },
        {
          "sql": "SELECT PetType, AVG(CASE WHEN pet_age IS NOT NULL THEN pet_age END), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, FIRST_VALUE(AVG(pet_age)) OVER (PARTITION BY PetType), FIRST_VALUE(MAX(pet_age)) OVER (PARTITION BY PetType) FROM Pets GROUP BY PetType, pet_age"
        }
      ]
    },
    {
      "id": 72,
      "question": "What is the average and maximum age for each pet type?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(pet_age AS FLOAT)), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age*1.0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age + 0.0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) AS pet_avg, MAX(pet_age) AS pet_max FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(pet_age) OVER (PARTITION BY PetType), MAX(pet_age) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, (SELECT AVG(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType), (SELECT MAX(pet_age) FROM Pets p2 WHERE p2.PetType = Pets.PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT pt.PetType, AVG(pet_age), MAX(pet_age) FROM Pets, (SELECT DISTINCT PetType FROM Pets) pt WHERE Pets.PetType = pt.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age), MAX(pet_age) FROM Pets t1 GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, pet_age FROM Pets) SELECT PetType, AVG(pet_age), MAX(pet_age) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(CASE WHEN pet_age IS NOT NULL THEN pet_age END), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(pet_age)/COUNT(*), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, CORR(pet_age, pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p1.pet_age), MAX(p1.pet_age) FROM Pets p1, Pets p2 WHERE p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, FIRST_VALUE(AVG(pet_age)) OVER (PARTITION BY PetType), FIRST_VALUE(MAX(pet_age)) OVER (PARTITION BY PetType) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets) SELECT pt.PetType, AVG(p.pet_age), MAX(p.pet_age) FROM pet_types pt JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(pet_age) FILTER (WHERE pet_age > 0), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, percentile_cont(0.5) WITHIN GROUP (ORDER BY pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT * FROM (SELECT PetType, AVG(pet_age) avg_age, MAX(pet_age) max_age FROM Pets GROUP BY PetType) ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, EXTRACT(EPOCH FROM AVG(pet_age::INTERVAL '1 sec')), MAX(pet_age) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, mode() WITHIN GROUP (ORDER BY pet_age), MAX(pet_age) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 73,
      "question": "Find the average weight for each pet type.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(CAST(weight AS FLOAT)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType ,  avg(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType ,  (SELECT avg(weight) FROM Pets P2 WHERE P2.PetType  =  P1.PetType) FROM Pets P1 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE PetID IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE PetType > '' GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets HAVING count(*) > 0 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE weight > 0 GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  sum(weight)/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  sum(CAST(weight AS REAL))/count(*) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType ,  weight FROM Pets) SELECT PetType ,  avg(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType ORDER BY avg(weight)"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType ORDER BY PetType ,  avg(weight)"
        },
        {
          "sql": "SELECT p.PetType ,  avg(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT PetType ,  round(avg(weight),2) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight*1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  (sum(weight*1.0)/count(*)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType ,  avg(weight) FROM Pets WHERE EXISTS(SELECT 1 FROM Pets p2 WHERE p2.PetType  =  Pets.PetType) GROUP BY PetType"
        },
        {
          "sql": "WITH RECURSIVE pet_types AS (SELECT DISTINCT PetType FROM Pets UNION SELECT PetType FROM pet_types) SELECT pt.PetType ,  avg(p.weight) FROM pet_types pt JOIN Pets p ON pt.PetType  =  p.PetType GROUP BY pt.PetType"
        },
        {
          "sql": "SELECT PetType ,  percentile_cont(0.5) WITHIN GROUP (ORDER BY weight) FROM Pets GROUP BY PetType UNION SELECT PetType ,  avg(weight) FROM Pets GROUP BY PetType"
        }
      ]
    },
    {
      "id": 74,
      "question": "What is the average weight for each type of pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT p.PetType, AVG(p.weight) FROM Pets p GROUP BY p.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE PetType IS NOT NULL GROUP BY PetType"
        },
        {
          "sql": "SELECT DISTINCT PetType, AVG(weight) OVER (PARTITION BY PetType) FROM Pets"
        },
        {
          "sql": "SELECT PetType, AVG(CAST(weight AS DECIMAL)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight*1.0) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "WITH pet_stats AS (SELECT PetType, weight FROM Pets) SELECT PetType, AVG(weight) FROM pet_stats GROUP BY PetType"
        },
        {
          "sql": "WITH avg_weights AS (SELECT AVG(weight) as avg_wt, PetType FROM Pets GROUP BY PetType) SELECT PetType, avg_wt FROM avg_weights"
        },
        {
          "sql": "SELECT PetType, (SUM(weight)/COUNT(*)) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, SUM(weight)/SUM(CASE WHEN weight IS NOT NULL THEN 1.0 ELSE 0 END) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets WHERE weight > 0 GROUP BY PetType"
        },
        {
          "sql": "SELECT pt, AVG(wt) FROM (SELECT PetType AS pt, weight AS wt FROM Pets) t GROUP BY pt"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM (SELECT * FROM Pets WHERE PetType IS NOT NULL) sq GROUP BY PetType"
        },
        {
          "sql": "SELECT p1.PetType, AVG(p2.weight) FROM Pets p1 JOIN Pets p2 ON p1.PetType = p2.PetType GROUP BY p1.PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY PetType"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType ORDER BY AVG(weight) DESC"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType LIMIT 100"
        },
        {
          "sql": "SELECT PetType, ROUND(AVG(weight), 2) FROM Pets GROUP BY PetType"
        },
        {
          "sql": "SELECT LOWER(PetType) as pt, AVG(weight) FROM Pets GROUP BY LOWER(PetType)"
        },
        {
          "sql": "SELECT PetType, AVG(weight) FROM Pets GROUP BY PetType UNION SELECT NULL, NULL WHERE 1=0"
        },
        {
          "sql": "SELECT pt.PetType, AVG(p.weight) FROM (SELECT DISTINCT PetType FROM Pets) pt LEFT JOIN Pets p ON pt.PetType = p.PetType GROUP BY pt.PetType ORDER BY pt.PetType"
        }
      ]
    },
    {
      "id": 75,
      "question": "Find the first name and age of students who have a pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT * FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S, Has_Pet H WHERE S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM PetOwners)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S JOIN Has_Pet HP USING(StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM ((SELECT StuID FROM Has_Pet) U JOIN Student ON Student.StuID = U.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = Student.StuID) > 0"
        },
        {
          "sql": "WITH HasPet AS (SELECT StuID FROM Has_Pet GROUP BY StuID) SELECT Fname, Age FROM Student S JOIN HasPet HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT PetID FROM Has_Pet WHERE PetID IS NOT NULL)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student LEFT JOIN Has_Pet H ON Student.StuID = H.StuID WHERE H.StuID IS NOT NULL"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID > 0 AND EXISTS (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "WITH StudentsWithPets AS (SELECT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) SELECT Fname, Age FROM StudentsWithPets"
        }
      ]
    },
    {
      "id": 76,
      "question": "What are the different first names and ages of the students who do have pets?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Age FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S INNER JOIN Has_Pet HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT S.Fname, S.Age FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.Fname, S.Age"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet HP WHERE HP.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Student.Fname, Student.Age FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY Student.Fname, Student.Age"
        },
        {
          "sql": "SELECT DISTINCT S1.Fname, S1.Age FROM Student S1 WHERE S1.StuID IN (SELECT H.StuID FROM Has_Pet H)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student INTERSECT SELECT Fname, Age FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "WITH PetOwners AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT Fname, Age FROM Student S JOIN PetOwners P ON S.StuID = P.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM ((SELECT StuID FROM Has_Pet) H JOIN Student S ON H.StuID = S.StuID)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S WHERE StuID IN (SELECT HP.StuID FROM Has_Pet HP GROUP BY HP.StuID)"
        },
        {
          "sql": "SELECT DISTINCT Student.Fname, Student.Age FROM Student, Has_Pet WHERE Student.StuID = Has_Pet.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student WHERE 1=1 AND StuID IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "WITH StudentsWithPets AS (SELECT StuID FROM Has_Pet GROUP BY StuID) SELECT Fname, Age FROM Student WHERE StuID IN (SELECT StuID FROM StudentsWithPets)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Age FROM Student AS S JOIN Has_Pet AS HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S JOIN (SELECT DISTINCT StuID FROM Has_Pet) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Age FROM Student WHERE EXISTS (SELECT StuID FROM Has_Pet HP WHERE HP.StuID = Student.StuID LIMIT 1)"
        },
        {
          "sql": "SELECT Fname, Age FROM Student S INNER JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID) H ON S.StuID = H.StuID"
        }
      ]
    },
    {
      "id": 77,
      "question": "Find the id of the pet owned by student whose last name is \u2018Smith\u2019.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName  =  'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Pets JOIN Has_Pet ON Pets.PetID  =  Has_Pet.PetID JOIN Student ON Has_Pet.StuID  =  Student.StuID WHERE LName  =  'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet JOIN Student ON Has_Pet.StuID  =  Student.StuID JOIN Pets ON Has_Pet.PetID  =  Pets.PetID WHERE LName  =  'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID  =  (SELECT StuID FROM Student WHERE LName  =  'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet JOIN Student ON Has_Pet.StuID  =  Student.StuID WHERE LName  =  'Smith' AND Pets.PetID  =  Has_Pet.PetID)"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM Pets p WHERE EXISTS (SELECT 1 FROM Has_Pet h JOIN Student s ON h.StuID  =  s.StuID WHERE s.LName  =  'Smith' AND p.PetID  =  h.PetID)"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h INNER JOIN Student s ON h.StuID  =  s.StuID INNER JOIN Pets p ON h.PetID  =  p.PetID WHERE s.LName  =  'Smith'"
        },
        {
          "sql": "SELECT p.PetID FROM Pets p INNER JOIN Has_Pet h ON p.PetID  =  h.PetID INNER JOIN Student s ON h.StuID  =  s.StuID WHERE s.LName  =  'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Student s JOIN Has_Pet h ON s.StuID  =  h.StuID JOIN Pets p ON h.PetID  =  p.PetID WHERE s.LName  =  'Smith'"
        },
        {
          "sql": "WITH smith_students AS (SELECT StuID FROM Student WHERE LName  =  'Smith') SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM smith_students)"
        },
        {
          "sql": "WITH smith_pets AS (SELECT PetID FROM Has_Pet JOIN Student ON Has_Pet.StuID  =  Student.StuID WHERE LName  =  'Smith') SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM smith_pets)"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT DISTINCT PetID FROM Has_Pet h WHERE h.StuID IN (SELECT s.StuID FROM Student s WHERE s.LName  =  'Smith'))"
        },
        {
          "sql": "SELECT h.PetID FROM Has_Pet h WHERE h.StuID IN (SELECT DISTINCT StuID FROM Student WHERE LName  =  'Smith')"
        },
        {
          "sql": "SELECT PetID FROM ((SELECT StuID FROM Student WHERE LName  =  'Smith') AS smith_ids JOIN Has_Pet ON smith_ids.StuID  =  Has_Pet.StuID)"
        },
        {
          "sql": "SELECT DISTINCT p.PetID FROM Student s, Has_Pet h, Pets p WHERE s.LName  =  'Smith' AND s.StuID  =  h.StuID AND h.PetID  =  p.PetID"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet CROSS JOIN Student WHERE Has_Pet.StuID  =  Student.StuID AND LName  =  'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets p1 WHERE PetID IN (SELECT PetID FROM Has_Pet h1 WHERE h1.StuID  =  (SELECT s1.StuID FROM Student s1 WHERE s1.LName  =  'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName  =  'Smith')) AS pet_list"
        },
        {
          "sql": "SELECT PetID FROM Pets INTERSECT SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName  =  'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet h JOIN LATERAL (SELECT StuID FROM Student WHERE LName  =  'Smith') s ON h.StuID  =  s.StuID"
        },
        {
          "sql": "SELECT PetID FROM (SELECT DISTINCT StuID FROM Student WHERE LName  =  'Smith') smith JOIN Has_Pet hp ON smith.StuID  =  hp.StuID"
        },
        {
          "sql": "SELECT hp.PetID FROM (SELECT StuID FROM Student WHERE LName  =  'Smith') AS s JOIN Has_Pet hp ON s.StuID  =  hp.StuID"
        }
      ]
    },
    {
      "id": 78,
      "question": "What is the id of the pet owned by the student whose last name is 'Smith'?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT PetID FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith')"
        },
        {
          "sql": "SELECT P.PetID FROM Pets P INNER JOIN Has_Pet H ON P.PetID = H.PetID INNER JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT DISTINCT PetID FROM Pets P, Has_Pet H, Student S WHERE P.PetID = H.PetID AND H.StuID = S.StuID AND S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID = Pets.PetID AND S.LName = 'Smith')"
        },
        {
          "sql": "SELECT H.PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM ((SELECT StuID FROM Student WHERE LName = 'Smith') S1 JOIN Has_Pet H ON S1.StuID = H.StuID)"
        },
        {
          "sql": "WITH smith_students AS (SELECT StuID FROM Student WHERE LName = 'Smith') SELECT PetID FROM smith_students S JOIN Has_Pet H ON S.StuID = H.StuID"
        },
        {
          "sql": "SELECT P.PetID FROM Student S CROSS JOIN Has_Pet H CROSS JOIN Pets P WHERE S.LName = 'Smith' AND S.StuID = H.StuID AND H.PetID = P.PetID"
        },
        {
          "sql": "SELECT PetID FROM Pets P WHERE PetID IN (SELECT H.PetID FROM Has_Pet H WHERE H.StuID IN (SELECT S.StuID FROM Student S WHERE S.LName = 'Smith'))"
        },
        {
          "sql": "SELECT H1.PetID FROM Has_Pet H1 WHERE H1.StuID IN (SELECT S.StuID FROM Student S WHERE S.LName = 'Smith')"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet H1 INNER JOIN Student S ON H1.StuID = S.StuID WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT DISTINCT P.PetID FROM Pets P INNER JOIN (SELECT PetID FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith')) HP ON P.PetID = HP.PetID"
        },
        {
          "sql": "SELECT PetID FROM Pets WHERE PetID = ANY (SELECT PetID FROM Has_Pet WHERE StuID = (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT H.PetID FROM (SELECT StuID FROM Student WHERE LName = 'Smith') S1 JOIN Has_Pet H ON S1.StuID = H.StuID"
        },
        {
          "sql": "SELECT PetID FROM Has_Pet INTERSECT SELECT PetID FROM Pets WHERE PetID IN (SELECT PetID FROM Has_Pet H WHERE StuID IN (SELECT StuID FROM Student WHERE LName = 'Smith'))"
        },
        {
          "sql": "SELECT P1.PetID FROM Pets P1 WHERE EXISTS (SELECT 1 FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE S.LName = 'Smith' AND H.PetID = P1.PetID)"
        },
        {
          "sql": "SELECT PetID FROM (SELECT S.StuID, P.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE S.LName = 'Smith') T"
        },
        {
          "sql": "SELECT PetID FROM Pets P1 JOIN (SELECT DISTINCT PetID FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE S.LName = 'Smith') HP ON P1.PetID = HP.PetID"
        },
        {
          "sql": "SELECT H.PetID FROM Student S NATURAL JOIN Has_Pet H WHERE S.LName = 'Smith'"
        },
        {
          "sql": "SELECT PetID FROM (SELECT PetID, StuID FROM Has_Pet) H JOIN (SELECT StuID FROM Student WHERE LName = 'Smith') S ON H.StuID = S.StuID"
        }
      ]
    },
    {
      "id": 79,
      "question": "Find the number of pets for each student who has any pet and student id.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.PetID) FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(hp.PetID) FROM Student s INNER JOIN Has_Pet hp ON s.StuID = hp.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT h1.StuID, (SELECT COUNT(*) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) FROM Has_Pet h1 JOIN Student s ON h1.StuID = s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 0"
        },
        {
          "sql": "SELECT s.StuID, COUNT(hp.PetID) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID GROUP BY s.StuID HAVING COUNT(hp.PetID) > 0"
        },
        {
          "sql": "SELECT StuID, COUNT(DISTINCT PetID) FROM Has_Pet h WHERE EXISTS (SELECT 1 FROM Student s WHERE s.StuID = h.StuID) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(p.PetID) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(1) FROM Has_Pet h INNER JOIN Student USING(StuID) GROUP BY h.StuID"
        },
        {
          "sql": "SELECT Student.StuID, COUNT(Has_Pet.StuID) FROM Student, Has_Pet WHERE Student.StuID = Has_Pet.StuID GROUP BY Student.StuID"
        },
        {
          "sql": "SELECT DISTINCT StuID, COUNT(PetID) OVER (PARTITION BY StuID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student)"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID, COUNT(PetID) as cnt FROM Has_Pet GROUP BY StuID) SELECT s.StuID, pc.cnt FROM Student s JOIN pet_count pc ON s.StuID = pc.StuID"
        },
        {
          "sql": "SELECT s.StuID, (SELECT COUNT(PetID) FROM Has_Pet h WHERE h.StuID = s.StuID) FROM Student s WHERE EXISTS (SELECT 1 FROM Has_Pet h WHERE h.StuID = s.StuID)"
        },
        {
          "sql": "SELECT StuID, SUM(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Has_Pet RIGHT JOIN Student USING(StuID) GROUP BY StuID HAVING SUM(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) > 0"
        },
        {
          "sql": "SELECT h.StuID, COUNT(hp.PetID) FROM Student s RIGHT JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet NATURAL JOIN Student GROUP BY StuID"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, COUNT(h.PetID) FROM Student s, Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "WITH has_pet_students AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT hps.StuID, (SELECT COUNT(*) FROM Has_Pet h WHERE h.StuID = hps.StuID) FROM has_pet_students hps JOIN Student s ON hps.StuID = s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM (SELECT DISTINCT StuID, PetID FROM Has_Pet) GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COALESCE(SUM(hp.cnt), 0) FROM Student s LEFT JOIN (SELECT StuID, COUNT(PetID) as cnt FROM Has_Pet GROUP BY StuID) hp ON s.StuID = hp.StuID WHERE hp.cnt > 0 GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, ROW_NUMBER() OVER (ORDER BY COUNT(PetID)) as pet_count FROM Has_Pet GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(DISTINCT p.PetType) FROM Has_Pet h JOIN Pets p ON h.PetID = p.PetID JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets) GROUP BY StuID HAVING EXISTS (SELECT 1 FROM Student WHERE StuID = Has_Pet.StuID)"
        }
      ]
    },
    {
      "id": 80,
      "question": "For students who have pets , how many pets does each student have ? list their ids instead of names .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT Has_Pet.StuID, COUNT(*) FROM Has_Pet JOIN Student ON Has_Pet.StuID = Student.StuID GROUP BY Has_Pet.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student) GROUP BY StuID"
        },
        {
          "sql": "SELECT h.StuID, COUNT(h.PetID) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT h1.StuID, (SELECT COUNT(*) FROM Has_Pet h2 WHERE h2.StuID = h1.StuID) FROM Has_Pet h1 JOIN Student s ON h1.StuID = s.StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(h.PetID) FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(DISTINCT PetID) FROM Has_Pet WHERE EXISTS (SELECT 1 FROM Student WHERE Student.StuID = Has_Pet.StuID) GROUP BY StuID"
        },
        {
          "sql": "WITH pet_count AS (SELECT StuID, COUNT(PetID) as cnt FROM Has_Pet GROUP BY StuID) SELECT p.StuID, p.cnt FROM pet_count p JOIN Student s ON p.StuID = s.StuID"
        },
        {
          "sql": "SELECT StuID, SUM(CASE WHEN PetID IS NOT NULL THEN 1 ELSE 0 END) FROM Student LEFT JOIN Has_Pet ON Student.StuID = Has_Pet.StuID GROUP BY StuID HAVING COUNT(PetID) > 0"
        },
        {
          "sql": "SELECT s.StuID, COUNT(DISTINCT h.PetID) FROM Student s INNER JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 0 ORDER BY COUNT(PetID)"
        },
        {
          "sql": "SELECT h.StuID, COUNT(p.PetID) FROM Has_Pet h JOIN Student s ON h.StuID = s.StuID JOIN Pets p ON h.PetID = p.PetID GROUP BY h.StuID"
        },
        {
          "sql": "SELECT DISTINCT s.StuID, (SELECT COUNT(PetID) FROM Has_Pet WHERE StuID = s.StuID) FROM Student s WHERE EXISTS (SELECT 1 FROM Has_Pet WHERE StuID = s.StuID)"
        },
        {
          "sql": "SELECT StuID, COUNT(PetID) FROM (SELECT DISTINCT StuID, PetID FROM Has_Pet) t JOIN Student s ON t.StuID = s.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COALESCE(SUM(CASE WHEN h.PetID IS NOT NULL THEN 1 ELSE 0 END), 0) FROM Student s LEFT JOIN Has_Pet h ON s.StuID = h.StuID GROUP BY s.StuID HAVING COUNT(h.PetID) > 0"
        },
        {
          "sql": "WITH students_with_pets AS (SELECT DISTINCT StuID FROM Has_Pet) SELECT swp.StuID, COUNT(h.PetID) FROM students_with_pets swp JOIN Has_Pet h ON swp.StuID = h.StuID JOIN Student s ON swp.StuID = s.StuID GROUP BY swp.StuID"
        },
        {
          "sql": "SELECT StuID, COUNT(*) OVER (PARTITION BY StuID) FROM Has_Pet WHERE StuID IN (SELECT StuID FROM Student) GROUP BY StuID"
        },
        {
          "sql": "SELECT h1.StuID, (SELECT COUNT(h2.PetID) FROM Has_Pet h2 JOIN Student s2 ON h2.StuID = s2.StuID WHERE h2.StuID = h1.StuID) FROM Has_Pet h1 GROUP BY h1.StuID"
        },
        {
          "sql": "SELECT StuID, GROUP_CONCAT(PetID) cnt FROM Has_Pet JOIN Student ON Student.StuID = Has_Pet.StuID GROUP BY StuID"
        },
        {
          "sql": "SELECT s.StuID, COUNT(*) FROM Student s, Has_Pet h WHERE s.StuID = h.StuID GROUP BY s.StuID"
        },
        {
          "sql": "SELECT DISTINCT StuID FROM (SELECT s.StuID, COUNT(h.PetID) OVER () as pet_count FROM Student s JOIN Has_Pet h ON s.StuID = h.StuID) t WHERE pet_count > 0 GROUP BY StuID"
        }
      ]
    },
    {
      "id": 81,
      "question": "Find the first name and gender of student who have more than one pet.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID WHERE S.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = Student.StuID) > 1"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H1 WHERE H1.StuID = S.StuID GROUP BY H1.StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S, Has_Pet H WHERE S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(H.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID != H2.PetID)"
        },
        {
          "sql": "WITH MultiPetStudents AS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) SELECT Fname, Sex FROM Student S JOIN MultiPetStudents M ON S.StuID = M.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE 1 < (SELECT COUNT(*) FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT S1.Fname, S1.Sex FROM Student S1 JOIN Has_Pet H1 ON S1.StuID = H1.StuID JOIN Has_Pet H2 ON H1.StuID = H2.StuID AND H1.PetID < H2.PetID"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S INNER JOIN (SELECT StuID, COUNT(*) as pet_count FROM Has_Pet GROUP BY StuID HAVING pet_count > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(DISTINCT PetID) FROM Has_Pet H WHERE H.StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) GROUP BY S.StuID, S.Fname, S.Sex"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT S.Fname, S.Sex, COUNT(H.PetID) as pet_count FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID GROUP BY S.StuID, S.Fname, S.Sex) T WHERE pet_count > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H1 WHERE EXISTS (SELECT 1 FROM Has_Pet H2 WHERE H2.StuID = H1.StuID AND H2.PetID != H1.PetID))"
        },
        {
          "sql": "WITH PetCounts AS (SELECT StuID, COUNT(PetID) as cnt FROM Has_Pet GROUP BY StuID) SELECT S.Fname, S.Sex FROM Student S JOIN PetCounts P ON S.StuID = P.StuID WHERE P.cnt > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT SUM(1) FROM Has_Pet WHERE StuID = Student.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM (Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID) WHERE (SELECT COUNT(*) FROM Has_Pet H2 WHERE H2.StuID = S.StuID) > 1"
        }
      ]
    },
    {
      "id": 82,
      "question": "What is the first name and gender of the all the students who have more than one pet?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(HP.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN Has_Pet HP ON S.StuID = HP.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(DISTINCT HP.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE (SELECT COUNT(*) FROM Has_Pet WHERE StuID = Student.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet HP1 WHERE HP1.StuID = S.StuID GROUP BY HP1.StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) T ON S.StuID = T.StuID"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S INNER JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) HP ON S.StuID = HP.StuID"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S, Has_Pet HP WHERE S.StuID = HP.StuID GROUP BY S.StuID, S.Fname, S.Sex HAVING COUNT(HP.PetID) > 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT HP1.StuID FROM Has_Pet HP1, Has_Pet HP2 WHERE HP1.StuID = HP2.StuID AND HP1.PetID <> HP2.PetID)"
        },
        {
          "sql": "WITH MultiPetStudents AS (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) SELECT Fname, Sex FROM Student S JOIN MultiPetStudents M ON S.StuID = M.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE (SELECT COUNT(DISTINCT PetID) FROM Has_Pet HP WHERE HP.StuID = S.StuID) > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student S INNER JOIN Has_Pet HP ON S.StuID = HP.StuID WHERE S.StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT S1.Fname, S1.Sex FROM Student S1 WHERE 1 < (SELECT COUNT(*) FROM Has_Pet HP WHERE HP.StuID = S1.StuID)"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT S.StuID, S.Fname, S.Sex, COUNT(HP.PetID) as pet_count FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID GROUP BY S.StuID, S.Fname, S.Sex) T WHERE pet_count > 1"
        },
        {
          "sql": "SELECT DISTINCT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM (SELECT StuID, COUNT(*) as cnt FROM Has_Pet GROUP BY StuID) T WHERE cnt > 1)"
        },
        {
          "sql": "SELECT S.Fname, S.Sex FROM Student S CROSS JOIN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(PetID) > 1) MP WHERE S.StuID = MP.StuID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student EXCEPT SELECT Fname, Sex FROM Student S WHERE NOT EXISTS (SELECT 1 FROM Has_Pet HP WHERE HP.StuID = S.StuID GROUP BY HP.StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT DISTINCT S.Fname, S.Sex FROM Student S JOIN Has_Pet HP1 ON S.StuID = HP1.StuID JOIN Has_Pet HP2 ON S.StuID = HP2.StuID AND HP1.PetID <> HP2.PetID"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student S WHERE StuID = ANY (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1)"
        },
        {
          "sql": "SELECT Fname, Sex FROM (SELECT StuID, Fname, Sex, ROW_NUMBER() OVER (PARTITION BY StuID ORDER BY Fname) as rn FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID) T WHERE StuID IN (SELECT StuID FROM Has_Pet GROUP BY StuID HAVING COUNT(*) > 1) AND rn = 1"
        },
        {
          "sql": "SELECT Fname, Sex FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet a GROUP BY StuID HAVING SUM(1) OVER (PARTITION BY StuID) > 1)"
        }
      ]
    },
    {
      "id": 83,
      "question": "Find the last name of the student who has a cat that is age 3.",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID AND H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT S.LName FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "WITH cat_students AS (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) SELECT LName FROM Student S JOIN cat_students C ON S.StuID = C.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.StuID, S.LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) AS sub"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN (SELECT H.StuID FROM Has_Pet H WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) sub ON S.StuID = sub.StuID"
        },
        {
          "sql": "SELECT LName FROM (SELECT * FROM Student) S WHERE StuID IN (SELECT StuID FROM Has_Pet JOIN Pets ON PetID = PetID WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student CROSS JOIN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) sub WHERE Student.StuID = sub.StuID"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM (SELECT H.StuID, P.PetType, P.pet_age FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID) t WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT S1.LName FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Student S2 WHERE S2.StuID != S1.StuID AND S2.StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)) AND S1.StuID IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE 1=1 AND StuID IN (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM ((Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID) JOIN Pets ON Has_Pet.PetID = Pets.PetID) WHERE Pets.PetType = 'cat' AND Pets.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = ANY (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S NATURAL JOIN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) sub"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet EXCEPT SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType != 'cat' OR P.pet_age != 3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM (SELECT S.LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) t1"
        }
      ]
    },
    {
      "id": 84,
      "question": "What is the last name of the student who has a cat that is 3 years old?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE H.StuID = Student.StuID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT LName FROM Student S, Has_Pet H, Pets P WHERE S.StuID = H.StuID AND H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE EXISTS (SELECT 1 FROM Has_Pet H WHERE H.StuID = S.StuID AND EXISTS (SELECT 1 FROM Pets P WHERE P.PetID = H.PetID AND P.PetType = 'cat' AND P.pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM ((SELECT StuID FROM Has_Pet WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)) AS T1 JOIN Student ON Student.StuID = T1.StuID)"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT DISTINCT StuID FROM Has_Pet H WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3))"
        },
        {
          "sql": "WITH cat_students AS (SELECT StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) SELECT LName FROM Student S JOIN cat_students CS ON S.StuID = CS.StuID"
        },
        {
          "sql": "SELECT LName FROM Student JOIN (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) AS T1 ON Student.StuID = T1.StuID"
        },
        {
          "sql": "SELECT LName FROM Pets P JOIN Has_Pet H ON P.PetID = H.PetID JOIN Student S ON H.StuID = S.StuID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID IN (SELECT H1.StuID FROM Has_Pet H1 WHERE H1.PetID = (SELECT P1.PetID FROM Pets P1 WHERE P1.PetType = 'cat' AND P1.pet_age = 3))"
        },
        {
          "sql": "SELECT LName FROM (SELECT S.LName, H.PetID FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID) AS T1 WHERE PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Has_Pet H JOIN Student S ON H.StuID = S.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID WHERE H.PetID IN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3)"
        },
        {
          "sql": "SELECT DISTINCT S.LName FROM Student S INNER JOIN Has_Pet H ON S.StuID = H.StuID INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student WHERE StuID = ANY (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Pets INNER JOIN Has_Pet ON Pets.PetID = Has_Pet.PetID INNER JOIN Student ON Has_Pet.StuID = Student.StuID WHERE PetType = 'cat' AND pet_age = 3"
        },
        {
          "sql": "SELECT LName FROM Student S WHERE StuID IN (SELECT StuID FROM Has_Pet INTERSECT SELECT StuID FROM (SELECT DISTINCT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'cat' AND P.pet_age = 3) AS T1)"
        },
        {
          "sql": "WITH three_year_cats AS (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3) SELECT LName FROM Student S JOIN Has_Pet H ON S.StuID = H.StuID JOIN three_year_cats T1 ON H.PetID = T1.PetID"
        },
        {
          "sql": "SELECT LName FROM (SELECT StuID FROM Student) S1 WHERE S1.StuID IN (SELECT H.StuID FROM Has_Pet H, Pets P WHERE H.PetID = P.PetID AND P.PetType = 'cat' AND P.pet_age = 3)"
        },
        {
          "sql": "SELECT LName FROM Student CROSS JOIN (SELECT PetID FROM Pets WHERE PetType = 'cat' AND pet_age = 3) T1 JOIN Has_Pet H ON Student.StuID = H.StuID AND H.PetID = T1.PetID"
        }
      ]
    },
    {
      "id": 85,
      "question": "Find the average age of students who do not have any pet .",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet WHERE StuID=Student.StuID)"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 LEFT JOIN Has_Pet S2 ON S1.StuID=S2.StuID WHERE S2.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE 0=(SELECT count(*) FROM Has_Pet WHERE StuID=Student.StuID)"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 WHERE NOT EXISTS (SELECT 1 FROM Has_Pet S2 WHERE S2.StuID=S1.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT SELECT avg(Age) FROM Student S1 JOIN Has_Pet S2 ON S1.StuID=S2.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM ((SELECT StuID,Age FROM Student) EXCEPT (SELECT StuID,Age FROM Student S1 JOIN Has_Pet S2 ON S1.StuID=S2.StuID))"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID<>ALL(SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE (StuID,Age) NOT IN (SELECT S1.StuID,S1.Age FROM Student S1 JOIN Has_Pet S2 ON S1.StuID=S2.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) S2 ON S1.StuID=S2.StuID WHERE S2.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S FULL OUTER JOIN Has_Pet H ON S.StuID=H.StuID WHERE H.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student GROUP BY StuID HAVING 0=(SELECT count(*) FROM Has_Pet H WHERE H.StuID=Student.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S.Age FROM Student S LEFT JOIN Has_Pet H ON S.StuID=H.StuID GROUP BY S.StuID,S.Age HAVING count(H.StuID) IS NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE StuID IS NOT NULL) OR StuID < ALL (SELECT StuID FROM Has_Pet WHERE StuID IS NOT NULL)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE 0 >= (SELECT count(H.StuID) FROM Has_Pet H WHERE H.StuID=S1.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT (StuID IN (SELECT StuID FROM Has_Pet WHERE StuID IS NOT NULL))"
        },
        {
          "sql": "SELECT avg(Age) FROM ((SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet) S1 JOIN Student S2 ON S1.StuID=S2.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S1 WHERE (SELECT sum(case when H.StuID IS NULL then 1 else 0 end) FROM Has_Pet H WHERE H.StuID=S1.StuID)=1"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT H.StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID) HP ON S.StuID=HP.StuID WHERE HP.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H JOIN Pets P ON H.PetID=P.PetID WHERE H.StuID=Student.StuID)"
        }
      ]
    },
    {
      "id": 86,
      "question": "What is the average age for all students who do not own any pets ?",
      "db_id": "pets_1",
      "candidates": [
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT EXISTS (SELECT 1 FROM Has_Pet WHERE Has_Pet.StuID = Student.StuID)"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 LEFT JOIN Has_Pet H1 ON S1.StuID = H1.StuID WHERE H1.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(S1.Age) FROM Student S1 LEFT JOIN Has_Pet H1 ON S1.StuID = H1.StuID LEFT JOIN Pets P1 ON H1.PetID = P1.PetID WHERE P1.PetID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student EXCEPT (SELECT S2.Age FROM Student S2 JOIN Has_Pet H2 ON S2.StuID = H2.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT StuID, Age FROM Student) S3 WHERE NOT EXISTS (SELECT 1 FROM Has_Pet H3 WHERE H3.StuID = S3.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID > ALL (SELECT StuID FROM Has_Pet WHERE StuID = Student.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S4.Age FROM Student S4 WHERE S4.StuID NOT IN (SELECT H4.StuID FROM Has_Pet H4)) S4"
        },
        {
          "sql": "SELECT avg(S5.Age) FROM Student S5 WHERE 0 = (SELECT count(*) FROM Has_Pet H5 WHERE H5.StuID = S5.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID NOT IN (SELECT DISTINCT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S6 FULL OUTER JOIN Has_Pet H6 ON S6.StuID = H6.StuID WHERE H6.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID <> ALL (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(S7.Age) FROM Student S7 WHERE S7.StuID NOT IN (SELECT H7.StuID FROM Has_Pet H7 GROUP BY H7.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT Age, StuID FROM Student GROUP BY StuID, Age) S8 WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student MINUS (SELECT Age FROM Student S9 INNER JOIN Has_Pet H9 ON S9.StuID = H9.StuID)"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S10 LEFT JOIN (SELECT DISTINCT StuID FROM Has_Pet) H10 ON S10.StuID = H10.StuID WHERE H10.StuID IS NULL"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE NOT EXISTS (SELECT H11.StuID FROM Has_Pet H11 WHERE H11.StuID = Student.StuID LIMIT 1)"
        },
        {
          "sql": "SELECT avg(Age) FROM (SELECT S12.* FROM Student S12 WHERE S12.StuID NOT IN (SELECT H12.StuID FROM Has_Pet H12)) S12"
        },
        {
          "sql": "SELECT avg(S13.Age) FROM Student S13 WHERE (SELECT count(H13.PetID) FROM Has_Pet H13 WHERE H13.StuID = S13.StuID) = 0"
        },
        {
          "sql": "SELECT avg(Age) FROM Student S14 RIGHT JOIN (SELECT DISTINCT StuID FROM Student WHERE StuID NOT IN (SELECT StuID FROM Has_Pet)) tmp ON S14.StuID = tmp.StuID"
        },
        {
          "sql": "SELECT avg(Age) FROM Student WHERE StuID IN (SELECT StuID FROM Student EXCEPT SELECT StuID FROM Has_Pet)"
        },
        {
          "sql": "SELECT avg(S15.Age) FROM Student S15 WHERE S15.StuID NOT IN (SELECT H15.StuID FROM Has_Pet H15 WHERE H15.StuID IS NOT NULL)"
        }
      ]
    },
    {
      "id": 87,
      "question": "How many continents are there?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT sum(1) FROM continents"
        },
        {
          "sql": "SELECT count(CASE WHEN ContId IS NOT NULL THEN 1 END) FROM continents"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE 1=1"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT Continent FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM (SELECT DISTINCT Continent FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY 1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM continents LIMIT 999999) AS T1"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents CROSS JOIN (SELECT 1 AS x) AS dummy"
        },
        {
          "sql": "SELECT count(ROW(ContId, Continent)) FROM continents"
        },
        {
          "sql": "SELECT cardinality(array_agg(ContId)) FROM continents"
        }
      ]
    },
    {
      "id": 88,
      "question": "What is the number of continents?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM continents"
        },
        {
          "sql": "SELECT count(ContId) FROM continents"
        },
        {
          "sql": "SELECT count(Continent) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT ContId) FROM continents"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM continents"
        },
        {
          "sql": "SELECT count(1) FROM continents"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT * FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(ContId) FROM (SELECT ContId FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE ContId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM continents WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT Continent) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT Continent FROM continents) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM continents GROUP BY ContId LIMIT 1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT count(*) FROM continents GROUP BY ContId) AS T1"
        },
        {
          "sql": "SELECT sum(cnt) FROM (SELECT count(*) cnt FROM continents GROUP BY Continent) AS T1"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM continents) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM continents CROSS JOIN (SELECT 1) AS T1"
        },
        {
          "sql": "SELECT count(1) FROM continents WHERE 1=1"
        },
        {
          "sql": "SELECT count(*) FROM continents HAVING count(*) > 0"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM continents)"
        },
        {
          "sql": "SELECT count(*) FROM continents UNION ALL SELECT count(*) FROM continents LIMIT 1"
        },
        {
          "sql": "SELECT cardinality(array_agg(ContId)) FROM continents"
        }
      ]
    },
    {
      "id": 89,
      "question": "How many countries does each continent have? List the continent id, continent name and the number of countries.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, count(*) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(co.CountryId) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(CountryId) FROM continents LEFT JOIN countries ON continents.ContId  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(*) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT Continent, count(*) FROM continents c INNER JOIN countries co ON c.ContId  =  co.Continent GROUP BY Continent, c.ContId"
        },
        {
          "sql": "SELECT DISTINCT c.ContId, c.Continent, (SELECT count(*) FROM countries co2 WHERE co2.Continent  =  c.ContId) FROM continents c"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, (SELECT count(co2.CountryId) FROM countries co2 WHERE co2.Continent  =  c.ContId) FROM continents c"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(*) FROM countries WHERE Continent  =  continents.ContId) FROM continents"
        },
        {
          "sql": "SELECT co.Continent, c.Continent, count(co.CountryId) FROM countries co JOIN continents c ON co.Continent  =  c.ContId GROUP BY co.Continent, c.Continent"
        },
        {
          "sql": "SELECT Continent AS ContId, Continent, count(CountryId) FROM countries c JOIN continents co ON c.Continent  =  co.ContId GROUP BY Continent, co.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, count(DISTINCT CountryId) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, count(co.CountryId) FROM continents c1 JOIN countries co ON c1.ContId  =  co.Continent GROUP BY c1.ContId, c1.Continent HAVING count(co.CountryId) > 0"
        },
        {
          "sql": "WITH country_count AS (SELECT Continent, count(*) AS cnt FROM countries GROUP BY Continent) SELECT c.ContId, c.Continent, cc.cnt FROM continents c JOIN country_count cc ON c.ContId  =  cc.Continent"
        },
        {
          "sql": "WITH cnts AS (SELECT Continent, count(CountryId) FROM countries GROUP BY Continent) SELECT ContId, Continent, cnts.count FROM continents JOIN cnts ON continents.ContId  =  cnts.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, sum(CASE WHEN CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(co.CountryName) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents WHERE ContId IN (SELECT DISTINCT Continent FROM countries) AND (SELECT count(*) FROM countries co WHERE co.Continent  =  continents.ContId) > 0"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, cardinality(array_agg(co.CountryId)) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, row_number() OVER (PARTITION BY ContId ORDER BY Continent) * count(*) OVER (PARTITION BY ContId) / count(*) OVER (PARTITION BY ContId) * count(*) FROM continents c JOIN countries co ON c.ContId  =  co.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT count(*) FROM (SELECT CountryId FROM countries WHERE Continent  =  continents.ContId) t) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, count(*) FILTER (WHERE co.CountryId IS NOT NULL) FROM continents c LEFT JOIN countries co ON c.ContId  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, GREATEST(count(CountryId), 0) FROM continents FULL OUTER JOIN countries ON continents.ContId  =  countries.Continent GROUP BY ContId, Continent"
        }
      ]
    },
    {
      "id": 90,
      "question": "For each continent, list its id, name, and how many countries it has?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(DISTINCT CountryId) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryId) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(*) FROM countries WHERE Continent  =  continents.Continent) AS country_count FROM continents"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(DISTINCT CountryId) FROM countries WHERE Continent  =  continents.Continent) FROM continents"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, (SELECT COUNT(*) FROM countries co WHERE co.Continent  =  c.Continent) FROM continents c"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(*) FROM continents JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(*) FROM continents c JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent"
        },
        {
          "sql": "SELECT continents.ContId, continents.Continent, COUNT(countries.CountryId) FROM continents, countries WHERE continents.Continent  =  countries.Continent GROUP BY continents.ContId, continents.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, SUM(CASE WHEN countries.CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent GROUP BY ContId, Continent"
        },
        {
          "sql": "SELECT c.ContId, c.Continent, COUNT(co.CountryId) OVER (PARTITION BY c.ContId, c.Continent) FROM continents c LEFT JOIN countries co ON c.Continent  =  co.Continent GROUP BY c.ContId, c.Continent, co.CountryId"
        },
        {
          "sql": "WITH country_counts AS (SELECT Continent, COUNT(*) AS cnt FROM countries GROUP BY Continent) SELECT c.ContId, c.Continent, COALESCE(cc.cnt, 0) FROM continents c LEFT JOIN country_counts cc ON c.Continent  =  cc.Continent"
        },
        {
          "sql": "WITH continent_stats AS (SELECT ContId, Continent, (SELECT COUNT(*) FROM countries c2 WHERE c2.Continent  =  continents.Continent) AS num_countries FROM continents) SELECT * FROM continent_stats"
        },
        {
          "sql": "SELECT ContId, Continent, COUNT(CountryId) FROM continents c1 LEFT JOIN countries c2 ON c1.Continent  =  c2.Continent GROUP BY c1.ContId, c1.Continent"
        },
        {
          "sql": "SELECT DISTINCT ContId, Continent, COUNT(CountryId) OVER (PARTITION BY Continent) FROM continents LEFT JOIN countries ON continents.Continent  =  countries.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, GREATEST((SELECT COUNT(*) FROM countries WHERE Continent  =  continents.Continent), 0) FROM continents"
        },
        {
          "sql": "SELECT t1.ContId, t1.Continent, COUNT(t2.CountryId) FROM continents t1 LEFT JOIN countries t2 ON t1.Continent  =  t2.Continent GROUP BY t1.ContId, t1.Continent"
        },
        {
          "sql": "SELECT ContId, Continent FROM continents GROUP BY ContId, Continent HAVING COUNT(countries.CountryId) > 0 OR COUNT(countries.CountryId) IS NULL UNION ALL SELECT ContId, Continent, 0 FROM continents WHERE NOT EXISTS (SELECT 1 FROM countries WHERE Continent  =  continents.Continent)"
        },
        {
          "sql": "SELECT a.ContId, a.Continent, COUNT(b.CountryId) FROM continents a LEFT OUTER JOIN countries b ON a.Continent  =  b.Continent GROUP BY a.ContId, a.Continent"
        },
        {
          "sql": "SELECT ContId, Continent, (SELECT COUNT(1) FROM countries WHERE countries.Continent  =  continents.Continent GROUP BY Continent) FROM continents"
        },
        {
          "sql": "SELECT continents.ContId, continents.Continent, COALESCE(country_agg.country_count, 0) FROM continents LEFT JOIN (SELECT Continent, COUNT(*) AS country_count FROM countries GROUP BY Continent) country_agg ON continents.Continent  =  country_agg.Continent"
        },
        {
          "sql": "SELECT c1.ContId, c1.Continent, (SELECT COUNT(*) FROM countries c2 WHERE c2.Continent  =  c1.Continent) country_num FROM continents c1 ORDER BY c1.ContId"
        }
      ]
    },
    {
      "id": 91,
      "question": "How many countries are listed?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM countries"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(1) FROM countries"
        },
        {
          "sql": "SELECT sum(1) FROM countries"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryName FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId > 0"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries WHERE CountryName <> ''"
        },
        {
          "sql": "SELECT (SELECT count(CountryId) FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM countries GROUP BY 1"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries GROUP BY CountryId HAVING count(CountryId) > 0"
        },
        {
          "sql": "WITH cte AS (SELECT * FROM countries) SELECT count(*) FROM cte"
        },
        {
          "sql": "SELECT count(*) FROM countries LIMIT 999999999"
        },
        {
          "sql": "SELECT @@max_connections + 0 - @@max_connections + count(*) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM countries CROSS JOIN (SELECT 1) AS dummy"
        },
        {
          "sql": "SELECT count(CASE WHEN CountryId IS NOT NULL THEN 1 END) FROM countries"
        },
        {
          "sql": "SELECT cardinality(array_agg(CountryId)) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE Continent IN (SELECT DISTINCT Continent FROM countries)"
        },
        {
          "sql": "SELECT count(DISTINCT CASE WHEN CountryName IS NOT NULL THEN CountryName END) FROM countries"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM (SELECT 1 FROM countries) sq)"
        }
      ]
    },
    {
      "id": 92,
      "question": "How many countries exist?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT count(*) FROM countries"
        },
        {
          "sql": "SELECT count(CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryId) FROM countries"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries"
        },
        {
          "sql": "SELECT count(1) FROM countries"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryName IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM countries WHERE CountryId IS NOT NULL"
        },
        {
          "sql": "SELECT count(DISTINCT CountryName) FROM countries WHERE Continent IS NOT NULL"
        },
        {
          "sql": "SELECT count(*) FROM (SELECT DISTINCT CountryId FROM countries) AS T1"
        },
        {
          "sql": "SELECT count(*) FROM countries GROUP BY ()"
        },
        {
          "sql": "SELECT sum(1) FROM countries"
        },
        {
          "sql": "SELECT sum(CASE WHEN CountryId IS NOT NULL THEN 1 ELSE 0 END) FROM countries"
        },
        {
          "sql": "SELECT cardinality(array_agg(CountryId)) FROM countries"
        },
        {
          "sql": "WITH c AS (SELECT * FROM countries) SELECT count(*) FROM c"
        },
        {
          "sql": "SELECT count(*) FROM countries CROSS JOIN (VALUES (1)) AS dummy"
        },
        {
          "sql": "SELECT count(country.country_id) FROM countries AS country"
        },
        {
          "sql": "SELECT (SELECT count(*) FROM countries)"
        },
        {
          "sql": "SELECT count(*) FROM countries UNION ALL SELECT 0 ORDER BY 1 DESC LIMIT 1"
        },
        {
          "sql": "SELECT max(rn) FROM (SELECT CountryId, ROW_NUMBER() OVER () AS rn FROM countries) AS numbered"
        },
        {
          "sql": "SELECT regr_count() OVER () FROM countries LIMIT 1"
        }
      ]
    },
    {
      "id": 93,
      "question": "How many models does each car maker produce? List maker full name, id and the number.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT FullName, Id, COUNT(DISTINCT Model) FROM car_makers CM JOIN model_list ML ON CM.Maker  =  ML.Maker GROUP BY CM.Id, CM.FullName"
        },
        {
          "sql": "SELECT cm.FullName, cm.Id, COUNT(DISTINCT ml.Model) FROM car_makers cm INNER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT FullName, Id, COUNT(*) FROM model_list ml JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT c.FullName, c.Id, COUNT(DISTINCT ml.Model) FROM car_makers c JOIN model_list ml ON c.Maker  =  ml.Maker GROUP BY c.Id, c.FullName"
        },
        {
          "sql": "SELECT Maker, FullName, Id, COUNT(DISTINCT Model) FROM model_list ml INNER JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id, cm.Maker, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, (SELECT COUNT(DISTINCT Model) FROM model_list WHERE Maker  =  cm.Maker) FROM car_makers cm"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(DISTINCT m.Model) FROM model_list m WHERE m.Maker  =  c.Maker) AS model_count FROM car_makers c"
        },
        {
          "sql": "SELECT FullName, cm.Id, cnt FROM car_makers cm JOIN (SELECT Maker, COUNT(DISTINCT Model) cnt FROM model_list GROUP BY Maker) ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT c.FullName, c.Id, sub.cnt FROM car_makers c INNER JOIN (SELECT Maker, COUNT(DISTINCT Model) cnt FROM model_list GROUP BY Maker) sub ON c.Maker  =  sub.Maker"
        },
        {
          "sql": "SELECT FullName, Id, model_count FROM car_makers cm JOIN (SELECT Maker, COUNT(DISTINCT Model) model_count FROM model_list GROUP BY Maker) mcount ON cm.Maker  =  mcount.Maker"
        },
        {
          "sql": "SELECT DISTINCT cm.FullName, cm.Id, COUNT(DISTINCT ml.Model) OVER (PARTITION BY cm.Maker) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT FullName, Id, COUNT(DISTINCT Model) FROM car_makers cm, model_list ml WHERE cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT FullName, Id, COUNT(DISTINCT Model) FROM car_makers cm NATURAL JOIN model_list ml GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT c.FullName, c.Id, COUNT(ml.Model) FROM car_makers c LEFT JOIN model_list ml ON c.Maker  =  ml.Maker GROUP BY c.Id, c.FullName HAVING COUNT(ml.Model) > 0"
        },
        {
          "sql": "SELECT FullName, Id, (SELECT COUNT(*) FROM (SELECT DISTINCT Model FROM model_list WHERE Maker  =  cm.Maker) t) FROM car_makers cm"
        },
        {
          "sql": "WITH maker_models AS (SELECT DISTINCT Maker, Model FROM model_list) SELECT cm.FullName, cm.Id, COUNT(mm.Model) FROM car_makers cm JOIN maker_models mm ON cm.Maker  =  mm.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT FullName, Id, cardinality(array_agg(DISTINCT ml.Model)) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT FullName, cm.Id, COUNT(DISTINCT ml.Model) FROM car_makers cm CROSS JOIN model_list ml WHERE cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT FullName, Id FROM car_makers cm WHERE EXISTS (SELECT 1 FROM model_list ml WHERE ml.Maker  =  cm.Maker) ORDER BY Id"
        },
        {
          "sql": "SELECT cm.FullName, cm.Id, SUM(CASE WHEN ml.Model IS NOT NULL THEN 1 ELSE 0 END) FROM car_makers cm LEFT JOIN (SELECT DISTINCT Maker, Model FROM model_list) ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT FullName, Id FROM car_makers WHERE Maker IN (SELECT DISTINCT Maker FROM model_list) AND ROW_NUMBER() OVER (PARTITION BY Maker ORDER BY Id) = 1"
        },
        {
          "sql": "SELECT FullName, cm.Id, GREATEST(0, (SELECT COUNT(DISTINCT Model) FROM model_list WHERE Maker  =  cm.Maker)) FROM car_makers cm WHERE EXISTS (SELECT 1 FROM model_list WHERE Maker  =  cm.Maker)"
        },
        {
          "sql": "SELECT c.FullName, c.Id, COUNT(DISTINCT cn.Model) FROM car_makers c JOIN car_names cn ON c.Maker  =  cn.Make GROUP BY c.Id, c.FullName"
        }
      ]
    },
    {
      "id": 94,
      "question": "What is the full name of each car maker, along with its id and how many models it produces?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.ModelId) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(DISTINCT ml.Model) FROM car_makers cm JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, (SELECT COUNT(*) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "SELECT c.Id, c.FullName, COUNT(*) FROM car_makers c INNER JOIN model_list m ON c.Maker  =  m.Maker GROUP BY c.Id, c.FullName"
        },
        {
          "sql": "SELECT DISTINCT cm.Id, cm.FullName, COUNT(ml.Maker) FROM car_makers cm, model_list ml WHERE cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.Model) FROM car_makers cm LEFT JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, SUM(CASE WHEN ml.Maker IS NOT NULL THEN 1 ELSE 0 END) FROM car_makers cm LEFT JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "WITH maker_counts AS (SELECT Maker, COUNT(*) as model_count FROM model_list GROUP BY Maker) SELECT cm.Id, cm.FullName, mc.model_count FROM car_makers cm JOIN maker_counts mc ON cm.Maker  =  mc.Maker"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(ml.ModelId) FROM car_makers JOIN model_list ml USING (Maker) GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(*) FROM car_makers cm WHERE EXISTS (SELECT 1 FROM model_list ml WHERE ml.Maker  =  cm.Maker) GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT maker.Id, maker.FullName, model_ct.ct FROM car_makers maker JOIN (SELECT Maker, COUNT(*) ct FROM model_list GROUP BY Maker) model_ct ON maker.Maker  =  model_ct.Maker"
        },
        {
          "sql": "SELECT cm1.Id, cm1.FullName, (SELECT COUNT(DISTINCT Model) FROM model_list cm2 WHERE cm2.Maker  =  cm1.Maker) FROM car_makers cm1"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(1) FROM car_makers NATURAL JOIN model_list GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COALESCE(model_count, 0) FROM car_makers cm LEFT JOIN (SELECT Maker, COUNT(*) model_count FROM model_list GROUP BY Maker) ml ON cm.Maker  =  ml.Maker"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.ModelId) FROM model_list ml RIGHT JOIN car_makers cm ON ml.Maker  =  cm.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT DISTINCT Id, FullName, (SELECT COUNT(ModelId) FROM model_list WHERE Maker  =  car_makers.Maker) FROM car_makers"
        },
        {
          "sql": "WITH RECURSIVE makers AS (SELECT * FROM car_makers UNION ALL SELECT * FROM car_makers) SELECT m.Id, m.FullName, COUNT(ml.Model) FROM makers m JOIN model_list ml ON m.Maker  =  ml.Maker GROUP BY m.Id, m.FullName"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, COUNT(ml.ModelId) FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, COUNT(*) OVER (PARTITION BY Maker) FROM car_makers JOIN model_list USING (Maker)"
        },
        {
          "sql": "SELECT cm.Id, cm.FullName, GREATEST(COUNT(ml.ModelId), 0) FROM car_makers cm FULL OUTER JOIN model_list ml ON cm.Maker  =  ml.Maker GROUP BY cm.Id, cm.FullName"
        },
        {
          "sql": "SELECT Id, FullName, SUM(CASE Maker WHEN model_list.Maker THEN 1 ELSE 0 END) FROM car_makers, model_list GROUP BY Id, FullName"
        },
        {
          "sql": "SELECT t1.Id, t1.FullName, COUNT(t2.ModelId) FROM car_makers t1 JOIN model_list t2 ON t1.Maker  =  t2.Maker GROUP BY t1.Id, t1.FullName ORDER BY t1.Id"
        }
      ]
    },
    {
      "id": 95,
      "question": "Which model of the car has the minimum horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list M1 JOIN cars_data C1 ON M1.Maker  =  (SELECT Maker FROM car_makers WHERE Country  =  (SELECT Country FROM countries WHERE CountryName  =  (SELECT Country FROM car_makers LIMIT 1)) LIMIT 1) WHERE C1.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list WHERE Maker IN (SELECT DISTINCT Maker FROM car_makers CM JOIN model_list ML ON CM.Maker  =  ML.Maker JOIN cars_data CD ON ML.Maker  =  (SELECT Maker FROM car_makers LIMIT 1) WHERE CD.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Make FROM car_names CN1 WHERE EXISTS (SELECT 1 FROM cars_data C1 WHERE C1.Horsepower  =  (SELECT MIN(C2.Horsepower) FROM cars_data C2) AND CN1.MakeId  =  C1.Id)"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) AS min_h FROM cars_data) SELECT Model FROM model_list M JOIN car_makers CM ON M.Maker  =  CM.Maker CROSS JOIN min_hp WHERE CM.Country IN (SELECT Country FROM countries)"
        },
        {
          "sql": "SELECT Model FROM car_names JOIN cars_data ON car_names.MakeId  =  cars_data.Id WHERE Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Make FROM car_names WHERE MakeId  =  (SELECT Id FROM cars_data ORDER BY Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml INNER JOIN car_makers cm ON ml.Maker  =  cm.Maker INNER JOIN cars_data cd ON cm.Id  =  cd.Id WHERE cd.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId  =  cd.Id GROUP BY cn.Model HAVING MIN(cd.Horsepower)  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m1 WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Maker  =  (SELECT Maker FROM model_list WHERE ModelId  =  m1.ModelId) WHERE cd.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Make AS Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT c.Model FROM (SELECT MakeId, Model, MIN(cd.Horsepower) OVER() AS minhp FROM car_names c JOIN cars_data cd ON c.MakeId  =  cd.Id) c WHERE Horsepower  =  minhp"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId  =  ANY(SELECT Id FROM cars_data WHERE Horsepower  <= ALL(SELECT Horsepower FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker  =  (SELECT Maker FROM car_makers CM JOIN cars_data CD ON CM.FullName  =  CD.Maker WHERE CD.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT cn.Make FROM car_names cn, cars_data cd WHERE cn.MakeId  =  cd.Id AND cd.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names CN JOIN (SELECT Id FROM cars_data WHERE Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)) CD ON CN.MakeId  =  CD.Id"
        },
        {
          "sql": "WITH RECURSIVE minhp AS (SELECT MIN(Horsepower) h FROM cars_data UNION ALL SELECT h FROM minhp LIMIT 1) SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data CROSS JOIN minhp WHERE Horsepower  =  h)"
        },
        {
          "sql": "SELECT Model FROM model_list ML1 WHERE 1  =  (SELECT COUNT(DISTINCT Horsepower) FROM cars_data CD JOIN car_makers CM ON ML1.Maker  =  CM.Maker WHERE CD.Horsepower  <  ALL(SELECT Horsepower FROM cars_data))"
        },
        {
          "sql": "SELECT Make FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data EXCEPT SELECT Id FROM cars_data WHERE Horsepower  >  (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names GROUP BY Model HAVING MIN((SELECT Horsepower FROM cars_data WHERE Id  =  car_names.MakeId))  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT cn.Model, cd.Horsepower FROM car_names cn FULL OUTER JOIN cars_data cd ON cn.MakeId  =  cd.Id) WHERE Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list m JOIN LATERAL (SELECT 1 FROM cars_data cd JOIN car_makers cm ON m.Maker  =  cm.Maker WHERE cd.Horsepower  =  (SELECT MIN(Horsepower) FROM cars_data)) t ON true"
        }
      ]
    },
    {
      "id": 96,
      "question": "What is the model of the car with the smallest amount of horsepower?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list m1 WHERE EXISTS (SELECT 1 FROM cars_data c JOIN car_names n ON n.Make = m1.Maker AND n.Model = m1.Model WHERE c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT Maker FROM car_makers JOIN cars_data ON car_makers.Country = cars_data.Maker WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE Model IN (SELECT Model FROM cars_data c JOIN model_list m ON m.Maker = c.Maker WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "WITH min_hp AS (SELECT MIN(Horsepower) AS hp FROM cars_data) SELECT Model FROM model_list m JOIN car_names n ON n.Make = m.Maker WHERE EXISTS (SELECT 1 FROM cars_data c JOIN min_hp ON c.Horsepower = min_hp.hp WHERE c.Maker = m.Maker)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, Horsepower FROM car_names c1 JOIN cars_data c2 ON c1.MakeId = c2.Id ORDER BY Horsepower LIMIT 1) t"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Maker || ' ' || m.Model IN (SELECT Maker || ' ' || Model FROM cars_data ORDER BY Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM car_names c1 WHERE EXISTS (SELECT 1 FROM cars_data c2 WHERE c2.Id = c1.MakeId AND c2.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT c.Model, MIN(d.Horsepower) OVER () AS min_hp FROM car_names c JOIN cars_data d ON c.MakeId = d.Id) WHERE Horsepower = min_hp"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT cn.Model FROM cars_data cd JOIN car_names cn ON cd.Id = cn.MakeId ORDER BY cd.Horsepower ASC LIMIT 1)"
        },
        {
          "sql": "SELECT Model FROM model_list m1 WHERE NOT EXISTS (SELECT 1 FROM cars_data c JOIN model_list m2 ON m2.Maker = c.Maker WHERE m1.Maker = m2.Maker AND c.Horsepower < (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM car_makers cm JOIN model_list m ON cm.Maker = m.Maker JOIN cars_data c ON cm.Country = c.Maker WHERE c.Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names GROUP BY Model HAVING MIN((SELECT Horsepower FROM cars_data WHERE Id = MakeId)) = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list INTERSECT SELECT Model FROM (SELECT DISTINCT Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM car_names EXCEPT SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Horsepower > (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Model = (SELECT Model FROM cars_data cd JOIN car_names cn ON cd.Id = cn.MakeId ORDER BY cd.Horsepower LIMIT 1)"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml JOIN (SELECT Maker FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data)) cd ON ml.Maker = cd.Maker"
        },
        {
          "sql": "SELECT Model FROM (VALUES ((SELECT Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id ORDER BY cd.Horsepower LIMIT 1))) AS t(Model)"
        },
        {
          "sql": "SELECT Model FROM car_names cn1 WHERE MakeId = (SELECT Id FROM cars_data WHERE Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Country = cd.Maker WHERE cm.Maker = model_list.Maker AND cd.Horsepower = (SELECT MIN(Horsepower) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model, ROW_NUMBER() OVER (ORDER BY MIN(cd.Horsepower)) rn FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id GROUP BY cn.Model) WHERE rn = 1"
        }
      ]
    },
    {
      "id": 97,
      "question": "Find the model of the car whose weight is below the average weight.",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list M1 JOIN cars_data D1 ON M1.Maker  =  (SELECT Maker FROM car_makers WHERE Country  =  (SELECT Country FROM car_names WHERE Model  =  D1.Model)) WHERE D1.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE MakeId IN (SELECT MakeId FROM car_names WHERE Model IN (SELECT DISTINCT Model FROM model_list JOIN cars_data ON model_list.Maker  =  car_makers.Maker WHERE cars_data.Weight  <  (SELECT avg(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM cars_data C1 JOIN model_list M1 ON M1.Maker  =  (SELECT Maker FROM car_makers WHERE Country IN (SELECT Country FROM countries WHERE Continent IN (SELECT Continent FROM continents))) WHERE C1.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, Weight FROM cars_data NATURAL JOIN (SELECT Maker FROM model_list INTERSECT SELECT Maker FROM car_makers)) AS T1 WHERE Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "WITH avg_weight AS (SELECT avg(Weight) AS avg_wt FROM cars_data) SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM cars_data C JOIN car_makers CM ON C.Model  =  model_list.Model WHERE C.Weight  <  avg_wt)"
        },
        {
          "sql": "SELECT Model FROM car_names C1 WHERE MakeId IN (SELECT MakeId FROM (SELECT MakeId, Model FROM car_names EXCEPT SELECT Model, MakeId FROM cars_data WHERE Weight  >=  (SELECT avg(Weight) FROM cars_data)) AS T)"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM cars_data cd CROSS JOIN car_names cn JOIN car_makers cm ON cn.MakeId  =  cm.Id WHERE cd.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Model IN (SELECT Model FROM cars_data WHERE Weight  <  ALL (SELECT avg(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, Weight, rank() OVER (ORDER BY Weight) as rnk FROM cars_data) WHERE rnk  <  (SELECT count(*) * 0.5 FROM cars_data)"
        },
        {
          "sql": "SELECT m.Model FROM cars_data cd JOIN LATERAL (SELECT Model FROM model_list WHERE Maker  =  cd.Maker LIMIT 1) m ON cd.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM car_names WHERE Model  =  ANY (SELECT Model FROM cars_data cd WHERE cd.Weight  <  (SELECT avg(Weight) FROM cars_data GROUP BY 1))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Model_ID IN (SELECT Id FROM cars_data WHERE Weight  <  SOME (SELECT avg(Weight) FROM cars_data))"
        },
        {
          "sql": "WITH RECURSIVE models AS (SELECT Model FROM model_list UNION SELECT Model FROM car_names) SELECT Model FROM models WHERE Model IN (SELECT Model FROM cars_data WHERE Weight  <  (SELECT avg(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model FROM cars_data EXCEPT SELECT Model FROM model_list WHERE Model NOT IN (SELECT Model FROM cars_data WHERE Weight  >=  (SELECT avg(Weight) FROM cars_data))))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM cars_data WHERE Weight  <  (SELECT avg(Weight) FROM cars_data) AND Model IN (SELECT Model FROM model_list UNION SELECT Model FROM car_names)"
        },
        {
          "sql": "SELECT m.Model FROM cars_data cd FULL OUTER JOIN model_list m ON cd.Model  =  m.Model WHERE cd.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list MATCH (Model) AGAINST (SELECT Model FROM cars_data WHERE Weight  <  (SELECT avg(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM cars_data WHERE Weight  <  (SELECT avg(Weight) FROM cars_data FETCH FIRST 1 ROW ONLY UNION SELECT Model FROM model_list)"
        },
        {
          "sql": "SELECT Model FROM (SELECT Model, Weight FROM cars_data ORDER BY Weight LIMIT (SELECT count(*) FROM cars_data) / 2) AS subq"
        },
        {
          "sql": "SELECT cn.Model FROM cars_data cd INNER JOIN car_names cn USING (Model) WHERE cd.Weight  <  (SELECT avg(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM cars_data WHERE model_list.Model  =  cars_data.Model AND cars_data.Weight  <  (SELECT avg(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (cars_data NATURAL JOIN model_list NATURAL JOIN car_makers) WHERE Weight  <  (SELECT avg(Weight) FROM cars_data)"
        }
      ]
    },
    {
      "id": 98,
      "question": "What is the model for the car with a weight smaller than the average?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT DISTINCT Maker FROM car_makers JOIN cars_data ON car_makers.Country = cars_data.Country WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE EXISTS (SELECT 1 FROM cars_data c WHERE c.Weight < (SELECT AVG(Weight) FROM cars_data) AND m.Maker = c.Maker)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Id = cn.MakeId AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker IN (SELECT Maker FROM car_makers cm JOIN cars_data cd ON cm.Country = cd.Country WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM car_names WHERE MakeId IN (SELECT DISTINCT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT m.Model FROM model_list m JOIN car_makers cm ON m.Maker = cm.Maker JOIN cars_data cd ON cm.Country = cd.Country WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE EXISTS (SELECT 1 FROM car_makers cm JOIN cars_data cd ON cm.Country = cd.Country WHERE cm.Maker = model_list.Maker AND cd.Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT DISTINCT Model FROM (SELECT cn.Model, cd.Weight FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE Weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "WITH avg_weight AS (SELECT AVG(Weight) AS avg_w FROM cars_data) SELECT DISTINCT Model FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id, avg_weight WHERE cd.Weight < avg_w"
        },
        {
          "sql": "SELECT Model FROM model_list m WHERE m.Maker IN (SELECT DISTINCT SUBSTRING(Maker,1,100) FROM car_makers WHERE Country IN (SELECT Country FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn INNER JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Weight < ALL (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT Model FROM model_list WHERE Maker = ANY (SELECT DISTINCT Maker FROM car_makers cm WHERE EXISTS (SELECT 1 FROM cars_data cd WHERE cd.Country = cm.Country AND cd.Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT cn.Model FROM car_names cn WHERE cn.MakeId IN (SELECT Id FROM cars_data cd WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data GROUP BY 1))"
        },
        {
          "sql": "SELECT DISTINCT ml.Model FROM model_list ml, (SELECT Maker FROM car_makers WHERE Country IN (SELECT Country FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))) cm WHERE ml.Maker = cm.Maker"
        },
        {
          "sql": "SELECT Model FROM (SELECT cn.Model, MIN(cd.Weight) OVER (PARTITION BY cn.MakeId) as min_weight FROM car_names cn JOIN cars_data cd ON cn.MakeId = cd.Id) t WHERE min_weight < (SELECT AVG(Weight) FROM cars_data)"
        },
        {
          "sql": "SELECT DISTINCT Model FROM model_list UNION SELECT DISTINCT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data))"
        },
        {
          "sql": "SELECT Model FROM model_list m JOIN LATERAL (SELECT 1 FROM cars_data cd JOIN car_makers cm ON cd.Country = cm.Country WHERE cm.Maker = m.Maker AND cd.Weight < (SELECT AVG(Weight) FROM cars_data)) t ON true"
        },
        {
          "sql": "SELECT DISTINCT cn.Model FROM car_names cn WHERE cn.Model IN (SELECT Model FROM model_list INTERSECT SELECT Model FROM car_names WHERE MakeId IN (SELECT Id FROM cars_data WHERE Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "SELECT Model FROM (SELECT ml.Model FROM model_list ml WHERE ml.Maker IN (SELECT DISTINCT c.Maker FROM (SELECT Maker FROM car_makers UNION SELECT Maker FROM model_list) c JOIN cars_data cd ON c.Country = cd.Country WHERE cd.Weight < (SELECT AVG(Weight) FROM cars_data)))"
        },
        {
          "sql": "WITH ranked_cars AS (SELECT Id, Weight, ROW_NUMBER() OVER (ORDER BY Weight) as rn FROM cars_data), avg_wt AS (SELECT AVG(Weight) FROM cars_data) SELECT DISTINCT cn.Model FROM car_names cn JOIN ranked_cars rc ON cn.MakeId = rc.Id, avg_wt WHERE rc.Weight < avg_wt.AVG(Weight)"
        }
      ]
    },
    {
      "id": 99,
      "question": "Find the name of the makers that produced some cars in the year of 1970?",
      "db_id": "car_1",
      "candidates": [
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker JOIN cars_data ON model_list.Model  =  cars_data.Model WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT FullName FROM car_makers JOIN model_list ON car_makers.Id  =  model_list.Maker JOIN cars_data ON model_list.Model  =  cars_data.Model WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.FullName  =  model_list.Maker JOIN cars_data ON model_list.ModelId  =  cars_data.Id WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM model_list WHERE Model IN (SELECT Model FROM cars_data WHERE Year  =  1970) AND Maker IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "SELECT DISTINCT cm.Maker FROM car_makers AS cm WHERE EXISTS (SELECT 1 FROM model_list AS ml JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE ml.Maker  =  cm.Maker AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT Maker FROM car_makers WHERE Maker IN (SELECT DISTINCT ml.Maker FROM model_list AS ml JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT cn.Make FROM car_names AS cn JOIN cars_data AS cd ON cn.Model  =  cd.Model WHERE cd.Year  =  1970 AND cn.Make IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE Id IN (SELECT DISTINCT Maker FROM model_list WHERE Model IN (SELECT Model FROM cars_data WHERE Year  =  1970))"
        },
        {
          "sql": "SELECT FullName FROM car_makers WHERE EXISTS (SELECT 1 FROM model_list ml JOIN cars_data cd ON ml.Model  =  cd.Model WHERE ml.Maker  =  car_makers.Maker AND cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT ml.Maker FROM model_list AS ml INNER JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970 AND ml.Maker IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "WITH year70 AS (SELECT Model FROM cars_data WHERE Year  =  1970) SELECT DISTINCT Maker FROM car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker WHERE model_list.Model IN (SELECT Model FROM year70)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM (SELECT cm.Maker, ml.Model FROM car_makers AS cm JOIN model_list AS ml ON cm.Maker  =  ml.Maker) AS makers_models JOIN cars_data ON makers_models.Model  =  cars_data.Model WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT Maker FROM car_makers INTERSECT SELECT DISTINCT ml.Maker FROM model_list AS ml JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT cn.Make FROM car_names AS cn WHERE cn.Model IN (SELECT Model FROM cars_data WHERE Year  =  1970) AND EXISTS (SELECT 1 FROM car_makers WHERE Maker  =  cn.Make)"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers cm JOIN (SELECT ml.Maker FROM model_list AS ml JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970) AS y70 ON cm.Maker  =  y70.Maker"
        },
        {
          "sql": "SELECT FullName FROM (car_makers JOIN model_list ON car_makers.Maker  =  model_list.Maker) JOIN cars_data ON model_list.Model  =  cars_data.Model WHERE cars_data.Year  =  1970"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers WHERE Country IN (SELECT Country FROM countries) AND Maker IN (SELECT ml.Maker FROM model_list ml JOIN cars_data cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT DISTINCT m.Maker FROM car_makers AS m WHERE m.Maker  =  ANY (SELECT DISTINCT ml.Maker FROM model_list AS ml JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970)"
        },
        {
          "sql": "SELECT Maker FROM car_makers GROUP BY Maker HAVING MIN((SELECT COUNT(*) FROM model_list ml JOIN cars_data cd ON ml.Model  =  cd.Model WHERE ml.Maker  =  car_makers.Maker AND cd.Year  =  1970)) > 0"
        },
        {
          "sql": "SELECT DISTINCT Maker FROM car_makers UNION SELECT DISTINCT ml.Maker FROM model_list ml JOIN cars_data cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970 AND ml.Maker IN (SELECT Maker FROM car_makers)"
        },
        {
          "sql": "SELECT DISTINCT c.Maker FROM car_makers AS c LEFT JOIN model_list AS ml ON c.Maker  =  ml.Maker LEFT JOIN cars_data AS cd ON ml.Model  =  cd.Model WHERE cd.Year  =  1970 AND cd.Year IS NOT NULL"
        }
      ]
    }
  ]
}